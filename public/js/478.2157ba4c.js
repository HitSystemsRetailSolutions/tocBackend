"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[478],{3449:function(e,a,l){l.d(a,{O:function(){return u}});var t=l(73396),o=l(20065),n=l(91076),i=l(42492),d=l.n(i);function u(){const e=(0,o.oR)(),a=(0,t.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),l=(0,t.Fl)((()=>e.state.Trabajadores.indexActivo)),i=(0,t.Fl)((()=>a.value&&void 0!=l.value&&null!=l.value&&a.value[l.value]?a.value[l.value]:null)),u=(0,t.Fl)((()=>e.state.Cestas.arrayCestas));async function s(e){try{const a=await n.Z.post("clientes/getClienteById",{idCliente:e});if(a.data)return r(a.data);throw new Error("No se ha podido obtener la información del cliente desde el backend")}catch(a){return d().fire("Oops...",a.message,"error"),!1}}async function r(a){const{id:l,nombre:t,albaran:o,vip:d,descuento:s}=a;if(u.value)for(let r=0;r<u.value.length;r++)if(i.value.idCesta===u.value[r]._id){await e.dispatch("Cestas/setClienteCesta",{index:r,idCliente:l,albaran:o,nombreCliente:t,vip:d});e.dispatch("EstadoDinamico/setVistaCliente",!0);const a=o||d||!s?0:s;return e.dispatch("Cestas/setDescuentoAction",Number(a)/100),n.Z.post("cestas/recalcularIvas",{idCesta:u.value[r]._id}),!0}return!1}return{findCliente:s}}},61562:function(e,a,l){l.d(a,{Z:function(){return m}});var t=l(73396),o=l(87139);const n=["onClick"],i={class:"botonTecladoSpaceDiv"};function d(e,a,l,d,u,s){const r=(0,t.up)("MDBInput"),c=(0,t.up)("MDBModalHeader"),p=(0,t.up)("MDBModalBody"),m=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(m,{frame:"",position:"bottom",id:"keyBoardModal",tabindex:"-1",labelledby:"keyBoardModal",modelValue:d.keyBoardModal,"onUpdate:modelValue":a[4]||(a[4]=e=>d.keyBoardModal=e)},{default:(0,t.w5)((()=>[d.showInput?((0,t.wg)(),(0,t.j4)(c,{key:0},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{style:{width:"80rem !important"},label:"Texto introducido",modelValue:d.text,"onUpdate:modelValue":a[0]||(a[0]=e=>d.text=e)},null,8,["modelValue"])])),_:1})):(0,t.kq)("",!0),(0,t.Wm)(p,{class:"mainDiv"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(d.chars.length,((e,a)=>((0,t.wg)(),(0,t.iD)("div",{key:a},[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(d.chars[e-1],((e,a)=>((0,t.wg)(),(0,t.iD)("div",{class:"btn-group-vertical mt-1 divTecla",key:a},[(0,t._)("button",{type:"button",style:(0,o.j5)([{"text-transform":"none"},d.keyStyle(e)]),class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a=>d.processTecla(e)},(0,o.zw)(e),13,n)])))),128))])))),128)),(0,t._)("div",i,[(0,t._)("button",{style:(0,o.j5)([{"font-size":"1.8rem"},d.keyStyle("✎")]),type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[1]||(a[1]=e=>d.processTecla("✎"))}," ✎ ",4),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonTecladoSpace",onClick:a[2]||(a[2]=e=>d.processTecla(" "))}," ␣ "),(0,t._)("button",{style:(0,o.j5)([{"font-size":"1.8rem"},d.keyStyle("#")]),type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[3]||(a[3]=e=>d.processTecla("#"))}," Ⅳ ",4)])])),_:1})])),_:1},8,["modelValue"])}var u=l(44870),s=l(74313),r={name:"KeyBoardComponent",components:{MDBIcon:s.vm,MDBModalBody:s.Yz,MDBModal:s.j3,MDBBtn:s.$v,MDBModalHeader:s.ol,MDBModalTitle:s.wo,MDBInput:s.u2,MDBModalFooter:s.ab},props:{value:String,text:String},setup(e,{expose:a}){const l=(0,u.iH)(e.value||""),o=(0,u.iH)(!1),n=(0,u.iH)(!1),i=(0,u.iH)(!1);let d=!1;const s=(0,u.iH)(!1),r=[["q","w","e","r","t","y","u","i","o","p","←"],["a","s","d","f","g","h","j","k","l","ñ","↵"],["z","x","c","v","b","n","m",",",".","-","⇪"]],c=(0,u.iH)([]);function p(e){switch(e){case"←":b();break;case"↵":o.value=!1;break;case"⇪":d=!d,l.value.length>0&&(n.value=!n.value),f();break;case"#":i.value=!i.value,f();break;case"✎":s.value=!s.value;break;default:v(e);break}}function m(e){let a=l.value.length<=0&&!d||n.value,t="background-color: #606060 !important; color: white !important;";return i.value&&"#"==e||s.value&&"✎"==e||"⇪"==e&&a?t:a?"text-transform: uppercase":"text-transform: none;"}function v(e){let a=l.value.length<=0&&!d||n.value;d=!1,a&&(e=e.toUpperCase()),l.value+=e}function b(){l.value.length>0&&(l.value=l.value.slice(0,-1))}function f(){let e=r;const a=["á","é","í","ó","ú","ü","¡","¿"];if(i.value){let a=[["1","2","3","4","5","6","7","8","9","0","ç"]];a=a.concat(r),e=a}c.value=e.map((e=>e.map((e=>a.includes(e)?[e,e.toUpperCase()]:e))))}function y(e=""){void 0===l.value&&(l.value=""),l.value=e,o.value=!0}function C(){return[l.value,o.value]}return a({getValue:C,abrirModal:y}),(0,t.bv)((()=>{f()})),{text:l,addTecla:v,deleteTecla:b,keyBoardModal:o,processTecla:p,upperCase:n,keyStyle:m,buildKeyboard:f,abrirModal:y,showInput:s,chars:c}}},c=l(40089);const p=(0,c.Z)(r,[["render",d],["__scopeId","data-v-c19133e2"]]);var m=p},33727:function(e,a,l){l.d(a,{Z:function(){return C}});var t=l(73396),o=l(87139);const n={class:"btn-group"},i={class:"btn-group"},d={class:"btn-group"},u={class:"btn-group"},s={class:"btn-group"};function r(e,a,l,r,c,p){return(0,t.wg)(),(0,t.iD)("div",{class:(0,o.C_)(["btn-group-vertical mt-1",{disabled:l.disabled}])},[(0,t._)("div",n,[(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[0]||(a[0]=e=>r.addTecla("1"))}," 1 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[1]||(a[1]=e=>r.addTecla("2"))}," 2 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[2]||(a[2]=e=>r.addTecla("3"))}," 3 ")]),(0,t._)("div",i,[(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[3]||(a[3]=e=>r.addTecla("4"))}," 4 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[4]||(a[4]=e=>r.addTecla("5"))}," 5 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[5]||(a[5]=e=>r.addTecla("6"))}," 6 ")]),(0,t._)("div",d,[(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[6]||(a[6]=e=>r.addTecla("7"))}," 7 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[7]||(a[7]=e=>r.addTecla("8"))}," 8 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[8]||(a[8]=e=>r.addTecla("9"))}," 9 ")]),(0,t._)("div",u,[(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[9]||(a[9]=e=>r.deleteTecla())}," < "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[10]||(a[10]=e=>r.addTecla("0"))}," 0 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary botonNumpad",onClick:a[11]||(a[11]=e=>r.addTecla("."))}," , ")]),(0,t._)("div",s,[(0,t._)("button",{type:"button",class:"btn btn-outline-secondary botonComa",onClick:a[12]||(a[12]=e=>r.okValue(Number(r.cantidad)))}," OK ")])],2)}l(42492);var c=l(32066),p=l(28571),m=l(44870);const v=(0,c.io)("http://"+p.Z.state.TocGameURL+":5051");var b={props:{skipBalanza:{type:Boolean,default:!1},max3EntersDigits:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},name:"NumpadComponent",setup(e,{expose:a,emit:l}){const o=(0,m.iH)("0"),n=(0,t.f3)("okValue"),i=(0,m.iH)("5.5rem"),d=(0,m.iH)("5.5rem");(0,t.Fl)((()=>p.Z.state.Weight.lastWeight));function u(){l("activarShake")}function s(a){if(e.max3EntersDigits){let[e,l]=o.value.split("."),t=o.value.includes(".");if(e.length>=3&&!t&&"."!=a)return u();if(l&&l.length>=2)return u();if("."===a&&o.value.includes("."))return u()}"."===a&&o.value.includes(".")||(o.value+=a,"0"==o.value[0]&&(o.value=o.value.slice(1)),l("setValue",o.value))}function r(){o.value=o.value.slice(0,-1),""===o.value&&(o.value="0")}function c(e){o.value=Number(e).toString(),l("setValue",o.value)}return v.on("setBalanzaValue",(a=>{a&&!e.skipBalanza&&c(a)})),a({cantidad:o,setValor:c}),(0,t.bv)((async()=>{e.skipBalanza||c((await(0,t.Fl)((()=>p.Z.state.Weight.lastWeight))).value)})),{okValue:n,cantidad:o,addTecla:s,deleteTecla:r,setValor:c,anchoTecla:i,altoTecla:d}}},f=l(40089);const y=(0,f.Z)(b,[["render",r],["__scopeId","data-v-2468ee80"]]);var C=y},46626:function(e,a,l){l.d(a,{Z:function(){return q}});var t=l(73396),o=l(87139),n=l(49242);const i={class:"row"},d={class:"d-inline-block text-center"},u={class:"row mt-1 p-4"},s={class:"col-md-8"},r={class:"col-md-4"},c={key:0,class:"row"},p={class:"col"},m={class:"table-responsive w-100",style:{height:"400px"}},v={class:"table table-striped mt-1"},b={class:"nameDiv"},f={class:"textoNombre d-inline-block text-truncate"},y={key:1,class:"row"},C={class:"sinResultados position-relative"},M={class:"textoSinResultados position-absolute top-50 start-50 translate-middle"};function _(e,a,l,_,B,k){const g=(0,t.up)("MDBBtn"),w=(0,t.up)("MDBBadge"),D=(0,t.up)("MDBicon"),h=(0,t.up)("MDBModalBody"),T=(0,t.up)("MDBModal"),x=(0,t.up)("ModalNuevoCliente"),V=(0,t.up)("KeyBoardComponentVue"),H=(0,t.up)("ModalCondicionalClienteComponent");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(T,{id:"modalClientes",tabindex:"-1",labelledby:"tituloModalClientes",modelValue:_.modalClientes,"onUpdate:modelValue":a[8]||(a[8]=e=>_.modalClientes=e),staticBackdrop:"",size:"xl"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[(0,t._)("div",i,[(0,t._)("div",d,[(0,t.Wm)(g,{color:"warning",class:"sizeBotones",onClick:a[0]||(a[0]=e=>_.clickDelivery("Glovo")),disabled:!_.activoGlovo},{default:(0,t.w5)((()=>[(0,t.Uk)("Glovo")])),_:1},8,["disabled"]),(0,t.Wm)(g,{color:"dark",class:"ms-2 sizeBotones",disabled:!_.activoUber,onClick:a[1]||(a[1]=e=>_.clickDelivery("Uber"))},{default:(0,t.w5)((()=>[(0,t.Uk)("Uber")])),_:1},8,["disabled"]),(0,t.Wm)(g,{color:"primary",class:"ms-2 sizeBotones",disabled:!_.activoToGo,onClick:a[2]||(a[2]=e=>_.clickDelivery("TooGoodToGo"))},{default:(0,t.w5)((()=>[(0,t.Uk)("To Go")])),_:1},8,["disabled"]),(0,t.Wm)(g,{color:"success",class:"ms-2 sizeBotones",onClick:a[3]||(a[3]=e=>_.modalNuevoClienteRef.abrirModal())},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$t("nuevo","Nuevo")),1)])),_:1}),(0,t.Wm)(g,{color:"danger",class:"ms-2 sizeBotones",onClick:a[4]||(a[4]=e=>_.modalClientes=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$t("salir","Salir")),1)])),_:1})])]),(0,t._)("div",u,[(0,t._)("div",s,[(0,t.wy)((0,t._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:"Buscar por nombre","aria-label":".form-control-lg example","onUpdate:modelValue":a[5]||(a[5]=e=>_.inputBusqueda=e),onClick:a[6]||(a[6]=e=>_.openKeyboard()),readonly:""},null,512),[[n.nr,_.inputBusqueda]])]),(0,t._)("div",r,[(0,t.Wm)(g,{color:"secondary",class:"botonBusqueda w-100",onClick:a[7]||(a[7]=e=>_.buscar())},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$t("buscar","Buscar")),1)])),_:1})])]),_.arrayClientes?.length>0?((0,t.wg)(),(0,t.iD)("div",c,[(0,t._)("div",p,[(0,t._)("div",m,[(0,t._)("table",v,[(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(_.arrayClientes,((a,l)=>((0,t.wg)(),(0,t.iD)("tr",{key:l},[(0,t._)("td",null,[(0,t._)("div",b,[(0,t._)("span",f,(0,o.zw)(a.nombre),1),(0,t.Uk)("  "),a.albaran?((0,t.wg)(),(0,t.j4)(w,{key:0,badge:"info",class:"text-dark textoAlbaran",pill:""},{default:(0,t.w5)((()=>[(0,t.Uk)("Albaran")])),_:1})):a?.vip?((0,t.wg)(),(0,t.j4)(w,{key:1,badge:"info",class:"text-dark textoAlbaran",pill:""},{default:(0,t.w5)((()=>[(0,t.Uk)("Vip")])),_:1})):(0,t.kq)("",!0)])]),(0,t._)("td",null,[(0,t.Wm)(g,{color:"primary",size:"lg",onClick:e=>_.selectCliente(a.id,a.nombre),class:"w-100",style:{height:"3.85rem","font-size":"1.5rem"}},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$t("elegir","Elegir")),1),(0,t.Wm)(D,{icon:""})])),_:2},1032,["onClick"])])])))),128))])])])])])):((0,t.wg)(),(0,t.iD)("div",y,[(0,t._)("div",C,[(0,t._)("span",M,(0,o.zw)(e.$t("sin_resultados","Sin resultados")),1)])]))])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(x,{ref:"modalNuevoClienteRef"},null,512),(0,t.Wm)(V,{ref:"keyboardRef"},null,512),(0,t.Wm)(H,{ref:"refModalCondicionalCliente",onSetModo:_.updateModo},null,8,["onSetModo"])],64)}var B=l(91076),k=l(74313),g=l(42492),w=l.n(g),D=l(44870),h=l(20065),T=l(62492),x=l(61562),V=l(3449);const H=e=>((0,t.dD)("data-v-12a0a310"),e=e(),(0,t.Cn)(),e),N={class:"h4 mx-2 py-2 border-bottom"},z={class:"d-flex justify-content-between mt-3 mx-2"},U=H((()=>(0,t._)("input",{type:"radio",name:"tipo",id:"tipo1",value:"CONSUMO_PERSONAL"},null,-1))),W={for:"tipo1",class:"h5"},j=H((()=>(0,t._)("input",{type:"radio",name:"tipo",id:"tipo2",value:"VENTA"},null,-1))),S={for:"tipo2",class:"h5"},F={class:"h5"},I=H((()=>(0,t._)("i",{class:"fa fa-exclamation-circle text-danger","aria-hidden":"true"},null,-1)));function Z(e,a,l,n,i,d){const u=(0,t.up)("MDBModalTitle"),s=(0,t.up)("MDBModalHeader"),r=(0,t.up)("MDBModalBody"),c=(0,t.up)("MDBBtn"),p=(0,t.up)("MDBModalFooter"),m=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(m,{id:"modalCondicionalCliente",tabindex:"-1",labelledby:"modalCondicionalCliente",modelValue:n.modalCondicionalCliente,"onUpdate:modelValue":a[4]||(a[4]=e=>n.modalCondicionalCliente=e),staticBackdrop:"",centered:""},{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t.Wm)(u,{class:"h3 ms-2"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(n.nombreCliente)+" "+(0,o.zw)(e.$t("es_un_trabajador","es un trabajador")),1)])),_:1})])),_:1}),(0,t.Wm)(r,{class:"py-3"},{default:(0,t.w5)((()=>[(0,t._)("h2",N,(0,o.zw)(e.$t("elige_el_tipo_de_cobro","Elige el tipo de cobro"))+": ",1),(0,t._)("div",z,[(0,t._)("div",{class:"inputCondCliente",onClick:a[0]||(a[0]=e=>n.tipo="CONSUMO_PERSONAL")},[U,(0,t._)("label",W,(0,o.zw)(e.$t("consumo_personal","Consumo personal")),1)]),(0,t._)("div",{class:"inputCondCliente",onClick:a[1]||(a[1]=e=>n.tipo="VENTA")},[j,(0,t._)("label",S,(0,o.zw)(e.$t("ticket_normal","Ticket normal")),1)])]),(0,t._)("div",{class:(0,o.C_)([{"d-none":!n.errorValidacionTipo},"m-2 text-center"])},[(0,t._)("p",F,[I,(0,t.Uk)(" "+(0,o.zw)(n.commentError),1)])],2)])),_:1}),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{color:"success",size:"lg",onClick:a[2]||(a[2]=e=>n.confirmarTipo())},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$t("confirmar","confirmar")),1)])),_:1}),(0,t.Wm)(c,{color:"warning",size:"lg",onClick:a[3]||(a[3]=e=>n.cerrarModalCondicionalCliente())},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}var E={name:"ModalCondicionalClienteComponent",components:{MDBModal:k.j3,MDBModalBody:k.Yz,MDBBtn:k.$v,MDBModalHeader:k.ol,MDBModalTitle:k.wo,MDBModalFooter:k.ab,MDBIcon:k.vm,MDBTabs:k.zk,MDBTabNav:k.JH,MDBTabItem:k.kX,MDBTabContent:k.oJ,MDBTabPane:k.jE,MDBSelect:k.R3,MDBPopover:k.SW},setup(e,{expose:a,emit:l}){(0,h.oR)();const t=(0,D.iH)(!1),o=(0,D.iH)(null),n=(0,D.iH)(!1),i=(0,D.iH)(""),d=(0,D.iH)(""),u=(0,D.iH)(null),s=()=>{o.value?(n.value=!1,"CONSUMO_PERSONAL"===o.value?l("setModo",{modo:"CONSUMO_PERSONAL",idCliente:u.value}):l("setModo",{modo:"VENTA",idCliente:u.value}),c()):(n.value=!0,i.value=$t("debes_seleccionar_un_tipo_de_cobro","Debes seleccionar un tipo de cobro"))},r=(e,a=null)=>{t.value=!0,u.value=e,d.value=a},c=()=>{t.value=!1,o.value=null,n.value=!1,i.value="",u.value=null,d.value=""};return a({abrirModal:r}),{modalCondicionalCliente:t,tipo:o,errorValidacionTipo:n,commentError:i,confirmarTipo:s,cerrarModalCondicionalCliente:c,nombreCliente:d}}},A=l(40089);const O=(0,A.Z)(E,[["render",Z],["__scopeId","data-v-12a0a310"]]);var $=O,R={name:"ModalClientesComponent",components:{MDBModal:k.j3,MDBModalBody:k.Yz,MDBBtn:k.$v,ModalNuevoCliente:T.Z,MDBIcon:k.vm,MDBBadge:k.m_,KeyBoardComponentVue:x.Z,ModalCondicionalClienteComponent:$},setup(e,a){const l=(0,h.oR)(),o=(0,D.iH)(!1),n=(0,D.iH)(0),i=(0,D.iH)(null),d=(0,D.iH)(""),u=(0,D.iH)(),s=(0,D.iH)(null),r=(0,D.iH)(!0),c=(0,D.iH)(!0),p=(0,D.iH)(!0),m=(0,t.f3)("actualizarPuntos"),v=(0,t.Fl)((()=>l.state.Trabajadores.arrayTrabajadores)),b=(0,t.Fl)((()=>l.state.Trabajadores.indexActivo)),f=((0,t.Fl)((()=>v.value&&void 0!=b.value&&null!=b.value&&v.value[b.value]?v.value[b.value]:null)),(0,t.Fl)((()=>l.state.Cestas.arrayCestas))),y=(0,t.Fl)((()=>{if(f.value)for(let e=0;e<f.value.length;e++)if(f.value[e]._id==v.value[b.value].idCesta)return f.value[e];return null})),C=(0,D.iH)(!1),M=e=>{z(e)},{findCliente:_}=(0,V.O)();function k(){o.value=!0,x()}function g(){n.value++}function T(e){B.Z.post("clientes/getClienteById",{idCliente:e}).then((a=>{if(!a.data)throw Error("No se ha podido obtener la información del cliente. backend");N(e,a.data.nombre,a.data.albaran,a.data.vip)})).catch((e=>{w().fire("Oops...",e.message,"error")}))}const x=async()=>{const e=await B.Z.post("clientes/getServiciosTienda");e.data?(r.value=!!e.data.includes("Glovo"),c.value=!!e.data.includes("TooGoodToGo"),p.value=!!e.data.includes("Uber")):(r.value=!1,c.value=!1,p.value=!1)},H=async e=>{const a=await B.Z.post("clientes/getClienteByServicio",{servicio:e});if(!a.data)throw Error("No se ha podido obtener la información del cliente. backend");T(a.data)};async function N(e,a){const{data:l}=await B.Z.get("clientes/getIdTrabajadorCliente",{params:{idCliente:e}});if(l&&C.value)C.value.abrirModal(e,a);else{const a=await _(e);a&&(m(),U())}}async function z(e){const a=f.value.findIndex((e=>e._id===y.value._id));-1!==a&&l.dispatch("Cestas/setModoCesta",{index:a,modo:e.modo});const t=await _(e.idCliente);t&&m(),U()}function U(){o.value=!1}function W(){B.Z.post("clientes/buscar",{busqueda:d.value}).then((e=>{u.value=e.data})).catch((e=>{w().fire("Oops...",e.message,"error")}))}let j;async function S(){try{i.value.abrirModal(d.value),j=setInterval((()=>{d.value=i.value.getValue()[0],i.value.getValue()[1]||clearInterval(j)}),100)}catch(e){console.log(e),j=void 0}}return(0,t.YP)(d,(()=>{W()})),a.expose({abrirModal:k,datoBorrar:n,selectCliente:N}),(0,t.JJ)("cerrarModalClientes",U),{test:g,datoBorrar:n,modalClientes:o,inputBusqueda:d,arrayClientes:u,selectCliente:N,buscar:W,keyboardRef:i,openKeyboard:S,modalNuevoClienteRef:s,clickClienteAtajo:T,activoGlovo:r,activoToGo:c,activoUber:p,clickDelivery:H,refModalCondicionalCliente:C,updateModo:M}}};const G=(0,A.Z)(R,[["render",_],["__scopeId","data-v-cd4d2582"]]);var q=G},62492:function(e,a,l){l.d(a,{Z:function(){return _}});var t=l(73396),o=l(87139);const n={class:"row"},i={class:"col w-50"},d={class:"col w-50 datos"},u={key:0,class:"spinner"},s={key:1};function r(e,a,l,r,c,p){const m=(0,t.up)("MDBModalHeader"),v=(0,t.up)("MDBInput"),b=(0,t.up)("MDBModalBody"),f=(0,t.up)("MDBBtn"),y=(0,t.up)("MDBModalFooter"),C=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(C,{id:"modalFichaCliente",tabindex:"-1",labelledby:"tituloModalFichaCliente",modelValue:r.modalFichaCliente,"onUpdate:modelValue":a[9]||(a[9]=e=>r.modalFichaCliente=e),staticBackdrop:"",size:"xl"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t._)("h2",null,"Ficha de "+(0,o.zw)(r.nombre),1)])),_:1}),(0,t.Wm)(b,null,{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("div",i,[(0,t.Wm)(v,{label:"Nombre",modelValue:r.nombre,"onUpdate:modelValue":a[0]||(a[0]=e=>r.nombre=e),style:{"margin-top":"10px"}},null,8,["modelValue"]),(0,t.Wm)(v,{label:"Telefono",modelValue:r.telefono,"onUpdate:modelValue":a[1]||(a[1]=e=>r.telefono=e),class:"datos",style:{"margin-top":"10px"}},null,8,["modelValue"]),(0,t.Wm)(v,{label:"email",modelValue:r.email,"onUpdate:modelValue":a[2]||(a[2]=e=>r.email=e),class:"datos",style:{"margin-top":"10px"}},null,8,["modelValue"]),(0,t.Wm)(v,{label:"direccion",modelValue:r.direccion,"onUpdate:modelValue":a[3]||(a[3]=e=>r.direccion=e),class:"datos",style:{"margin-top":"10px"}},null,8,["modelValue"])]),(0,t._)("div",d,[(0,t.Wm)(v,{label:"Tarjeta Cliente",modelValue:r.tarjeta,"onUpdate:modelValue":a[4]||(a[4]=e=>r.tarjeta=e),class:"datos",style:{"margin-top":"10px"},"aria-required":"true"},null,8,["modelValue"]),(0,t.Wm)(v,{label:"Nif",modelValue:r.nif,"onUpdate:modelValue":a[5]||(a[5]=e=>r.nif=e),class:"datos",style:{"margin-top":"10px"}},null,8,["modelValue"]),(0,t.Wm)(v,{label:"descuento",modelValue:r.descuento,"onUpdate:modelValue":a[6]||(a[6]=e=>r.descuento=e),type:"number",min:"0",max:"100",class:"datos",style:{"margin-top":"10px"},onChange:r.validateDescuento},null,8,["modelValue","onChange"])])])])),_:1}),(0,t.Wm)(y,null,{default:(0,t.w5)((()=>[(0,t.Wm)(f,{color:"primary",onClick:a[7]||(a[7]=e=>r.guardarCliente()),disabled:r.loading,class:"btnSpinner d-flex align-items-center justify-content-center"},{default:(0,t.w5)((()=>[r.loading?((0,t.wg)(),(0,t.iD)("span",u)):((0,t.wg)(),(0,t.iD)("span",s,"Guardar"))])),_:1},8,["disabled"]),(0,t.Wm)(f,{color:"danger",onClick:a[8]||(a[8]=e=>r.modalFichaCliente=!1),ref:"salirBoton",disabled:r.loading},{default:(0,t.w5)((()=>[(0,t.Uk)(" Salir ")])),_:1},8,["disabled"])])),_:1})])),_:1},8,["modelValue"])}var c=l(74313),p=l(44870),m=l(91076),v=l(42492),b=l.n(v),f=l(3449),y={name:"ModalFichaClienteComponent",props:["callback"],components:{MDBBtn:c.$v,MDBInput:c.u2,MDBModal:c.j3,MDBModalBody:c.Yz,MDBModalFooter:c.ab,MDBModalHeader:c.ol},setup(e,{expose:a}){const l=(0,p.iH)(!1),o=(0,p.iH)(""),n=(0,p.iH)(""),i=(0,p.iH)(""),d=(0,p.iH)(""),u=(0,p.iH)(""),s=(0,p.iH)(""),r=(0,p.iH)("0"),c=((0,p.iH)(null),(0,p.iH)(null)),v=(0,t.f3)("cerrarModalClientes"),y=(0,p.iH)(!1),{findCliente:C}=(0,f.O)(),M=(0,t.f3)("actualizarPuntos"),_=async()=>{""!=o.value?isNaN(Number(r.value))?b().fire({title:"Vaya...",text:"El descuento tiene que ser un número",icon:"error",confirmButtonText:"Aceptar"}):(y.value=!0,m.Z.post("clientes/crearNuevoCliente",{nombre:o.value,telefono:n.value,email:i.value,direccion:d.value,tarjetaCliente:u.value,nif:s.value,descuento:r.value}).then((async e=>{if(e.data.success){b().fire({title:"Cliente creado",icon:"success",confirmButtonText:"Aceptar"});const a=await C(e.data.idCliente);a&&M(),y.value=!1,l.value=!1,v&&"function"===typeof v&&v()}else b().fire({title:"Vaya...",text:e.data.message,icon:"error",confirmButtonText:"Aceptar"}),y.value=!1})).catch((e=>{console.log(e),b().fire({title:"Vaya...",text:"Error al crear el cliente",icon:"error",confirmButtonText:"Aceptar"}),y.value=!1}))):b().fire({title:"Vaya...",text:"El campo de nombre y de tarjeta son obligatorios",icon:"error",confirmButtonText:"Aceptar"})};function B(e=""){o.value="",n.value="",i.value="",d.value="",u.value=e,s.value="",r.value="",l.value=!0}function k(e){const a=e.target.value,l=a.replace(/[^0-9.]/g,""),[t,o]=l.split("."),n=o&&o.length>2?o.slice(0,2):o,i=t+(n?`.${n}`:""),d=parseFloat(i);isNaN(d)?r.value="":r.value=d<0?"0":d>100?"100":i}return a({abrirModal:B}),{modalFichaCliente:l,guardarCliente:_,nombre:o,telefono:n,email:i,direccion:d,tarjeta:u,nif:s,descuento:r,salirBoton:c,loading:y,validateDescuento:k}}},C=l(40089);const M=(0,C.Z)(y,[["render",r],["__scopeId","data-v-085c5614"]]);var _=M}}]);
//# sourceMappingURL=478.2157ba4c.js.map