"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[412],{8412:function(e,a,t){t.r(a),t.d(a,{default:function(){return U}});var s=t(3396),l=t(7139);const n=e=>((0,s.dD)("data-v-5a6046a2"),e=e(),(0,s.Cn)(),e),i={id:"main"},o={id:"vueMenuEncargo"},c={class:"encargos"},r={class:""},d={class:"row"},u=n((()=>(0,s._)("div",{class:"col"},null,-1))),v={class:"col"},_={key:0},g={class:"btnEncargo lgEncargo float-right"},p={key:1,class:"btnEncargo float-right"},m=n((()=>(0,s._)("i",{class:"fas fa-search"},null,-1))),C=n((()=>(0,s._)("hr",null,null,-1))),b={class:"productos"},D={key:0},f={class:"d-flex flex-column justify-content-center"},w={class:"d-flex flex-column justify-content-center"},h={key:1},k={class:"encargos-footer"},y=n((()=>(0,s._)("small",{id:"emailHelp",class:"form-text text-muted"},"Precio total:",-1))),E={class:"mb-0 mt-2"},T={class:""};function x(e,a,t,n,x,A){return(0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("div",o,[(0,s._)("div",null,[(0,s._)("div",c,[(0,s._)("div",r,[(0,s._)("div",d,[u,(0,s._)("div",v,[n.clienteData.idCliente?((0,s.wg)(),(0,s.iD)("h1",_,[(0,s._)("button",g,(0,l.zw)(n.clienteData.nombreCliente),1)])):((0,s.wg)(),(0,s.iD)("button",p,[m,(0,s.Uk)(" Abrir modal cliente ")]))])]),C,(0,s._)("div",b,[n.cestaActiva.lista.length?((0,s.wg)(),(0,s.iD)("div",D,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.cestaActiva.lista,((e,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"producto",key:a},[(0,s._)("div",f,[(0,s._)("span",null,(0,l.zw)(e.nombre),1),(0,s._)("div",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.arraySuplementos,((e,a)=>((0,s.wg)(),(0,s.iD)("span",{key:a},(0,l.zw)(e.nombre),1)))),128))]),(0,s._)("span",null,(0,l.zw)(e.unidades)+" unidad(es)",1)])])))),128))])):((0,s.wg)(),(0,s.iD)("div",h,(0,l.zw)(e.$t("toc_game_no_hay_productos","No hay ningún producto seleccionado")),1))]),(0,s._)("div",k,[(0,s._)("div",null,[y,(0,s._)("p",E,(0,l.zw)(n.precioTotal)+"€",1)]),(0,s._)("div",T,[(0,s._)("input",{type:"button",value:"Crear deuda",class:"btn btn-primary btn-lg",onClick:a[0]||(a[0]=(...e)=>n.crearDeuda&&n.crearDeuda(...e))})])])])])])])])}t(7658);var A=t(4870),j=t(65),z=t(2492),F=t.n(z),H=t(5658),O=t(4161),N=t(250),I={name:"DeudasComponent",setup(){const e=(0,j.oR)(),{t:a}=(0,H.QT)(),t=(0,A.iH)(0),l=e.getters["Cestas/getCestaActiva"],n=e.getters["Cestas/getCestaActivaIndex"],i=(0,s.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),o=(0,s.Fl)((()=>e.state.Trabajadores.indexActivo)),c=(0,s.Fl)((()=>i.value&&null!=o.value&&void 0!=o.value&&i.value[o.value]?i.value[o.value]:null)),r=(0,A.iH)(null),d={idCliente:l.idCliente,nombreCliente:l.nombreCliente},u=()=>{const e=l.lista.reduce(((e,a)=>e+a.subtotal),0);return Number(e.toFixed(2))},v=async()=>{try{console.log("OK=0");const e=await O.Z.post("tickets/crearTicket",{total:u(),idCesta:l._id,idTrabajador:c.value._id,tipo:"DEUDA",tkrsData:{cantidadTkrs:t.value,formaPago:"EFECTIVO"},concepto:"DEUDA"});if(!e.data)throw Error("No se ha podido crear el ticket");g(a("toc_game_encargos_ok","Encargo creado!"),"success",_)}catch(e){F().fire("Oops...",e.message,"error")}},_=async()=>(await e.dispatch("Cestas/setModoCesta",{index:n,modo:"VENTA"}),e.dispatch("Cestas/setClienteCesta",{index:n,idCliente:null,nombreCliente:null}),e.dispatch("EstadoDinamico/reset"),e.dispatch("Cestas/deleteLista",l._id),p("/"),Promise.resolve()),g=(e,a,t=(()=>{}))=>{F().fire("error"===a?"Oops...":"Ok!!",e,a).then((()=>t()))},p=e=>N.Z.push(e);return(0,s.bv)((()=>{console.log(l),r.value=u()})),{crearDeuda:v,cestaActiva:l,clienteData:d,precioTotal:r,cantidadTkrs:t}}},K=t(89);const P=(0,K.Z)(I,[["render",x],["__scopeId","data-v-5a6046a2"]]);var U=P}}]);
//# sourceMappingURL=412.e1405365.js.map