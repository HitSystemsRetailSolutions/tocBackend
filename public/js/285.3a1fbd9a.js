"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[285],{3449:function(e,a,o){o.d(a,{O:function(){return s}});var l=o(73396),t=o(20065),r=o(91076),i=o(42492),n=o.n(i);function s(){const e=(0,t.oR)(),a=(0,l.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),o=(0,l.Fl)((()=>e.state.Trabajadores.indexActivo)),i=(0,l.Fl)((()=>a.value&&void 0!=o.value&&null!=o.value&&a.value[o.value]?a.value[o.value]:null)),s=(0,l.Fl)((()=>e.state.Cestas.arrayCestas));async function d(e){try{const a=await r.Z.post("clientes/getClienteById",{idCliente:e});if(a.data)return c(a.data);throw new Error("No se ha podido obtener la información del cliente desde el backend")}catch(a){return n().fire("Oops...",a.message,"error"),!1}}async function c(a){const{id:o,nombre:l,albaran:t,vip:n,descuento:d}=a;if(s.value)for(let c=0;c<s.value.length;c++)if(i.value.idCesta===s.value[c]._id){await e.dispatch("Cestas/setClienteCesta",{index:c,idCliente:o,albaran:t,nombreCliente:l,vip:n});e.dispatch("EstadoDinamico/setVistaCliente",!0);const a=t||n||!d?0:d;return e.dispatch("Cestas/setDescuentoAction",Number(a)/100),r.Z.post("cestas/recalcularIvas",{idCesta:s.value[c]._id}),!0}return!1}return{findCliente:d}}},22871:function(e,a,o){o.d(a,{Z:function(){return p}});var l=o(73396),t=o(87139);const r=["onClick"],i={class:"botonTecladoSpaceDiv"};function n(e,a,o,n,s,d){const c=(0,l.up)("MDBInput"),u=(0,l.up)("MDBModalHeader"),m=(0,l.up)("MDBModalBody"),p=(0,l.up)("MDBModal");return(0,l.wg)(),(0,l.j4)(p,{frame:"",position:"bottom",id:"keyBoardModal",tabindex:"-1",labelledby:"keyBoardModal",modelValue:n.keyBoardModal,"onUpdate:modelValue":a[5]||(a[5]=e=>n.keyBoardModal=e)},{default:(0,l.w5)((()=>[n.showInput?((0,l.wg)(),(0,l.j4)(u,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{style:{width:"80rem !important"},label:"Texto introducido",modelValue:n.text,"onUpdate:modelValue":a[0]||(a[0]=e=>n.text=e)},null,8,["modelValue"])])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(m,{class:"mainDiv"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.chars.length,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.chars[e-1],((e,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"btn-group-vertical mt-1 divTecla",key:a},[(0,l._)("button",{type:"button",style:(0,t.j5)([{"text-transform":"none"},n.keyStyle(e)]),class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a=>n.processTecla(e)},(0,t.zw)(e),13,r)])))),128))])))),128)),(0,l._)("div",i,[(0,l._)("button",{style:(0,t.j5)([{"font-size":"1.8rem"},n.keyStyle("✎")]),type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[1]||(a[1]=e=>n.processTecla("✎"))}," ✎ ",4),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonTecladoSpace",onClick:a[2]||(a[2]=e=>n.processTecla(" "))}," ␣ "),(0,l._)("button",{style:{"font-size":"1.8rem"},type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[3]||(a[3]=e=>n.processTecla("@"))}," @ "),(0,l._)("button",{style:(0,t.j5)([{"font-size":"1.8rem"},n.keyStyle("#")]),type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[4]||(a[4]=e=>n.processTecla("#"))}," Ⅳ ",4)])])),_:1})])),_:1},8,["modelValue"])}var s=o(44870),d=o(74313),c={name:"KeyBoardComponent",components:{MDBIcon:d.vm,MDBModalBody:d.Yz,MDBModal:d.j3,MDBBtn:d.$v,MDBModalHeader:d.ol,MDBModalTitle:d.wo,MDBInput:d.u2,MDBModalFooter:d.ab},props:{value:String,text:String},setup(e,{expose:a}){const o=(0,s.iH)(e.value||""),t=(0,s.iH)(!1),r=(0,s.iH)(!1),i=(0,s.iH)(!1);let n=!1;const d=(0,s.iH)(!1),c=[["q","w","e","r","t","y","u","i","o","p","←"],["a","s","d","f","g","h","j","k","l","ñ","↵"],["z","x","c","v","b","n","m",",",".","-","⇪"]],u=(0,s.iH)([]);function m(e){switch(e){case"←":f();break;case"↵":t.value=!1;break;case"⇪":n=!n,o.value.length>0&&(r.value=!r.value),g();break;case"#":i.value=!i.value,g();break;case"✎":d.value=!d.value;break;default:v(e);break}}function p(e){let a=(o.value?.length<=0||!o.value)&&!n||r.value,l="background-color: #606060 !important; color: white !important;";return i.value&&"#"==e||d.value&&"✎"==e||"⇪"==e&&a?l:a?"text-transform: uppercase":"text-transform: none;"}function v(e){let a=r.value;n=!1,a&&(e=e.toUpperCase()),o.value+=e}function b(e){o.value=e}function f(){o.value.length>0&&(o.value=o.value.slice(0,-1))}function g(){let e=c;const a=["á","é","í","ó","ú","ü","¡","¿"];if(i.value){let a=[["1","2","3","4","5","6","7","8","9","0","ç"]];a=a.concat(c),e=a}u.value=e.map((e=>e.map((e=>a.includes(e)?[e,e.toUpperCase()]:e))))}function C(e=""){void 0===o.value&&(o.value=""),o.value=e,t.value=!0}function y(){return[o.value,t.value]}return a({getValue:y,abrirModal:C,setText:b}),(0,l.bv)((()=>{g()})),{text:o,addTecla:v,deleteTecla:f,keyBoardModal:t,processTecla:m,upperCase:r,keyStyle:p,buildKeyboard:g,abrirModal:C,showInput:d,chars:u}}},u=o(40089);const m=(0,u.Z)(c,[["render",n],["__scopeId","data-v-0b19e9d8"]]);var p=m},33727:function(e,a,o){o.d(a,{Z:function(){return C}});var l=o(73396),t=o(87139);const r={class:"btn-group"},i={class:"btn-group"},n={class:"btn-group"},s={class:"btn-group"},d={class:"btn-group"};function c(e,a,o,c,u,m){return(0,l.wg)(),(0,l.iD)("div",{class:(0,t.C_)(["btn-group-vertical mt-1",{disabled:o.disabled}])},[(0,l._)("div",r,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[0]||(a[0]=e=>c.addTecla("1"))}," 1 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[1]||(a[1]=e=>c.addTecla("2"))}," 2 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[2]||(a[2]=e=>c.addTecla("3"))}," 3 ")]),(0,l._)("div",i,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[3]||(a[3]=e=>c.addTecla("4"))}," 4 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[4]||(a[4]=e=>c.addTecla("5"))}," 5 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[5]||(a[5]=e=>c.addTecla("6"))}," 6 ")]),(0,l._)("div",n,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[6]||(a[6]=e=>c.addTecla("7"))}," 7 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[7]||(a[7]=e=>c.addTecla("8"))}," 8 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[8]||(a[8]=e=>c.addTecla("9"))}," 9 ")]),(0,l._)("div",s,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[9]||(a[9]=e=>c.deleteTecla())}," < "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[10]||(a[10]=e=>c.addTecla("0"))}," 0 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary botonNumpad",onClick:a[11]||(a[11]=e=>c.addTecla("."))}," , ")]),(0,l._)("div",d,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary botonComa",onClick:a[12]||(a[12]=e=>c.okValue(Number(c.cantidad)))}," OK ")])],2)}o(42492);var u=o(32066),m=o(25994),p=o(44870);const v=(0,u.io)("http://"+m.Z.state.TocGameURL+":5051");var b={props:{skipBalanza:{type:Boolean,default:!1},max3EntersDigits:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},name:"NumpadComponent",setup(e,{expose:a,emit:o}){const t=(0,p.iH)("0"),r=(0,l.f3)("okValue"),i=(0,p.iH)("5.5rem"),n=(0,p.iH)("5.5rem");(0,l.Fl)((()=>m.Z.state.Weight.lastWeight));function s(){o("activarShake")}function d(a){if(e.max3EntersDigits){let[e,o]=t.value.split("."),l=t.value.includes(".");if(e.length>=3&&!l&&"."!=a)return s();if(o&&o.length>=2)return s();if("."===a&&t.value.includes("."))return s()}"."===a&&t.value.includes(".")||(t.value+=a,"0"==t.value[0]&&(t.value=t.value.slice(1)),o("setValue",t.value))}function c(){t.value=t.value.slice(0,-1),""===t.value&&(t.value="0")}function u(e){t.value=Number(e).toString(),o("setValue",t.value)}return v.on("setBalanzaValue",(a=>{a&&!e.skipBalanza&&u(a)})),a({cantidad:t,setValor:u}),(0,l.bv)((async()=>{e.skipBalanza||u((await(0,l.Fl)((()=>m.Z.state.Weight.lastWeight))).value)})),{okValue:r,cantidad:t,addTecla:d,deleteTecla:c,setValor:u,anchoTecla:i,altoTecla:n}}},f=o(40089);const g=(0,f.Z)(b,[["render",c],["__scopeId","data-v-2468ee80"]]);var C=g},72109:function(e,a,o){o.r(a),o.d(a,{default:function(){return fo}});var l=o(73396),t=o(87139);const r={key:0,class:"row mt-2 overflow-auto sizeGeneral"},i={key:0},n={key:1},s={key:0,style:{"font-size":"1.2rem"}},d={class:"overflow-auto text-truncate listaCesta"},c={class:"list-group"},u={class:"d-inline-block text-truncate",style:{"max-width":"12rem"}},m={class:"ms-1",style:{"vertical-align":"top"}},p={class:"trabajadores"},v={key:1,class:"row sizeGeneral m-0 mt-1"},b={key:2,class:"position-absolute bottom-0 start-0"};function f(e,a,o,f,g,C){const y=(0,l.up)("MDBCardTitle"),_=(0,l.up)("MDBCardText"),w=(0,l.up)("MDBBtn"),k=(0,l.up)("MDBCardBody"),M=(0,l.up)("MDBBadge"),h=(0,l.up)("MDBCard"),x=(0,l.up)("MesasComponent"),D=(0,l.up)("CobroSeparadoMesas");return(0,l.wg)(),(0,l.iD)(l.HY,null,[!f.vistaMesas&&f.arrayTrabajadores&&f.arrayCestas&&null!=f.indexActivoTrabajador&&void 0!=f.indexActivoTrabajador?((0,l.wg)(),(0,l.iD)("div",r,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.totalRows,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"row",key:a},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(4,((e,o)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:o},[4*a+o+1<=f.arrayCestas.length&&(null!=f.arrayCestas[4*a+o].indexMesa||f.arrayCestas[4*a+o].trabajador===f.arrayTrabajadores[f.indexActivoTrabajador]._id)||"DEVOLUCION"==f.arrayCestas[4*a+o]?.modo?((0,l.wg)(),(0,l.j4)(h,{key:0,onClick:e=>f.seleccionar(f.arrayCestas[4*a+o]),class:(0,t.C_)(["cesta mb-3 ms-2 me-1",{cestaActiva:f.arrayCestas[4*a+o]._id===f.idCestaSeleccionada}]),size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(f.arrayCestas[4*a+o].modo)+" ",1),null===f.arrayCestas[4*a+o].indexMesa?((0,l.wg)(),(0,l.iD)("a",i,[(0,l.Uk)(" de "),(0,l._)("i",null,(0,t.zw)(f.getNombreByID(f.arrayCestas[4*a+o].trabajador)),1)])):(0,l.kq)("",!0),f.arrayMesas[4*a+o]&&null!=f.arrayCestas[4*a+o].indexMesa?((0,l.wg)(),(0,l.iD)("span",n,"Mesa: "+(0,t.zw)(f.arrayMesas[f.arrayCestas[4*a+o].indexMesa].nombre),1)):(0,l.kq)("",!0)])),_:2},1024),(0,l.Wm)(_,null,{default:(0,l.w5)((()=>["VENTA"===f.arrayCestas[4*a+o].modo?((0,l.wg)(),(0,l.iD)("span",s,"Total: "+(0,t.zw)(f.getTotal(f.arrayCestas[4*a+o]).toFixed(2))+" €",1)):(0,l.kq)("",!0),(0,l._)("div",d,[(0,l._)("ul",c,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.arrayCestas[4*a+o].lista,((e,a)=>((0,l.wg)(),(0,l.iD)("li",{key:a,class:"list-group-item"},[(0,l._)("span",u,(0,t.zw)(e.nombre),1),(0,l._)("span",m,"x"+(0,t.zw)(e.unidades),1)])))),128))])])])),_:2},1024),f.arrayMesas[4*a+o]&&null!=f.arrayCestas[4*a+o].indexMesa&&(f.arrayCestas[4*a+o].lista.length>1||f.arrayCestas[4*a+o].lista[0]?.unidades>1)?((0,l.wg)(),(0,l.j4)(w,{key:0,onClick:e=>f.PagarSeparado(f.arrayCestas[4*a+o],4*a+o),style:{"font-size":"16px"},color:"secondary d-inline-block"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Pagar por separado ")])),_:2},1032,["onClick"])):(0,l.kq)("",!0)])),_:2},1024),(0,l._)("div",p,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.arrayCestas[4*a+o].trabajadores,((e,a)=>((0,l.wg)(),(0,l.j4)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(M,{color:"info",class:"text-dark",pill:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(f.arrayTrabajadoresID[e]),1)])),_:2},1024)])),_:2},1024)))),256))])])),_:2},1032,["onClick","class"])):(0,l.kq)("",!0)],64)))),64))])))),128))])):(0,l.kq)("",!0),f.vistaMesas?((0,l.wg)(),(0,l.iD)("div",v,[(0,l.Wm)(x)])):(0,l.kq)("",!0),f.vistaMesas?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",b,[(0,l._)("button",{onClick:a[0]||(a[0]=e=>f.volver()),class:"btn btn-warning ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("volver","VOLVER")),1)])),(0,l.Wm)(D,{ref:"CobroSeparadoRef"},null,512)],64)}var g=o(44870),C=o(20065),y=o(74313),_=o(44918),w=o(91076),k=o(42492),M=o.n(k);const h={key:0},x=["onClick"],D={class:"nombreMesa"},B={key:0,class:"trabajadores"},z=["onClick"],T={class:"nombreMesa"},E={key:0,class:"trabajadores"},P={class:"position-relative footer"},j={class:"position-absolute bottom-0 start-0"},H={class:"position-absolute bottom-0 end-0"},U={key:5,style:{"font-size":"1.7rem","font-weight":"bold"},class:"me-2"};function V(e,a,o,r,i,n){const s=(0,l.up)("MDBBtn"),d=(0,l.up)("MDBBtnGroup"),c=(0,l.up)("MDBBadge"),u=(0,l.up)("MDBInput"),m=(0,l.up)("MDBModalBody"),p=(0,l.up)("MDBModalFooter"),v=(0,l.up)("MDBModal"),b=(0,l.up)("MDBIcon"),f=(0,l.up)("modalSeleccionarRepartidor"),g=(0,l.up)("CobroSeparadoMesas"),C=(0,l.up)("ModalCondicionalPedidoCliente");return(0,l.wg)(),(0,l.iD)(l.HY,null,[r.PedidosTelegram?((0,l.wg)(),(0,l.iD)("div",h,[(0,l.Wm)(d,{class:"buttonsSelector"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{size:"lg",disabled:r.modoEdicion||r.modoImprimir,color:[r.activeMenu?"secondary":"primary"],onClick:a[0]||(a[0]=e=>r.activeMenu=0)},{default:(0,l.w5)((()=>[(0,l.Uk)("MESAS")])),_:1},8,["disabled","color"]),(0,l.Wm)(s,{size:"lg",disabled:r.modoEdicion||r.modoImprimir,color:r.activeMenu?"primary":"secondary",onClick:a[1]||(a[1]=e=>r.activeMenu=1)},{default:(0,l.w5)((()=>[(0,l.Uk)("PEDIDOS")])),_:1},8,["disabled","color"])])),_:1})])):(0,l.kq)("",!0),r.arrayMesas.length>0&&!r.activeMenu?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},(0,l.Ko)(5,((e,a)=>(0,l._)("div",{class:"row p-0",key:a},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(10,((e,o)=>(0,l._)("div",{class:(0,t.C_)(["mesa ms-3",[0===o?"ms-5":"",o+10*a===r.indexMesaActiva&&r.modoEdicion?"border border-4 border-dark":"",r.cestaSeleccionada===r.arrayMesas[o+10*a].idCesta?"seleccionada":"",r.tieneCosas(r.arrayMesas[o+10*a].idCesta)?"tieneCosas":"",r.arrayMesas[o+10*a].nombre?"habilitada":"deshabilitada",r.cestasHonei.includes(o+10*a)?"honei":""]]),key:o,onClick:e=>r.handleClick(o+10*a)},[(0,l._)("span",D,(0,t.zw)(r.arrayMesas[o+10*a].nombre),1),r.arrayMesas[o+10*a].nombre?((0,l.wg)(),(0,l.iD)("div",B,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.getCestaById(r.arrayMesas[o+10*a].idCesta)?.trabajadores,((e,a)=>((0,l.wg)(),(0,l.j4)(c,{color:"info",class:"text-dark trabajador",pill:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(r.getNombreTrabajadorById(e)),1)])),_:2},1024)))),256))])):(0,l.kq)("",!0)],10,x))),64))]))),64)):(0,l.kq)("",!0),r.activeMenu?((0,l.wg)(),(0,l.iD)(l.HY,{key:2},(0,l.Ko)(5,((e,a)=>(0,l._)("div",{class:"row p-0",key:a},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(10,((e,o)=>(0,l._)("div",{class:(0,t.C_)(["mesa ms-3",[0===o?"ms-5":"",r.arrayEncargos[o+10*a]?._id?"habilitada":"deshabilitada",r.arrayEncargos[o+10*a]?.cesta.lista.length>0?"tieneCosas":""]]),key:o,onClick:e=>r.openPedido(o+10*a)},[(0,l._)("span",T,(0,t.zw)(r.arrayEncargos[o+10*a]?.nombreCliente),1),r.arrayEncargos[o+10*a]?.nombreCliente?((0,l.wg)(),(0,l.iD)("div",E,[r.arrayEncargos[o+10*a]?.nombreCliente?((0,l.wg)(),(0,l.j4)(c,{key:0,color:"info",class:"text-dark trabajador",pill:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(r.arrayEncargos[o+10*a]?.nombreDependienta),1)])),_:2},1024)):(0,l.kq)("",!0)])):(0,l.kq)("",!0)],10,z))),64))]))),64)):(0,l.kq)("",!0),(0,l._)("div",P,[(0,l._)("div",j,[(0,l._)("button",{onClick:a[2]||(a[2]=e=>r.volver()),class:"btn btn-warning ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("volver","Volver")),1)]),(0,l._)("div",H,[r.arrayMesas&&null!=r.indexMesaActiva&&void 0!=r.indexMesaActiva&&r.arrayMesas[r.indexMesaActiva]&&r.arrayMesas[r.indexMesaActiva].nombre&&r.modoEdicion?((0,l.wg)(),(0,l.iD)("button",{key:0,onClick:a[3]||(a[3]=e=>r.desactivarMesa()),class:"btn btn-danger ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("eliminar_cesta","Eliminar cesta")),1)):(0,l.kq)("",!0),r.arrayMesas&&null!=r.indexMesaActiva&&void 0!=r.indexMesaActiva&&r.arrayMesas[r.indexMesaActiva]&&r.arrayMesas[r.indexMesaActiva].nombre&&r.modoEdicion&&!r.activeMenu?((0,l.wg)(),(0,l.iD)("button",{key:1,onClick:a[4]||(a[4]=e=>r.toggleModotransferir()),class:"btn btn-secondary ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("transferir_articulos","Transferir articulos")),1)):(0,l.kq)("",!0),r.arrayMesas&&null!=r.indexMesaActiva&&void 0!=r.indexMesaActiva&&r.arrayMesas[r.indexMesaActiva]&&r.arrayMesas[r.indexMesaActiva].nombre&&r.modoEdicion&&!r.activeMenu?((0,l.wg)(),(0,l.iD)("button",{key:2,onClick:a[5]||(a[5]=e=>r.modalNombreMesa=!0),class:"btn btn-info ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("cambiar_nombre","Cambiar nombre")),1)):r.modoEdicion&&!r.activeMenu?((0,l.wg)(),(0,l.iD)("button",{key:3,onClick:a[6]||(a[6]=e=>r.activarMesa()),class:"btn btn-success ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("activar_cesta","Activar cesta")),1)):r.modoEdicion||r.modoImprimir||r.activeMenu?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("button",{key:4,onClick:a[7]||(a[7]=e=>r.pagarPorSeparado()),class:(0,t.C_)(["btn",r.pagarNoJunto?"btn-warning":"btn-success","ms-2"]),style:{"font-size":"27px"}},(0,t.zw)(e.$t("pagar_por_separado","Pagar por separado")),3)),r.modoImprimir?((0,l.wg)(),(0,l.iD)("span",U,(0,t.zw)(e.$t("selecciona_una_mesa","Selecciona una mesa"))+" "+(0,t.zw)(e.$t("para_imprimir_la_nota","para imprimir la nota")),1)):(0,l.kq)("",!0)])]),(0,l.Wm)(v,{id:"modalNombreMesa",tabindex:"-1",modelValue:r.modalNombreMesa,"onUpdate:modelValue":a[11]||(a[11]=e=>r.modalNombreMesa=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{label:"Introduce el nombre de la mesa",size:"lg",modelValue:r.inputNombre,"onUpdate:modelValue":a[8]||(a[8]=e=>r.inputNombre=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s,{color:"secondary",size:"lg",onClick:a[9]||(a[9]=e=>r.modalNombreMesa=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("cerrar","Cerrar")),1)])),_:1}),(0,l.Wm)(s,{color:"primary",size:"lg",onClick:a[10]||(a[10]=e=>r.cambiarNombre())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("guardar_cambios","Guardar cambios")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),r.modoImprimir||r.activeMenu?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(s,{key:3,color:"dark",floating:"",id:"editBtn",onClick:a[12]||(a[12]=e=>r.toggleEdicion())},{default:(0,l.w5)((()=>[r.modoEdicion?((0,l.wg)(),(0,l.j4)(b,{key:1,icon:"check"})):((0,l.wg)(),(0,l.j4)(b,{key:0,icon:"edit"}))])),_:1})),!r.modoImprimir&&r.activeMenu?((0,l.wg)(),(0,l.j4)(s,{key:4,color:"dark",floating:"",id:"editBtn",onClick:a[13]||(a[13]=e=>{r.enviarRepartidor=!r.enviarRepartidor,r.activarModosPedido()})},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{icon:"paper-plane"})])),_:1})):(0,l.kq)("",!0),r.modoImprimir||r.modoEdicion||r.activeMenu?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(s,{key:5,color:"dark",floating:"",id:"userBtn",onClick:a[14]||(a[14]=e=>r.handleClick("",!0))},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{icon:"user"})])),_:1})),r.modoImprimir||r.modoEdicion||!r.activeMenu?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(s,{key:6,color:"dark",floating:"",id:"userBtn",onClick:a[15]||(a[15]=e=>{r.eliminarPedido=!r.eliminarPedido,r.activarModosPedido()})},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{icon:"trash"})])),_:1})),r.arrayMesas&&null!=r.indexMesaActiva&&void 0!=r.indexMesaActiva&&r.arrayMesas[r.indexMesaActiva]&&r.arrayMesas[r.indexMesaActiva].nombre&&!r.modoEdicion?((0,l.wg)(),(0,l.j4)(s,{key:7,color:"dark",floating:"",id:"printBtn",onClick:a[16]||(a[16]=e=>r.toggleImprimir())},{default:(0,l.w5)((()=>[r.modoImprimir?((0,l.wg)(),(0,l.j4)(b,{key:1,icon:"times"})):((0,l.wg)(),(0,l.j4)(b,{key:0,icon:"print"}))])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(f,{ref:"modalSeleccionarRepartidor"},null,512),(0,l.Wm)(g,{ref:"CobroSeparadoRef"},null,512),(0,l.Wm)(C,{ref:"ModalCondicionalPedidoClienteRef"},null,512)],64)}const S=e=>((0,l.dD)("data-v-47afe112"),e=e(),(0,l.Cn)(),e),W={class:"row"},N=["onClick"],A=S((()=>(0,l._)("br",null,null,-1))),$=["onClick"],F=S((()=>(0,l._)("br",null,null,-1))),I={class:"row"},Z={key:0,class:"table-responsive divCesta reverso"},R={class:"table colorFuente"},q={class:"tableBody"},O=["onClick"],Y={class:"d-inline-block text-truncate",style:{"max-width":"21rem","min-width":"21rem"}};function K(e,a,o,r,i,n){const s=(0,l.up)("MDBModalTitle"),d=(0,l.up)("MDBModalHeader"),c=(0,l.up)("MDBBtn"),u=(0,l.up)("MDBModalBody"),m=(0,l.up)("MDBModalFooter"),p=(0,l.up)("MDBModal"),v=(0,l.up)("modalCobroViewVue");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(p,{id:"modalCobroSeparado",tabindex:"-1",labelledby:"staticBackdropLabel",modelValue:r.modalCobroSeparado,"onUpdate:modelValue":a[3]||(a[3]=e=>r.modalCobroSeparado=e),staticBackdrop:"",size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s,{id:"staticBackdropLabel"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Selecciona los articulos a pagar "+(0,t.zw)(r.totalPrice.toFixed(2))+" € ",1)])),_:1})])),_:1}),(0,l.Wm)(u,{class:"modal-body"},{default:(0,l.w5)((()=>[(0,l._)("div",W,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.arrayArticulosMesa,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a,class:"col mb-3"},[e?.gramos&&e?.gramos>0?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn w-100 h-100 colorIvan1 btnSuplemento",onClick:o=>r.addArticulo(e,a)},[(0,l.Uk)((0,t.zw)(e.nombre)+" ",1),A,(0,l.Uk)(" "+(0,t.zw)(e.subtotal.toFixed(2))+" € ",1)],8,N)):((0,l.wg)(),(0,l.iD)("button",{key:1,class:"btn w-100 h-100 colorIvan1 btnSuplemento",onClick:o=>r.addArticulo(e,a)},[(0,l.Uk)((0,t.zw)(e.nombre)+" ",1),F,(0,l.Uk)(" "+(0,t.zw)((e.subtotal/e.unidades).toFixed(2))+" € ",1)],8,$))])))),128))]),(0,l._)("div",I,[r.articulosAPagar?((0,l.wg)(),(0,l.iD)("div",Z,[(0,l._)("table",R,[(0,l._)("tbody",q,[e.item?.pagado?(0,l.kq)("",!0):((0,l.wg)(!0),(0,l.iD)(l.HY,{key:0},(0,l.Ko)(r.articulosAPagar,((e,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:a,class:(0,t.C_)(["itemCesta",{seleccionado:r.itemSeleccionado===a}]),onClick:e=>r.setIndex(a)},[(0,l._)("td",null,[(0,l._)("span",Y,(0,t.zw)(e.nombre),1)]),(0,l._)("td",null,(0,t.zw)((e.subtotal/e.unidades).toFixed(2))+" €",1)],10,O)))),128))])])])):(0,l.kq)("",!0),r.deleteBtn?((0,l.wg)(),(0,l.j4)(c,{key:1,onClick:a[0]||(a[0]=e=>r.delArticulo()),color:"danger",size:"lg"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("eliminar","Eliminar")),1)])),_:1})):(0,l.kq)("",!0)])])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{color:"secondary",onClick:a[1]||(a[1]=e=>r.modalCobroSeparado=!1),size:"lg"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1}),(0,l.Wm)(c,{color:"success",size:"lg",onClick:a[2]||(a[2]=e=>r.Pago())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("Pagar","Pagar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(v,{class:"p-0",ref:"modalCobroViewVueRef"},null,512)],64)}o(57658);var J=o(22483),L=o(50617),G={name:"modalCobroSeparadoComponent",components:{MDBModal:y.j3,MDBModalHeader:y.ol,MDBModalTitle:y.wo,MDBModalBody:y.Yz,MDBModalFooter:y.ab,MDBBtn:y.$v,modalCobroViewVue:L.Z},setup(e,{expose:a}){const o=(0,g.iH)(!1),t=(0,g.iH)(null),r=(0,g.iH)([]);let i=(0,l.Fl)((()=>s.state.Cestas.arrayCestas));const n=(0,g.iH)([]),s=(0,C.oR)(),d=(0,J.tv)(),c=(0,l.Fl)((()=>s.state.Trabajadores.indexActivo)),u=(0,l.Fl)((()=>s.state.Trabajadores.arrayTrabajadores)),m=(0,l.Fl)((()=>s.state.Trabajadores.indexActivo)),p=(0,l.Fl)((()=>u.value&&void 0!=c.value&&null!=c.value&&u.value[c.value]?u.value[c.value]:null)),v=(0,g.iH)([]);let b=0;const f=(0,g.iH)(!1),y=(0,g.iH)(0),_=(0,g.iH)(null);async function k(e){n.value.push(e)}async function h(e){for(let a=0;a<e.lista.length;a++)for(let o=0;o<e.lista[a].unidades;o++)e.lista[a].pagado||k(e.lista[a])}async function x(e,a){n.value.splice(a,1),y.value+=e.subtotal/e.unidades,r.value.push(e)}async function D(){let e=t.value;n.value.push(r.value[e]),y.value-=r.value[e].subtotal/r.value[e].unidades,r.value.splice(e,1),f.value=!1,t.value=-1}function B(e){t.value==e?(t.value=-1,f.value=!1):(t.value=e,f.value=!0)}async function z(e){v.value=e,b=e._id,r.value=[],n.value=[],o.value=!0,y.value=0,f.value=!1,h(e)}async function T(){let e,a=v;s.dispatch("Cestas/setCestaBaseAction",a.value._id),a.value.lista=r.value;for(let o=0;o<a.value.lista.length;o++)a.value.lista[o].subtotal=a.value.lista[o].subtotal/a.value.lista[o].unidades,a.value.lista[o].unidades=1;w.Z.post("cestas/PagarPorSeparado",{articulos:a.value.lista}).then((async a=>{a.data&&await w.Z.post("cestas/cambiarCestaTrabajador",{idCesta:a.data,idTrabajador:u.value[m.value]._id}).then((async t=>{if(i=(0,l.Fl)((()=>s.state.Cestas.arrayCestas)),e=await(0,l.Fl)((()=>{if(i.value)for(let e=0;e<i.value.length;e++)if(i.value[e]._id==a.data)return i.value[e]})),"PAGO SEPARADO"===e.value.modo)if(e.value.idCliente&&""!=e.value.idCliente){const a=(await w.Z.post("clientes/getClienteById",{idCliente:e.value.idCliente})).data;!0===a?.albaran&&!0===a?.noPagaEnTienda?w.Z.post("tickets/crearTicket",{total:y.value,idCesta:e.value._id,idTrabajador:p.value._id,tipo:"DEUDA",tkrsData:null}).then((e=>{if(!e.data)throw Error("No se ha podido registrar la venta en modo deuda");M().fire({icon:"success",title:"Venta modo deuda registrada correctamente",showConfirmButton:!1,timer:2e3})})).catch((e=>{M().fire("Oops...",e.message,"error")})):(await w.Z.post("impresora/despedida",{precioTotal:y.value.toFixed(2)}),await d.push("/cobro").then((()=>{})))}else await w.Z.post("impresora/despedida",{precioTotal:y.value.toFixed(2)}),_.value.abrirModal(),o.value=!1}))})),await w.Z.post("cestas/borrarUnicoItemCesta",{idCesta:a.value._id,articulos:r.value}).then((e=>{if(!e.data)throw Error("No se ha podido eliminar el artículo de la cesta")})).catch((e=>{M().fire("Oops...",e.message,"error")}))}return a({abrirModal:z}),{articulosAPagar:r,arrayArticulosMesa:n,modalCobroSeparado:o,itemSeleccionado:t,setIndex:B,deleteBtn:f,addArticulo:x,delArticulo:D,totalPrice:y,Pago:T,modalCobroViewVueRef:_}}},Q=o(40089);const X=(0,Q.Z)(G,[["render",K],["__scopeId","data-v-47afe112"]]);var ee=X;const ae=e=>((0,l.dD)("data-v-60ae68fa"),e=e(),(0,l.Cn)(),e),oe={style:{padding:"5px 0px 30px 0px"}},le={class:"w-100 text-center"},te=ae((()=>(0,l._)("div",{class:"modal-icon-container mb-3"},[(0,l._)("i",{class:"fas fa-bicycle modal-icon"})],-1))),re=ae((()=>(0,l._)("h2",{class:"modal-title fw-bold text-primary mb-1"}," Seleccionar Repartidor ",-1))),ie={class:"text-muted small mb-0"},ne={class:"infoCliente"},se=ae((()=>(0,l._)("i",{class:"fas fa-map-marker-alt"},null,-1))),de=ae((()=>(0,l._)("i",{class:"fas fa-phone"},null,-1))),ce={class:"form-group"},ue=ae((()=>(0,l._)("label",{class:"form-label fw-semibold text-dark mb-2"},[(0,l._)("i",{class:"fas fa-user-check me-2 text-primary"}),(0,l.Uk)(" Repartidores disponibles: ")],-1))),me={class:"select-wrapper"},pe=ae((()=>(0,l._)("div",{class:"info-card mt-3 p-3 bg-light rounded-3"},[(0,l._)("div",{class:"d-flex align-items-center"},[(0,l._)("i",{class:"fas fa-info-circle text-info me-2"}),(0,l._)("small",{class:"text-muted"}," El repartidor recibirá una notificación en Telegram. ")])],-1))),ve={class:"d-flex gap-2 w-100"},be=ae((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1))),fe=ae((()=>(0,l._)("i",{class:"fas fa-paper-plane me-2"},null,-1))),ge=ae((()=>(0,l._)("span",null,"Enviar información",-1))),Ce=ae((()=>(0,l._)("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},[(0,l._)("span",{class:"visually-hidden"},"Cargando...")],-1))),ye=ae((()=>(0,l._)("span",null,"Enviando...",-1)));function _e(e,a,o,r,i,n){const s=(0,l.up)("MDBSelect"),d=(0,l.up)("MDBModalBody"),c=(0,l.up)("MDBBtn"),u=(0,l.up)("MDBModalFooter"),m=(0,l.up)("MDBModal");return(0,l.wg)(),(0,l.j4)(m,{id:"modalSeleccionarRepartidor",tabindex:"-1",labelledby:"tituloModalRepartidor",modelValue:r.modalSeleccionarRepartidor,"onUpdate:modelValue":a[4]||(a[4]=e=>r.modalSeleccionarRepartidor=e),staticBackdrop:"",centered:"",size:"md"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"px-4 py-3"},{default:(0,l.w5)((()=>[(0,l._)("div",oe,[(0,l._)("div",le,[te,re,(0,l._)("p",ie,[(0,l.Uk)(" Elige el repartidor para esta entrega "),(0,l._)("b",null,(0,t.zw)(r.infoCliente?.nombre),1)]),(0,l._)("div",ne,[(0,l._)("span",null,[se,(0,l.Uk)(" "+(0,t.zw)(r.infoCliente?.direccion),1)]),(0,l._)("span",null,[de,(0,l.Uk)(" "+(0,t.zw)(r.infoCliente?.telefono),1)])])])]),(0,l._)("div",ce,[ue,(0,l._)("div",me,[(0,l.Wm)(s,{options:r.repartidoresValues,"onUpdate:options":a[0]||(a[0]=e=>r.repartidoresValues=e),selected:r.selectedRepartidor,"onUpdate:selected":a[1]||(a[1]=e=>r.selectedRepartidor=e),optionHeight:50,filter:"",placeholder:"Buscar y seleccionar repartidor...",class:"custom-select"},null,8,["options","selected"])])]),pe])),_:1}),(0,l.Wm)(u,{class:"border-0 pt-2 px-4 pb-4"},{default:(0,l.w5)((()=>[(0,l._)("div",ve,[(0,l.Wm)(c,{color:"light",onClick:a[2]||(a[2]=e=>r.modalSeleccionarRepartidor=!1),ref:"salirBoton",disabled:r.loading,class:"flex-fill btn-cancel"},{default:(0,l.w5)((()=>[be,(0,l.Uk)(" Cancelar ")])),_:1},8,["disabled"]),(0,l.Wm)(c,{color:"success",onClick:a[3]||(a[3]=e=>r.enviarRepartidor()),disabled:r.loading,class:"flex-fill btn-confirm btnSpinner d-flex align-items-center justify-content-center"},{default:(0,l.w5)((()=>[r.loading?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[Ce,ye],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[fe,ge],64))])),_:1},8,["disabled"])])])),_:1})])),_:1},8,["modelValue"])}o(3449);var we={name:"ModalFichaClienteComponent",props:["callback"],components:{MDBBtn:y.$v,MDBSelect:y.R3,MDBModal:y.j3,MDBModalBody:y.Yz,MDBModalFooter:y.ab,MDBModalHeader:y.ol},setup(e,{expose:a}){const o=(0,g.iH)(!1),l=(0,g.iH)(""),t="1175028468:AAGzPS8EvKKfLcnjOZozFj493tzJ9uATxCA",r=(0,g.iH)({idEncargo:null,total:null}),i=(0,C.oR)(),n=(0,g.iH)(null),s=(0,g.iH)(null),d=(0,g.iH)(!1),c=(0,g.iH)([{id:-1,text:"No hay repartidores disponibles",disabled:!0,selected:!0}]),u=async()=>{let e=(await w.Z.post("trabajadores/getRepartidores")).data;0!=e.length&&(c.value=e.map((e=>({value:e._id,text:e.nombreCorto,secondaryText:e.numero,telegram_id:e.telegram_id,telefono:e.numero}))))},m=async()=>{let e=c.value.find((e=>e.value==l.value));void 0==e&&M().fire({icon:"error",title:"Error",text:"No se ha seleccionado un repartidor"}),console.log(e);const a="https://www.google.com/maps/search/?api=1&query="+encodeURIComponent(s.value.direccion),n=`\n      <b>🚚 NUEVO PEDIDO</b>\n\n      <b>👤 Cliente:</b> ${s.value.nombre}\n      <b>📍 Dirección:</b> ${s.value.direccion}\n      <b>📞 Teléfono:</b> ${s.value.telefono}\n      <b>💰 Total:</b> ${r.value.total.toFixed(2)}€\n\n      Pulsa el botón para ver la ubicación en Google Maps:\n      `,d={inline_keyboard:[[{text:"📍 Ver ubicación",url:a}]]};await w.Z.post(`https://api.telegram.org/bot${t}/sendMessage`,{chat_id:e.telegram_id,text:n,parse_mode:"HTML",reply_markup:d}).then((a=>{a.data.ok?w.Z.post("encargos/setPedidoRepartidor",{idEncargo:r.value.idEncargo,idRepartidor:e.value}).then((e=>{M().fire({icon:"success",title:"Mensaje enviado",text:"El mensaje ha sido enviado correctamente"}),w.Z.post("/encargos/getPedidos").then((e=>{i.dispatch("Encargos/setPedidos",e.data)}))})):M().fire({icon:"error",title:"Error",text:"Ha ocurrido un error al enviar el mensaje"}),o.value=!1}))},p=async(e,a)=>{r.value=a,n.value=e,u(),s.value=(await w.Z.post("clientes/getClienteById",{idCliente:e})).data,o.value=!0};return a({abrirModal:p}),{loading:d,selectedRepartidor:l,infoCliente:s,repartidoresValues:c,enviarRepartidor:m,modalSeleccionarRepartidor:o}}};const ke=(0,Q.Z)(we,[["render",_e],["__scopeId","data-v-60ae68fa"]]);var Me=ke,he=o(49242);const xe=e=>((0,l.dD)("data-v-04f665b0"),e=e(),(0,l.Cn)(),e),De={class:"h4 mx-2 py-2 border-bottom text-secondary"},Be={class:"d-flex justify-content-around mt-4 mx-2"},ze={for:"tipo1",class:"h5 d-flex align-items-center"},Te=xe((()=>(0,l._)("i",{class:"fas fa-user-plus me-2"},null,-1))),Ee={for:"tipo2",class:"h5 d-flex align-items-center"},Pe=xe((()=>(0,l._)("i",{class:"fas fa-users me-2"},null,-1))),je={class:"h5 mb-0"},He=xe((()=>(0,l._)("i",{class:"fa fa-exclamation-circle","aria-hidden":"true"},null,-1))),Ue=xe((()=>(0,l._)("i",{class:"fas fa-check me-2"},null,-1))),Ve=xe((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1))),Se=xe((()=>(0,l._)("i",{class:"fas fa-user-plus me-2"},null,-1))),We={class:"row g-3"},Ne={class:"col-md-6 mb-3"},Ae={for:"nombreCliente",class:"form-label fw-bold"},$e=xe((()=>(0,l._)("i",{class:"fas fa-user me-2 text-primary"},null,-1))),Fe={class:"col-md-6 mb-3"},Ie={for:"telefonoCliente",class:"form-label fw-bold"},Ze=xe((()=>(0,l._)("i",{class:"fas fa-phone me-2 text-primary"},null,-1))),Re={class:"col-12 mb-3"},qe={for:"direccionCliente",class:"form-label fw-bold"},Oe=xe((()=>(0,l._)("i",{class:"fas fa-map-marker-alt me-2 text-primary"},null,-1))),Ye={class:"col-md-4 mb-3"},Ke={for:"pisoCliente",class:"form-label fw-bold"},Je=xe((()=>(0,l._)("i",{class:"fas fa-building me-2 text-primary"},null,-1))),Le={class:"col-md-4 mb-3"},Ge={for:"puertaCliente",class:"form-label fw-bold"},Qe=xe((()=>(0,l._)("i",{class:"fas fa-door-open me-2 text-primary"},null,-1))),Xe={class:"col-md-4 mb-3"},ea={for:"codigoPostalCliente",class:"form-label fw-bold"},aa=xe((()=>(0,l._)("i",{class:"fas fa-mail-bulk me-2 text-primary"},null,-1))),oa={class:"h5 mb-0"},la=xe((()=>(0,l._)("i",{class:"fa fa-exclamation-circle me-2","aria-hidden":"true"},null,-1))),ta=xe((()=>(0,l._)("i",{class:"fas fa-save me-2"},null,-1))),ra=xe((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1))),ia=xe((()=>(0,l._)("i",{class:"fas fa-users me-2"},null,-1))),na={class:"row mt-1 p-4"},sa={class:"col-md-8"},da=["placeholder"],ca={class:"col-md-4"},ua=xe((()=>(0,l._)("i",{class:"fas fa-search me-2"},null,-1))),ma={key:0,class:"row"},pa={class:"col"},va={class:"table-responsive w-100",style:{height:"400px"}},ba={class:"table table-striped mt-1"},fa={class:"nameDiv"},ga={class:"textoNombre d-inline-block text-truncate"},Ca=xe((()=>(0,l._)("i",{class:"fas fa-check-circle me-2"},null,-1))),ya={key:1,class:"row"},_a={class:"sinResultados position-relative"},wa={class:"textoSinResultados position-absolute top-50 start-50 translate-middle"},ka=xe((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1))),Ma=xe((()=>(0,l._)("i",{class:"fas fa-map-marker-alt me-2"},null,-1))),ha={class:"row g-3"},xa={class:"col-md-12 mb-3"},Da={for:"direccionCliente",class:"form-label fw-bold"},Ba=xe((()=>(0,l._)("i",{class:"fas fa-home me-2 text-primary"},null,-1))),za={class:"col-md-6 mb-3"},Ta={for:"pisoCliente",class:"form-label fw-bold"},Ea=xe((()=>(0,l._)("i",{class:"fas fa-building me-2 text-primary"},null,-1))),Pa={class:"col-md-6 mb-3"},ja={for:"puertaCliente",class:"form-label fw-bold"},Ha=xe((()=>(0,l._)("i",{class:"fas fa-door-open me-2 text-primary"},null,-1))),Ua={class:"col-md-6 mb-3"},Va={for:"cpCliente",class:"form-label fw-bold"},Sa=xe((()=>(0,l._)("i",{class:"fas fa-mail-bulk me-2 text-primary"},null,-1))),Wa={class:"h5 mb-0"},Na=xe((()=>(0,l._)("i",{class:"fa fa-exclamation-circle","aria-hidden":"true"},null,-1))),Aa=xe((()=>(0,l._)("i",{class:"fas fa-check me-2"},null,-1))),$a=xe((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1))),Fa=xe((()=>(0,l._)("i",{class:"fas fa-map-marker-alt me-2"},null,-1))),Ia={class:"row g-3"},Za={class:"col-md-12 mb-3"},Ra={for:"direccionCliente",class:"form-label fw-bold"},qa=xe((()=>(0,l._)("i",{class:"fas fa-home me-2 text-primary"},null,-1))),Oa={class:"col-md-6 mb-3"},Ya={for:"pisoCliente",class:"form-label fw-bold"},Ka=xe((()=>(0,l._)("i",{class:"fas fa-building me-2 text-primary"},null,-1))),Ja={class:"col-md-6 mb-3"},La={for:"puertaCliente",class:"form-label fw-bold"},Ga=xe((()=>(0,l._)("i",{class:"fas fa-door-open me-2 text-primary"},null,-1))),Qa={class:"col-md-6 mb-3"},Xa={for:"cpCliente",class:"form-label fw-bold"},eo=xe((()=>(0,l._)("i",{class:"fas fa-mail-bulk me-2 text-primary"},null,-1))),ao={class:"h5 mb-0"},oo=xe((()=>(0,l._)("i",{class:"fa fa-exclamation-circle","aria-hidden":"true"},null,-1))),lo=xe((()=>(0,l._)("i",{class:"fas fa-check me-2"},null,-1))),to=xe((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1)));function ro(e,a,o,r,i,n){const s=(0,l.up)("MDBModalTitle"),d=(0,l.up)("MDBModalHeader"),c=(0,l.up)("MDBModalBody"),u=(0,l.up)("MDBBtn"),m=(0,l.up)("MDBModalFooter"),p=(0,l.up)("MDBModal"),v=(0,l.up)("MDBBadge"),b=(0,l.up)("KeyBoardComponentVue");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(p,{id:"ModalCondicionalPedidoCliente",tabindex:"-1",labelledby:"ModalCondicionalPedidoCliente",modelValue:r.ModalCondicionalPedidoCliente,"onUpdate:modelValue":a[4]||(a[4]=e=>r.ModalCondicionalPedidoCliente=e),staticBackdrop:"",centered:""},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"h3 ms-2 text-primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("elige_pedido_cliente","Seleccionar opción"))+":",1)])),_:1})])),_:1}),(0,l.Wm)(c,{class:"py-4"},{default:(0,l.w5)((()=>[(0,l._)("h2",De,(0,t.zw)(e.$t("que_desea_hacer","¿Que desea hacer?")),1),(0,l._)("div",Be,[(0,l._)("div",{class:(0,t.C_)("createClient"==r.tipo?"option-card selected":"option-card"),onClick:a[0]||(a[0]=e=>r.tipo="createClient")},[(0,l._)("label",ze,[Te,(0,l.Uk)(" "+(0,t.zw)(e.$t("crear_cliente","Cliente nuevo")),1)])],2),(0,l._)("div",{class:(0,t.C_)("existenClient"==r.tipo?"option-card selected":"option-card"),onClick:a[1]||(a[1]=e=>r.tipo="existenClient")},[(0,l._)("label",Ee,[Pe,(0,l.Uk)(" "+(0,t.zw)(e.$t("existen_client","Cliente existente")),1)])],2)]),(0,l._)("div",{class:(0,t.C_)([{"d-none":!r.errorValidacionTipo},"alert alert-danger mt-3 mx-2 text-center"])},[(0,l._)("p",je,[He,(0,l.Uk)(" "+(0,t.zw)(r.commentError),1)])],2)])),_:1}),(0,l.Wm)(m,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{color:"success",size:"lg",class:"px-4",onClick:a[2]||(a[2]=e=>r.confirmarTipo())},{default:(0,l.w5)((()=>[Ue,(0,l.Uk)(" "+(0,t.zw)(e.$t("confirmar","confirmar")),1)])),_:1}),(0,l.Wm)(u,{color:"warning",size:"lg",class:"px-4",onClick:a[3]||(a[3]=e=>r.cerrarModalCondicionalPedidoCliente())},{default:(0,l.w5)((()=>[Ve,(0,l.Uk)(" "+(0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(p,{id:"ModalCrearCliente",tabindex:"-1",labelledby:"ModalCrearCliente",modelValue:r.modalCrearCliente,"onUpdate:modelValue":a[13]||(a[13]=e=>r.modalCrearCliente=e),staticBackdrop:"",centered:"",size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"h3 ms-2 text-primary"},{default:(0,l.w5)((()=>[Se,(0,l.Uk)(" "+(0,t.zw)(e.$t("datos_nuevo_cliente","Datos del nuevo cliente")),1)])),_:1})])),_:1}),(0,l.Wm)(c,{class:"py-4"},{default:(0,l.w5)((()=>[(0,l._)("div",We,[(0,l._)("div",Ne,[(0,l._)("label",Ae,[$e,(0,l.Uk)(" "+(0,t.zw)(e.$t("nombre_cliente","Nombre cliente")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"nombreCliente","onUpdate:modelValue":a[5]||(a[5]=e=>r.datosNuevoCliente.nombre=e),placeholder:"Nombre completo"},null,512),[[he.nr,r.datosNuevoCliente.nombre]])]),(0,l._)("div",Fe,[(0,l._)("label",Ie,[Ze,(0,l.Uk)(" "+(0,t.zw)(e.$t("telefono_cliente","Número de teléfono")),1)]),(0,l.wy)((0,l._)("input",{type:"tel",class:"form-control form-control-lg",id:"telefonoCliente","onUpdate:modelValue":a[6]||(a[6]=e=>r.datosNuevoCliente.telefono=e),placeholder:"Ej: 612345678"},null,512),[[he.nr,r.datosNuevoCliente.telefono]])]),(0,l._)("div",Re,[(0,l._)("label",qe,[Oe,(0,l.Uk)(" "+(0,t.zw)(e.$t("direccion_cliente","Dirección")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"direccionCliente","onUpdate:modelValue":a[7]||(a[7]=e=>r.datosNuevoCliente.direccion=e),placeholder:"Calle, número"},null,512),[[he.nr,r.datosNuevoCliente.direccion]])]),(0,l._)("div",Ye,[(0,l._)("label",Ke,[Je,(0,l.Uk)(" "+(0,t.zw)(e.$t("piso_cliente","Piso")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"pisoCliente","onUpdate:modelValue":a[8]||(a[8]=e=>r.datosNuevoCliente.piso=e),placeholder:"Ej: 2"},null,512),[[he.nr,r.datosNuevoCliente.piso]])]),(0,l._)("div",Le,[(0,l._)("label",Ge,[Qe,(0,l.Uk)(" "+(0,t.zw)(e.$t("puerta_cliente","Puerta")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"puertaCliente","onUpdate:modelValue":a[9]||(a[9]=e=>r.datosNuevoCliente.puerta=e),placeholder:"Ej: A"},null,512),[[he.nr,r.datosNuevoCliente.puerta]])]),(0,l._)("div",Xe,[(0,l._)("label",ea,[aa,(0,l.Uk)(" "+(0,t.zw)(e.$t("codigo_postal_cliente","Código postal")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"codigoPostalCliente","onUpdate:modelValue":a[10]||(a[10]=e=>r.datosNuevoCliente.codigoPostal=e),placeholder:"Ej: 08001"},null,512),[[he.nr,r.datosNuevoCliente.codigoPostal]])])]),(0,l._)("div",{class:(0,t.C_)([{"d-none":!r.errorValidacionDatosCliente},"alert alert-danger mt-3 text-center"])},[(0,l._)("p",oa,[la,(0,l.Uk)(" "+(0,t.zw)(r.errorDatosCliente),1)])],2)])),_:1}),(0,l.Wm)(m,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{color:"success",size:"lg",class:"px-4",onClick:a[11]||(a[11]=e=>r.confirmarDatosCliente())},{default:(0,l.w5)((()=>[ta,(0,l.Uk)(" "+(0,t.zw)(e.$t("guardar","Guardar")),1)])),_:1}),(0,l.Wm)(u,{color:"warning",size:"lg",class:"px-4",onClick:a[12]||(a[12]=e=>r.cerrarModalCrearCliente())},{default:(0,l.w5)((()=>[ra,(0,l.Uk)(" "+(0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(p,{id:"ModalSeleccionarCliente",tabindex:"-1",labelledby:"ModalSeleccionarCliente",modelValue:r.modalSeleccionarCliente,"onUpdate:modelValue":a[18]||(a[18]=e=>r.modalSeleccionarCliente=e),staticBackdrop:"",size:"xl"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"h3 ms-2 text-primary"},{default:(0,l.w5)((()=>[ia,(0,l.Uk)(" "+(0,t.zw)(e.$t("seleccionar_cliente_existente","Seleccionar cliente existente")),1)])),_:1})])),_:1}),(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l._)("div",na,[(0,l._)("div",sa,[(0,l.wy)((0,l._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:e.$t("buscar_por_nombre","Buscar por nombre"),"aria-label":".form-control-lg example","onUpdate:modelValue":a[14]||(a[14]=e=>r.inputBusqueda=e),onClick:a[15]||(a[15]=e=>r.openKeyboard()),readonly:""},null,8,da),[[he.nr,r.inputBusqueda]])]),(0,l._)("div",ca,[(0,l.Wm)(u,{color:"secondary",class:"botonBusqueda w-100",onClick:a[16]||(a[16]=e=>r.buscarClientes())},{default:(0,l.w5)((()=>[ua,(0,l.Uk)(" "+(0,t.zw)(e.$t("buscar","Buscar")),1)])),_:1})])]),r.arrayClientes?.length>0?((0,l.wg)(),(0,l.iD)("div",ma,[(0,l._)("div",pa,[(0,l._)("div",va,[(0,l._)("table",ba,[(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.arrayClientes,((a,o)=>((0,l.wg)(),(0,l.iD)("tr",{key:o,class:"cliente-row"},[(0,l._)("td",null,[(0,l._)("div",fa,[(0,l._)("span",ga,(0,t.zw)(a.nombre),1),a.albaran?((0,l.wg)(),(0,l.j4)(v,{key:0,badge:"info",class:"text-dark textoAlbaran",pill:""},{default:(0,l.w5)((()=>[(0,l.Uk)(" Albaran ")])),_:1})):a?.vip?((0,l.wg)(),(0,l.j4)(v,{key:1,badge:"info",class:"text-dark textoAlbaran",pill:""},{default:(0,l.w5)((()=>[(0,l.Uk)(" Vip ")])),_:1})):(0,l.kq)("",!0)])]),(0,l._)("td",null,[(0,l.Wm)(u,{color:"primary",size:"lg",onClick:e=>r.seleccionarClienteExistente(a.id,a.nombre),class:"w-100 btn-elegir"},{default:(0,l.w5)((()=>[Ca,(0,l.Uk)(" "+(0,t.zw)(e.$t("elegir","Elegir")),1)])),_:2},1032,["onClick"])])])))),128))])])])])])):((0,l.wg)(),(0,l.iD)("div",ya,[(0,l._)("div",_a,[(0,l._)("span",wa,(0,t.zw)(e.$t("sin_resultados","Sin resultados")),1)])]))])),_:1}),(0,l.Wm)(m,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{color:"warning",size:"lg",class:"px-4",onClick:a[17]||(a[17]=e=>r.cerrarModalSeleccionarCliente())},{default:(0,l.w5)((()=>[ka,(0,l.Uk)(" "+(0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(p,{id:"ModalEditarDireccion",tabindex:"-1",labelledby:"ModalEditarDireccion",modelValue:r.modalEditarDireccion,"onUpdate:modelValue":a[25]||(a[25]=e=>r.modalEditarDireccion=e),staticBackdrop:"",centered:"",size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"h3 ms-2 text-primary"},{default:(0,l.w5)((()=>[Ma,(0,l.Uk)(" "+(0,t.zw)(e.$t("editar_direccion","Editar dirección del cliente")),1)])),_:1})])),_:1}),(0,l.Wm)(c,{class:"py-4"},{default:(0,l.w5)((()=>[(0,l._)("div",ha,[(0,l._)("div",xa,[(0,l._)("label",Da,[Ba,(0,l.Uk)(" "+(0,t.zw)(e.$t("direccion","Dirección")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"direccionCliente","onUpdate:modelValue":a[19]||(a[19]=e=>r.datosDireccion.direccion=e),placeholder:"Calle, número..."},null,512),[[he.nr,r.datosDireccion.direccion]])]),(0,l._)("div",za,[(0,l._)("label",Ta,[Ea,(0,l.Uk)(" "+(0,t.zw)(e.$t("piso","Piso")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"pisoCliente","onUpdate:modelValue":a[20]||(a[20]=e=>r.datosDireccion.piso=e),placeholder:"Piso"},null,512),[[he.nr,r.datosDireccion.piso]])]),(0,l._)("div",Pa,[(0,l._)("label",ja,[Ha,(0,l.Uk)(" "+(0,t.zw)(e.$t("puerta","Puerta")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"puertaCliente","onUpdate:modelValue":a[21]||(a[21]=e=>r.datosDireccion.puerta=e),placeholder:"Puerta"},null,512),[[he.nr,r.datosDireccion.puerta]])]),(0,l._)("div",Ua,[(0,l._)("label",Va,[Sa,(0,l.Uk)(" "+(0,t.zw)(e.$t("codigo_postal","Código Postal")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"cpCliente","onUpdate:modelValue":a[22]||(a[22]=e=>r.datosDireccion.codigoPostal=e),placeholder:"Código Postal"},null,512),[[he.nr,r.datosDireccion.codigoPostal]])])]),(0,l._)("div",{class:(0,t.C_)([{"d-none":!r.errorValidacionDireccion},"alert alert-danger mt-3 mx-2 text-center"])},[(0,l._)("p",Wa,[Na,(0,l.Uk)(" "+(0,t.zw)(r.errorDireccion),1)])],2)])),_:1}),(0,l.Wm)(m,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{color:"success",size:"lg",class:"px-4",onClick:a[23]||(a[23]=e=>r.confirmarDireccion())},{default:(0,l.w5)((()=>[Aa,(0,l.Uk)(" "+(0,t.zw)(e.$t("confirmar","Confirmar")),1)])),_:1}),(0,l.Wm)(u,{color:"warning",size:"lg",class:"px-4",onClick:a[24]||(a[24]=e=>r.cerrarModalEditarDireccion())},{default:(0,l.w5)((()=>[$a,(0,l.Uk)(" "+(0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(p,{id:"ModalEditarDireccion",tabindex:"-1",labelledby:"ModalEditarDireccion",modelValue:r.modalEditarDireccion,"onUpdate:modelValue":a[32]||(a[32]=e=>r.modalEditarDireccion=e),staticBackdrop:"",centered:"",size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"h3 ms-2 text-primary"},{default:(0,l.w5)((()=>[Fa,(0,l.Uk)(" "+(0,t.zw)(e.$t("editar_direccion","Editar dirección del cliente")),1)])),_:1})])),_:1}),(0,l.Wm)(c,{class:"py-4"},{default:(0,l.w5)((()=>[(0,l._)("div",Ia,[(0,l._)("div",Za,[(0,l._)("label",Ra,[qa,(0,l.Uk)(" "+(0,t.zw)(e.$t("direccion","Dirección")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"direccionCliente","onUpdate:modelValue":a[26]||(a[26]=e=>r.datosDireccion.direccion=e),placeholder:"Calle, número..."},null,512),[[he.nr,r.datosDireccion.direccion]])]),(0,l._)("div",Oa,[(0,l._)("label",Ya,[Ka,(0,l.Uk)(" "+(0,t.zw)(e.$t("piso","Piso")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"pisoCliente","onUpdate:modelValue":a[27]||(a[27]=e=>r.datosDireccion.piso=e),placeholder:"Piso"},null,512),[[he.nr,r.datosDireccion.piso]])]),(0,l._)("div",Ja,[(0,l._)("label",La,[Ga,(0,l.Uk)(" "+(0,t.zw)(e.$t("puerta","Puerta")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"puertaCliente","onUpdate:modelValue":a[28]||(a[28]=e=>r.datosDireccion.puerta=e),placeholder:"Puerta"},null,512),[[he.nr,r.datosDireccion.puerta]])]),(0,l._)("div",Qa,[(0,l._)("label",Xa,[eo,(0,l.Uk)(" "+(0,t.zw)(e.$t("codigo_postal","Código Postal")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"cpCliente","onUpdate:modelValue":a[29]||(a[29]=e=>r.datosDireccion.codigoPostal=e),placeholder:"Código Postal"},null,512),[[he.nr,r.datosDireccion.codigoPostal]])])]),(0,l._)("div",{class:(0,t.C_)([{"d-none":!r.errorValidacionDireccion},"alert alert-danger mt-3 mx-2 text-center"])},[(0,l._)("p",ao,[oo,(0,l.Uk)(" "+(0,t.zw)(r.errorDireccion),1)])],2)])),_:1}),(0,l.Wm)(m,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{color:"success",size:"lg",class:"px-4",onClick:a[30]||(a[30]=e=>r.confirmarDireccion())},{default:(0,l.w5)((()=>[lo,(0,l.Uk)(" "+(0,t.zw)(e.$t("confirmar","Confirmar")),1)])),_:1}),(0,l.Wm)(u,{color:"warning",size:"lg",class:"px-4",onClick:a[31]||(a[31]=e=>r.cerrarModalEditarDireccion())},{default:(0,l.w5)((()=>[to,(0,l.Uk)(" "+(0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(b,{ref:"keyboardRef"},null,512)],64)}var io=o(22871),no={name:"ModalCondicionalPedidoClienteComponent",components:{MDBModal:y.j3,MDBModalBody:y.Yz,MDBBtn:y.$v,MDBModalHeader:y.ol,MDBModalTitle:y.wo,MDBModalFooter:y.ab,MDBIcon:y.vm,MDBTabs:y.zk,MDBTabNav:y.JH,MDBTabItem:y.kX,MDBTabContent:y.oJ,MDBTabPane:y.jE,MDBSelect:y.R3,MDBPopover:y.SW,MDBBadge:y.m_,KeyBoardComponentVue:io.Z},setup(e,{expose:a,emit:o}){const t=(0,C.oR)(),r=(0,g.iH)(!1),i=(0,g.iH)(null),n=(0,g.iH)(!1),s=(0,g.iH)(""),d=(0,g.iH)(""),c=(0,g.iH)(null),u=(0,g.iH)(null),m=t.getters["Cestas/getCestaActiva"],p=(0,g.iH)(!1),v=(0,g.iH)({nombre:"",telefono:"",direccion:"",piso:"",puerta:"",codigoPostal:""}),b=(0,g.iH)(!1),f=(0,g.iH)(""),y=(0,g.iH)(!1),_=(0,g.iH)(""),k=(0,g.iH)([]),h=(0,g.iH)(null),x=(0,l.Fl)((()=>t.state.Trabajadores.arrayTrabajadores)),D=(0,l.Fl)((()=>t.state.Trabajadores.indexActivo)),B=(0,l.Fl)((()=>x.value&&null!=D.value&&void 0!=D.value&&x.value[D.value]?x.value[D.value]:null)),z=(0,g.iH)(!1),T=(0,g.iH)({direccion:"",piso:"",puerta:"",codigoPostal:""}),E=(0,g.iH)(!1),P=(0,g.iH)(""),j=()=>{if(!T.value.direccion)return E.value=!0,void(P.value="La dirección es obligatoria");w.Z.post("clientes/actualizarCliente",{idCliente:c.value.id,nombre:c.value.nombre,telefono:c.value.telefono,direccion:U(T.value),email:c.value.email,tarjetaCliente:c.value.tarjetaCliente,nif:c.value.nif,descuento:c.value.descuento}).then((e=>{console.log(e.data),e.data?(M().fire("¡Éxito!","Dirección actualizada correctamente","success"),H(),N(c.value.id,c.value.nombre),I()):M().fire("Oops...",e.data.msg||"Error al actualizar la dirección","error")})).catch((e=>{console.error(e),M().fire("Oops...","Error al conectar con el servidor","error")}))},H=()=>{z.value=!1,E.value=!1,P.value="",T.value={direccion:"",piso:"",puerta:"",codigoPostal:""}};(0,l.YP)(i,(e=>{"createClient"===e&&(v.value={nombre:"",telefono:"",direccion:"",piso:"",puerta:"",codigoPostal:""})}));const U=e=>{let a=e.direccion;return e.piso&&(a+=", Piso "+e.piso),e.puerta&&(a+=", Puerta "+e.puerta),a+=", Código Postal "+e.codigoPostal,a};(0,l.YP)(_,(()=>{Z()}));const V=()=>{i.value?(n.value=!1,"createClient"===i.value?p.value=!0:"existenClient"===i.value?(y.value=!0,Z()):I()):(n.value=!0,s.value="Debes seleccionar un tipo de cliente.")},S=()=>{switch(!0){case""===v.value.nombre:return b.value=!0,void(f.value="El nombre es obligatorio.");case""===v.value.telefono:return b.value=!0,void(f.value="El teléfono es obligatorio.");case""===v.value.direccion:return b.value=!0,void(f.value="La dirección es obligatoria.");case""===v.value.codigoPostal:return b.value=!0,void(f.value="El código postal es obligatorio.");default:b.value=!1,f.value="";break}w.Z.post("clientes/crearNuevoCliente",{nombre:v.value.nombre,telefono:v.value.telefono,email:"",direccion:U(v.value),tarjetaCliente:"",nif:"",descuento:0}).then((async e=>{console.log(e.data,"passerror"==e.data.details),e.data.success?("passerror"==e.data.details?await M().fire({title:e.data.message,icon:"warning",confirmButtonText:"Aceptar"}):await M().fire({title:"Cliente creado",icon:"success",confirmButtonText:"Aceptar"}),A(),I(),N(e.data.idCliente,v.value.nombre)):M().fire({title:"Vaya...",text:"Error al crear el cliente",icon:"error",confirmButtonText:"Aceptar"})})).catch((e=>{console.log(e,"socjo"),M().fire({title:"Vaya...",text:"Error al crear el cliente",icon:"error",confirmButtonText:"Aceptar"})}))},W=(e,a,o=(()=>{}))=>{M().fire("error"===a?"Oops...":"Ok!!",e,a).then((()=>o()))},N=(e,a)=>{const o=new Date;let l=m;const r=o.getFullYear(),i=o.getMonth()+1,n=o.getDate();let s=`${r}-${i.toString().padStart(2,"0")}-${n.toString().padStart(2,"0")}`;l.idCliente=e,l.nombreCliente=a;const d={idCliente:e,nombreCliente:a,opcionRecogida:1,amPm:"pm",fecha:s,hora:null,dias:[],dejaCuenta:0,total:0,productos:[],cesta:l,idTrabajador:B.value._id,nombreDependienta:B.value.nombre};w.Z.post("encargos/setPedido",d).then((({data:e})=>{function a(){w.Z.post("/encargos/getPedidos").then((e=>{t.dispatch("Encargos/setPedidos",e.data)}))}e&&e.msg?e.error?W(e.msg,"error"):(a(),t.dispatch("Cestas/setCestaActivaAction",null),W("Pedido iniciado","success")):W("Error general","error")})).catch((e=>{console.log(e),W("Error general","error")}))},A=()=>{p.value=!1,b.value=!1,f.value=""},$=()=>{y.value=!1,_.value="",k.value=[]},F=(e,a=null)=>{const o=(0,l.Fl)((()=>t.state.Encargos.pedidos));o.value.length>49?M().fire({title:"Vaya...",text:"Ya tienes demasiados pedidos abiertos",icon:"warning",confirmButtonText:"Aceptar"}):(r.value=!0,u.value=e,d.value=a)},I=()=>{r.value=!1,i.value=null,n.value=!1,s.value="",u.value=null,d.value="",p.value=!1,y.value=!1},Z=()=>{w.Z.post("clientes/buscar",{busqueda:_.value}).then((e=>{k.value=e.data})).catch((e=>{M().fire("Oops...",e.message,"error")}))},R=async(e,a)=>{const o=await w.Z.post("clientes/getClienteById",{idCliente:e});if(!o.data)return M().fire("Oops...","Cliente no encontrado","error");c.value=o.data,await M().fire({title:"Confirmar dirección",html:`¿La dirección que hay guardada del cliente es correcta?<br><br> <b>${c.value.direccion}</b>`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, es correcta",cancelButtonText:"No, es incorrecta"}).then((o=>{o.isConfirmed?($(),N(e,a),I()):(z.value=!0,T.value=q(c.value.direccion))}))},q=e=>{const a=e.split(","),o=`${a[0]} ${a[1].includes("Piso")?"":a[1]}`;let l="",t="",r="";for(let i=1;i<a.length;i++){const e=a[i].trim();e.startsWith("Piso")&&(l=e.split(" ")[1]),e.startsWith("Puerta")&&(t=e.split(" ")[1]),e.startsWith("Código Postal")&&(r=e.split(" ")[2])}return{direccion:o,piso:l,puerta:t,codigoPostal:r}};let O;const Y=()=>{try{h.value.abrirModal(_.value),O=setInterval((()=>{_.value=h.value.getValue()[0],h.value.getValue()[1]||clearInterval(O)}),10)}catch(e){console.log(e),O=void 0}};return a({abrirModal:F,cerrarModalCondicionalPedidoCliente:I,crearPedido:N}),{ModalCondicionalPedidoCliente:r,tipo:i,errorValidacionTipo:n,commentError:s,confirmarTipo:V,cerrarModalCondicionalPedidoCliente:I,nombreCliente:d,confirmarDireccion:j,datosDireccion:T,errorValidacionDireccion:E,errorDireccion:P,modalEditarDireccion:z,cerrarModalEditarDireccion:H,modalCrearCliente:p,datosNuevoCliente:v,errorValidacionDatosCliente:b,errorDatosCliente:f,ClienteSeleccionado:c,confirmarDatosCliente:S,cerrarModalCrearCliente:A,modalSeleccionarCliente:y,inputBusqueda:_,arrayClientes:k,buscarClientes:Z,seleccionarClienteExistente:R,cerrarModalSeleccionarCliente:$,openKeyboard:Y,keyboardRef:h}}};const so=(0,Q.Z)(no,[["render",ro],["__scopeId","data-v-04f665b0"]]);var co=so,uo={name:"MesasComponent",components:{MDBModal:y.j3,MDBModalBody:y.Yz,MDBModalFooter:y.ab,modalSeleccionarRepartidor:Me,MDBBtn:y.$v,MDBInput:y.u2,MDBIcon:y.vm,ModalCondicionalPedidoCliente:co,MDBBadge:y.m_,MDBBtnGroup:y.Ff,CobroSeparadoMesas:ee},setup(){const e=(0,g.iH)([]),a=(0,g.iH)(0),o=(0,g.iH)(null),t=(0,g.iH)(""),r=(0,g.iH)(null),i=(0,g.iH)(!1),n=(0,g.iH)(!1),s=(0,C.oR)(),d=(0,g.iH)(!1),c=(0,g.iH)(!1),u="1175028468:AAGzPS8EvKKfLcnjOZozFj493tzJ9uATxCA",m=(0,g.iH)(0),p=(0,g.iH)(!1),v=(0,l.Fl)((()=>s.state.Encargos.pedidos)),b=(0,g.iH)(!1),f=(0,g.iH)(null),y=(0,g.iH)(!1),k=(0,g.iH)(null);let h=(0,l.Fl)((()=>s.state.Cestas.arrayCestas));const x=(0,l.Fl)((()=>s.state.Trabajadores.arrayTrabajadores)),D=(0,l.Fl)((()=>s.state.Trabajadores.indexActivo)),B=e=>{const a=h.value.find((a=>a._id===e));return a},z=e=>{const a=x.value.find((a=>a._id==e));return a?.nombre},T=()=>{y.value=!y.value},E=async(e,a)=>{try{const o=await w.Z.post("/cestas/transferirItemsCesta",{idCestaOrigen:e.idCesta,idCestaDestino:a.idCesta});if(!o.data)throw Error("No se han podido transferir los articulos")}catch(o){M().fire("Oops...",o.message,"error")}};function P(){w.Z.post("/encargos/getPedidos").then((e=>{s.dispatch("Encargos/setPedidos",e.data)}))}const j=async e=>{let a=(await w.Z.post("trabajadores/getRepartidores")).data;a=a.filter((a=>a._id==v.value[e].idRepartidor)),M().fire({title:"¿Estás seguro?",html:"¡No podrás revertir esto!<br/>Pedido de: <b>"+v.value[e].nombreCliente,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, eliminar!",cancelButtonText:"Cancelar."}).then((async o=>{o.isConfirmed&&(a.length>0&&a[0].telegram_id&&await M().fire({title:"¿Desea avisar al repartidor?",html:"Repartidor: <b> "+a[0].nombre+"</b>",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, avisar!",cancelButtonText:"No, sin avisar."}).then((async o=>{if(o.isConfirmed){console.log(a[0]);let o=`<b>⚠️ Pedido Anulado</b>\n\nEl pedido a nombre de <b>${v.value[e].nombreCliente}</b> ha sido <b style="color: red;">cancelado</b>.\n\nPor favor, no proceses este pedido.\n\nSi tienes alguna duda, contacta con el responsable.\n\nGracias por tu atención 🙏`;await w.Z.post(`https://api.telegram.org/bot${u}/sendMessage`,{chat_id:a[0].telegram_id,text:o,parse_mode:"HTML"})}})),await w.Z.post("/encargos/anularEncargo",{id:v.value[e]._id}).then((e=>{e.data&&(M().fire("Eliminado!","El pedido ha sido eliminado.","success"),P())})))}))},H=async e=>{r.value.abrirModal(v.value[e].idCliente,{idEncargo:v.value[e]._id,total:U(v.value[e].total,2)})};function U(e,a){let o=new RegExp("\\d\\.(\\d){"+a+",}");return o.test(e)?Number(e.toFixed(a)):0===Number(e.toFixed(a))?0:e}function V(e){const a=document.querySelector("body");if(a.style.backgroundColor="#fff5e9",n.value){if(n.value=!1,!v.value[e])return;j(e)}else if(i.value){if(i.value=!1,!v.value[e])return;H(e)}else{if(!v.value[e])return f.value.abrirModal();try{if(p.value)return void W(v.value[e]);U(v.value[e].total,2);s.dispatch("Cestas/setCestaBaseAction",X);const a=v.value[e].cesta;w.Z.post("cestas/generarCestaPedido",{idEncargo:v.value[e]._id,cestaEncargo:a}).then((async a=>{if(!a.data)throw Error("No se ha podido cargar la cesta");await w.Z.post("cestas/cambiarCestaTrabajador",{idCesta:a.data,idTrabajador:x.value[D.value]._id}).then((async o=>{let t=(0,l.Fl)((()=>s.state.Cestas.arrayCestas)),r=await(0,l.Fl)((()=>{if(t.value)for(let e=0;e<t.value.length;e++)if(t.value[e]._id==a.data)return t.value[e]}));(r.value.modo="MODIFICAR PEDIDO")&&(s.dispatch("EstadoDinamico/setVistaCliente",!0),s.dispatch("Encargos/setEncargoSeleccionado",v.value[e]))})),_.Z.back()}))}catch(o){console.error(o)}}}async function S(o,l=!1){if(c.value)a.value=o;else if(p.value)N(e.value[o]);else{if(s.dispatch("Cestas/deleteCestaHonei",o),b.value){const l=await M().fire({icon:"question",title:`¿Quieres transferir los articulos de ${e.value[a.value].nombre} a ${e.value[o].nombre}?`,showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"});if(!l.isConfirmed)return;await E(e.value[a.value],e.value[o])}if(y.value)k.value.abrirModal(B(e.value[o].idCesta));else{if(l)G(X);else{if(!e.value[o].idCesta)return;G(e.value[o].idCesta)}_.Z.back()}}}const W=e=>{if(!e?.cesta?.lista.length)return M().fire("Oops...","Añade productos para imprimir un pedido. No se puede imprimir","error"),void(p.value=!1);const a=x.value[D.value]._id;w.Z.post("cestas/imprimirNotaPedido",{idEncargo:e._id,idTrabajador:a,cesta:e.cesta,codigo:e._id.slice(-4)}).then((e=>{if(!e.data)throw Error("No se ha podido imprimir la cesta")})).catch((e=>{M().fire("Oops...",e.message,"error")}))},N=e=>{if(!e.idCesta)return M().fire("Oops...","Mesa inactiva. No se puede imprimir","error");const a=x.value[D.value]._id;w.Z.post("cestas/imprimirNotaMesa",{idCesta:e.idCesta,idTrabajador:a}).then((e=>{if(!e.data)throw Error("No se ha podido imprimir la cesta")})).catch((e=>{M().fire("Oops...",e.message,"error")}))},A=()=>{b.value=!0,F()},$=document.querySelector("body");$.style.backgroundColor=c.value?"#FFFF00":"#fff5e9";const F=()=>{c.value=!c.value,$.style.backgroundColor=c.value?"#FFFF00":"#fff5e9"},I=()=>{p.value=!p.value,$.style.backgroundColor=p.value?"#FFFF00":"#fff5e9"},Z=()=>{$.style.backgroundColor=n.value?"#bf5c18":i.value?"#e9fcff":"#fff5e9"};async function R(a){try{const o=(await w.Z.post("cestas/onlyCrearCestaParaMesa",{indexMesa:a})).data;if(!o)throw Error("No se ha podido crear la cesta para la nueva mesa");e.value[a].idCesta=o,K()}catch(o){M().fire("Oops...",o.message,"error")}}function q(){e.value&&null!=a.value&&void 0!=a.value&&e.value[a.value]&&(e.value[a.value]={nombre:"Mesa "+(a.value+1)},R(a.value))}function O(){e.value&&null!=a.value&&void 0!=a.value&&e.value[a.value]&&(w.Z.post("cestas/fulminarCesta",{idCesta:e.value[a.value].idCesta}).then((e=>{if(!e.data)throw Error("No se ha podido eliminar la cesta de la mesa")})).catch((e=>{M().fire("Oops...",e.message,"error")})),e.value[a.value]={nombre:null,idCesta:null},K())}function Y(){e.value&&null!=a.value&&void 0!=a.value&&e.value[a.value]&&(e.value[a.value].nombre=t.value,o.value=!1,K())}function K(){w.Z.post("mesas/guardarCambios",{arrayMesas:e.value}).then((e=>{if(!e.data)throw Error("No se han podido guardar los cambios")})).catch((e=>{M().fire("Oops...",e.message,"error")}))}const J=e=>{if(null===e||void 0===e)return!1;const a=B(e);return a?.lista?.length>0},L=(0,l.f3)("volver"),G=(0,l.f3)("seleccionar"),Q=(0,l.f3)("cestaSeleccionada"),X=(0,l.f3)("cestaParticular"),ee=((0,l.f3)("PagarSeparado"),s.getters["Cestas/getCestasHonei"]);return(0,l.bv)((async()=>{P();const{data:o}=await w.Z.post("parametros/getParametros");d.value="Si"==o.params.PedidosTelegram,console.log(d.value),w.Z.get("mesas/getMesas").then((o=>{if(!o.data||50!==o.data.length)throw Error("Error al obtener la configuración de mesas");e.value=o.data,a.value=e.value.find((e=>e.idCesta==Q.value))?._id??0})).catch((e=>{M().fire("Oops...",e.message,"error")}))})),{arrayMesas:e,indexMesaActiva:a,handleClick:S,volver:L,activarMesa:q,desactivarMesa:O,cambiarNombre:Y,modalNombreMesa:o,inputNombre:t,modoEdicion:c,toggleEdicion:F,cestaSeleccionada:Q,getCestaById:B,openPedido:V,ModalCondicionalPedidoClienteRef:f,activeMenu:m,modalSeleccionarRepartidor:r,getNombreTrabajadorById:z,activarModosPedido:Z,toggleModotransferir:A,tieneCosas:J,enviarRepartidor:i,eliminarPedido:n,pagarPorSeparado:T,pagarNoJunto:y,arrayEncargos:v,CobroSeparadoRef:k,cestasHonei:ee,modoImprimir:p,PedidosTelegram:d,toggleImprimir:I}}};const mo=(0,Q.Z)(uo,[["render",V],["__scopeId","data-v-1d19e9d6"]]);var po=mo,vo={name:"CestasView",components:{MDBCard:y.Yl,MDBCardBody:y.H7,MDBCardTitle:y.QM,MDBCardText:y.Pp,MDBBadge:y.m_,MDBBtn:y.$v,MesasComponent:po,CobroSeparadoMesas:ee},setup(){const e=(0,C.oR)(),a=(0,g.iH)(!0),o=(0,g.iH)(null);(0,l.Fl)((()=>e.state.Configuracion.parametros));let t=(0,l.Fl)((()=>e.state.Cestas.arrayCestas));const r=(0,g.iH)([]),i=(0,g.iH)({}),n=(0,l.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),s=(0,l.Fl)((()=>e.state.Trabajadores.indexActivo)),d=(0,g.iH)(null),c=(0,g.iH)(!1);function u(){const e=document.querySelector("body");e.style.backgroundColor="#fff5e9",_.Z.back()}function m(e){n.value&&void 0!=s.value&&null!=s.value&&n.value[s.value]&&null!=e.indexMesa&&o.value.abrirModal(e)}function p(e){let a="undefined";for(let o=0;o<n.value.length;o++)n.value[o].idTrabajador==e&&(a=n.value[o].nombre);return a}function v(e){const a=e.detalleIva,o=Object.keys(a).filter((e=>e.startsWith("importe"))).reduce(((e,o)=>e+a[o]),0);return Math.round(100*o)/100}const b=(0,l.Fl)((()=>{const e=t.value.length;let a=Math.trunc(e/4);return e%4>0&&(a+=1),a}));function f(){void 0!=s.value&&null!=s.value&&n.value&&w.Z.post("cestas/crearCesta",{idTrabajador:n.value[s.value]._id}).then((e=>{if(!e.data)throw Error("No se ha podido crear una nueva cesta, ¡Comprueba que no tengas una ya!")})).catch((e=>{M().fire("Oops...",e.message,"error")}))}function y(){if(d.value){for(let e=0;e<t.value.length;e++)if(t.value[e]._id===d.value&&null!=t.value[e].indexMesa&&void 0!=t.value[e].indexMesa)return M().fire("Oops...","No puedes eliminar una cesta de tipo MESA","error"),!1;w.Z.post("cestas/fulminarCesta",{idCesta:d.value}).then((e=>{if(!e.data)throw Error("No se ha podido borrar la cesta")})).catch((e=>{M().fire("Oops...",e.message,"error")}))}}function k(e){n.value&&void 0!=s.value&&null!=s.value&&n.value[s.value]?(d.value=e,w.Z.post("cestas/cambiarCestaTrabajador",{idCesta:e,idTrabajador:n.value[s.value]._id})):M().fire("Oops...","Error, no se ha podido seleccionar la cesta para el trabajador","error")}function h(){w.Z.get("mesas/getMesas").then((e=>{if(!e.data||50!==e.data.length)throw Error("Error al obtener la configuración de mesas");r.value=e.data})).catch((e=>{M().fire("Oops...",e.message,"error")}))}let x;return t.value.forEach((e=>{e.trabajador===n.value[s.value]._id&&"DEVOLUCION"!=e.modo&&(x=e._id)})),(0,l.JJ)("volver",u),(0,l.JJ)("seleccionar",k),(0,l.JJ)("cestaSeleccionada",d),(0,l.JJ)("cestaParticular",x),(0,l.JJ)("PagarSeparado",m),(0,l.bv)((()=>{if(n.value.forEach((e=>{let a=e.idTrabajador,o=e.nombre;i.value[a]=o})),null==s.value)return M().fire("Oops...","Debes fichar para usar las cestas","error");d.value=n.value[s.value].idCesta,h(),w.Z.post("parametros/getParametros").then((e=>{void 0!=e.data?.params?.mesas?"Si"==e.data?.params?.mesas&&(c.value=!0):c.value=!1}))})),{vistaMesas:a,PagarSeparado:m,arrayCestas:t,arrayTrabajadores:n,indexActivoTrabajador:s,volver:u,getTotal:v,seleccionar:k,totalRows:b,nuevaCesta:f,borrarCesta:y,arrayMesas:r,idCestaSeleccionada:d,SiMesas:c,arrayTrabajadoresID:i,CobroSeparadoRef:o,getNombreByID:p}}};const bo=(0,Q.Z)(vo,[["render",f],["__scopeId","data-v-7f01a565"]]);var fo=bo}}]);
//# sourceMappingURL=285.3a1fbd9a.js.map