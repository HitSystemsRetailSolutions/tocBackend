"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[246],{38793:function(a,e,t){t.d(e,{Z:function(){return f}});var l=t(73396),n=t(87139);const o={class:"btn-group"},u={class:"btn-group"},d={class:"btn-group"},s={class:"btn-group"},c={class:"btn-group"};function i(a,e,t,i,r,p){return(0,l.wg)(),(0,l.iD)("div",{class:(0,n.C_)(["btn-group-vertical mt-1",{disabled:t.disabled}])},[(0,l._)("div",o,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[0]||(e[0]=a=>i.addTecla("1"))}," 1 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[1]||(e[1]=a=>i.addTecla("2"))}," 2 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[2]||(e[2]=a=>i.addTecla("3"))}," 3 ")]),(0,l._)("div",u,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[3]||(e[3]=a=>i.addTecla("4"))}," 4 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[4]||(e[4]=a=>i.addTecla("5"))}," 5 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[5]||(e[5]=a=>i.addTecla("6"))}," 6 ")]),(0,l._)("div",d,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[6]||(e[6]=a=>i.addTecla("7"))}," 7 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[7]||(e[7]=a=>i.addTecla("8"))}," 8 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[8]||(e[8]=a=>i.addTecla("9"))}," 9 ")]),(0,l._)("div",s,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[9]||(e[9]=a=>i.deleteTecla())}," < "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[10]||(e[10]=a=>i.addTecla("0"))}," 0 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[11]||(e[11]=a=>i.okValue(Number(i.cantidad)))}," OK ")]),(0,l._)("div",c,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonComa",onClick:e[12]||(e[12]=a=>i.addTecla("."))}," , ")])],2)}t(42492);var r=t(32066),p=t(28571),b=t(44870);const m=(0,r.io)("http://"+p.Z.state.TocGameURL+":5051");var v={props:{skipBalanza:{type:Boolean,default:!1},max3EntersDigits:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},name:"NumpadComponent",setup(a,{expose:e,emit:t}){const n=(0,b.iH)("0"),o=(0,l.f3)("okValue"),u=(0,b.iH)("5.5rem"),d=(0,b.iH)("5.5rem");(0,l.Fl)((()=>p.Z.state.Weight.lastWeight));function s(){console.log("Shake"),t("activarShake")}function c(e){if(a.max3EntersDigits){let[a,t]=n.value.split("."),l=n.value.includes(".");if(a.length>=3&&!l&&"."!=e)return s();if(t&&t.length>=2)return s();if("."===e&&n.value.includes("."))return s()}"."===e&&(n.value=n.value.replace(".","")),n.value+=e,"0"==n.value[0]&&(n.value=n.value.slice(1)),t("setValue",n.value)}function i(){n.value=n.value.slice(0,-1),""===n.value&&(n.value="0")}function r(a){n.value=Number(a).toString(),t("setValue",n.value)}return m.on("setBalanzaValue",(e=>{e&&!a.skipBalanza&&r(e)})),e({cantidad:n,setValor:r}),(0,l.bv)((async()=>{a.skipBalanza||r((await(0,l.Fl)((()=>p.Z.state.Weight.lastWeight))).value)})),{okValue:o,cantidad:n,addTecla:c,deleteTecla:i,setValor:r,anchoTecla:u,altoTecla:d}}},y=t(40089);const _=(0,y.Z)(v,[["render",i],["__scopeId","data-v-30e0be06"]]);var f=_},26246:function(a,e,t){t.r(e),t.d(e,{default:function(){return Q}});var l=t(73396),n=t(87139),o=t(49242);const u=a=>((0,l.dD)("data-v-a24a2eda"),a=a(),(0,l.Cn)(),a),d={id:"main"},s={id:"vueMenuEncargo"},c={class:"encargos"},i={class:""},r={class:"row"},p=u((()=>(0,l._)("div",{class:"col"},null,-1))),b={class:"col"},m={key:0},v={class:"btnEncargo lgEncargo float-right"},y={key:1,class:"btnEncargo float-right"},_=u((()=>(0,l._)("i",{class:"fas fa-search"},null,-1))),f=u((()=>(0,l._)("hr",null,null,-1))),g={class:"productos"},k={key:0},C={class:"d-flex flex-column py-1"},D={class:"d-flex flex-column justify-content-center"},T={class:""},w={key:1},h={class:"encargos-footer"},N=u((()=>(0,l._)("small",{id:"emailHelp",class:"form-text text-muted"},"Precio total:",-1))),B={class:"mb-0 mt-2"},M={class:"input-deja-a-cuenta"},x=u((()=>(0,l._)("small",{id:"emailHelp",class:"form-text text-muted"},"Deja a cuenta:",-1))),H={class:""},j={key:0,class:"spinner"},z={key:1,class:"m-0"},V={class:"row"},A={class:"col"},W={class:"input-group input-group-lg"},E={class:"row"},F={class:"col text-center"};function U(a,e,t,u,U,Z){const O=(0,l.up)("MDBBtn"),I=(0,l.up)("MDBModalTitle"),R=(0,l.up)("MDBModalHeader"),L=(0,l.up)("NumpadComponent"),Y=(0,l.up)("MDBModalBody"),$=(0,l.up)("MDBModalFooter"),S=(0,l.up)("MDBModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",d,[(0,l._)("div",s,[(0,l._)("div",null,[(0,l._)("div",c,[(0,l._)("div",i,[(0,l._)("div",r,[p,(0,l._)("div",b,[u.clienteData.idCliente?((0,l.wg)(),(0,l.iD)("h1",m,[(0,l._)("button",v,(0,n.zw)(u.clienteData.nombreCliente),1)])):((0,l.wg)(),(0,l.iD)("button",y,[_,(0,l.Uk)(" Abrir modal cliente ")]))])]),f,(0,l._)("div",g,[u.cestaActiva.lista.length?((0,l.wg)(),(0,l.iD)("div",k,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(u.cestaActiva.lista,((a,e)=>((0,l.wg)(),(0,l.iD)("div",{class:"producto d-flex justify-content-between w-75",key:e},[(0,l._)("div",C,[(0,l._)("span",null,"- "+(0,n.zw)(a.nombre),1),(0,l._)("div",D,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.arraySuplementos,((a,e)=>((0,l.wg)(),(0,l.iD)("span",{class:"ms-3",key:e},(0,n.zw)(a.nombre),1)))),128))])]),(0,l._)("div",null,[(0,l._)("span",T,(0,n.zw)(a.unidades)+" unidad(es)",1)])])))),128))])):((0,l.wg)(),(0,l.iD)("div",w,(0,n.zw)(a.$t("toc_game_no_hay_productos","No hay ningún producto seleccionado")),1))]),(0,l._)("div",h,[(0,l._)("div",null,[N,(0,l._)("p",B,(0,n.zw)(u.precioTotal)+"€",1)]),(0,l._)("div",M,[x,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"cuenta",name:"dejaACuenta",placeholder:"0",min:"0","onUpdate:modelValue":e[0]||(e[0]=a=>u.dejaACuenta=a),onClick:e[1]||(e[1]=(...a)=>u.openTecladoNum&&u.openTecladoNum(...a)),readonly:""},null,512),[[o.nr,u.dejaACuenta]])]),(0,l._)("div",H,[(0,l.Wm)(O,{color:"primary",onClick:e[2]||(e[2]=a=>u.crearDeuda()),disabled:u.loading,class:"btn btn-primary btn-lg"},{default:(0,l.w5)((()=>[u.loading?((0,l.wg)(),(0,l.iD)("span",j)):((0,l.wg)(),(0,l.iD)("p",z,"Crear deuda"))])),_:1},8,["disabled"])])])])])])])]),(0,l.Wm)(S,{id:"modalTecladoNum",tabindex:"-1",labelledby:"modalTecladoNumLabel",modelValue:u.modalTecladoNum,"onUpdate:modelValue":e[6]||(e[6]=a=>u.modalTecladoNum=a),"data-backdrop":"false"},{default:(0,l.w5)((()=>[(0,l.Wm)(R,null,{default:(0,l.w5)((()=>[(0,l.Wm)(I,{id:"modalTecladoNumLabel"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(a.$t("deja_a_cuenta","Deja a cuenta")),1)])),_:1})])),_:1}),(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l._)("div",V,[(0,l._)("div",A,[(0,l._)("div",W,[u.numpadRef?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=a=>u.numpadRef.cantidad=a)},null,512)),[[o.nr,u.numpadRef.cantidad]]):(0,l.kq)("",!0)])])]),(0,l._)("div",E,[(0,l._)("div",F,[(0,l.Wm)(L,{skipBalanza:!0,ref:"numpadRef"},null,512)])])])),_:1}),(0,l.Wm)($,null,{default:(0,l.w5)((()=>[(0,l.Wm)(O,{color:"danger",onClick:e[4]||(e[4]=a=>u.closeTecladoNum()),size:"lg"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Cerrar ")])),_:1}),(0,l.Wm)(O,{color:"success",size:"lg",onClick:e[5]||(e[5]=a=>u.finishTecladoNum())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(a.$t("aceptar","Aceptar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}t(57658);var Z=t(44870),O=t(74313),I=t(20065),R=t(42492),L=t.n(R),Y=t(87853),$=t(91076),S=t(6411),J=t(38793),K={name:"DeudasComponent",components:{MDBBtn:O.$v,MDBCard:O.Yl,MDBCardBody:O.H7,MDBCardTitle:O.QM,MDBCardText:O.Pp,MDBCheckbox:O.IH,MDBModal:O.j3,MDBModalHeader:O.ol,MDBModalTitle:O.wo,MDBModalBody:O.Yz,MDBModalFooter:O.ab,MDBIcon:O.vm,MDBLoading:O.J$,NumpadComponent:J.Z},setup(){const a=(0,I.oR)(),{t:e}=(0,Y.QT)(),t=(0,Z.iH)(0),n=(0,l.Fl)((()=>a.state.Cestas.arrayCestas)),o=a.getters["Cestas/getCestaActiva"],u=(a.getters["Cestas/getCestaActivaIndex"],(0,l.Fl)((()=>a.state.Trabajadores.arrayTrabajadores))),d=(0,l.Fl)((()=>a.state.Trabajadores.indexActivo)),s=(0,l.Fl)((()=>u.value&&null!=d.value&&void 0!=d.value&&u.value[d.value]?u.value[d.value]:null)),c=(0,l.Fl)((()=>{if(n.value)for(let a=0;a<n.value.length;a++)if(n.value[a]._id==u.value[d.value].idCesta)return n.value[a];return null})),i=(0,l.Fl)((()=>a.state.Cestas.Descuento)),r=(0,Z.iH)(null),p={idCliente:o.idCliente,nombreCliente:o.nombreCliente},b=(0,Z.iH)(!1),m=(0,Z.iH)(null),v=(0,Z.iH)(null),y=(0,Z.iH)(0);function _(a){const e=a.detalleIva,t=Object.keys(e).filter((a=>a.startsWith("importe"))).reduce(((a,t)=>a+e[t]),0);return Math.round(100*t)/100}const f=async()=>{const a=_(c.value);if(a<y.value)L().fire("Oops...","La cantidad a cuenta no puede ser mayor que el total","error");else if(a!=y.value)try{const a=await $.Z.post("tickets/crearTicketDeuda",{total:_(c.value),idCesta:c.value._id,idTrabajador:s.value._id,tipo:"DEUDA",tkrsData:{cantidadTkrs:t.value,formaPago:"EFECTIVO"},dejaCuenta:y.value,concepto:"DEUDA"});if(!a.data)throw Error("No se ha podido crear el ticket");k(e("toc_game_encargos_ok","Deuda creada!"),"success",g)}catch(l){L().fire("Oops...",l.message,"error")}finally{b.value=!1}else L().fire("Oops...","La cantidad a cuenta no puede ser igual al total","error")};const g=async()=>{a.dispatch("EstadoDinamico/reset"),w("/main")},k=(a,e,t=(()=>{}))=>{L().fire("error"===e?"Oops...":"Ok!!",a,e).then((()=>t()))},C=()=>{m.value=!0},D=()=>{m.value=!1},T=()=>{let a=Number(v.value.cantidad);y.value=Number(a.toFixed(2)),D()};(0,l.JJ)("okValue",(()=>m.value?T():C()));const w=a=>S.Z.push(a);return(0,l.bv)((()=>{r.value=_(c.value)})),{crearDeuda:f,cestaActiva:o,clienteData:p,precioTotal:r,cantidadTkrs:t,cesta:c,arrayCestas:n,getTotal:_,DescuentoCliente:i,loading:b,modalTecladoNum:m,numpadRef:v,openTecladoNum:C,closeTecladoNum:D,finishTecladoNum:T,dejaACuenta:y}}},P=t(40089);const q=(0,P.Z)(K,[["render",U],["__scopeId","data-v-a24a2eda"]]);var Q=q}}]);
//# sourceMappingURL=246.88cec8d1.js.map