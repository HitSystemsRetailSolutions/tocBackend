"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[896],{61562:function(e,a,l){l.d(a,{Z:function(){return p}});var o=l(73396),t=l(87139);const n=["onClick"],i={class:"botonTecladoSpaceDiv"};function s(e,a,l,s,d,r){const u=(0,o.up)("MDBInput"),c=(0,o.up)("MDBModalHeader"),m=(0,o.up)("MDBModalBody"),p=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(p,{frame:"",position:"bottom",id:"keyBoardModal",tabindex:"-1",labelledby:"keyBoardModal",modelValue:s.keyBoardModal,"onUpdate:modelValue":a[4]||(a[4]=e=>s.keyBoardModal=e)},{default:(0,o.w5)((()=>[s.showInput?((0,o.wg)(),(0,o.j4)(c,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{style:{width:"80rem !important"},label:"Texto introducido",modelValue:s.text,"onUpdate:modelValue":a[0]||(a[0]=e=>s.text=e)},null,8,["modelValue"])])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(m,{class:"mainDiv"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.chars.length,((e,a)=>((0,o.wg)(),(0,o.iD)("div",{key:a},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.chars[e-1],((e,a)=>((0,o.wg)(),(0,o.iD)("div",{class:"btn-group-vertical mt-1 divTecla",key:a},[(0,o._)("button",{type:"button",style:(0,t.j5)([{"text-transform":"none"},s.keyStyle(e)]),class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a=>s.processTecla(e)},(0,t.zw)(e),13,n)])))),128))])))),128)),(0,o._)("div",i,[(0,o._)("button",{style:(0,t.j5)([{"font-size":"1.8rem"},s.keyStyle("✎")]),type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[1]||(a[1]=e=>s.processTecla("✎"))}," ✎ ",4),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonTecladoSpace",onClick:a[2]||(a[2]=e=>s.processTecla(" "))}," ␣ "),(0,o._)("button",{style:(0,t.j5)([{"font-size":"1.8rem"},s.keyStyle("#")]),type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[3]||(a[3]=e=>s.processTecla("#"))}," Ⅳ ",4)])])),_:1})])),_:1},8,["modelValue"])}var d=l(44870),r=l(74313),u={name:"KeyBoardComponent",components:{MDBIcon:r.vm,MDBModalBody:r.Yz,MDBModal:r.j3,MDBBtn:r.$v,MDBModalHeader:r.ol,MDBModalTitle:r.wo,MDBInput:r.u2,MDBModalFooter:r.ab},props:{value:String,text:String},setup(e,{expose:a}){const l=(0,d.iH)(e.value||""),t=(0,d.iH)(!1),n=(0,d.iH)(!1),i=(0,d.iH)(!1);let s=!1;const r=(0,d.iH)(!1),u=[["q","w","e","r","t","y","u","i","o","p","←"],["a","s","d","f","g","h","j","k","l","ñ","↵"],["z","x","c","v","b","n","m",",",".","-","⇪"]],c=(0,d.iH)([]);function m(e){switch(e){case"←":b();break;case"↵":t.value=!1;break;case"⇪":s=!s,l.value.length>0&&(n.value=!n.value),y();break;case"#":i.value=!i.value,y();break;case"✎":r.value=!r.value;break;default:v(e);break}}function p(e){let a=l.value.length<=0&&!s||n.value,o="background-color: #606060 !important; color: white !important;";return i.value&&"#"==e||r.value&&"✎"==e||"⇪"==e&&a?o:a?"text-transform: uppercase":"text-transform: none;"}function v(e){let a=l.value.length<=0&&!s||n.value;s=!1,a&&(e=e.toUpperCase()),l.value+=e}function b(){l.value.length>0&&(l.value=l.value.slice(0,-1))}function y(){let e=u;const a=["á","é","í","ó","ú","ü","¡","¿"];if(i.value){let a=[["1","2","3","4","5","6","7","8","9","0","ç"]];a=a.concat(u),e=a}c.value=e.map((e=>e.map((e=>a.includes(e)?[e,e.toUpperCase()]:e))))}function f(e=""){void 0===l.value&&(l.value=""),l.value=e,t.value=!0}function B(){return[l.value,t.value]}return a({getValue:B,abrirModal:f}),(0,o.bv)((()=>{y()})),{text:l,addTecla:v,deleteTecla:b,keyBoardModal:t,processTecla:m,upperCase:n,keyStyle:p,buildKeyboard:y,abrirModal:f,showInput:r,chars:c}}},c=l(40089);const m=(0,c.Z)(u,[["render",s],["__scopeId","data-v-c19133e2"]]);var p=m},49896:function(e,a,l){l.d(a,{Z:function(){return Z}});var o=l(73396),t=l(87139),n=l(49242);const i={class:"row"},s={class:"d-inline-block text-center"},d={class:"row mt-1 p-4"},r={class:"col-md-8"},u={class:"col-md-4"},c={key:0,class:"row"},m={class:"col"},p={class:"table-responsive w-100",style:{height:"400px"}},v={class:"table table-striped mt-1"},b={class:"nameDiv"},y={class:"textoNombre d-inline-block text-truncate"},f={key:1,class:"row"},B={class:"sinResultados position-relative"},k={class:"textoSinResultados position-absolute top-50 start-50 translate-middle"};function C(e,a,l,C,M,w){const g=(0,o.up)("MDBBtn"),_=(0,o.up)("MDBBadge"),D=(0,o.up)("MDBicon"),h=(0,o.up)("MDBModalBody"),x=(0,o.up)("MDBModal"),V=(0,o.up)("ModalNuevoCliente"),H=(0,o.up)("KeyBoardComponentVue");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(x,{id:"modalClientes",tabindex:"-1",labelledby:"tituloModalClientes",modelValue:C.modalClientes,"onUpdate:modelValue":a[8]||(a[8]=e=>C.modalClientes=e),staticBackdrop:"",size:"xl"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o._)("div",i,[(0,o._)("div",s,[(0,o.Wm)(g,{color:"warning",class:"sizeBotones",onClick:a[0]||(a[0]=e=>C.clickDelivery("Glovo")),disabled:!C.activoGlovo},{default:(0,o.w5)((()=>[(0,o.Uk)("Glovo")])),_:1},8,["disabled"]),(0,o.Wm)(g,{color:"dark",class:"ms-2 sizeBotones",disabled:!C.activoUber,onClick:a[1]||(a[1]=e=>C.clickDelivery("Uber"))},{default:(0,o.w5)((()=>[(0,o.Uk)("Uber")])),_:1},8,["disabled"]),(0,o.Wm)(g,{color:"primary",class:"ms-2 sizeBotones",disabled:!C.activoToGo,onClick:a[2]||(a[2]=e=>C.clickDelivery("TooGoodToGo"))},{default:(0,o.w5)((()=>[(0,o.Uk)("To Go")])),_:1},8,["disabled"]),(0,o.Wm)(g,{color:"success",class:"ms-2 sizeBotones",onClick:a[3]||(a[3]=e=>C.modalNuevoClienteRef.abrirModal())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("nuevo","Nuevo")),1)])),_:1}),(0,o.Wm)(g,{color:"danger",class:"ms-2 sizeBotones",onClick:a[4]||(a[4]=e=>C.modalClientes=!1)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("salir","Salir")),1)])),_:1})])]),(0,o._)("div",d,[(0,o._)("div",r,[(0,o.wy)((0,o._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:"Buscar por nombre","aria-label":".form-control-lg example","onUpdate:modelValue":a[5]||(a[5]=e=>C.inputBusqueda=e),onClick:a[6]||(a[6]=e=>C.openKeyboard()),readonly:""},null,512),[[n.nr,C.inputBusqueda]])]),(0,o._)("div",u,[(0,o.Wm)(g,{color:"secondary",class:"botonBusqueda w-100",onClick:a[7]||(a[7]=e=>C.buscar())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("buscar","Buscar")),1)])),_:1})])]),C.arrayClientes?.length>0?((0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("div",m,[(0,o._)("div",p,[(0,o._)("table",v,[(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.arrayClientes,((a,l)=>((0,o.wg)(),(0,o.iD)("tr",{key:l},[(0,o._)("td",null,[(0,o._)("div",b,[(0,o._)("span",y,(0,t.zw)(a.nombre),1),(0,o.Uk)("  "),a.albaran?((0,o.wg)(),(0,o.j4)(_,{key:0,badge:"info",class:"text-dark textoAlbaran",pill:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Albaran")])),_:1})):(0,o.kq)("",!0)])]),(0,o._)("td",null,[(0,o.Wm)(g,{color:"primary",size:"lg",onClick:e=>C.selectCliente(a.id,a.nombre,a.albaran),class:"w-100",style:{height:"3.85rem","font-size":"1.5rem"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("elegir","Elegir")),1),(0,o.Wm)(D,{icon:""})])),_:2},1032,["onClick"])])])))),128))])])])])])):((0,o.wg)(),(0,o.iD)("div",f,[(0,o._)("div",B,[(0,o._)("span",k,(0,t.zw)(e.$t("sin_resultados","Sin resultados")),1)])]))])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(V,{ref:"modalNuevoClienteRef"},null,512),(0,o.Wm)(H,{ref:"keyboardRef"},null,512)],64)}var M=l(44161),w=l(74313),g=l(42492),_=l.n(g),D=l(44870),h=l(20065);const x={class:"row"},V={class:"col w-50"},H={class:"col w-50 datos"},T={key:0,class:"spinner"},U={key:1};function W(e,a,l,n,i,s){const d=(0,o.up)("MDBModalHeader"),r=(0,o.up)("MDBInput"),u=(0,o.up)("MDBModalBody"),c=(0,o.up)("MDBBtn"),m=(0,o.up)("MDBModalFooter"),p=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(p,{id:"modalFichaCliente",tabindex:"-1",labelledby:"tituloModalFichaCliente",modelValue:n.modalFichaCliente,"onUpdate:modelValue":a[9]||(a[9]=e=>n.modalFichaCliente=e),staticBackdrop:"",size:"xl"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o._)("h2",null,"Ficha de "+(0,t.zw)(n.nombre),1)])),_:1}),(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o._)("div",x,[(0,o._)("div",V,[(0,o.Wm)(r,{label:"Nombre",modelValue:n.nombre,"onUpdate:modelValue":a[0]||(a[0]=e=>n.nombre=e),style:{"margin-top":"10px"}},null,8,["modelValue"]),(0,o.Wm)(r,{label:"Telefono",modelValue:n.telefono,"onUpdate:modelValue":a[1]||(a[1]=e=>n.telefono=e),class:"datos",style:{"margin-top":"10px"}},null,8,["modelValue"]),(0,o.Wm)(r,{label:"email",modelValue:n.email,"onUpdate:modelValue":a[2]||(a[2]=e=>n.email=e),class:"datos",style:{"margin-top":"10px"}},null,8,["modelValue"]),(0,o.Wm)(r,{label:"direccion",modelValue:n.direccion,"onUpdate:modelValue":a[3]||(a[3]=e=>n.direccion=e),class:"datos",style:{"margin-top":"10px"}},null,8,["modelValue"])]),(0,o._)("div",H,[(0,o.Wm)(r,{label:"Tarjeta Cliente",modelValue:n.tarjeta,"onUpdate:modelValue":a[4]||(a[4]=e=>n.tarjeta=e),class:"datos",style:{"margin-top":"10px"},"aria-required":"true"},null,8,["modelValue"]),(0,o.Wm)(r,{label:"Nif",modelValue:n.nif,"onUpdate:modelValue":a[5]||(a[5]=e=>n.nif=e),class:"datos",style:{"margin-top":"10px"}},null,8,["modelValue"]),(0,o.Wm)(r,{label:"descuento",modelValue:n.descuento,"onUpdate:modelValue":a[6]||(a[6]=e=>n.descuento=e),class:"datos",style:{"margin-top":"10px"}},null,8,["modelValue"])])])])),_:1}),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{color:"primary",onClick:a[7]||(a[7]=e=>n.guardarCliente()),disabled:n.loading,class:"btnSpinner d-flex align-items-center justify-content-center"},{default:(0,o.w5)((()=>[n.loading?((0,o.wg)(),(0,o.iD)("span",T)):((0,o.wg)(),(0,o.iD)("span",U,"Guardar"))])),_:1},8,["disabled"]),(0,o.Wm)(c,{color:"danger",onClick:a[8]||(a[8]=e=>n.modalFichaCliente=!1),ref:"salirBoton",disabled:n.loading},{default:(0,o.w5)((()=>[(0,o.Uk)(" Salir ")])),_:1},8,["disabled"])])),_:1})])),_:1},8,["modelValue"])}var z={name:"ModalFichaClienteComponent",props:["callback"],components:{MDBBtn:w.$v,MDBInput:w.u2,MDBModal:w.j3,MDBModalBody:w.Yz,MDBModalFooter:w.ab,MDBModalHeader:w.ol},setup(e,a){const l=(0,D.iH)(!1),t=e=>{n.value="",i.value="",s.value="",d.value="",r.value="",u.value="",c.value="",l.value=!0};a.expose({abrirModal:t});const n=(0,D.iH)(""),i=(0,D.iH)(""),s=(0,D.iH)(""),d=(0,D.iH)(""),r=(0,D.iH)(""),u=(0,D.iH)(""),c=(0,D.iH)("0"),m=((0,D.iH)(null),(0,D.iH)(null)),p=(0,o.f3)("cambiosCliente"),v=(0,D.iH)(!1),b=()=>{""!=n.value?isNaN(Number(c.value))?_().fire({title:"Vaya...",text:"El descuento tiene que ser un número",icon:"error",confirmButtonText:"Aceptar"}):(v.value=!0,M.Z.post("clientes/crearNuevoCliente",{nombre:n.value,telefono:i.value,email:s.value,direccion:d.value,tarjetaCliente:r.value,nif:u.value,descuento:c.value}).then((()=>{_().fire({title:"Cliente creado",icon:"success",confirmButtonText:"Aceptar"}),v.value=!1,l.value=!1})).catch((e=>{_().fire({title:"Vaya...",text:"Error al crear el cliente",icon:"error",confirmButtonText:"Aceptar"}),v.value=!1}))):_().fire({title:"Vaya...",text:"El campo de nombre y de tarjeta son obligatorios",icon:"error",confirmButtonText:"Aceptar"})};return{modalFichaCliente:l,guardarCliente:b,nombre:n,telefono:i,email:s,direccion:d,tarjeta:r,nif:u,descuento:c,salirBoton:m,cambiosCliente:p,loading:v}}},j=l(40089);const N=(0,j.Z)(z,[["render",W],["__scopeId","data-v-3ae4bab9"]]);var F=N,I=l(61562),S={name:"ModalClientesComponent",components:{MDBModal:w.j3,MDBModalBody:w.Yz,MDBBtn:w.$v,ModalNuevoCliente:F,MDBIcon:w.vm,MDBBadge:w.m_,KeyBoardComponentVue:I.Z},setup(e,a){const l=(0,h.oR)(),t=(0,D.iH)(!1),n=(0,D.iH)(0),i=(0,D.iH)(null),s=(0,D.iH)(""),d=(0,D.iH)(),r=(0,D.iH)(null),u=(0,D.iH)(!0),c=(0,D.iH)(!0),m=(0,D.iH)(!0),p=(0,o.f3)("actualizarPuntos"),v=(0,o.Fl)((()=>l.state.Trabajadores.arrayTrabajadores)),b=(0,o.Fl)((()=>l.state.Trabajadores.indexActivo)),y=(0,o.Fl)((()=>v.value&&void 0!=b.value&&null!=b.value&&v.value[b.value]?v.value[b.value]:null)),f=(0,o.Fl)((()=>l.state.Cestas.arrayCestas));function B(){t.value=!0,w()}function k(){n.value++}function C(e){M.Z.post("clientes/getClienteById",{idCliente:e}).then((a=>{if(!a.data)throw Error("No se ha podido obtener la información del cliente. backend");x(e,a.data.nombre,a.data.albaran)})).catch((e=>{_().fire("Oops...",e.message,"error")}))}const w=async()=>{const e=await M.Z.post("clientes/getServiciosTienda");e.data?(u.value=!!e.data.includes("Glovo"),c.value=!!e.data.includes("TooGoodToGo"),m.value=!!e.data.includes("Uber")):(u.value=!1,c.value=!1,m.value=!1)},g=async e=>{const a=await M.Z.post("clientes/getClienteByServicio",{servicio:e});if(!a.data)throw Error("No se ha podido obtener la información del cliente. backend");C(a.data)};async function x(e,a,o){if(f.value)for(let n=0;n<f.value.length;n++)if(y.value.idCesta===f.value[n]._id){l.dispatch("Cestas/setClienteCesta",{index:n,idCliente:e,albaran:o,nombreCliente:a}),l.dispatch("EstadoDinamico/setVistaCliente",!0),p();const i=await M.Z.post("clientes/getClienteById",{idCliente:e});l.dispatch("Cestas/setDescuentoAction",Number(i.data.descuento)/100),t.value=!1;break}}function V(){M.Z.post("clientes/buscar",{busqueda:s.value}).then((e=>{d.value=e.data})).catch((e=>{_().fire("Oops...",e.message,"error")}))}let H;async function T(){try{i.value.abrirModal(s.value),H=setInterval((()=>{s.value=i.value.getValue()[0],i.value.getValue()[1]||clearInterval(H)}),100)}catch(e){console.log(e),H=void 0}}return(0,o.YP)(s,(()=>{V()})),a.expose({abrirModal:B,datoBorrar:n,selectCliente:x}),{test:k,datoBorrar:n,modalClientes:t,inputBusqueda:s,arrayClientes:d,selectCliente:x,buscar:V,keyboardRef:i,openKeyboard:T,modalNuevoClienteRef:r,clickClienteAtajo:C,activoGlovo:u,activoToGo:c,activoUber:m,clickDelivery:g}}};const G=(0,j.Z)(S,[["render",C],["__scopeId","data-v-62a69a5a"]]);var Z=G}}]);
//# sourceMappingURL=896.e9533200.js.map