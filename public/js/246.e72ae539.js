"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[246],{33727:function(a,e,t){t.d(e,{Z:function(){return f}});var l=t(73396),n=t(87139);const o={class:"btn-group"},d={class:"btn-group"},u={class:"btn-group"},s={class:"btn-group"},c={class:"btn-group"};function i(a,e,t,i,r,p){return(0,l.wg)(),(0,l.iD)("div",{class:(0,n.C_)(["btn-group-vertical mt-1",{disabled:t.disabled}])},[(0,l._)("div",o,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[0]||(e[0]=a=>i.addTecla("1"))}," 1 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[1]||(e[1]=a=>i.addTecla("2"))}," 2 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[2]||(e[2]=a=>i.addTecla("3"))}," 3 ")]),(0,l._)("div",d,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[3]||(e[3]=a=>i.addTecla("4"))}," 4 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[4]||(e[4]=a=>i.addTecla("5"))}," 5 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[5]||(e[5]=a=>i.addTecla("6"))}," 6 ")]),(0,l._)("div",u,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[6]||(e[6]=a=>i.addTecla("7"))}," 7 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[7]||(e[7]=a=>i.addTecla("8"))}," 8 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[8]||(e[8]=a=>i.addTecla("9"))}," 9 ")]),(0,l._)("div",s,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[9]||(e[9]=a=>i.deleteTecla())}," < "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[10]||(e[10]=a=>i.addTecla("0"))}," 0 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary botonNumpad",onClick:e[11]||(e[11]=a=>i.addTecla("."))}," , ")]),(0,l._)("div",c,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary botonComa",onClick:e[12]||(e[12]=a=>i.okValue(Number(i.cantidad)))}," OK ")])],2)}t(42492);var r=t(32066),p=t(25994),b=t(44870);const m=(0,r.io)("http://"+p.Z.state.TocGameURL+":5051");var v={props:{skipBalanza:{type:Boolean,default:!1},max3EntersDigits:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},name:"NumpadComponent",setup(a,{expose:e,emit:t}){const n=(0,b.iH)("0"),o=(0,l.f3)("okValue"),d=(0,b.iH)("5.5rem"),u=(0,b.iH)("5.5rem");(0,l.Fl)((()=>p.Z.state.Weight.lastWeight));function s(){t("activarShake")}function c(e){if(a.max3EntersDigits){let[a,t]=n.value.split("."),l=n.value.includes(".");if(a.length>=3&&!l&&"."!=e)return s();if(t&&t.length>=2)return s();if("."===e&&n.value.includes("."))return s()}"."===e&&n.value.includes(".")||(n.value+=e,"0"==n.value[0]&&(n.value=n.value.slice(1)),t("setValue",n.value))}function i(){n.value=n.value.slice(0,-1),""===n.value&&(n.value="0")}function r(a){n.value=Number(a).toString(),t("setValue",n.value)}return m.on("setBalanzaValue",(e=>{e&&!a.skipBalanza&&r(e)})),e({cantidad:n,setValor:r}),(0,l.bv)((async()=>{a.skipBalanza||r((await(0,l.Fl)((()=>p.Z.state.Weight.lastWeight))).value)})),{okValue:o,cantidad:n,addTecla:c,deleteTecla:i,setValor:r,anchoTecla:d,altoTecla:u}}},_=t(40089);const y=(0,_.Z)(v,[["render",i],["__scopeId","data-v-2468ee80"]]);var f=y},26246:function(a,e,t){t.r(e),t.d(e,{default:function(){return Q}});var l=t(73396),n=t(87139),o=t(49242);const d=a=>((0,l.dD)("data-v-a24a2eda"),a=a(),(0,l.Cn)(),a),u={id:"main"},s={id:"vueMenuEncargo"},c={class:"encargos"},i={class:""},r={class:"row"},p=d((()=>(0,l._)("div",{class:"col"},null,-1))),b={class:"col"},m={key:0},v={class:"btnEncargo lgEncargo float-right"},_={key:1,class:"btnEncargo float-right"},y=d((()=>(0,l._)("i",{class:"fas fa-search"},null,-1))),f=d((()=>(0,l._)("hr",null,null,-1))),g={class:"productos"},C={key:0},k={class:"d-flex flex-column py-1"},D={class:"d-flex flex-column justify-content-center"},T={class:""},w={key:1},N={class:"encargos-footer"},h=d((()=>(0,l._)("small",{id:"emailHelp",class:"form-text text-muted"},"Precio total:",-1))),B={class:"mb-0 mt-2"},M={class:"input-deja-a-cuenta"},x=d((()=>(0,l._)("small",{id:"emailHelp",class:"form-text text-muted"},"Deja a cuenta:",-1))),H={class:""},j={key:0,class:"spinner"},z={key:1,class:"m-0"},V={class:"row"},A={class:"col"},W={class:"input-group input-group-lg"},E={class:"row"},F={class:"col text-center"};function U(a,e,t,d,U,Z){const O=(0,l.up)("MDBBtn"),I=(0,l.up)("MDBModalTitle"),R=(0,l.up)("MDBModalHeader"),L=(0,l.up)("NumpadComponent"),Y=(0,l.up)("MDBModalBody"),$=(0,l.up)("MDBModalFooter"),J=(0,l.up)("MDBModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",u,[(0,l._)("div",s,[(0,l._)("div",null,[(0,l._)("div",c,[(0,l._)("div",i,[(0,l._)("div",r,[p,(0,l._)("div",b,[d.clienteData.idCliente?((0,l.wg)(),(0,l.iD)("h1",m,[(0,l._)("button",v,(0,n.zw)(d.clienteData.nombreCliente),1)])):((0,l.wg)(),(0,l.iD)("button",_,[y,(0,l.Uk)(" Abrir modal cliente ")]))])]),f,(0,l._)("div",g,[d.cestaActiva.lista.length?((0,l.wg)(),(0,l.iD)("div",C,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.cestaActiva.lista,((a,e)=>((0,l.wg)(),(0,l.iD)("div",{class:"producto d-flex justify-content-between w-75",key:e},[(0,l._)("div",k,[(0,l._)("span",null,"- "+(0,n.zw)(a.nombre),1),(0,l._)("div",D,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.arraySuplementos,((a,e)=>((0,l.wg)(),(0,l.iD)("span",{class:"ms-3",key:e},(0,n.zw)(a.nombre),1)))),128))])]),(0,l._)("div",null,[(0,l._)("span",T,(0,n.zw)(a.unidades)+" unidad(es)",1)])])))),128))])):((0,l.wg)(),(0,l.iD)("div",w,(0,n.zw)(a.$t("toc_game_no_hay_productos","No hay ningún producto seleccionado")),1))]),(0,l._)("div",N,[(0,l._)("div",null,[h,(0,l._)("p",B,(0,n.zw)(d.precioTotal)+"€",1)]),(0,l._)("div",M,[x,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"cuenta",name:"dejaACuenta",placeholder:"0",min:"0","onUpdate:modelValue":e[0]||(e[0]=a=>d.dejaACuenta=a),onClick:e[1]||(e[1]=(...a)=>d.openTecladoNum&&d.openTecladoNum(...a)),readonly:""},null,512),[[o.nr,d.dejaACuenta]])]),(0,l._)("div",H,[(0,l.Wm)(O,{color:"primary",onClick:e[2]||(e[2]=a=>d.crearDeuda()),disabled:d.loading,class:"btn btn-primary btn-lg"},{default:(0,l.w5)((()=>[d.loading?((0,l.wg)(),(0,l.iD)("span",j)):((0,l.wg)(),(0,l.iD)("p",z,"Crear deuda"))])),_:1},8,["disabled"])])])])])])])]),(0,l.Wm)(J,{id:"modalTecladoNum",tabindex:"-1",labelledby:"modalTecladoNumLabel",modelValue:d.modalTecladoNum,"onUpdate:modelValue":e[6]||(e[6]=a=>d.modalTecladoNum=a),"data-backdrop":"false"},{default:(0,l.w5)((()=>[(0,l.Wm)(R,null,{default:(0,l.w5)((()=>[(0,l.Wm)(I,{id:"modalTecladoNumLabel"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(a.$t("deja_a_cuenta","Deja a cuenta")),1)])),_:1})])),_:1}),(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l._)("div",V,[(0,l._)("div",A,[(0,l._)("div",W,[d.numpadRef?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=a=>d.numpadRef.cantidad=a)},null,512)),[[o.nr,d.numpadRef.cantidad]]):(0,l.kq)("",!0)])])]),(0,l._)("div",E,[(0,l._)("div",F,[(0,l.Wm)(L,{skipBalanza:!0,ref:"numpadRef"},null,512)])])])),_:1}),(0,l.Wm)($,null,{default:(0,l.w5)((()=>[(0,l.Wm)(O,{color:"danger",onClick:e[4]||(e[4]=a=>d.closeTecladoNum()),size:"lg"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Cerrar ")])),_:1}),(0,l.Wm)(O,{color:"success",size:"lg",onClick:e[5]||(e[5]=a=>d.finishTecladoNum())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(a.$t("aceptar","Aceptar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}t(57658);var Z=t(44870),O=t(74313),I=t(20065),R=t(42492),L=t.n(R),Y=t(87853),$=t(91076),J=t(44918),K=t(33727),P={name:"DeudasComponent",components:{MDBBtn:O.$v,MDBCard:O.Yl,MDBCardBody:O.H7,MDBCardTitle:O.QM,MDBCardText:O.Pp,MDBCheckbox:O.IH,MDBModal:O.j3,MDBModalHeader:O.ol,MDBModalTitle:O.wo,MDBModalBody:O.Yz,MDBModalFooter:O.ab,MDBIcon:O.vm,MDBLoading:O.J$,NumpadComponent:K.Z},setup(){const a=(0,I.oR)(),{t:e}=(0,Y.QT)(),t=(0,Z.iH)(0),n=(0,l.Fl)((()=>a.state.Cestas.arrayCestas)),o=a.getters["Cestas/getCestaActiva"],d=(a.getters["Cestas/getCestaActivaIndex"],(0,l.Fl)((()=>a.state.Trabajadores.arrayTrabajadores))),u=(0,l.Fl)((()=>a.state.Trabajadores.indexActivo)),s=(0,l.Fl)((()=>d.value&&null!=u.value&&void 0!=u.value&&d.value[u.value]?d.value[u.value]:null)),c=(0,l.Fl)((()=>{if(n.value)for(let a=0;a<n.value.length;a++)if(n.value[a]._id==d.value[u.value].idCesta)return n.value[a];return null})),i=(0,l.Fl)((()=>a.state.Cestas.Descuento)),r=(0,Z.iH)(null),p={idCliente:o.idCliente,nombreCliente:o.nombreCliente},b=(0,Z.iH)(!1),m=(0,Z.iH)(null),v=(0,Z.iH)(null),_=(0,Z.iH)(0);function y(a){const e=a.detalleIva,t=Object.keys(e).filter((a=>a.startsWith("importe"))).reduce(((a,t)=>a+e[t]),0);return Math.round(100*t)/100}const f=async()=>{const a=y(c.value);if(a<_.value)L().fire("Oops...","La cantidad a cuenta no puede ser mayor que el total","error");else if(a!=_.value)try{const a=await $.Z.post("tickets/crearTicketDeuda",{total:y(c.value),idCesta:c.value._id,idTrabajador:s.value._id,tipo:"DEUDA",tkrsData:{cantidadTkrs:t.value,formaPago:"EFECTIVO"},dejaCuenta:_.value,concepto:"DEUDA"});if(!a.data)throw Error("No se ha podido crear el ticket");C(e("toc_game_encargos_ok","Deuda creada!"),"success",g)}catch(l){L().fire("Oops...",l.message,"error")}finally{b.value=!1}else L().fire("Oops...","La cantidad a cuenta no puede ser igual al total","error")};const g=async()=>{a.dispatch("EstadoDinamico/reset"),w("/main")},C=(a,e,t=(()=>{}))=>{L().fire("error"===e?"Oops...":"Ok!!",a,e).then((()=>t()))},k=()=>{m.value=!0},D=()=>{m.value=!1},T=()=>{let a=Number(v.value.cantidad);_.value=Number(a.toFixed(2)),D()};(0,l.JJ)("okValue",(()=>m.value?T():k()));const w=a=>J.Z.push(a);return(0,l.bv)((()=>{r.value=y(c.value)})),{crearDeuda:f,cestaActiva:o,clienteData:p,precioTotal:r,cantidadTkrs:t,cesta:c,arrayCestas:n,getTotal:y,DescuentoCliente:i,loading:b,modalTecladoNum:m,numpadRef:v,openTecladoNum:k,closeTecladoNum:D,finishTecladoNum:T,dejaACuenta:_}}},S=t(40089);const q=(0,S.Z)(P,[["render",U],["__scopeId","data-v-a24a2eda"]]);var Q=q}}]);
//# sourceMappingURL=246.e72ae539.js.map