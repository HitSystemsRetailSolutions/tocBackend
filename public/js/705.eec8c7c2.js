"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[705],{18827:function(a,e,t){t.d(e,{Z:function(){return g}});var l=t(73396),o=t(87139);const n={class:"btn-group"},d={class:"btn-group"},c={class:"btn-group"},s={class:"btn-group"},u=["disabled"],i={class:"btn-group"};function r(a,e,t,r,p,m){return(0,l.wg)(),(0,l.iD)("div",{class:(0,o.C_)(["btn-group-vertical mt-1",{disabled:t.disabled}])},[(0,l._)("div",n,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[0]||(e[0]=a=>r.addTecla("1"))}," 1 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[1]||(e[1]=a=>r.addTecla("2"))}," 2 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[2]||(e[2]=a=>r.addTecla("3"))}," 3 ")]),(0,l._)("div",d,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[3]||(e[3]=a=>r.addTecla("4"))}," 4 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[4]||(e[4]=a=>r.addTecla("5"))}," 5 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[5]||(e[5]=a=>r.addTecla("6"))}," 6 ")]),(0,l._)("div",c,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[6]||(e[6]=a=>r.addTecla("7"))}," 7 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[7]||(e[7]=a=>r.addTecla("8"))}," 8 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[8]||(e[8]=a=>r.addTecla("9"))}," 9 ")]),(0,l._)("div",s,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[9]||(e[9]=a=>r.deleteTecla())}," < "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[10]||(e[10]=a=>r.addTecla("0"))}," 0 "),(0,l._)("button",{disabled:t.disabledComa,type:"button",class:"btn btn-outline-secondary botonNumpad",onClick:e[11]||(e[11]=a=>r.addTecla("."))}," , ",8,u)]),(0,l._)("div",i,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary botonComa",onClick:e[12]||(e[12]=a=>r.okValue(Number(r.cantidad)))}," OK ")])],2)}t(42492);var p=t(32066),m=t(25994),b=t(44870);const v=(0,p.io)("http://"+m.Z.state.TocGameURL+":5051");var f={props:{useBalanza:{type:Boolean,default:!1},max3EntersDigits:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},disabledComa:{type:Boolean,default:!1}},name:"NumpadComponent",setup(a,{expose:e,emit:t}){const o=(0,b.iH)("0"),n=(0,l.f3)("okValue"),d=(0,b.iH)("5.5rem"),c=(0,b.iH)("5.5rem");(0,l.Fl)((()=>m.Z.state.Weight.lastWeight));function s(){t("activarShake")}function u(e){if(a.max3EntersDigits){let[a,t]=o.value.split("."),l=o.value.includes(".");if(a.length>=3&&!l&&"."!=e)return s();if(t&&t.length>=2)return s();if("."===e&&o.value.includes("."))return s()}"."===e&&o.value.includes(".")||(o.value+=e,"0"==o.value[0]&&(o.value=o.value.slice(1)),t("setValue",o.value))}function i(){o.value=o.value.slice(0,-1),""===o.value&&(o.value="0")}function r(a){o.value=Number(a).toString(),t("setValue",o.value)}return v.on("setBalanzaValue",(e=>{null!=e&&void 0!=e&&a.useBalanza&&r(e)})),e({cantidad:o,setValor:r}),(0,l.bv)((async()=>{a.useBalanza&&r((await(0,l.Fl)((()=>m.Z.state.Weight.lastWeight))).value)})),{okValue:n,cantidad:o,addTecla:u,deleteTecla:i,setValor:r,anchoTecla:d,altoTecla:c}}},y=t(40089);const _=(0,y.Z)(f,[["render",r],["__scopeId","data-v-6c00b36e"]]);var g=_},47705:function(a,e,t){t.r(e),t.d(e,{default:function(){return ta}});var l=t(73396),o=t(87139),n=t(49242);const d=a=>((0,l.dD)("data-v-30f471f1"),a=a(),(0,l.Cn)(),a),c={id:"main"},s={id:"vueMenuEncargo"},u={class:"encargos"},i={class:""},r={class:"row"},p=d((()=>(0,l._)("div",{class:"col"},null,-1))),m={class:"col"},b={key:0},v={class:"btnEncargo lgEncargo float-right"},f={key:1,class:"btnEncargo float-right"},y=d((()=>(0,l._)("i",{class:"fas fa-search"},null,-1))),_=d((()=>(0,l._)("hr",null,null,-1))),g={class:"productos"},k={key:0},D={class:"d-flex flex-column py-1"},C={class:"d-flex flex-column justify-content-center"},T={class:""},w={key:1},h={class:"encargos-footer"},N=d((()=>(0,l._)("small",{id:"emailHelp",class:"form-text text-muted"},"Precio total:",-1))),B={class:"mb-0 mt-2"},M={class:"input-deja-a-cuenta"},x=d((()=>(0,l._)("small",{id:"emailHelp",class:"form-text text-muted"},"Deja a cuenta:",-1))),E={key:0,class:"mb-2 d-flex align-items-center gap-3"},H={class:"form-check form-check-inline"},V={class:"form-check-label",for:"radioEfectivo"},j={class:"form-check form-check-inline"},z={class:"form-check-label",for:"radioDatafono"},A={class:""},W={key:0,class:"spinner"},F={key:1,class:"m-0"},U={class:"row"},O={class:"col"},I={class:"input-group input-group-lg"},P={class:"row"},Z={class:"col text-center"};function G(a,e,t,d,G,R){const $=(0,l.up)("MDBIcon"),L=(0,l.up)("MDBBtn"),Y=(0,l.up)("MDBModalTitle"),q=(0,l.up)("MDBModalHeader"),J=(0,l.up)("NumpadComponent"),K=(0,l.up)("MDBModalBody"),S=(0,l.up)("MDBModalFooter"),Q=(0,l.up)("MDBModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",c,[(0,l._)("div",s,[(0,l._)("div",null,[(0,l._)("div",u,[(0,l._)("div",i,[(0,l._)("div",r,[p,(0,l._)("div",m,[d.clienteData.idCliente?((0,l.wg)(),(0,l.iD)("h1",b,[(0,l._)("button",v,(0,o.zw)(d.clienteData.nombreCliente),1)])):((0,l.wg)(),(0,l.iD)("button",f,[y,(0,l.Uk)(" Abrir modal cliente ")]))])]),_,(0,l._)("div",g,[d.cestaActiva.lista.length?((0,l.wg)(),(0,l.iD)("div",k,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.cestaActiva.lista,((a,e)=>((0,l.wg)(),(0,l.iD)("div",{class:"producto d-flex justify-content-between w-75",key:e},[(0,l._)("div",D,[(0,l._)("span",null,"- "+(0,o.zw)(a.nombre),1),(0,l._)("div",C,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.arraySuplementos,((a,e)=>((0,l.wg)(),(0,l.iD)("span",{class:"ms-3",key:e},(0,o.zw)(a.nombre),1)))),128))])]),(0,l._)("div",null,[(0,l._)("span",T,(0,o.zw)(a.unidades)+" unidad(es)",1)])])))),128))])):((0,l.wg)(),(0,l.iD)("div",w,(0,o.zw)(a.$t("toc_game_no_hay_productos","No hay ningún producto seleccionado")),1))]),(0,l._)("div",h,[(0,l._)("div",null,[N,(0,l._)("p",B,(0,o.zw)(d.precioTotal)+"€",1)]),(0,l._)("div",M,[x,1===d.tipoDatafono3G?((0,l.wg)(),(0,l.iD)("div",E,[(0,l._)("div",H,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"radio",id:"radioEfectivo",value:"EFECTIVO","onUpdate:modelValue":e[0]||(e[0]=a=>d.metodoPago=a)},null,512),[[n.G2,d.metodoPago]]),(0,l._)("label",V,[(0,l.Wm)($,{icon:"money-bill-wave",style:{color:"#28a745","margin-right":"4px"}}),(0,l.Uk)(" "+(0,o.zw)(a.$t("efectivo","Efectivo")),1)])]),(0,l._)("div",j,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"radio",id:"radioDatafono",value:"DATAFONO3G","onUpdate:modelValue":e[1]||(e[1]=a=>d.metodoPago=a)},null,512),[[n.G2,d.metodoPago]]),(0,l._)("label",z,[(0,l.Wm)($,{icon:"credit-card",style:{color:"#007bff","margin-right":"4px"}}),(0,l.Uk)(" "+(0,o.zw)(a.$t("datafono_3g","Datáfono 3G")),1)])])])):(0,l.kq)("",!0),(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"cuenta",name:"dejaACuenta",placeholder:"0",min:"0","onUpdate:modelValue":e[2]||(e[2]=a=>d.dejaACuenta=a),onClick:e[3]||(e[3]=(...a)=>d.openTecladoNum&&d.openTecladoNum(...a)),readonly:""},null,512),[[n.nr,d.dejaACuenta]])]),(0,l._)("div",A,[(0,l.Wm)(L,{color:"primary",onClick:e[4]||(e[4]=a=>d.crearDeuda()),disabled:d.loading,class:"btn btn-primary btn-lg mt-3"},{default:(0,l.w5)((()=>[d.loading?((0,l.wg)(),(0,l.iD)("span",W)):((0,l.wg)(),(0,l.iD)("p",F,"Crear deuda"))])),_:1},8,["disabled"])])])])])])])]),(0,l.Wm)(Q,{id:"modalTecladoNum",tabindex:"-1",labelledby:"modalTecladoNumLabel",modelValue:d.modalTecladoNum,"onUpdate:modelValue":e[8]||(e[8]=a=>d.modalTecladoNum=a),"data-backdrop":"false"},{default:(0,l.w5)((()=>[(0,l.Wm)(q,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,{id:"modalTecladoNumLabel"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a.$t("deja_a_cuenta","Deja a cuenta")),1)])),_:1})])),_:1}),(0,l.Wm)(K,null,{default:(0,l.w5)((()=>[(0,l._)("div",U,[(0,l._)("div",O,[(0,l._)("div",I,[d.numpadRef?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=a=>d.numpadRef.cantidad=a)},null,512)),[[n.nr,d.numpadRef.cantidad]]):(0,l.kq)("",!0)])])]),(0,l._)("div",P,[(0,l._)("div",Z,[(0,l.Wm)(J,{ref:"numpadRef"},null,512)])])])),_:1}),(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(L,{color:"danger",onClick:e[6]||(e[6]=a=>d.closeTecladoNum()),size:"lg"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Cerrar ")])),_:1}),(0,l.Wm)(L,{color:"success",size:"lg",onClick:e[7]||(e[7]=a=>d.finishTecladoNum())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a.$t("aceptar","Aceptar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}t(57658);var R=t(44870),$=t(74313),L=t(20065),Y=t(42492),q=t.n(Y),J=t(87853),K=t(91076),S=t(44918),Q=t(18827),X={name:"DeudasComponent",components:{MDBBtn:$.$v,MDBCard:$.Yl,MDBCardBody:$.H7,MDBCardTitle:$.QM,MDBCardText:$.Pp,MDBCheckbox:$.IH,MDBModal:$.j3,MDBModalHeader:$.ol,MDBModalTitle:$.wo,MDBModalBody:$.Yz,MDBModalFooter:$.ab,MDBIcon:$.vm,MDBLoading:$.J$,NumpadComponent:Q.Z},setup(){const a=(0,L.oR)(),{t:e}=(0,J.QT)(),t=(0,R.iH)(0),o=(0,l.Fl)((()=>a.state.Cestas.arrayCestas)),n=a.getters["Cestas/getCestaActiva"],d=(a.getters["Cestas/getCestaActivaIndex"],(0,l.Fl)((()=>a.state.Trabajadores.arrayTrabajadores))),c=(0,l.Fl)((()=>a.state.Trabajadores.indexActivo)),s=(0,l.Fl)((()=>d.value&&null!=c.value&&void 0!=c.value&&d.value[c.value]?d.value[c.value]:null)),u=(0,l.Fl)((()=>{if(o.value)for(let a=0;a<o.value.length;a++)if(o.value[a]._id==d.value[c.value].idCesta)return o.value[a];return null})),i=(0,l.Fl)((()=>a.state.Cestas.Descuento)),r=(0,R.iH)(null),p={idCliente:n.idCliente,nombreCliente:n.nombreCliente},m=(0,R.iH)(!1),b=(0,R.iH)(null),v=(0,R.iH)(null),f=(0,R.iH)(0),y=(0,R.iH)("EFECTIVO"),_=(0,R.iH)(0);function g(a){const e=a.detalleIva,t=Object.keys(e).filter((a=>a.startsWith("importe"))).reduce(((a,t)=>a+e[t]),0);return Math.round(100*t)/100}const k=async()=>{const a=g(u.value);if(a<f.value)q().fire("Oops...","La cantidad a cuenta no puede ser mayor que el total","error");else if(a!=f.value)try{const a=await K.Z.post("tickets/crearTicketDeuda",{total:g(u.value),idCesta:u.value._id,idTrabajador:s.value._id,tipo:"DEUDA",tkrsData:{cantidadTkrs:t.value,formaPago:"EFECTIVO"},dejaCuenta:f.value,concepto:"DEUDA",metodoPago:y.value});if(!a.data)throw Error("No se ha podido crear el ticket");C(e("toc_game_encargos_ok","Deuda creada!"),"success",D)}catch(l){q().fire("Oops...",l.message,"error")}finally{m.value=!1}else q().fire("Oops...","La cantidad a cuenta no puede ser igual al total","error")};const D=async()=>{a.dispatch("EstadoDinamico/reset"),N("/main")},C=(a,e,t=(()=>{}))=>{q().fire("error"===e?"Oops...":"Ok!!",a,e).then((()=>t()))},T=()=>{b.value=!0},w=()=>{b.value=!1},h=()=>{let a=Number(v.value.cantidad);f.value=Number(a.toFixed(2)),w()};(0,l.JJ)("okValue",(()=>b.value?h():T()));const N=a=>S.Z.push(a);return(0,l.bv)((async()=>{r.value=g(u.value);try{K.Z.post("parametros/getParametros").then((a=>{"3G"!==a.data?.tipoDatafono&&"0.0.0.0"!=a.data?.ipTefpay||(_.value=1)}))}catch(a){console.error("Error al obtener parámetros:",a)}})),{crearDeuda:k,cestaActiva:n,clienteData:p,precioTotal:r,cantidadTkrs:t,cesta:u,arrayCestas:o,getTotal:g,DescuentoCliente:i,loading:m,modalTecladoNum:b,numpadRef:v,openTecladoNum:T,closeTecladoNum:w,finishTecladoNum:h,dejaACuenta:f,metodoPago:y,tipoDatafono3G:_}}},aa=t(40089);const ea=(0,aa.Z)(X,[["render",G],["__scopeId","data-v-30f471f1"]]);var ta=ea}}]);
//# sourceMappingURL=705.eec8c7c2.js.map