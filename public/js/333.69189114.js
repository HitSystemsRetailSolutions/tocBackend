"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[333],{7767:function(e,a,t){t.d(a,{Z:function(){return b}});var o=t(3396);const l={class:"btn-group-vertical mt-1"},n={class:"btn-group"},s={class:"btn-group"},i={class:"btn-group"},r={class:"btn-group"},c={class:"btn-group"};function d(e,a,t,d,u,m){return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("div",n,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[0]||(a[0]=e=>d.addTecla("1"))}," 1 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[1]||(a[1]=e=>d.addTecla("2"))}," 2 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[2]||(a[2]=e=>d.addTecla("3"))}," 3 ")]),(0,o._)("div",s,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[3]||(a[3]=e=>d.addTecla("4"))}," 4 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[4]||(a[4]=e=>d.addTecla("5"))}," 5 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[5]||(a[5]=e=>d.addTecla("6"))}," 6 ")]),(0,o._)("div",i,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[6]||(a[6]=e=>d.addTecla("7"))}," 7 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[7]||(a[7]=e=>d.addTecla("8"))}," 8 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[8]||(a[8]=e=>d.addTecla("9"))}," 9 ")]),(0,o._)("div",r,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[9]||(a[9]=e=>d.deleteTecla())}," < "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[10]||(a[10]=e=>d.addTecla("0"))}," 0 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[11]||(a[11]=e=>d.okValue(Number(d.cantidad)))}," OK ")]),(0,o._)("div",c,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonComa",onClick:a[12]||(a[12]=e=>d.addTecla("."))}," , ")])])}var u=t(4870),m={name:"NumpadComponent",setup(e,{expose:a}){const t=(0,u.iH)("0"),l=(0,o.f3)("okValue"),n=(0,u.iH)("5.5rem"),s=(0,u.iH)("5.5rem");function i(e){"."===e&&(t.value=t.value.replace(".","")),t.value+=e,"0"==t.value[0]&&(t.value=t.value.slice(1))}function r(){t.value=t.value.slice(0,-1),""===t.value&&(t.value="0")}function c(e){t.value=e.toString()}return a({cantidad:t,setValor:c}),{okValue:l,cantidad:t,addTecla:i,deleteTecla:r,setValor:c,anchoTecla:n,altoTecla:s}}},p=t(89);const v=(0,p.Z)(m,[["render",d],["__scopeId","data-v-6bb950cc"]]);var b=v},9333:function(e,a,t){t.r(a),t.d(a,{default:function(){return Aa}});var o=t(3396);const l={class:"row mt-1"},n={class:"col-md-3"},s={class:"col-md-6"},i={class:"col-md-3"};function r(e,a,t,r,c,d){const u=(0,o.up)("MenusComponent"),m=(0,o.up)("SubmenusComponent"),p=(0,o.up)("TeclasComponent"),v=(0,o.up)("MenuIzquierdaComponent"),b=(0,o.up)("CestaComponent"),f=(0,o.up)("MenuDerechaComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(u),(0,o.Wm)(m),(0,o.Wm)(p,{ref:"refTeclasComponent"},null,512),(0,o._)("div",l,[(0,o._)("div",n,[(0,o.Wm)(v,{ref:"refMenuIzquierda"},null,512)]),(0,o._)("div",s,[(0,o.Wm)(b,{ref:"cestaRef"},null,512)]),(0,o._)("div",i,[(0,o.Wm)(f)])])],64)}t(7658);var c=t(7139);const d={class:"row",style:{"margin-top":"1px"}},u={class:"btn-group shadow-none",role:"group"},m=["onClick"];function p(e,a,t,l,n,s){return(0,o.wg)(),(0,o.iD)("div",d,[(0,o._)("div",u,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.teclado,((e,a)=>((0,o.wg)(),(0,o.iD)("button",{key:a,class:(0,c.C_)([{activo:a==l.indexMenuActivo},"btn btn-secondary border border-1 rounded botonesMenu menusColorIvan"]),onClick:e=>l.setActivo(a)},(0,c.zw)(e.nombre),11,m)))),128))])])}var v=t(65),b={name:"MenusComponent",setup(e,{expose:a}){const t=(0,v.oR)(),l=(0,o.Fl)((()=>t.state.Teclado.objTeclado)),n=(0,o.Fl)((()=>t.state.Teclado.indexMenuActivo));function s(e){t.dispatch("Teclado/setIndexMenuActivo",e)}return(0,o.bv)((()=>{s(0)})),a({indexMenuActivo:n}),{teclado:l,indexMenuActivo:n,setActivo:s}}},f=t(89);const C=(0,f.Z)(b,[["render",p],["__scopeId","data-v-5f21fe0c"]]);var y=C;const w={key:0,class:"row mt-1"},_=["onClick"];function g(e,a,t,l,n,s){return l.teclado&&l.teclado[l.indexMenuActivo]&&l.teclado[l.indexMenuActivo].arraySubmenus&&l.teclado[l.indexMenuActivo].arraySubmenus.length>0?((0,o.wg)(),(0,o.iD)("div",w,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.teclado[l.indexMenuActivo].arraySubmenus,((e,a)=>((0,o.wg)(),(0,o.iD)("div",{class:"col",style:{padding:"0px 6px 0px 1px"},key:a},[(0,o._)("button",{class:(0,c.C_)([{activo:a==l.indexSubmenuActivo},"btn btn-secondary border border-1 rounded botonesSubmenus menusColorIvan w-100"]),onClick:e=>l.setIndexSubmenu(a)},(0,c.zw)(e.nombre),11,_)])))),128))])):(0,o.kq)("",!0)}var k={name:"SubmenusComponent",setup(){const e=(0,v.oR)(),a=(0,o.Fl)((()=>e.state.Teclado.objTeclado)),t=(0,o.Fl)((()=>e.state.Teclado.indexMenuActivo)),l=(0,o.Fl)((()=>e.state.Teclado.indexSubmenuActivo));function n(a){e.dispatch("Teclado/setIndexSubmenuActivo",a)}return{teclado:a,indexMenuActivo:t,indexSubmenuActivo:l,setIndexSubmenu:n}}};const M=(0,f.Z)(k,[["render",g],["__scopeId","data-v-88124a2e"]]);var h=M;const B=["onClick"];function x(e,a,t,l,n,s){const i=(0,o.up)("PesoComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)(6,((e,a)=>((0,o.wg)(),(0,o.iD)(o.HY,{key:a},[l.arrayTeclas&&l.arrayTeclas.length>0?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,c.C_)(["row",{"mt-1":0==a}])},[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)(6,((e,t)=>(0,o._)("div",{class:(0,c.C_)(["col",[l.teclado[l.indexMenuActivo].arraySubmenus&&l.teclado[l.indexMenuActivo].arraySubmenus.length>0?"colJuntitasConSubmenus":"colJuntitas"]]),key:t},[l.arrayTeclas[t+6*a].idArticle?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:e=>l.clickTecla(l.arrayTeclas[t+6*a]),class:(0,c.C_)(["btn btn-primary w-100 d-inline-block esconderTexto",[l.teclado[l.indexMenuActivo].arraySubmenus&&l.teclado[l.indexMenuActivo].arraySubmenus.length>0?"teclasConSubmenu":"teclas"]]),style:(0,c.j5)({"background-color":"#"+l.arrayTeclas[t+6*a].color.toString(16),color:l.getTextColor("#"+l.arrayTeclas[t+6*a].color.toString(16))})},(0,c.zw)(l.arrayTeclas[t+6*a].nombreArticulo),15,B)):((0,o.wg)(),(0,o.iD)("button",{key:1,class:(0,c.C_)(["btn btn-primary w-100 invisible",[null==l.teclado[l.indexMenuActivo].arraySubmenus?"teclas":"teclasConSubmenu"]])}," VACÍO ",2))],2))),64))],2)):(0,o.kq)("",!0)],64)))),64)),(0,o.Wm)(i,{ref:"modalPesoRef"},null,512)],64)}var D=t(4870);const T={class:"row"},A={class:"row"};function W(e,a,t,l,n,s){const i=(0,o.up)("MDBModalTitle"),r=(0,o.up)("MDBModalHeader"),c=(0,o.up)("MDBInput"),d=(0,o.up)("NumpadComponent"),u=(0,o.up)("MDBModalBody"),m=(0,o.up)("MDBBtn"),p=(0,o.up)("MDBModalFooter"),v=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(v,{id:"modalPeso",tabindex:"-1",labelledby:"staticBackdropLabel",modelValue:l.modalPeso,"onUpdate:modelValue":a[2]||(a[2]=e=>l.modalPeso=e),staticBackdrop:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i,{id:"staticBackdropLabel"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Introduce los gramos ")])),_:1})])),_:1}),(0,o.Wm)(u,{class:"mx-auto"},{default:(0,o.w5)((()=>[(0,o._)("div",T,[l.numpadRef&&l.numpadRef.cantidad?((0,o.wg)(),(0,o.j4)(c,{key:0,modelValue:l.numpadRef.cantidad,"onUpdate:modelValue":a[0]||(a[0]=e=>l.numpadRef.cantidad=e)},null,8,["modelValue"])):(0,o.kq)("",!0)]),(0,o._)("div",A,[(0,o.Wm)(d,{ref:"numpadRef"},null,512)])])),_:1}),(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(m,{color:"danger",onClick:a[1]||(a[1]=e=>l.modalPeso=!1),size:"lg"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Cerrar ")])),_:1}),(0,o.Wm)(m,{color:"success",size:"lg"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Aceptar ")])),_:1})])),_:1})])),_:1},8,["modelValue"])}var j=t(4313),z=t(7767),N=t(70),U=t(2492),S=t.n(U),E={name:"PesoComponent",components:{MDBModal:j.j3,MDBModalHeader:j.ol,MDBModalTitle:j.wo,MDBModalBody:j.Yz,MDBModalFooter:j.ab,MDBBtn:j.$v,MDBInput:j.u2,NumpadComponent:z.Z},setup(e,{expose:a}){const t=(0,D.iH)(!1),l=(0,D.iH)(null),n=(0,D.iH)({idArticulo:null,idCesta:null});function s(e,a){n.value.idArticulo=e,n.value.idCesta=a,t.value=!0}function i(e){N.Z.post("teclado/clickTeclaArticulo",{idArticulo:n.value.idArticulo,gramos:e,idCesta:n.value.idCesta,unidades:1,arraySuplementos:null}).then((e=>{if(!e.data)throw Error("No se ha podido insertar el artículo a peso");n.value.idArticulo=null,n.value.idCesta=null,t.value=!1})).catch((e=>{S().fire("Oops...",e.message,"error")}))}function r(){console.log(45)}return a({abrirModal:s}),(0,o.JJ)("okValue",i),{modalPeso:t,numpadRef:l,infoArticulo:n,test:r}}};const I=(0,f.Z)(E,[["render",W]]);var H=I,V=t(2483),F={name:"TeclasComponent",components:{PesoComponent:H},setup(e,{expose:a}){const t=(0,v.oR)(),l=(0,V.tv)(),n=(0,o.Fl)((()=>t.state.Teclado.objTeclado)),s=(0,o.Fl)((()=>t.state.Teclado.indexMenuActivo)),i=(0,o.Fl)((()=>t.state.Cestas.arrayCestas)),r=(0,o.Fl)((()=>t.state.Trabajadores.arrayTrabajadores)),c=(0,o.Fl)((()=>t.state.Trabajadores.indexActivo)),d=(0,o.Fl)((()=>t.state.Teclado.indexSubmenuActivo)),u=(0,D.iH)(null),m=(0,o.Fl)((()=>t.state.Unidades.unidades)),p=(0,o.Fl)((()=>{if(i.value)for(let e=0;e<i.value.length;e++)if(i.value[e]._id==r.value[c.value].idCesta)return i.value[e];return null}));function b(){let e=[];for(let a=0;a<36;a++)e[a]={idArticle:null,nombreArticulo:null,pos:a,color:null,esSumable:null};return e}async function f(e){try{if(!p.value)throw Error("Es necesario una cesta activa para añadir un artículo");if(e.esSumable)if(t.getters["Configuracion/suplementosActivos"])console.log("COMPROBAR SI TIENE SUPLEMENTOS");else{const a=await N.Z.post("teclado/clickTeclaArticulo",{idArticulo:e.idArticle,gramos:0,idCesta:p.value._id,unidades:m.value,arraySuplementos:null});if(!a.data)throw Error("No se ha podido añadir el artículo a la cesta");t.dispatch("Unidades/setUnidades",1)}else u.value.abrirModal(e.idArticle,p.value._id)}catch(a){S().fire("Oops...",a.message,"error")}}const C=(0,o.Fl)((()=>{let e=b();if(n.value&&n.value[s.value]&&n.value[s.value].arraySubmenus&&n.value[s.value].arraySubmenus[d.value])for(let a=0;a<n.value[s.value].arraySubmenus[d.value].arrayTeclas.length;a++)e[n.value[s.value].arraySubmenus[d.value].arrayTeclas[a].pos]=n.value[s.value].arraySubmenus[d.value].arrayTeclas[a];else if(n.value&&n.value[s.value]&&n.value[s.value].arrayTeclas)for(let a=0;a<n.value[s.value].arrayTeclas.length;a++)e[n.value[s.value].arrayTeclas[a].pos]=n.value[s.value].arrayTeclas[a];return e}));function y(e){return parseInt(e,16)||e}function w(e){return y(e)/255<=.03928?y(e)/255/12.92:Math.pow((y(e)/255+.055)/1.055,2.4)}function _(e){return.2126*w(e.substr(1,2))+.7152*w(e.substr(3,2))+.0722*w(e.substr(-2))}function g(e,a){const t=_(e),o=_(a);return(Math.max(t,o)+.05)/(Math.min(t,o)+.05)}function k(e){const a=g(e,"#ffffff"),t=g(e,"#000000");return a>t?"#ffffff":"#000000"}function M(e){console.log(e)}return(0,o.JJ)("addItem",M),a({clickTecla:f}),(0,o.bv)((()=>{r.value&&0!==r.value?.length||l.push("menu/fichajes")})),{teclado:n,indexMenuActivo:s,arrayTeclas:C,getTextColor:k,modalPesoRef:u,clickTecla:f}}};const P=(0,f.Z)(F,[["render",x],["__scopeId","data-v-6893c154"]]);var q=P;const R={key:0,class:"table-responsive divCesta reverso"},O={class:"table colorFuente"},Z={class:"tableBody"},Y=["onClick"],J={class:"d-inline-block text-truncate",style:{"max-width":"21rem","min-width":"21rem"}},L={class:"xUnidades ms-2 d-inline"},G={key:1},K={key:0,class:"fw-bold"};function $(e,a,t,l,n,s){const i=(0,o.up)("MDBCardTitle"),r=(0,o.up)("MDBCardText"),d=(0,o.up)("MDBBtn"),u=(0,o.up)("MDBCardBody"),m=(0,o.up)("MDBCard");return l.cesta&&l.cesta.lista?((0,o.wg)(),(0,o.iD)("div",R,[(0,o._)("table",O,[(0,o._)("tbody",Z,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.cesta.lista,((e,a)=>((0,o.wg)(),(0,o.iD)("tr",{key:a,class:(0,c.C_)(["itemCesta",{estiloPromo:e.promocion,seleccionado:l.indexItemCestaActivo===a,sePuedeRegalar:l.sePuedeRegalar(e),regalado:e.regalo}]),onClick:e=>l.clickItem(a)},[(0,o._)("td",null,[(0,o._)("span",J,(0,c.zw)(e.nombre),1),(0,o._)("span",L," x"+(0,c.zw)(e.unidades),1)]),(0,o._)("td",null,(0,c.zw)(e.subtotal.toFixed(2))+" €",1)],10,Y)))),128))])])])):((0,o.wg)(),(0,o.iD)("div",G,[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o.Uk)("Cesta no inicializada")])),_:1}),(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" En este momento no hay ninguna cesta seleccionada para "),l.arrayTrabajadores&&l.arrayTrabajadores[l.indexTrabajadorActivo]?((0,o.wg)(),(0,o.iD)("span",K,(0,c.zw)(l.arrayTrabajadores[l.indexTrabajadorActivo].nombre),1)):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(d,{color:"primary",onClick:a[0]||(a[0]=e=>l.inicializarCesta())},{default:(0,o.w5)((()=>[(0,o.Uk)("Crear nueva cesta")])),_:1})])),_:1})])),_:1})]))}var Q={name:"CestaComponent",components:{MDBCard:j.Yl,MDBCardBody:j.H7,MDBCardTitle:j.QM,MDBCardText:j.Pp,MDBBtn:j.$v},setup(e,{expose:a}){const t=(0,v.oR)(),l=(0,o.Fl)((()=>t.state.Cestas.arrayCestas)),n=(0,o.Fl)((()=>t.state.Cestas.indexItemActivo)),s=(0,o.Fl)((()=>t.state.Trabajadores.arrayTrabajadores)),i=(0,o.Fl)((()=>t.state.Trabajadores.indexActivo)),r=(0,o.Fl)((()=>{if(l.value)for(let e=0;e<l.value.length;e++)if(s.value&&s.value[i.value]&&l.value[e]._id==s.value[i.value].idCesta)return l.value[e];return null})),c=(0,D.iH)(0);function d(){r.value?.idCliente?N.Z.post("clientes/consultarPuntos",{idCliente:r.value?.idCliente}).then((e=>{"number"===typeof e.data?c.value=e.data:c.value=0})).catch((e=>{S().fire("Oops...",e.message,"error"),c.value=0})):c.value=0}function u(){s.value&&void 0!=i.value&&null!=i.value&&s.value[i.value]?N.Z.post("cestas/crearCesta",{idTrabajador:s.value[i.value]._id}).then((e=>{if(!e.data)throw Error("No se ha podido inicializar la nueva cesta")})).catch((e=>{S().fire("Oops...",e.message,"error")})):s.value&&void 0!=i.value&&null!=i.value?S().fire("Oops...","Error desconocido #123","error"):S().fire("Oops...","Error, no hay trabajador activo. Es necesario fichar antes de realizar esta acción","error")}function m(e){return Math.trunc(.03*e*.02)}function p(e){const a=[8641,8654,8640,8675,99,315,314,312,5603];if(null==r.value.idCliente||void 0==r.value.idCliente||""==r.value.idCliente)return!1;for(let t=0;t<a.length;t++)if(a[t]===e.idArticulo&&m(c.value)>=e.subtotal&&!e.regalo)return!0;return!1}function b(e){N.Z.post("cestas/regalarProducto",{idCesta:r.value._id,indexLista:e}).then((e=>{e.data?S().fire({icon:"success",title:"¡Regalo aplicado!",showConfirmButton:!1,timer:1500}):S().fire("Oops...","No se ha podido regalar el producto","error")}))}function f(e){p(r.value.lista[e])?S().fire({title:"¿Regalar este artículo?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Sí, regalar",denyButtonText:"No",icon:"question",customClass:{actions:"my-actions",cancelButton:"order-1 right-gap",confirmButton:"order-2",denyButton:"order-3"}}).then((a=>{a.isConfirmed?b(e):a.isDenied&&t.dispatch("Cestas/setActivoAction",e)})):t.dispatch("Cestas/setActivoAction",e)}return a({actualizarPuntos:d}),(0,o.bv)((()=>{d()})),{cesta:r,arrayTrabajadores:s,indexTrabajadorActivo:i,indexItemCestaActivo:n,clickItem:f,inicializarCesta:u,sePuedeRegalar:p,puntos:c}}};const X=(0,f.Z)(Q,[["render",$],["__scopeId","data-v-12e3ff44"]]);var ee=X;const ae={class:"modoVenta d-block text-center"},te={key:0,class:"d-block textoNombreCliente text-center"},oe={class:"text-truncate",style:{"max-width":"10rem"}},le={key:1,class:"d-block text-center textoNombreCliente"};function ne(e,a,t,l,n,s){const i=(0,o.up)("MDBBtn"),r=(0,o.up)("MDBIcon"),d=(0,o.up)("MDBBtnGroup"),u=(0,o.up)("ModalClientesComponent"),m=(0,o.up)("ModalArticulosComponent"),p=(0,o.up)("ModalUnidadesComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[l.vistaEspecial&&l.cesta?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,c.C_)(["divInfoModo mb-2",{fondoDevolucion:"DEVOLUCION"==l.cesta.modo,fondoCliente:l.cesta.idCliente}])},[(0,o._)("div",null,[(0,o._)("span",ae,(0,c.zw)(l.cesta.modo),1),l.cesta.idCliente?((0,o.wg)(),(0,o.iD)("div",te,[(0,o._)("span",oe,(0,c.zw)(l.cesta.nombreCliente),1),(0,o.Wm)(i,{onClick:a[0]||(a[0]=e=>l.consultarPuntos(l.cesta.idCliente)),class:"d-block mx-auto w-100",size:"lg",color:"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)("Consultar puntos")])),_:1})])):((0,o.wg)(),(0,o.iD)("span",le,"Sin cliente asignado"))])],2)):(0,o.kq)("",!0),l.vistaEspecial?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(d,{key:1,class:"shadow-0"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{outline:"secondary",class:"botones",onClick:a[1]||(a[1]=e=>l.goTo("/menu/caja/tickets"))},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"bars",size:"4x"})])),_:1}),(0,o.Wm)(i,{onClick:a[2]||(a[2]=e=>l.refModalArticulos.abrirModal()),outline:"secondary",class:"botones ms-1"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"search",size:"4x"})])),_:1}),(0,o.Wm)(i,{outline:"secondary",class:"botones ms-1",onClick:a[3]||(a[3]=e=>l.refModalClientes.abrirModal())},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"users",size:"4x"})])),_:1})])),_:1})),l.vistaEspecial?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(d,{key:2,class:"shadow-0 mt-1"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{outline:"secondary",class:"botones"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"print",size:"4x"})])),_:1}),(0,o.Wm)(i,{onClick:a[4]||(a[4]=e=>l.refModalUnidades.abrirModal()),outline:"secondary",class:"botones ms-1"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"calculator",size:"4x"})])),_:1}),(0,o.Wm)(i,{onClick:a[5]||(a[5]=e=>l.goTo("/cestas")),outline:"secondary",class:"botones ms-1"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"shopping-cart",size:"4x"})])),_:1})])),_:1})),(0,o.Wm)(d,{class:"shadow-0 mt-1"},{default:(0,o.w5)((()=>[void 0==l.indexActivoCesta||null==l.indexActivoCesta?((0,o.wg)(),(0,o.j4)(i,{key:0,outline:"secondary",class:"botones",onClick:a[6]||(a[6]=e=>l.borrarLista())},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"trash",size:"4x"})])),_:1})):((0,o.wg)(),(0,o.j4)(i,{key:1,outline:"secondary",class:"botones",onClick:a[7]||(a[7]=e=>l.borrarItem())},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"times",size:"4x"})])),_:1})),(0,o.Wm)(i,{onClick:a[8]||(a[8]=e=>l.resetGeneral()),outline:"secondary",class:"botones ms-1"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"undo",size:"4x"})])),_:1}),(0,o.Wm)(i,{outline:"secondary",onClick:a[9]||(a[9]=e=>l.changeVistaCliente()),class:"botones ms-1"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"star",size:"4x"})])),_:1})])),_:1}),(0,o.Wm)(u,{ref:"refModalClientes"},null,512),(0,o.Wm)(m,{ref:"refModalArticulos"},null,512),(0,o.Wm)(p,{ref:"refModalUnidades"},null,512)],64)}var se=t(9351),ie=t(9242);const re=e=>((0,o.dD)("data-v-109548fe"),e=e(),(0,o.Cn)(),e),ce={class:"row"},de={class:"d-inline-block text-center"},ue={class:"row mt-1 p-4"},me={class:"col-md-8"},pe={class:"col-md-4"},ve={key:0,class:"row"},be={class:"col"},fe={class:"table-responsive w-100",style:{height:"400px"}},Ce={class:"table table-striped mt-1"},ye={class:"textoNombre d-inline-block text-truncate"},we={key:1,class:"row"},_e=re((()=>(0,o._)("div",{class:"sinResultados position-relative"},[(0,o._)("span",{class:"textoSinResultados position-absolute top-50 start-50 translate-middle"},"Sin resultados")],-1))),ge=[_e];function ke(e,a,t,l,n,s){const i=(0,o.up)("MDBBtn"),r=(0,o.up)("MDBModalBody"),d=(0,o.up)("MDBModal"),u=(0,o.up)("ModalNuevoCliente");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(d,{id:"modalClientes",tabindex:"-1",labelledby:"tituloModalClientes",modelValue:l.modalClientes,"onUpdate:modelValue":a[7]||(a[7]=e=>l.modalClientes=e),staticBackdrop:"",size:"xl"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o._)("div",ce,[(0,o._)("div",de,[(0,o.Wm)(i,{color:"warning",class:"sizeBotones",onClick:a[0]||(a[0]=e=>l.clickClienteAtajo("CliBoti_000_{A83B364B-252F-464B-B0C3-AA89DA258F64}"))},{default:(0,o.w5)((()=>[(0,o.Uk)("Glovo")])),_:1}),(0,o.Wm)(i,{color:"dark",class:"ms-2 sizeBotones",onClick:a[1]||(a[1]=e=>l.clickClienteAtajo("CliBoti_000_{2713C1E3-06C0-4099-851D-33018FD4851C}"))},{default:(0,o.w5)((()=>[(0,o.Uk)("Uber")])),_:1}),(0,o.Wm)(i,{color:"primary",class:"ms-2 sizeBotones",onClick:a[2]||(a[2]=e=>l.clickClienteAtajo("CliBoti_000_{7A6EA7B0-3229-4A94-81EA-232F4666A7BE}"))},{default:(0,o.w5)((()=>[(0,o.Uk)("To Go")])),_:1}),(0,o.Wm)(i,{color:"success",class:"ms-2 sizeBotones",onClick:a[3]||(a[3]=e=>l.modalNuevoClienteRef.abrirModal())},{default:(0,o.w5)((()=>[(0,o.Uk)("Nuevo")])),_:1}),(0,o.Wm)(i,{color:"danger",class:"ms-2 sizeBotones",onClick:a[4]||(a[4]=e=>l.modalClientes=!1)},{default:(0,o.w5)((()=>[(0,o.Uk)("Salir")])),_:1})])]),(0,o._)("div",ue,[(0,o._)("div",me,[(0,o.wy)((0,o._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:"Buscar por nombre","aria-label":".form-control-lg example","onUpdate:modelValue":a[5]||(a[5]=e=>l.inputBusqueda=e)},null,512),[[ie.nr,l.inputBusqueda]])]),(0,o._)("div",pe,[(0,o.Wm)(i,{color:"secondary",class:"botonBusqueda w-100",onClick:a[6]||(a[6]=e=>l.buscar())},{default:(0,o.w5)((()=>[(0,o.Uk)("Buscar")])),_:1})])]),l.arrayClientes?.length>0?((0,o.wg)(),(0,o.iD)("div",ve,[(0,o._)("div",be,[(0,o._)("div",fe,[(0,o._)("table",Ce,[(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.arrayClientes,((e,a)=>((0,o.wg)(),(0,o.iD)("tr",{key:a},[(0,o._)("td",null,[(0,o._)("span",ye,(0,c.zw)(e.nombre),1)]),(0,o._)("td",null,[(0,o.Wm)(i,{color:"primary",size:"lg",onClick:a=>l.selectCliente(e.id,e.nombre),class:"w-100",style:{height:"3.85rem","font-size":"1.5rem"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Seleccionar")])),_:2},1032,["onClick"])])])))),128))])])])])])):((0,o.wg)(),(0,o.iD)("div",we,ge))])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(u,{ref:"modalNuevoClienteRef"},null,512)],64)}const Me={class:"row mt-1 p-4"},he={class:"col-md-8"},Be={class:"col-md-4"},xe={class:"row p-4"},De={class:"col-md-8"},Te={class:"col-md-4 sizeModalClientes"},Ae={class:"row"},We={class:"d-inline-block text-end"};function je(e,a,t,l,n,s){const i=(0,o.up)("MDBBtn"),r=(0,o.up)("MDBModalBody"),c=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(c,{id:"modalNuevoCliente",tabindex:"-1",labelledby:"tituloModalClientes",modelValue:l.modalNuevoCliente,"onUpdate:modelValue":a[4]||(a[4]=e=>l.modalNuevoCliente=e),staticBackdrop:"",size:"xl"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o._)("div",Me,[(0,o._)("div",he,[(0,o.wy)((0,o._)("input",{class:"form-control inputNombreCliente w-100",type:"text",placeholder:"Nombre del cliente","aria-label":".form-control-lg example","onUpdate:modelValue":a[0]||(a[0]=e=>l.inputNombreCliente=e)},null,512),[[ie.nr,l.inputNombreCliente]])]),(0,o._)("div",Be,[(0,o.Wm)(i,{color:"secondary",class:"botonBusqueda w-100",disabled:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Nombre")])),_:1})])]),(0,o._)("div",xe,[(0,o._)("div",De,[(0,o.wy)((0,o._)("input",{class:"form-control inputNombreCliente w-100",type:"text",placeholder:"Código tarjeta","aria-label":".form-control-lg example","onUpdate:modelValue":a[1]||(a[1]=e=>l.inputCodigoTarjeta=e)},null,512),[[ie.nr,l.inputCodigoTarjeta]])]),(0,o._)("div",Te,[(0,o.Wm)(i,{color:"secondary",class:"botonBusqueda w-100",disabled:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Cód. tarjeta")])),_:1})])]),(0,o._)("div",Ae,[(0,o._)("div",We,[(0,o.Wm)(i,{color:"primary",class:"ms-2 sizeBotones",onClick:a[2]||(a[2]=e=>l.crearCliente())},{default:(0,o.w5)((()=>[(0,o.Uk)("Crear")])),_:1}),(0,o.Wm)(i,{color:"danger",class:"ms-2 sizeBotones",onClick:a[3]||(a[3]=e=>l.modalNuevoCliente=!1)},{default:(0,o.w5)((()=>[(0,o.Uk)("Atrás")])),_:1})])])])),_:1})])),_:1},8,["modelValue"])}var ze={name:"ModalNuevoClienteComponent",components:{MDBModal:j.j3,MDBModalBody:j.Yz,MDBBtn:j.$v},setup(e,a){const t=(0,D.iH)(!1),o=(0,D.iH)(""),l=(0,D.iH)("");function n(){t.value=!0}function s(){N.Z.post("clientes/crearNuevoCliente",{idTarjetaCliente:l.value,nombreCliente:o.value}).then((e=>{if(!e.data)throw Error("No se ha podido crear el cliente. backend");S().fire({icon:"success",title:"Cliente creado correctamente",showConfirmButton:!1,timer:2e3}),t.value=!1})).catch((e=>{S().fire("Oops...",e.message,"error")}))}return a.expose({abrirModal:n}),{inputCodigoTarjeta:l,modalNuevoCliente:t,inputNombreCliente:o,crearCliente:s}}};const Ne=(0,f.Z)(ze,[["render",je],["__scopeId","data-v-267c0da2"]]);var Ue=Ne,Se={name:"ModalClientesComponent",components:{MDBModal:j.j3,MDBModalBody:j.Yz,MDBBtn:j.$v,ModalNuevoCliente:Ue},setup(e,a){const t=(0,v.oR)(),l=(0,D.iH)(!1),n=(0,D.iH)(0),s=(0,D.iH)(""),i=(0,D.iH)(),r=(0,D.iH)(null),c=(0,o.f3)("actualizarPuntos"),d=(0,o.Fl)((()=>t.state.Trabajadores.arrayTrabajadores)),u=(0,o.Fl)((()=>t.state.Trabajadores.indexActivo)),m=(0,o.Fl)((()=>d.value&&void 0!=u.value&&null!=u.value&&d.value[u.value]?d.value[u.value]:null)),p=(0,o.Fl)((()=>t.state.Cestas.arrayCestas));function b(){l.value=!0}function f(){n.value++}function C(e){N.Z.post("clientes/getClienteById",{idCliente:e}).then((a=>{if(!a.data)throw Error("No se ha podido obtener la información del cliente. backend");y(e,a.data.nombre)})).catch((e=>{S().fire("Oops...",e.message,"error")}))}function y(e,a){if(p.value)for(let o=0;o<p.value.length;o++)if(m.value.idCesta===p.value[o]._id){t.dispatch("Cestas/setClienteCesta",{index:o,idCliente:e,nombreCliente:a}),t.dispatch("EstadoDinamico/setVistaCliente",!0),c(),l.value=!1;break}}function w(){N.Z.post("clientes/buscar",{busqueda:s.value}).then((e=>{i.value=e.data})).catch((e=>{S().fire("Oops...",e.message,"error")}))}return(0,o.YP)(s,(()=>{w()})),a.expose({abrirModal:b,datoBorrar:n}),{test:f,datoBorrar:n,modalClientes:l,inputBusqueda:s,arrayClientes:i,selectCliente:y,buscar:w,modalNuevoClienteRef:r,clickClienteAtajo:C}}};const Ee=(0,f.Z)(Se,[["render",ke],["__scopeId","data-v-109548fe"]]);var Ie=Ee;const He=e=>((0,o.dD)("data-v-2b57f362"),e=e(),(0,o.Cn)(),e),Ve={class:"row mt-1 p-4"},Fe={class:"col-md-8"},Pe={class:"col-md-4"},qe={key:0,class:"row"},Re={class:"col"},Oe={class:"table-responsive w-100",style:{height:"400px"}},Ze={class:"table table-striped mt-1"},Ye={class:"textoNombre d-inline-block text-truncate"},Je={key:1,class:"row"},Le=He((()=>(0,o._)("div",{class:"sinResultados position-relative"},[(0,o._)("span",{class:"textoSinResultados position-absolute top-50 start-50 translate-middle"},"Sin resultados")],-1))),Ge=[Le];function Ke(e,a,t,l,n,s){const i=(0,o.up)("MDBBtn"),r=(0,o.up)("MDBModalBody"),d=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(d,{id:"modalArticulos",tabindex:"-1",labelledby:"tituloModalArticulos",modelValue:l.modalArticulos,"onUpdate:modelValue":a[2]||(a[2]=e=>l.modalArticulos=e),size:"xl"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o._)("div",Ve,[(0,o._)("div",Fe,[(0,o.wy)((0,o._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:"Buscar por nombre de artículo","aria-label":".form-control-lg example","onUpdate:modelValue":a[0]||(a[0]=e=>l.inputBusqueda=e)},null,512),[[ie.nr,l.inputBusqueda]])]),(0,o._)("div",Pe,[(0,o.Wm)(i,{color:"secondary",class:"botonBusqueda w-100",onClick:a[1]||(a[1]=e=>l.buscar())},{default:(0,o.w5)((()=>[(0,o.Uk)("Buscar")])),_:1})])]),l.arrayArticulos?.length>0?((0,o.wg)(),(0,o.iD)("div",qe,[(0,o._)("div",Re,[(0,o._)("div",Oe,[(0,o._)("table",Ze,[(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.arrayArticulos,((e,a)=>((0,o.wg)(),(0,o.iD)("tr",{key:a},[(0,o._)("td",null,[(0,o._)("span",Ye,(0,c.zw)(e.nombre),1)]),(0,o._)("td",null,[(0,o.Wm)(i,{color:"primary",size:"lg",onClick:a=>l.selectArticulo({idArticle:e._id,esSumable:e.esSumable}),class:"w-100",style:{height:"3.85rem","font-size":"1.5rem"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Seleccionar")])),_:2},1032,["onClick"])])])))),128))])])])])])):((0,o.wg)(),(0,o.iD)("div",Je,Ge))])),_:1})])),_:1},8,["modelValue"])}var $e={name:"ModalArticulosComponent",components:{MDBModal:j.j3,MDBModalBody:j.Yz,MDBBtn:j.$v},setup(e,a){const t=(0,D.iH)(!1),l=(0,D.iH)(0),n=(0,D.iH)(""),s=(0,D.iH)(),i=(0,o.f3)("clickTecla");function r(e){i(e),t.value=!1}function c(){t.value=!0}function d(){l.value++}function u(){N.Z.post("articulos/buscar",{busqueda:n.value}).then((e=>{s.value=e.data})).catch((e=>{S().fire("Oops...",e.message,"error")}))}return(0,o.YP)(n,(()=>{u()})),a.expose({abrirModal:c,datoBorrar:l}),{test:d,datoBorrar:l,modalArticulos:t,inputBusqueda:n,arrayArticulos:s,buscar:u,selectArticulo:r}}};const Qe=(0,f.Z)($e,[["render",Ke],["__scopeId","data-v-2b57f362"]]);var Xe=Qe;const ea={class:"row"},aa={class:"row"},ta={class:"text-center"};function oa(e,a,t,l,n,s){const i=(0,o.up)("MDBModalTitle"),r=(0,o.up)("MDBModalHeader"),c=(0,o.up)("NumpadComponent"),d=(0,o.up)("MDBModalBody"),u=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(u,{id:"modalUnidades",tabindex:"-1",labelledby:"modalUnidadesLabel",modelValue:l.modalUnidades,"onUpdate:modelValue":a[1]||(a[1]=e=>l.modalUnidades=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i,{id:"modalUnidadesLabel"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Introduce las unidades y marca un artículo ")])),_:1})])),_:1}),(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o._)("div",ea,[l.refUnidadesComponent?(0,o.wy)(((0,o.wg)(),(0,o.iD)("input",{key:0,type:"text",class:"form-control sizeUnidades",disabled:"","onUpdate:modelValue":a[0]||(a[0]=e=>l.refUnidadesComponent.cantidad=e)},null,512)),[[ie.nr,l.refUnidadesComponent.cantidad]]):(0,o.kq)("",!0)]),(0,o._)("div",aa,[(0,o._)("div",ta,[(0,o.Wm)(c,{ref:"refUnidadesComponent"},null,512)])])])),_:1})])),_:1},8,["modelValue"])}var la={name:"UnidadesComponent",components:{NumpadComponent:z.Z,MDBModal:j.j3,MDBModalBody:j.Yz,MDBModalHeader:j.ol,MDBModalTitle:j.wo},setup(){const e=(0,D.iH)(null),a=(0,D.iH)(null),t=(0,v.oR)();function l(){a.value=!0}function n(e){t.dispatch("Unidades/setUnidades",e),a.value=!1}return(0,o.JJ)("okValue",n),{refUnidadesComponent:e,modalUnidades:a,abrirModal:l}}};const na=(0,f.Z)(la,[["render",oa],["__scopeId","data-v-27c1c7b7"]]);var sa=na,ia={name:"MenuIzquierdaComponent",components:{MDBBtnGroup:j.Ff,MDBBtn:j.$v,MDBIcon:j.vm,ModalClientesComponent:Ie,ModalArticulosComponent:Xe,ModalUnidadesComponent:sa},setup(e,{expose:a}){const t=(0,v.oR)(),l=(0,D.iH)(null),n=(0,D.iH)(null),s=(0,D.iH)(null),i=(0,o.Fl)((()=>t.state.EstadoDinamico.vistaEspecial)),r=(0,o.Fl)((()=>t.state.Cestas.arrayCestas)),c=(0,o.Fl)((()=>t.state.Trabajadores.arrayTrabajadores)),d=(0,o.Fl)((()=>t.state.Cestas.indexItemActivo)),u=(0,o.Fl)((()=>t.state.Trabajadores.indexActivo)),m=(0,o.Fl)((()=>{if(r.value)for(let e=0;e<r.value.length;e++)if(c.value&&c.value[u.value]&&r.value[e]._id==c.value[u.value].idCesta)return r.value[e];return null}));function p(){null!=d.value&&void 0!=d.value&&m.value&&t.dispatch("Cestas/deleteIndex",{index:d.value,idCesta:m.value._id})}function b(){m.value&&t.dispatch("Cestas/deleteLista",m.value._id)}function f(){i.value?t.dispatch("EstadoDinamico/setVistaCliente",!1):t.dispatch("EstadoDinamico/setVistaCliente",!0)}function C(e){se.Z.push(e)}function y(e){N.Z.post("clientes/consultarPuntos",{idCliente:e}).then((e=>{if("number"!==typeof e.data)throw Error("No se ha podido obtener la información del cliente");S().fire(`Puntos: ${e.data}`,"","info")})).catch((e=>{S().fire("Oops...",e.message,"error")}))}async function w(){if(r.value&&m.value)for(let e=0;e<r.value.length;e++)if(r.value[e]._id===m.value._id){t.dispatch("Unidades/setUnidades",1),await t.dispatch("Cestas/setModoCesta",{index:e,modo:"VENTA"}),t.dispatch("Cestas/setClienteCesta",{index:e,idCliente:null,nombreCliente:null}),t.dispatch("EstadoDinamico/reset");break}}return a({resetGeneral:w}),(0,o.bv)((()=>{m.value&&(m.value.idCliente||"VENTA"!=m.value.modo)&&t.dispatch("EstadoDinamico/setVistaCliente",!0)})),{indexActivoCesta:d,borrarItem:p,borrarLista:b,vistaEspecial:i,changeVistaCliente:f,cesta:m,goTo:C,refModalClientes:l,refModalArticulos:n,refModalUnidades:s,resetGeneral:w,consultarPuntos:y}}};const ra=(0,f.Z)(ia,[["render",ne],["__scopeId","data-v-82789f42"]]);var ca=ra;const da=e=>((0,o.dD)("data-v-6a05eadc"),e=e(),(0,o.Cn)(),e),ua={class:"row"},ma={key:0,class:"nombreTrabajador text-center d-inline-block text-truncate"},pa={key:1,class:"nombreMesa d-inline-block text-truncate"},va={class:"row"},ba=da((()=>(0,o._)("span",{class:"disponible"},"Datáfono disponible",-1))),fa=da((()=>(0,o._)("span",{class:"again"},"Reintentar pago",-1))),Ca={key:2,src:"pay-loading.svg",alt:"Procesando pago",width:"200",height:"60"},ya={key:3,class:"d-inline text-center caritasContentas grupoContento pt-1"},wa={key:4,class:"d-inline text-center caritasTristes grupoTriste pt-1"},_a={class:"row mt-1"},ga={class:"letraTotal ms-3 mt-2"},ka=da((()=>(0,o._)("span",{class:"text-end fst-italic informacion"},"Tienda (t-000) Empresa (Tena) Versión (4.0)",-1)));function Ma(e,a,t,l,n,s){const i=(0,o.up)("MDBBtn"),r=(0,o.up)("MDBIcon");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",ua,[l.trabajadorActivo?((0,o.wg)(),(0,o.iD)("span",ma,(0,c.zw)(l.trabajadorActivo.nombreCorto),1)):(0,o.kq)("",!0),l.cesta&&l.cesta.indexMesa&&l.arrayMesas&&l.arrayMesas[l.cesta.indexMesa]?((0,o.wg)(),(0,o.iD)("span",pa,"Mesa "+(0,c.zw)(l.arrayMesas[l.cesta.indexMesa].nombre),1)):(0,o.kq)("",!0)]),(0,o._)("div",va,[""===l.estadoDatafono?((0,o.wg)(),(0,o.j4)(i,{key:0,outline:"primary",class:"botonEstado"},{default:(0,o.w5)((()=>[ba])),_:1})):(0,o.kq)("",!0),"AGAIN"===l.estadoDatafono?((0,o.wg)(),(0,o.j4)(i,{key:1,outline:"warning",class:"botonEstado",onClick:a[0]||(a[0]=e=>l.tarjetaUltimoTicket())},{default:(0,o.w5)((()=>[fa])),_:1})):(0,o.kq)("",!0),"PENDIENTE"===l.estadoDatafono?((0,o.wg)(),(0,o.iD)("img",Ca)):(0,o.kq)("",!0),"APROBADA"===l.estadoDatafono?((0,o.wg)(),(0,o.iD)("div",ya,[(0,o.Wm)(r,{class:"d-inline",icon:"grin-alt",iconStyle:"far",size:"3x"}),(0,o.Wm)(r,{class:"d-inline ms-2",icon:"grin-alt",iconStyle:"far",size:"3x"}),(0,o.Wm)(r,{class:"d-inline ms-2",icon:"grin-alt",iconStyle:"far",size:"3x"}),(0,o.Wm)(r,{class:"d-inline ms-2",icon:"grin-alt",iconStyle:"far",size:"3x"})])):(0,o.kq)("",!0),"DENEGADA"===l.estadoDatafono?((0,o.wg)(),(0,o.iD)("div",wa,[(0,o.Wm)(r,{class:"d-inline",icon:"frown",iconStyle:"far",size:"3x"}),(0,o.Wm)(r,{class:"d-inline ms-2",icon:"frown",iconStyle:"far",size:"3x"}),(0,o.Wm)(r,{class:"d-inline ms-2",icon:"frown",iconStyle:"far",size:"3x"}),(0,o.Wm)(r,{class:"d-inline ms-2",icon:"frown",iconStyle:"far",size:"3x"})])):(0,o.kq)("",!0)]),(0,o._)("div",_a,[l.cesta&&l.getTotal(l.cesta)>0?((0,o.wg)(),(0,o.j4)(i,{key:0,outline:"primary",class:"botonPagar",onClick:a[1]||(a[1]=e=>l.handleCobro())},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"hand-holding-usd",size:"5x"}),(0,o._)("span",ga,(0,c.zw)(l.getTotal(l.cesta).toFixed(2))+" € ",1)])),_:1})):(0,o.kq)("",!0),l.cesta&&0===l.getTotal(l.cesta)?((0,o.wg)(),(0,o.j4)(i,{key:1,outline:"primary",class:"botonPagar",onClick:a[2]||(a[2]=e=>l.abrirCajon())},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"hand-holding-usd",size:"5x"})])),_:1})):(0,o.kq)("",!0),ka])],64)}var ha={name:"MenuDerechaComponent",components:{MDBIcon:j.vm,MDBBtn:j.$v},setup(){const e=(0,v.oR)(),a=(0,V.tv)(),t=(0,D.iH)([]),l=(0,o.f3)("resetGeneral"),n=(0,o.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),s=(0,o.Fl)((()=>e.state.Cestas.arrayCestas)),i=(0,o.Fl)((()=>e.state.Trabajadores.indexActivo)),r=(0,o.Fl)((()=>e.state.Datafono.estado)),c=(0,o.Fl)((()=>n.value&&void 0!=i.value&&null!=i.value&&n.value[i.value]?n.value[i.value]:null)),d=(0,o.Fl)((()=>{if(s.value)for(let e=0;e<s.value.length;e++)if(n.value&&n.value[i.value]&&s.value[e]._id==n.value[i.value].idCesta)return s.value[e];return null}));function u(e){return e.detalleIva.importe1+e.detalleIva.importe2+e.detalleIva.importe3}function m(){N.Z.get("mesas/getMesas").then((e=>{if(!e.data||50!==e.data.length)throw Error("Error al obtener la configuración de mesas");t.value=e.data})).catch((e=>{S().fire("Oops...",e.message,"error")}))}function p(e){a.push(e)}function b(){S().fire("en construcción","cosa en construcción","info")}function f(){N.Z.post("paytef/cobrarUltimoTicket",{idTrabajador:c.value._id}).then((()=>{e.dispatch("Datafono/setEstado","PENDIENTE")})).catch((e=>{S().fire("Oops...",e.message,"error")}))}async function C(){if(d.value)if("VENTA"===d.value.modo)if(d.value.idCliente&&""!=d.value.idCliente){const e=(await N.Z.post("clientes/getClienteById",{idCliente:d.value.idCliente})).data;!0===e?.albaran&&!0===e?.noPagaEnTienda?N.Z.post("tickets/crearTicket",{total:u(d.value),idCesta:d.value._id,idTrabajador:c.value._id,tipo:"DEUDA",tkrsData:null}).then((e=>{if(!e.data)throw Error("No se ha podido registrar la venta en modo deuda");S().fire({icon:"success",title:"Venta modo deuda registrada correctamente",showConfirmButton:!1,timer:2e3})})).catch((e=>{S().fire("Oops...",e.message,"error")})):p("/cobro")}else p("/cobro");else"DEVOLUCION"===d.value.modo?N.Z.post("devoluciones/nuevaDevolucion",{total:u(d.value),idCesta:d.value._id,idTrabajador:c.value._id}).then((e=>{if(!e.data)throw Error("No se ha podido crear la devolución");l(),S().fire({icon:"success",title:"Devolución creada correctamente",showConfirmButton:!1,timer:2e3})})).catch((e=>{S().fire("Oops...",e.message,"error")})):"CONSUMO_PERSONAL"===d.value.modo&&N.Z.post("tickets/crearTicket",{total:u(d.value),idCesta:d.value._id,idTrabajador:c.value._id,tipo:"CONSUMO_PERSONAL"}).then((e=>{if(!e.data)throw Error("No se ha podido crear el ticket de consumo personal");l(),S().fire({icon:"success",title:"Consumo personal registrado",showConfirmButton:!1,timer:1200})})).catch((e=>{S().fire("Oops...",e.message,"error")}));else S().fire("Oops...","El modo de la cesta es incorrecto","error")}return(0,o.bv)((()=>{m()})),{trabajadorActivo:c,estadoDatafono:r,cesta:d,arrayMesas:t,getTotal:u,goTo:p,abrirCajon:b,tarjetaUltimoTicket:f,handleCobro:C}}};const Ba=(0,f.Z)(ha,[["render",Ma],["__scopeId","data-v-6a05eadc"]]);var xa=Ba,Da={name:"MainView",components:{MenusComponent:y,SubmenusComponent:h,TeclasComponent:q,CestaComponent:ee,MenuIzquierdaComponent:ca,MenuDerechaComponent:xa},setup(){const e=(0,V.tv)(),a=(0,D.iH)(null),t=(0,D.iH)(null),l=(0,D.iH)(null);function n(e){a.value.clickTecla(e)}function s(){t.value.resetGeneral()}function i(){l.value.actualizarPuntos()}return(0,o.JJ)("clickTecla",n),(0,o.JJ)("resetGeneral",s),(0,o.JJ)("actualizarPuntos",i),(0,o.bv)((()=>{N.Z.get("caja/estadoCaja").then((a=>{a.data||e.push("/abrirCaja")})).catch((e=>{S().fire("Oops...",e.message,"error")}))})),{refTeclasComponent:a,refMenuIzquierda:t,cestaRef:l}}};const Ta=(0,f.Z)(Da,[["render",r]]);var Aa=Ta}}]);
//# sourceMappingURL=333.69189114.js.map