"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[600],{5600:function(a,e,o){o.r(e),o.d(e,{default:function(){return N}});var r=o(3396),t=o(7139);const n={class:"row mt-2"},l={class:"row mt-4 divInferior"},s={class:"col anchoCajaConsumoPersonal"},i={key:0,class:"col tablaDescansando table-responsive d-inline",style:{"background-color":"white"}},d={class:"table"},c={class:"tituloDescanso"},u=["onClick"],m={class:"textoNombre d-inline-block text-truncate"};function f(a,e,o,f,p,b){const v=(0,r.up)("MDBCardTitle"),_=(0,r.up)("MDBIcon"),w=(0,r.up)("MDBCardBody"),h=(0,r.up)("MDBCard"),M=(0,r.up)("MDBBtn"),g=(0,r.up)("ModalLeerQR"),C=(0,r.up)("FichajesModal"),j=(0,r.up)("InformesCajaComponent");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",n,[(0,r.Wm)(h,{onClick:e[0]||(e[0]=a=>f.modalFichajes.abrirModal()),class:"estiloCard ms-4"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{class:"text-center"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("iniciar_turno","Iniciar turno")),1)])),_:1}),(0,r.Wm)(_,{class:"mt-3",icon:"play",iconStyle:"fas",size:"6x"})])),_:1})])),_:1}),(0,r.Wm)(h,{onClick:e[1]||(e[1]=a=>f.iniciarDescanso()),class:"estiloCard ms-4"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{class:"text-center"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("iniciar_descanso","Iniciar descanso")),1)])),_:1}),(0,r.Wm)(_,{class:"mt-3",icon:"pause",iconStyle:"fas",size:"6x"})])),_:1})])),_:1}),(0,r.Wm)(h,{onClick:e[2]||(e[2]=a=>f.preguntarFinalizarTurno()),class:"estiloCard ms-4"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{class:"text-center"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("finalizar_turno","Finalizar turno")),1)])),_:1}),(0,r.Wm)(_,{class:"mt-3",icon:"stop",iconStyle:"fas",size:"6x"})])),_:1})])),_:1}),f.esFac_Tena?((0,r.wg)(),(0,r.j4)(h,{key:0,onClick:e[3]||(e[3]=a=>f.ModalLeerQRRef.abrirModal()),class:"estiloCardQR ms-4"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{class:"text-center"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("iframe_iterum","Leer QR")),1)])),_:1}),(0,r.Wm)(_,{class:"mt-3",icon:"qrcode",iconStyle:"fas",size:"5x"})])),_:1})])),_:1})):(0,r.kq)("",!0),f.verVentas?((0,r.wg)(),(0,r.j4)(h,{key:1,onClick:e[4]||(e[4]=a=>f.ModalVentasRef.abrirModal()),class:"estiloCardQR ms-4"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{class:"text-center"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("estado_ventas","Estado Ventas")),1)])),_:1}),(0,r.Wm)(_,{class:"mt-3",icon:"book",iconStyle:"fas",size:"5x"})])),_:1})])),_:1})):(0,r.kq)("",!0)]),(0,r._)("div",l,[(0,r._)("div",s,[f.trabajadorActivo?((0,r.wg)(),(0,r.j4)(M,{key:0,onClick:e[5]||(e[5]=a=>f.activarConsumoPersonal()),color:"primary",class:"w-100 botonConsumoPersonal"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("consumo_personal","Consumo personal")),1)])),_:1})):(0,r.kq)("",!0),(0,r.Wm)(M,{onClick:e[6]||(e[6]=a=>f.apagar_equipo()),color:"danger",class:"w-100 botonConsumoPersonal mt-4"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("apagar_equipo","Apagar equipo")),1)])),_:1}),null!=f.idActivoDescanso?((0,r.wg)(),(0,r.j4)(M,{key:1,onClick:e[7]||(e[7]=a=>f.preguntarFinalDescanso()),color:"primary",class:"w-100 botonConsumoPersonal mt-4"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("finalizar_descanso","Finalizar descanso")),1)])),_:1})):(0,r.kq)("",!0)]),f.arrayTrabajadoresDescanso&&f.arrayTrabajadoresDescanso.length>0?((0,r.wg)(),(0,r.iD)("div",i,[(0,r._)("table",d,[(0,r._)("thead",null,[(0,r._)("tr",null,[(0,r._)("th",c,(0,t.zw)(a.$t("trabajadores_en_descanso_activo","Trabajadores en descanso activo")),1)])]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(f.arrayTrabajadoresDescanso,((a,e)=>((0,r.wg)(),(0,r.iD)("tr",{key:e,class:(0,t.C_)({activoTabla:a._id===f.idActivoDescanso}),onClick:e=>f.setActivo(a._id)},[(0,r._)("td",null,[(0,r._)("span",m,(0,t.zw)(a.nombre),1)])],10,u)))),128))])])])):(0,r.kq)("",!0)]),(0,r.Wm)(g,{ref:"ModalLeerQRRef"},null,512),(0,r.Wm)(C,{ref:"modalFichajes"},null,512),(0,r.Wm)(j,{ref:"ModalVentasRef"},null,512)],64)}o(7658);var p=o(4834),b=o(4161);const v=["src"];function _(a,e,o,n,l,s){const i=(0,r.up)("MDBBtn"),d=(0,r.up)("MDBModalFooter"),c=(0,r.up)("MDBModal");return(0,r.wg)(),(0,r.j4)(c,{id:"ModalLeerQR",tabindex:"-1",labelledby:"ModalLeerQRLabel",modelValue:n.ModalLeerQR,"onUpdate:modelValue":e[1]||(e[1]=a=>n.ModalLeerQR=a),fullscreen:""},{default:(0,r.w5)((()=>[(0,r._)("iframe",{src:n.url,style:{position:"absolute",height:"90%",width:"90%",border:"none"}},null,8,v),(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Wm)(i,{color:"danger",size:"lg",onClick:e[0]||(e[0]=a=>n.ModalLeerQR=!1)},{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("cerrar","Cerrar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}var w=o(4870),h=o(4313),M={name:"ModalLeerQRComponent",components:{MDBModal:h.j3,MDBModalFooter:h.ab,MDBBtn:h.$v},setup(a,{expose:e}){const o=(0,w.iH)(!1),r=(0,w.iH)("");function t(a){n(),o.value=!0}function n(){r.value="https://silema.web.app/validarQR-trabajador"}return e({abrirModal:t}),{ModalLeerQR:o,abrirModal:t,url:r}}},g=o(89);const C=(0,g.Z)(M,[["render",_]]);var j=C,B=o(2492),D=o.n(B),k=o(65),y=o(9242);const z={class:"row"},F={key:0,class:"row mt-2"},T={class:"table table-striped"},W={class:"textoNombre d-inline-block text-truncate"},x={key:1,class:"row"},R={class:"sinResultados position-relative"},V={class:"textoSinResultados position-absolute top-50 start-50 translate-middle"};function $(a,e,o,n,l,s){const i=(0,r.up)("MDBModalTitle"),d=(0,r.up)("MDBModalHeader"),c=(0,r.up)("MDBBtn"),u=(0,r.up)("MDBModalBody"),m=(0,r.up)("MDBModalFooter"),f=(0,r.up)("MDBModal");return(0,r.wg)(),(0,r.j4)(f,{id:"modalFichajes",tabindex:"-1",labelledby:"staticBackdropLabel",modelValue:n.modalFichajes,"onUpdate:modelValue":e[2]||(e[2]=a=>n.modalFichajes=a),size:"xl",modalFichajes:""},{default:(0,r.w5)((()=>[(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Wm)(i,{id:"staticBackdropLabel"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("fichar","Fichar")),1)])),_:1})])),_:1}),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r._)("div",z,[(0,r.wy)((0,r._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:"Buscar por nombre","aria-label":".form-control-lg example","onUpdate:modelValue":e[0]||(e[0]=a=>n.inputBusqueda=a)},null,512),[[y.nr,n.inputBusqueda]])]),n.arrayTrabajadores&&n.arrayTrabajadores.length>0?((0,r.wg)(),(0,r.iD)("div",F,[(0,r._)("table",T,[(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.arrayTrabajadores,((e,o)=>((0,r.wg)(),(0,r.iD)("tr",{key:o},[(0,r._)("td",null,[(0,r._)("span",W,(0,t.zw)(e.nombre),1)]),(0,r._)("td",null,[(0,r.Wm)(c,{color:"primary",size:"lg",onClick:a=>n.fichar(e._id),class:"w-100",style:{height:"3.85rem","font-size":"1.5rem"}},{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("fichar","Fichar")),1)])),_:2},1032,["onClick"])])])))),128))])])])):((0,r.wg)(),(0,r.iD)("div",x,[(0,r._)("div",R,[(0,r._)("span",V,(0,t.zw)(a.$t("sin_resultados","Sin resultados")),1)])]))])),_:1}),(0,r.Wm)(m,null,{default:(0,r.w5)((()=>[(0,r.Wm)(c,{color:"primary",size:"lg",onClick:e[1]||(e[1]=a=>n.modalFichajes=!1)},{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("cerrar","Cerrar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}var H={name:"FichajesModal",components:{MDBModal:h.j3,MDBModalHeader:h.ol,MDBModalTitle:h.wo,MDBModalBody:h.Yz,MDBModalFooter:h.ab,MDBBtn:h.$v},setup(){const a=(0,w.iH)(null),e=(0,w.iH)([]),o=(0,w.iH)("");function t(){a.value=!0}function n(){b.Z.post("trabajadores/buscar",{busqueda:o.value}).then((a=>{e.value=a.data})).catch((a=>{D().fire("Oops...",a.message,"error")}))}function l(e){b.Z.post("trabajadores/fichar",{idTrabajador:e}).then((e=>{if(!e.data)throw Error("Error, no se ha podido fichar");p.W.cargarTrabajadoresFichados(),a.value=!1})).catch((a=>{D().fire("Oops...",a.message,"error")}))}return(0,r.YP)(o,(()=>{n()})),{modalFichajes:a,abrirModal:t,arrayTrabajadores:e,inputBusqueda:o,fichar:l}}};const q=(0,g.Z)(H,[["render",$],["__scopeId","data-v-6f9e5052"]]);var L=q,E=o(6109);const U={class:"caja"},Q={class:"result"};function A(a,e,o,n,l,s){const i=(0,r.up)("MDBModalHeader"),d=(0,r.up)("MDBBtn"),c=(0,r.up)("MDBModalBody"),u=(0,r.up)("MDBModal");return(0,r.wg)(),(0,r.j4)(u,{id:"modalVentas",tabindex:"-1",labelledby:"tituloModalEstadoVentas",modelValue:n.modalVentas,"onUpdate:modelValue":e[1]||(e[1]=a=>n.modalVentas=a),staticBackdrop:"",size:"lg"},{default:(0,r.w5)((()=>[(0,r._)("div",U,[(0,r.Wm)(i,null,{default:(0,r.w5)((()=>[(0,r._)("h2",null,(0,t.zw)(a.$t("estado_de_la_caja","Estado de la caja")),1)])),_:1}),(0,r.Wm)(c,null,{default:(0,r.w5)((()=>[(0,r.Wm)(d,{color:"primary",onClick:e[0]||(e[0]=a=>n.toggleCaja())},{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(a.$t("consultar_estado_de_la_caja","Consultar estado de la caja")),1)])),_:1}),(0,r._)("div",Q,(0,t.zw)(a.$t("estado","estado"))+": "+(0,t.zw)(n.emoji),1)])),_:1})])])),_:1},8,["modelValue"])}var I={name:"InformesCajaComponent",components:{MDBBtn:h.$v,MDBCard:h.Yl,MDBModal:h.j3,MDBModalBody:h.Yz,MDBModalHeader:h.ol},setup(a,{expose:e}){const o=(0,w.iH)(!1),t=(0,k.oR)(),n=(0,r.Fl)((()=>t.state.Caja.arrayVentas));let l=0;const s=()=>{u.value=c(),b.Z.post("/movimientos/getPred").then((a=>{u.value=m(a.data)}))};function i(a){return Math.floor(Math.random()*a)}function d(){o.value=!0}function c(){const a=["Consultando con jesus...","Preguntando a los astros...","Mirando en la bola de cristal...","Leyendo el tarot...","Mirando en la barra del bar...","Consultando con el oraculo...","Leyendo el horoscopo...","Mirando en el cafe turco...","Consultando con el espiritu santo...","Lo siento profe no estudie..."];return a[i(a.length)]}e({abrirModal:d});const u=(0,w.iH)(c()),m=(a=[])=>{if(0==a.length||!a)return"No hay datos â“";const e=Number(a[0].Import),o=20*e/100,r=50*e/100,t=e,s=125*e/100;return l=0,n.value.forEach((a=>{l+=Number(a.total)})),l<=o?"ðŸ’©":l>o&&l<=r?"ðŸ˜":l>r&&l<=t?"ðŸ˜€":l>t&&l<=s?"ðŸ˜":"ðŸ¤‘"};return s(),{toggleCaja:s,emoji:u,modalVentas:o}}};const Z=(0,g.Z)(I,[["render",A],["__scopeId","data-v-1b07e4f6"]]);var S=Z,O={name:"fichajesView",components:{MDBIcon:h.vm,FichajesModal:L,MDBCard:h.Yl,MDBCardBody:h.H7,MDBCardTitle:h.QM,MDBBtn:h.$v,ModalLeerQR:j,InformesCajaComponent:S},setup(){const a=(0,k.oR)(),e=a.getters["Configuracion/parametros"],o=(0,w.iH)(null),t=(0,w.iH)(!1),n=(0,w.iH)(null),l=(0,w.iH)([]),s=(0,w.iH)(null),i=(0,w.iH)(null),d=(0,w.iH)(!1),c=(0,r.Fl)((()=>a.state.Trabajadores.arrayTrabajadores)),u=(0,r.Fl)((()=>a.state.Trabajadores.indexActivo)),m=(0,r.Fl)((()=>c.value&&void 0!=u.value&&null!=u.value&&c.value[u.value]?c.value[u.value]:null)),f=(0,r.Fl)((()=>a.state.Cestas.arrayCestas)),v=(0,r.Fl)((()=>{if(f.value)for(let a=0;a<f.value.length;a++)if(f.value[a]._id==c.value[u.value].idCesta)return f.value[a];return null}));function _(a){s.value=a}function h(){s.value=null}function M(){b.Z.post("trabajadores/desfichar",{idTrabajador:m.value._id}).then((a=>{if(!a.data)throw Error("Error, no se ha podido registrar el fin de turno (backend)");p.W.cargarTrabajadoresFichados(),D().fire("OK","Fin de turno registrado correctamente","success")})).catch((a=>{D().fire("Oops...",a.message,"error")}))}function g(a){for(let e=0;e<l.value.length;e++)if(a===l.value[e]._id)return l.value[e];return null}function C(){if(s.value){const a=g(s.value);a&&D().fire({title:"Por favor, confirma el descanso para: ",html:`${a.nombre}`,showCancelButton:!0,cancelButtonText:"Cancelar",confirmButtonText:"Confirmar"}).then((a=>{a.isConfirmed&&z(s.value)}))}}function j(){D().fire({title:"Â¿Desea realmente apagar el equipo? ",html:"Â¡Esta funcion apagarÃ¡ instantaneamente su equipo!",showCancelButton:!0,confirmButtonText:"Apagar",cancelButtonText:"Cancelar",confirmButtonColor:"red",cancelButtonColor:"green",iconColor:"red",icon:"warning",backdrop:"rgba(255,0,0,0.4)"}).then((a=>{a.isConfirmed&&b.Z.post("controlTpv/ApagarOrdenador",{}).then((a=>{a.data?D().fire("Â¡Apagando!","Su equipo se apagarÃ¡ en unos instantes...","success"):D().fire("Â¡No hemos podido apagar el equipo!","Si el error se mantiene, pruebe a forzar un apagado!","error")})).catch((a=>{D().fire("Â¡No hemos podido apagar el equipo!","Si el error se mantiene, pruebe a forzar un apagado!"+a,"error")}))}))}async function B(){if(f.value&&v.value)for(let e=0;e<f.value.length;e++)if(f.value[e]._id===v.value._id){await a.dispatch("Cestas/setModoCesta",{modo:"CONSUMO_PERSONAL",index:e}),E.Z.push("/main");break}}function y(){m.value&&D().fire({title:"Confirma. Fin de turno para: ",html:`${m.value.nombre}`,showCancelButton:!0,cancelButtonText:"Cancelar",confirmButtonText:"Confirmar"}).then((a=>{a.isConfirmed&&M()}))}function z(a){b.Z.post("trabajadores/finDescanso",{idTrabajador:a}).then((a=>{if(!a.data)throw Error("Error, no se  ha podido iniciar el descanso");p.W.cargarTrabajadoresFichados(),h(),T(),D().fire("Descanso finalizado","","success")})).catch((a=>{D().fire("Oops...",a.message,"error")}))}function F(){m.value._id?b.Z.post("trabajadores/inicioDescanso",{idTrabajador:m.value._id}).then((a=>{if(!a.data)throw Error("Error, no se ha podido iniciar el descanso");T(),p.W.cargarTrabajadoresFichados(),D().fire("OK","Descanso iniciado correctamente","success")})).catch((a=>{D().fire("Oops...",a.message,"error")})):D().fire("Importante....","Es necesario un trabajador activo para realizar esta acciÃ³n","warning")}function T(){b.Z.get("trabajadores/descansando").then((a=>{if(!a.data)throw Error("Error, no se han podido obtener los trabajadores en descanso");l.value=a.data})).catch((a=>{D().fire("Oops...",a.message,"error")}))}return(0,r.bv)((()=>{T(),"Tena"==e.nombreEmpresa&&(t.value=!0),b.Z.post("/parametros/getParametros").then((a=>{d.value="Si"===a.data.params.verInformesVentas}))})),{modalFichajes:o,arrayTrabajadoresDescanso:l,idActivoDescanso:s,esFac_Tena:t,setActivo:_,trabajadorActivo:m,finDeTurno:M,iniciarDescanso:F,preguntarFinalDescanso:C,resetidActivoDescansando:h,preguntarFinalizarTurno:y,activarConsumoPersonal:B,apagar_equipo:j,ModalLeerQRRef:n,ModalVentasRef:i,verVentas:d}}};const P=(0,g.Z)(O,[["render",f],["__scopeId","data-v-5162e486"]]);var N=P}}]);
//# sourceMappingURL=600.5f37632c.js.map