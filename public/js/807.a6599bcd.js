"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[807],{7767:function(e,a,o){o.d(a,{Z:function(){return f}});var t=o(3396);const l={class:"btn-group-vertical mt-1"},n={class:"btn-group"},r={class:"btn-group"},i={class:"btn-group"},s={class:"btn-group"},d={class:"btn-group"};function u(e,a,o,u,c,m){return(0,t.wg)(),(0,t.iD)("div",l,[(0,t._)("div",n,[(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[0]||(a[0]=e=>u.addTecla("1"))}," 1 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[1]||(a[1]=e=>u.addTecla("2"))}," 2 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[2]||(a[2]=e=>u.addTecla("3"))}," 3 ")]),(0,t._)("div",r,[(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[3]||(a[3]=e=>u.addTecla("4"))}," 4 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[4]||(a[4]=e=>u.addTecla("5"))}," 5 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[5]||(a[5]=e=>u.addTecla("6"))}," 6 ")]),(0,t._)("div",i,[(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[6]||(a[6]=e=>u.addTecla("7"))}," 7 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[7]||(a[7]=e=>u.addTecla("8"))}," 8 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[8]||(a[8]=e=>u.addTecla("9"))}," 9 ")]),(0,t._)("div",s,[(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[9]||(a[9]=e=>u.deleteTecla())}," < "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[10]||(a[10]=e=>u.addTecla("0"))}," 0 "),(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[11]||(a[11]=e=>u.okValue(Number(u.cantidad)))}," OK ")]),(0,t._)("div",d,[(0,t._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonComa",onClick:a[12]||(a[12]=e=>u.addTecla("."))}," , ")])])}var c=o(4870),m={name:"NumpadComponent",setup(e,{expose:a}){const o=(0,c.iH)("0"),l=(0,t.f3)("okValue"),n=(0,c.iH)("5.5rem"),r=(0,c.iH)("5.5rem");function i(e){"."===e&&(o.value=o.value.replace(".","")),o.value+=e,"0"==o.value[0]&&(o.value=o.value.slice(1))}function s(){o.value=o.value.slice(0,-1),""===o.value&&(o.value="0")}function d(e){o.value=e.toString()}return a({cantidad:o,setValor:d}),{okValue:l,cantidad:o,addTecla:i,deleteTecla:s,setValor:d,anchoTecla:n,altoTecla:r}}},p=o(89);const v=(0,p.Z)(m,[["render",u],["__scopeId","data-v-6bb950cc"]]);var f=v},9534:function(e,a,o){o.d(a,{Z:function(){return B}});var t=o(3396),l=o(7139);const n={class:"container"},r={class:"h3 text-center"},i={class:"h3"},s={class:"row mt-2 container"},d={class:"again py-5"},u={class:"again py-5"},c={class:"again py-5"},m={class:"row mt-2"},p={class:"d-inline-block text-end"};function v(e,a,o,v,f,b){const C=(0,t.up)("MDBBtn"),_=(0,t.up)("MDBModalBody"),w=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(w,{id:"modalDatafono",tabindex:"-1",labelledby:"tituloModalDatafono",modelValue:v.modalErrorDatafono,"onUpdate:modelValue":a[4]||(a[4]=e=>v.modalErrorDatafono=e),staticBackdrop:"",size:"xl"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,null,{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("p",r,(0,l.zw)(e.$t("error_al_ejecutar","Error al ejecutar"))+" "+(0,l.zw)(e.$t("la_comanda_en_el_datafono","la comanda en el datáfono")),1),(0,t._)("p",i,(0,l.zw)(e.$t("seleccione","seleccione"))+":",1)]),(0,t._)("div",s,[(0,t.Wm)(C,{color:"primary",size:"lg",class:"botonEstado my-3",onClick:a[0]||(a[0]=e=>v.tarjetaUltimoTicket())},{default:(0,t.w5)((()=>[(0,t._)("span",d,(0,l.zw)(e.$t("reintentar_pago","Reintentar pago")),1)])),_:1}),(0,t.Wm)(C,{color:"primary",size:"lg",class:"botonEstado my-3",onClick:a[1]||(a[1]=e=>v.modalErrorDatafono=!1)},{default:(0,t.w5)((()=>[(0,t._)("span",u,(0,l.zw)(e.$t("pago en efectivo","Pago en EFECTIVO")),1)])),_:1}),(0,t.Wm)(C,{color:"primary",size:"lg",class:"botonEstado my-3",onClick:a[2]||(a[2]=e=>v.anularTicket())},{default:(0,t.w5)((()=>[(0,t._)("span",c,(0,l.zw)(e.$t("reintentar_anular_ticket","Reintentar Anular Ticket")),1)])),_:1})]),(0,t._)("div",m,[(0,t._)("div",p,[(0,t.Wm)(C,{color:"danger",size:"lg",class:"mt-2",onClick:a[3]||(a[3]=e=>v.modalErrorDatafono=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,l.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])])])),_:1})])),_:1},8,["modelValue"])}var f=o(65),b=o(4161),C=o(4313),_=o(2492),w=o.n(_),M=o(4870),y={name:"ModalErrorDatafonoComponent",components:{MDBModal:C.j3,MDBModalBody:C.Yz,MDBBtn:C.$v},setup(e,{expose:a}){const o=(0,M.iH)(null),l=(0,f.oR)(),n=(0,M.iH)(!1),r=(0,t.Fl)((()=>l.state.Trabajadores.arrayTrabajadores)),i=(0,t.Fl)((()=>l.state.Trabajadores.indexActivo)),s=(0,t.Fl)((()=>r.value&&void 0!=i.value&&null!=i.value&&r.value[i.value]?r.value[i.value]:null));function d(e){o.value=e,n.value=!0}function u(){b.Z.post("paytef/cobrarUltimoTicket",{idTrabajador:s.value._id}).then((()=>{n.value=!1,l.dispatch("Datafono/setEstado","PENDIENTE")})).catch((e=>{n.value=!0,w().fire("Oops...",e.message,"error")}))}function c(){null!=o.value&&confirm("¿Confirma ANULACIÓN de ticket?")&&(b.Z.post("tickets/anularTicket",{ticketId:o.value}).then((e=>{e.data.res&&"EFECTIVO"==e.data.tipo?w().fire({icon:"success",title:"Ticket anulado",showConfirmButton:!1,timer:1200}):e.data.res||w().fire({icon:"error",title:"Ya esta anulado",showConfirmButton:!1,timer:1400})})).catch((e=>{w().fire(e.message)})),n.value=!1)}return a({abrirModal:d}),{store:l,modalErrorDatafono:n,tarjetaUltimoTicket:u,arrayTrabajadores:r,indexTrabajadorActivo:i,idSeleccionado:o,anularTicket:c}}},g=o(89);const k=(0,g.Z)(y,[["render",v]]);var B=k},5807:function(e,a,o){o.r(a),o.d(a,{default:function(){return zo}});var t=o(3396);const l={class:"row mt-1"},n={class:"col-md-3"},r={class:"col-md-6"},i={class:"col-md-3"};function s(e,a,o,s,d,u){const c=(0,t.up)("MenusComponent"),m=(0,t.up)("SubmenusComponent"),p=(0,t.up)("TeclasComponent"),v=(0,t.up)("MenuIzquierdaComponent"),f=(0,t.up)("CestaComponent"),b=(0,t.up)("MenuDerechaComponent"),C=(0,t.up)("ModalErrorDatafonoComponent");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(c),(0,t.Wm)(m),(0,t.Wm)(p,{ref:"refTeclasComponent"},null,512),(0,t._)("div",l,[(0,t._)("div",n,[(0,t.Wm)(v,{ref:"refMenuIzquierda"},null,512)]),(0,t._)("div",r,[(0,t.Wm)(f,{ref:"cestaRef"},null,512)]),(0,t._)("div",i,[(0,t.Wm)(b)])]),(0,t.Wm)(C,{ref:"modalErrorDatafonoRef"},null,512)],64)}o(7658);var d=o(7139);const u={class:"row",style:{"margin-top":"1px"}},c={class:"btn-group shadow-none",role:"group"},m=["onClick"];function p(e,a,o,l,n,r){return(0,t.wg)(),(0,t.iD)("div",u,[(0,t._)("div",c,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.teclado,((e,a)=>((0,t.wg)(),(0,t.iD)("button",{key:a,class:(0,d.C_)([{activo:a==l.indexMenuActivo},"btn btn-secondary border border-1 rounded botonesMenu menusColorIvan"]),onClick:e=>l.setActivo(a)},(0,d.zw)(e.nombre),11,m)))),128))])])}var v=o(65),f={name:"MenusComponent",setup(e,{expose:a}){const o=(0,v.oR)(),l=(0,t.Fl)((()=>o.state.Teclado.objTeclado)),n=(0,t.Fl)((()=>o.state.Teclado.indexMenuActivo));function r(e){o.dispatch("Teclado/setIndexMenuActivo",e)}return(0,t.bv)((()=>{r(0)})),a({indexMenuActivo:n}),{teclado:l,indexMenuActivo:n,setActivo:r}}},b=o(89);const C=(0,b.Z)(f,[["render",p],["__scopeId","data-v-792a1e76"]]);var _=C;const w={key:0,class:"row mt-1"},M=["onClick"];function y(e,a,o,l,n,r){return l.teclado&&l.teclado[l.indexMenuActivo]&&l.teclado[l.indexMenuActivo].arraySubmenus&&l.teclado[l.indexMenuActivo].arraySubmenus.length>0?((0,t.wg)(),(0,t.iD)("div",w,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.teclado[l.indexMenuActivo].arraySubmenus,((e,a)=>((0,t.wg)(),(0,t.iD)("div",{class:"col",style:{padding:"0px 6px 0px 1px"},key:a},[(0,t._)("button",{class:(0,d.C_)([{activo:a==l.indexSubmenuActivo},"btn btn-secondary border border-1 rounded botonesSubmenus menusColorIvan w-100"]),onClick:e=>l.setIndexSubmenu(a)},(0,d.zw)(e.nombre),11,M)])))),128))])):(0,t.kq)("",!0)}var g={name:"SubmenusComponent",setup(){const e=(0,v.oR)(),a=(0,t.Fl)((()=>e.state.Teclado.objTeclado)),o=(0,t.Fl)((()=>e.state.Teclado.indexMenuActivo)),l=(0,t.Fl)((()=>e.state.Teclado.indexSubmenuActivo));function n(a){e.dispatch("Teclado/setIndexSubmenuActivo",a)}return{teclado:a,indexMenuActivo:o,indexSubmenuActivo:l,setIndexSubmenu:n}}};const k=(0,b.Z)(g,[["render",y],["__scopeId","data-v-88124a2e"]]);var B=k;const h=["onClick"];function D(e,a,o,l,n,r){const i=(0,t.up)("MDBBtn"),s=(0,t.up)("PesoComponent"),u=(0,t.up)("SuplementosComponent"),c=(0,t.up)("ModalEditarProducto"),m=(0,t.up)("ModalCrearProducto");return(0,t.wg)(),(0,t.iD)(t.HY,null,[((0,t.wg)(),(0,t.iD)(t.HY,null,(0,t.Ko)(6,((a,o)=>((0,t.wg)(),(0,t.iD)(t.HY,{key:o},[l.arrayTeclas&&l.arrayTeclas.length>0?((0,t.wg)(),(0,t.iD)("div",{key:0,class:(0,d.C_)(["row",{"mt-1":0==o}])},[((0,t.wg)(),(0,t.iD)(t.HY,null,(0,t.Ko)(6,((a,n)=>(0,t._)("div",{class:(0,d.C_)(["col",[l.teclado[l.indexMenuActivo].arraySubmenus&&l.teclado[l.indexMenuActivo].arraySubmenus.length>0?"colJuntitasConSubmenus":"colJuntitas"]]),key:n},[l.arrayTeclas[n+6*o].idArticle?((0,t.wg)(),(0,t.j4)(i,{key:0,onClick:e=>l.clickTecla(l.arrayTeclas[n+6*o]),onContextmenu:e=>l.abrirFicha(l.arrayTeclas[n+6*o].idArticle),class:(0,d.C_)(["btn btn-primary w-100 d-inline-block esconderTexto",[l.teclado[l.indexMenuActivo].arraySubmenus&&l.teclado[l.indexMenuActivo].arraySubmenus.length>0?"teclasConSubmenu":"teclas"]]),style:(0,d.j5)({"background-color":"#"+l.arrayTeclas[n+6*o].color.toString(16),color:l.getTextColor("#"+l.arrayTeclas[n+6*o].color.toString(16))})},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(l.arrayTeclas[n+6*o].nombreArticulo),1)])),_:2},1032,["onClick","onContextmenu","class","style"])):((0,t.wg)(),(0,t.iD)("button",{key:1,class:(0,d.C_)(["btn btn-primary w-100",[{editarArticulos:"MOVER_ARTICULO"==l.isEditarArticulos(!1)},{invisible:"MOVER_ARTICULO"!==l.isEditarArticulos(!1)&&"MODIFICAR_ARTICULO"!==l.isEditarArticulos(!1)},null==l.teclado[l.indexMenuActivo].arraySubmenus?"teclas":"teclasConSubmenu"]]),onClick:e=>l.editarArticulo(l.arrayTeclas[n+6*o].pos)},(0,d.zw)(e.$t("vacio","Vacío"))+" "+(0,d.zw)(l.isEditarArticulos(!0)),11,h))],2))),64))],2)):(0,t.kq)("",!0)],64)))),64)),(0,t.Wm)(s,{ref:"modalPesoRef"},null,512),(0,t.Wm)(u,{ref:"modalSuplementosRef"},null,512),(0,t.Wm)(c,{ref:"modalEditarProdRef"},null,512),(0,t.Wm)(m,{ref:"modalCrearProdRef"},null,512)],64)}var A=o(4870);const T={class:"row"},x={class:"row"};function I(e,a,o,l,n,r){const i=(0,t.up)("MDBModalTitle"),s=(0,t.up)("MDBModalHeader"),u=(0,t.up)("MDBInput"),c=(0,t.up)("NumpadComponent"),m=(0,t.up)("MDBModalBody"),p=(0,t.up)("MDBBtn"),v=(0,t.up)("MDBModalFooter"),f=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(f,{id:"modalPeso",tabindex:"-1",labelledby:"staticBackdropLabel",modelValue:l.modalPeso,"onUpdate:modelValue":a[2]||(a[2]=e=>l.modalPeso=e),staticBackdrop:""},{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t.Wm)(i,{id:"staticBackdropLabel"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("introduce_los_gramos","Introduce los gramos")),1)])),_:1})])),_:1}),(0,t.Wm)(m,{class:"mx-auto"},{default:(0,t.w5)((()=>[(0,t._)("div",T,[l.numpadRef&&l.numpadRef.cantidad?((0,t.wg)(),(0,t.j4)(u,{key:0,modelValue:l.numpadRef.cantidad,"onUpdate:modelValue":a[0]||(a[0]=e=>l.numpadRef.cantidad=e)},null,8,["modelValue"])):(0,t.kq)("",!0)]),(0,t._)("div",x,[(0,t.Wm)(c,{ref:"numpadRef"},null,512)])])),_:1}),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(p,{color:"danger",onClick:a[1]||(a[1]=e=>l.modalPeso=!1),size:"lg"},{default:(0,t.w5)((()=>[(0,t.Uk)(" Cerrar ")])),_:1}),(0,t.Wm)(p,{color:"success",size:"lg"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("aceptar","Aceptar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}var z=o(4313),S=o(7767),U=o(4161),E=o(2492),W=o.n(E),j={name:"PesoComponent",components:{MDBModal:z.j3,MDBModalHeader:z.ol,MDBModalTitle:z.wo,MDBModalBody:z.Yz,MDBModalFooter:z.ab,MDBBtn:z.$v,MDBInput:z.u2,NumpadComponent:S.Z},setup(e,{expose:a}){const o=(0,A.iH)(!1),l=(0,A.iH)(null),n=(0,A.iH)({idArticulo:null,idCesta:null});function r(e,a){n.value.idArticulo=e,n.value.idCesta=a,o.value=!0}function i(e){U.Z.post("teclado/clickTeclaArticulo",{idArticulo:n.value.idArticulo,gramos:e,idCesta:n.value.idCesta,unidades:1,arraySuplementos:null}).then((e=>{if(!e.data)throw Error("No se ha podido insertar el artículo a peso");n.value.idArticulo=null,n.value.idCesta=null,o.value=!1})).catch((e=>{W().fire("Oops...",e.message,"error")}))}function s(){}return a({abrirModal:r}),(0,t.JJ)("okValue",i),{modalPeso:o,numpadRef:l,infoArticulo:n,test:s}}};const N=(0,b.Z)(j,[["render",I]]);var H=N;const V=e=>((0,t.dD)("data-v-e498fbc8"),e=e(),(0,t.Cn)(),e),O={class:"row"},R=["onClick"],F=V((()=>(0,t._)("br",null,null,-1))),P={class:"row"},Z={key:0,class:"table-responsive divCesta reverso"},$={class:"table colorFuente"},q={class:"tableBody"},L=["onClick"],Y={class:"d-inline-block text-truncate",style:{"max-width":"21rem","min-width":"21rem"}};function J(e,a,o,l,n,r){const i=(0,t.up)("MDBModalTitle"),s=(0,t.up)("MDBModalHeader"),u=(0,t.up)("MDBModalBody"),c=(0,t.up)("MDBBtn"),m=(0,t.up)("MDBModalFooter"),p=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(p,{id:"modalSuplementos",tabindex:"-1",labelledby:"staticBackdropLabel",modelValue:l.modalSuplementos,"onUpdate:modelValue":a[3]||(a[3]=e=>l.modalSuplementos=e),staticBackdrop:""},{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t.Wm)(i,{id:"staticBackdropLabel"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("selecciona_los_suplementos","Selecciona los suplementos"))+" "+(0,d.zw)(l.totalSuplementos.toFixed(2))+" € ",1)])),_:1})])),_:1}),(0,t.Wm)(u,{class:"mx-auto modal-body"},{default:(0,t.w5)((()=>[(0,t._)("div",O,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.arrayCompletoSuplementos,((e,a)=>((0,t.wg)(),(0,t.iD)("div",{key:a,class:"col mb-3"},[(0,t._)("button",{class:(0,d.C_)(["btn w-100 h-100 colorIvan1 btnSuplemento",[{suplementoActivo:l.checkSuplementoActivo(e._id)}]]),onClick:a=>l.addSuplemento(e)},[(0,t.Uk)((0,d.zw)(e.nombre)+" ",1),F,(0,t.Uk)(" "+(0,d.zw)(e.precioConIva)+" € ",1)],10,R)])))),128))]),(0,t._)("div",P,[l.suplementosSeleccionados?((0,t.wg)(),(0,t.iD)("div",Z,[(0,t._)("table",$,[(0,t._)("tbody",q,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.suplementosSeleccionados,((e,a)=>((0,t.wg)(),(0,t.iD)("tr",{key:a,class:(0,d.C_)(["itemCesta",{seleccionado:l.itemSeleccionado===a}]),onClick:e=>l.setIndex(a)},[(0,t._)("td",null,[(0,t._)("span",Y,(0,d.zw)(e.nombre),1)]),(0,t._)("td",null,(0,d.zw)(e.precioConIva.toFixed(2))+" €",1)],10,L)))),128))])])])):(0,t.kq)("",!0)])])),_:1}),(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{color:"danger",onClick:a[0]||(a[0]=e=>l.eliminarActivo()),size:"lg"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("eliminar","Eliminar")),1)])),_:1}),(0,t.Wm)(c,{color:"secondary",onClick:a[1]||(a[1]=e=>l.modalSuplementos=!1),size:"lg"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("cerrar","Cerrar")),1)])),_:1}),(0,t.Wm)(c,{color:"success",size:"lg",onClick:a[2]||(a[2]=e=>l.insertarArticulo())},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("aceptar","Aceptar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}var G={name:"SuplementosComponent",components:{MDBModal:z.j3,MDBModalHeader:z.ol,MDBModalTitle:z.wo,MDBModalBody:z.Yz,MDBModalFooter:z.ab,MDBBtn:z.$v},setup(e,{expose:a}){const o=(0,A.iH)(!1),l=(0,A.iH)(null),n=(0,A.iH)(null),r={idArticulo:null,idCesta:null,cliente:null,suplementos:null},i=(0,A.iH)([]),s=(0,A.iH)([]);let d=0;const u=(0,t.Fl)((()=>{if(i.value&&i.value.length>0){let e=0;for(let a=0;a<i.value.length;a++)e+=i.value[a].precioConIva;return e}return 0}));async function c(e,a,t,l,n){r.idArticulo=e,r.idCesta=a,r.cliente=t,d=n;const i=await U.Z.post("articulos/getSuplementos",{arrayIdSuplementos:l});if(!i)throw Error("No se ha podido obtener la lista de suplementos");s.value=i.data,o.value=!0}function m(e){try{i.value.push(e)}catch(a){W().fire("Oops...",a.message,"error")}}function p(e){const a=i.value.findIndex((a=>a.suplemento===e));return-1!==a}function v(e){n.value=e}function f(){i.value.splice(n.value,1)}async function b(){try{const e=await U.Z.post("teclado/clickTeclaArticulo",{idArticulo:r.idArticulo,gramos:0,idCesta:r.idCesta,unidades:d,arraySuplementos:i.value});if(r.idArticulo=null,r.idCesta=null,i.value=[],!e.data)throw Error("No se ha podido insertar el artículo con suplementos");o.value=!1}catch(e){W().fire("Oops...",e.message,"error")}}function C(){}return a({abrirModal:c}),(0,t.JJ)("okValue",b),{modalSuplementos:o,addSuplemento:m,checkSuplementoActivo:p,numpadRef:l,arrayCompletoSuplementos:s,suplementosSeleccionados:i,itemSeleccionado:n,insertarArticulo:b,setIndex:v,eliminarActivo:f,totalSuplementos:u,test:C}}};const K=(0,b.Z)(G,[["render",J],["__scopeId","data-v-e498fbc8"]]);var Q=K,X=o(9242);const ee=e=>((0,t.dD)("data-v-9c9d6e02"),e=e(),(0,t.Cn)(),e),ae={class:"row"},oe={for:"nombre"},te=ee((()=>(0,t._)("label",{for:"tipoIva"},"Tipo de IVA",-1))),le=ee((()=>(0,t._)("option",{value:"4"},"0%",-1))),ne=ee((()=>(0,t._)("option",{value:"1"},"4%",-1))),re=ee((()=>(0,t._)("option",{value:"5"},"5%",-1))),ie=ee((()=>(0,t._)("option",{value:"2"},"10%",-1))),se=ee((()=>(0,t._)("option",{value:"3"},"21%",-1))),de=[le,ne,re,ie,se],ue=ee((()=>(0,t._)("label",{for:"esSumable"},"¿Se vende a unidades?",-1))),ce=ee((()=>(0,t._)("option",{value:"true"},"Si",-1))),me=ee((()=>(0,t._)("option",{value:"false"},"No",-1))),pe=[ce,me],ve={for:"precioIva"};function fe(e,a,o,l,n,r){const i=(0,t.up)("MDBModalTitle"),s=(0,t.up)("MDBModalHeader"),u=(0,t.up)("MDBModalBody"),c=(0,t.up)("MDBBtn"),m=(0,t.up)("MDBModalFooter"),p=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(p,{id:"modalEditarProd",tabindex:"-1",labelledby:"modalEditarProd",modelValue:l.modalEditarProd,"onUpdate:modelValue":a[8]||(a[8]=e=>l.modalEditarProd=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t.Wm)(i,{id:"modalTkrsLabel"},{default:(0,t.w5)((()=>[(0,t.Uk)(" Datos del producto ")])),_:1})])),_:1}),(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t._)("div",ae,[(0,t._)("label",oe,[(0,t.Uk)("Nombre producto "),(0,t.wy)((0,t._)("input",{id:"nombre",type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=e=>l.nombre=e)},null,512),[[X.nr,l.nombre]])]),te,(0,t.wy)((0,t._)("select",{name:"tipoIva",id:"tipoIva","onUpdate:modelValue":a[1]||(a[1]=e=>l.tipoIva=e),class:"form-control"},de,512),[[X.bM,l.tipoIva]]),ue,(0,t.wy)((0,t._)("select",{name:"esSumable",id:"esSumable","onUpdate:modelValue":a[2]||(a[2]=e=>l.esSumable=e),class:"form-control"},pe,512),[[X.bM,l.esSumable]]),(0,t._)("label",ve,[(0,t.Uk)("Precio con "+(0,d.zw)(parseInt(l.tiposIva[l.tipoIva-1]))+"% de IVA ",1),(0,t.wy)((0,t._)("input",{id:"precioIva",type:"number",class:"form-control","onUpdate:modelValue":a[3]||(a[3]=e=>l.precioConIva=e)},null,512),[[X.nr,l.precioConIva]])])])])),_:1}),(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{color:"success",size:"lg",onClick:a[4]||(a[4]=e=>l.confirmar())},{default:(0,t.w5)((()=>[(0,t.Uk)("Guardar")])),_:1}),(0,t.Wm)(c,{color:"warning",size:"lg",onClick:a[5]||(a[5]=e=>l.cambiarPosicion())},{default:(0,t.w5)((()=>[(0,t.Uk)("Cambiar posición")])),_:1}),(0,t.Wm)(c,{color:"danger",size:"lg",onClick:a[6]||(a[6]=e=>l.EliminarTecla())},{default:(0,t.w5)((()=>[(0,t.Uk)("Elminar producto")])),_:1}),(0,t.Wm)(c,{color:"secondary",size:"lg",onClick:a[7]||(a[7]=e=>l.salirSinGuardar())},{default:(0,t.w5)((()=>[(0,t.Uk)("Cerrar sin guardar")])),_:1})])),_:1})])),_:1},8,["modelValue"])}var be=o(4834),Ce={name:"ModalEditarProducto",components:{MDBModal:z.j3,MDBModalHeader:z.ol,MDBModalTitle:z.wo,MDBModalBody:z.Yz,MDBModalFooter:z.ab,MDBBtn:z.$v},setup(e,{expose:a}){const o=(0,v.oR)(),l=(0,A.iH)(0),n=(0,A.iH)(!1),r=(0,A.iH)(0),i=(0,A.iH)(0),s=[4,10,21,0,5],d=(0,A.iH)(""),u=(0,A.iH)(-1),c=(0,A.iH)(""),m=(0,A.iH)(!0);async function p(){await U.Z.post("articulos/editarArticulo",{idArticulo:u.value,nombre:d.value,precioBase:parseFloat(r.value)/parseFloat(i.value),precioConIva:parseFloat(r.value),tipoIva:i.value,essumable:JSON.parse(m.value)}).then((e=>{n.value=!1,W().fire("Producto guardado","Producto guardado correctamente","success"),be.W.cargarTeclado()}))}function f(){n.value=!1}function b(){n.value=!1,o.dispatch("setModoActual","MOVER_ARTICULO")}async function C(e,a){await U.Z.post("articulos/moverArticulo",{id:u.value,posicion:e,menu:a}).then((a=>{W().fire("Producto establecido","Se ha movido el producto "+d.value+" correctamente a la celda "+e,"success"),be.W.cargarTeclado()})),o.dispatch("setModoActual","MODIFICAR_ARTICULO")}async function _(){confirm("¿Estas segur@ que desea eliminar el producto?")&&(await U.Z.post("articulos/eliminarArticulo",{id:u.value}).then((e=>{W().fire("Producto eliminado","Se eliminado el producto "+d.value+" correctamente a la celda","success"),be.W.cargarTeclado()})),o.dispatch("setModoActual","MODIFICAR_ARTICULO"),n.value=!1)}async function w(e,a,o,t,l,s){d.value=e,r.value=a,u.value=o,i.value=t,m.value=l,n.value=!0,c.value=s}return(0,t.bv)((()=>{})),a({abrirModal:w,botonVacio:C}),(0,t.YP)((()=>o.getters["ModalEditarProducto/getNombre"]),(()=>{})),{nombre:d,precioBase:l,precioConIva:r,id:u,modalEditarProd:n,tipoIva:i,confirmar:p,menus:c,cambiarPosicion:b,esSumable:m,tiposIva:s,salirSinGuardar:f,EliminarTecla:_}}};const _e=(0,b.Z)(Ce,[["render",fe],["__scopeId","data-v-9c9d6e02"]]);var we=_e;const Me=e=>((0,t.dD)("data-v-3c7ff1ac"),e=e(),(0,t.Cn)(),e),ye={class:"row"},ge={for:"nombre"},ke=Me((()=>(0,t._)("label",{for:"tipoIva"},"Tipo de IVA",-1))),Be=Me((()=>(0,t._)("option",{value:"4"},"0%",-1))),he=Me((()=>(0,t._)("option",{value:"1"},"4%",-1))),De=Me((()=>(0,t._)("option",{value:"5"},"5%",-1))),Ae=Me((()=>(0,t._)("option",{value:"2"},"10%",-1))),Te=Me((()=>(0,t._)("option",{value:"3"},"21%",-1))),xe=[Be,he,De,Ae,Te],Ie=Me((()=>(0,t._)("label",{for:"esSumable"},"¿Se vende a unidades?",-1))),ze=Me((()=>(0,t._)("option",{value:"true"},"Si",-1))),Se=Me((()=>(0,t._)("option",{value:"false"},"No",-1))),Ue=[ze,Se],Ee={for:"precioIva"};function We(e,a,o,l,n,r){const i=(0,t.up)("MDBModalTitle"),s=(0,t.up)("MDBModalHeader"),u=(0,t.up)("MDBModalBody"),c=(0,t.up)("MDBBtn"),m=(0,t.up)("MDBModalFooter"),p=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(p,{id:"modalCrearProd",tabindex:"-1",labelledby:"modalCrearProd",modelValue:l.modalCrearProd,"onUpdate:modelValue":a[6]||(a[6]=e=>l.modalCrearProd=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t.Wm)(i,{id:"modalTkrsLabel"},{default:(0,t.w5)((()=>[(0,t.Uk)(" Datos del producto ")])),_:1})])),_:1}),(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t._)("div",ye,[(0,t._)("label",ge,[(0,t.Uk)("Nombre producto "),(0,t.wy)((0,t._)("input",{id:"nombre",type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=e=>l.nombre=e)},null,512),[[X.nr,l.nombre]])]),ke,(0,t.wy)((0,t._)("select",{name:"tipoIva",id:"tipoIva","onUpdate:modelValue":a[1]||(a[1]=e=>l.tipoIva=e),class:"form-control"},xe,512),[[X.bM,l.tipoIva]]),Ie,(0,t.wy)((0,t._)("select",{name:"esSumable",id:"esSumable","onUpdate:modelValue":a[2]||(a[2]=e=>l.esSumable=e),class:"form-control"},Ue,512),[[X.bM,l.esSumable]]),(0,t._)("label",Ee,[(0,t.Uk)("Precio con "+(0,d.zw)(parseInt(l.tiposIva[l.tipoIva-1]))+"% de IVA incluido ",1),(0,t.wy)((0,t._)("input",{id:"precioIva",type:"number",class:"form-control","onUpdate:modelValue":a[3]||(a[3]=e=>l.precioConIva=e)},null,512),[[X.nr,l.precioConIva]])])])])),_:1}),(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{color:"success",size:"lg",onClick:a[4]||(a[4]=e=>l.confirmar())},{default:(0,t.w5)((()=>[(0,t.Uk)("Crear producto")])),_:1}),(0,t.Wm)(c,{color:"danger",size:"lg",onClick:a[5]||(a[5]=e=>l.salirSinGuardar())},{default:(0,t.w5)((()=>[(0,t.Uk)("Cerrar sin crear")])),_:1})])),_:1})])),_:1},8,["modelValue"])}var je={name:"modalCrearProducto",components:{MDBModal:z.j3,MDBModalHeader:z.ol,MDBModalTitle:z.wo,MDBModalBody:z.Yz,MDBModalFooter:z.ab,MDBBtn:z.$v},setup(e,{expose:a}){const o=(0,v.oR)(),l=(0,A.iH)(0),n=(0,A.iH)(!1),r=(0,A.iH)(0),i=(0,A.iH)(0),s=(0,A.iH)(0),d=[4,10,21,0,5],u=(0,A.iH)(""),c=(0,A.iH)(""),m=(0,A.iH)(-1),p=(0,A.iH)(""),f=(0,A.iH)(!0);async function b(){U.Z.post("articulos/anadirProducto",{nombreArticulo:u.value,precioConIva:parseFloat(r.value),esSumable:JSON.parse(f.value),precioBase:parseFloat(r.value)/parseFloat(i.value),tipoIva:parseFloat(i.value),menus:p.value,posicion:s.value}).then((e=>{c.value="",l.value=0,r.value=0,i.value=3,f.value=!1,n.value=!1,W().fire("Producto creado","Producto creado correctamente","success"),be.W.cargarTeclado()}))}function C(){n.value=!1}function _(){n.value=!1,o.dispatch("setModoActual","MOVER_ARTICULO")}async function w(e,a){s.value=e,u.value="Nombre",r.value="0.0",i.value="3",f.value=!0,n.value=!0,p.value=a}return(0,t.bv)((()=>{})),a({abrirModal:w}),(0,t.YP)((()=>o.getters["ModalEditarProducto/getNombre"]),(()=>{})),{nombre:u,precioBase:l,precioConIva:r,id:m,modalCrearProd:n,tipoIva:i,confirmar:b,menus:p,cambiarPosicion:_,esSumable:f,tiposIva:d,salirSinGuardar:C}}};const Ne=(0,b.Z)(je,[["render",We],["__scopeId","data-v-3c7ff1ac"]]);var He=Ne,Ve=o(2483),Oe={name:"TeclasComponent",components:{PesoComponent:H,MDBBtn:z.$v,SuplementosComponent:Q,ModalEditarProducto:we,ModalCrearProducto:He},setup(e,{expose:a}){const o=(0,v.oR)(),l=(0,Ve.tv)(),n=(0,t.Fl)((()=>o.state.modoActual)),r=(0,t.Fl)((()=>o.state.Configuracion.parametros)),i=(0,t.Fl)((()=>o.state.Teclado.objTeclado)),s=(0,t.Fl)((()=>o.state.Teclado.indexMenuActivo)),d=(0,t.Fl)((()=>o.state.Cestas.arrayCestas)),u=(0,t.Fl)((()=>o.state.Trabajadores.arrayTrabajadores)),c=(0,t.Fl)((()=>o.state.Trabajadores.indexActivo)),m=(0,t.Fl)((()=>o.state.Teclado.indexSubmenuActivo)),p=(0,A.iH)(null),f=(0,A.iH)(null),b=(0,A.iH)(null),C=(0,A.iH)(null),_=(0,A.iH)(null),w=(0,t.Fl)((()=>o.state.Unidades.unidades)),M=(0,A.iH)(!1),y=(0,t.Fl)((()=>{if(d.value)for(let e=0;e<d.value.length;e++)if(d.value[e]._id==u.value[c.value].idCesta)return d.value[e];return null}));function g(e){_.value.abrirModal(e)}function k(){let e=[];for(let a=0;a<36;a++)e[a]={idArticle:null,nombreArticulo:null,pos:a,color:null,esSumable:null};return e}async function B(e){let a=e.idArticle,t=d.value[0].idCliente;try{if("MODIFICAR_ARTICULO"===n.value||"MOVER_ARTICULO"===n.value)return"MOVER_ARTICULO"===n.value?void W().fire({icon:"error",title:"Ya hay un producto en esta parcela",showConfirmButton:!1,timer:1e3}):void U.Z.post("articulos/getArticulo",{idArticulo:a,idCliente:t}).then((({data:a})=>{if(!a)throw Error("Error al editar el producto");b.value.abrirModal(a.nombre,a.precioConIva,e.idArticle,a.tipoIva,a.esSumable)})).catch((e=>{throw Error(e)}));if(!y.value)throw Error("Es necesario una cesta activa para añadir un artículo");if(console.log(e.esSumable),JSON.parse(e.esSumable))if("Si"!=r?.value?.prohibirSuplementos&&e.suplementos?.length>0)f.value.abrirModal(e.idArticle,y.value._id,y.value.idCliente,e.suplementos,w.value);else{const a=await U.Z.post("teclado/clickTeclaArticulo",{idArticulo:e.idArticle,gramos:0,idCesta:y.value._id,unidades:w.value,arraySuplementos:null});if(!a.data)throw Error("No se ha podido añadir el artículo a la cesta");o.dispatch("Unidades/setUnidades",1)}else p.value.abrirModal(e.idArticle,y.value._id)}catch(l){W().fire("Oops...",l.message,"error")}}const h=(0,t.Fl)((()=>{let e=k();if(i.value&&i.value[s.value]&&i.value[s.value].arraySubmenus&&i.value[s.value].arraySubmenus[m.value])for(let a=0;a<i.value[s.value].arraySubmenus[m.value].arrayTeclas.length;a++)e[i.value[s.value].arraySubmenus[m.value].arrayTeclas[a].pos]=i.value[s.value].arraySubmenus[m.value].arrayTeclas[a];else if(i.value&&i.value[s.value]&&i.value[s.value].arrayTeclas)for(let a=0;a<i.value[s.value].arrayTeclas.length;a++)e[i.value[s.value].arrayTeclas[a].pos]=i.value[s.value].arrayTeclas[a];return e}));function D(e){return parseInt(e,16)||e}function T(e){return D(e)/255<=.03928?D(e)/255/12.92:Math.pow((D(e)/255+.055)/1.055,2.4)}function x(e){return.2126*T(e.substr(1,2))+.7152*T(e.substr(3,2))+.0722*T(e.substr(-2))}function I(e,a){const o=x(e),t=x(a);return(Math.max(o,t)+.05)/(Math.min(o,t)+.05)}function z(e){const a=I(e,"#ffffff"),o=I(e,"#000000");return a>o?"#ffffff":"#000000"}function S(e){}function E(e){return e?"MOVER_ARTICULO"==n.value?"Mover aqui":"Vacío":n.value}function j(e){let a=i.value[s.value],o="",t=`${a.nombre}`;if(null!=a.arraySubmenus&&(o=a.arraySubmenus[m.value].nombre,t=`[${a.nombre}] ${o}`),"MOVER_ARTICULO"==n.value)return b.value.botonVacio(e,t);C.value.abrirModal(e,t)}return(0,t.JJ)("addItem",S),(0,t.bv)((()=>{u.value&&0!==u.value?.length||l.push("menu/fichajes"),U.Z.post("parametros/getParametros").then((e=>{void 0!=e.data?.params?.prohibirSuplementos?"Si"==e.data?.params?.prohibirSuplementos&&(M.value=!0):M.value=!1}))})),a({clickTecla:B}),{teclado:i,indexMenuActivo:s,arrayTeclas:h,getTextColor:z,modalPesoRef:p,modalSuplementosRef:f,modalAlergenosRef:_,modalEditarProdRef:b,modalCrearProdRef:C,abrirFicha:g,clickTecla:B,NoSuplementos:M,isEditarArticulos:E,editarArticulo:j}}};const Re=(0,b.Z)(Oe,[["render",D],["__scopeId","data-v-7e429e70"]]);var Fe=Re;const Pe={key:0,class:"table-responsive divCesta reverso"},Ze={class:"table colorFuente"},$e={class:"tableBody"},qe=["onClick"],Le={class:"d-inline-block text-truncate",style:{"max-width":"21rem","min-width":"21rem"}},Ye={class:"xUnidades ms-2 d-inline"},Je={key:0},Ge={key:1},Ke={key:0,class:"fw-bold"};function Qe(e,a,o,l,n,r){const i=(0,t.up)("MDBCardTitle"),s=(0,t.up)("MDBCardText"),u=(0,t.up)("MDBBtn"),c=(0,t.up)("MDBCardBody"),m=(0,t.up)("MDBCard");return l.cesta&&l.cesta.lista?((0,t.wg)(),(0,t.iD)("div",Pe,[(0,t._)("table",Ze,[(0,t._)("tbody",$e,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.cesta.lista,((e,a)=>((0,t.wg)(),(0,t.iD)("tr",{key:a,class:(0,d.C_)(["itemCesta",{estiloPromo:e.promocion,seleccionado:l.indexItemCestaActivo===a,sePuedeRegalar:l.sePuedeRegalar(e),regalado:e.regalo}]),onClick:e=>l.clickItem(a)},[(0,t._)("td",null,[(0,t._)("span",Le,(0,d.zw)(e.nombre),1),(0,t._)("span",Ye," x"+(0,d.zw)(e.unidades),1),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.arraySuplementos,((e,a)=>((0,t.wg)(),(0,t.iD)("li",{key:a},(0,d.zw)(e.nombre),1)))),128))]),"CONSUMO_PERSONAL"!==l.cesta.modo&&"DEVOLUCION"!==l.cesta.modo?((0,t.wg)(),(0,t.iD)("td",Je,(0,d.zw)(e.subtotal.toFixed(2))+" € ",1)):(0,t.kq)("",!0)],10,qe)))),128))])])])):((0,t.wg)(),(0,t.iD)("div",Ge,[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("cesta_no_inicializada","Cesta no inicializada")),1)])),_:1}),(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("en_este_momento_no_hay_ninguna_cesta_seleccionada","En este momento no hay ninguna cesta seleccionada"))+" ",1),l.arrayTrabajadores&&l.arrayTrabajadores[l.indexTrabajadorActivo]?((0,t.wg)(),(0,t.iD)("span",Ke,(0,d.zw)(l.arrayTrabajadores[l.indexTrabajadorActivo].nombre),1)):(0,t.kq)("",!0)])),_:1}),(0,t.Wm)(u,{color:"primary",onClick:a[0]||(a[0]=e=>l.inicializarCesta())},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("crear_nueva_cesta","Crear nueva cesta")),1)])),_:1})])),_:1})])),_:1})]))}var Xe={name:"CestaComponent",components:{MDBCard:z.Yl,MDBCardBody:z.H7,MDBCardTitle:z.QM,MDBCardText:z.Pp,MDBBtn:z.$v},setup(e,{expose:a}){const o=(0,v.oR)(),l=(0,t.Fl)((()=>o.state.Cestas.arrayCestas)),n=(0,t.Fl)((()=>o.state.Cestas.indexItemActivo)),r=(0,t.Fl)((()=>o.state.Trabajadores.arrayTrabajadores)),i=(0,t.Fl)((()=>o.state.Trabajadores.indexActivo)),s=(0,t.Fl)((()=>{if(l.value)for(let e=0;e<l.value.length;e++)if(r.value&&r.value[i.value]&&l.value[e]._id==r.value[i.value].idCesta)return l.value[e];return null})),d=(0,A.iH)(0);function u(){s.value?.idCliente?U.Z.post("clientes/consultarPuntos",{idCliente:s.value?.idCliente}).then((e=>{"number"===typeof e.data?d.value=e.data:d.value=0})).catch((e=>{W().fire("Oops...",e.message,"error"),d.value=0})):d.value=0}function c(){r.value&&void 0!=i.value&&null!=i.value&&r.value[i.value]?U.Z.post("cestas/crearCesta",{idTrabajador:r.value[i.value]._id}).then((e=>{if(!e.data)throw Error("No se ha podido inicializar la nueva cesta")})).catch((e=>{W().fire("Oops...",e.message,"error")})):r.value&&void 0!=i.value&&null!=i.value?W().fire("Oops...","Error desconocido #123","error"):W().fire("Oops...","Error, no hay trabajador activo. Es necesario fichar antes de realizar esta acción","error")}function m(e){return Math.trunc(.03*e*.02)}function p(e){const a=[8641,8654,8640,8675,99,315,314,312,5603];if(null==s.value.idCliente||void 0==s.value.idCliente||""==s.value.idCliente)return!1;for(let o=0;o<a.length;o++)if(a[o]===e.idArticulo&&m(d.value)>=e.subtotal&&!e.regalo)return!0;return!1}function f(e){U.Z.post("cestas/regalarProducto",{idCesta:s.value._id,indexLista:e}).then((e=>{e.data?W().fire({icon:"success",title:"¡Regalo aplicado!",showConfirmButton:!1,timer:1500}):W().fire("Oops...","No se ha podido regalar el producto","error")}))}function b(e){p(s.value.lista[e])?W().fire({title:"¿Regalar este artículo?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Sí, regalar",denyButtonText:"No",icon:"question",customClass:{actions:"my-actions",cancelButton:"order-1 right-gap",confirmButton:"order-2",denyButton:"order-3"}}).then((a=>{a.isConfirmed?f(e):a.isDenied&&o.dispatch("Cestas/setActivoAction",e)})):o.dispatch("Cestas/setActivoAction",e)}return a({actualizarPuntos:u}),(0,t.bv)((()=>{u()})),{cesta:s,arrayTrabajadores:r,indexTrabajadorActivo:i,indexItemCestaActivo:n,clickItem:b,inicializarCesta:c,sePuedeRegalar:p,puntos:d}}};const ea=(0,b.Z)(Xe,[["render",Qe],["__scopeId","data-v-3c426d06"]]);var aa=ea;const oa={class:"modoVenta d-block text-center"},ta={key:0,class:"d-block textoNombreCliente text-center"},la={class:"text-truncate",style:{"max-width":"10rem"}},na={key:1,class:"d-block text-center textoNombreCliente"};function ra(e,a,o,l,n,r){const i=(0,t.up)("MDBBtn"),s=(0,t.up)("MDBIcon"),u=(0,t.up)("MDBBtnGroup"),c=(0,t.up)("ModalClientesComponent"),m=(0,t.up)("ModalArticulosComponent"),p=(0,t.up)("ModalUnidadesComponent"),v=(0,t.up)("tarjetaClienteNumero");return(0,t.wg)(),(0,t.iD)(t.HY,null,[l.vistaEspecial&&l.cesta?((0,t.wg)(),(0,t.iD)("div",{key:0,class:(0,d.C_)(["divInfoModo mb-2",{fondoDevolucion:"DEVOLUCION"==l.cesta.modo,fondoCliente:l.cesta.idCliente}])},[(0,t._)("div",null,[(0,t._)("span",oa,(0,d.zw)(l.cesta.modo),1),l.cesta.idCliente?((0,t.wg)(),(0,t.iD)("div",ta,[(0,t._)("span",la,(0,d.zw)(l.cesta.nombreCliente),1),(0,t.Wm)(i,{onClick:a[0]||(a[0]=e=>l.consultarPuntos(l.cesta.idCliente)),class:"d-block mx-auto w-100",size:"lg",color:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("consultar_puntos","Consultar puntos")),1)])),_:1})])):((0,t.wg)(),(0,t.iD)("span",na,(0,d.zw)(e.$t("sin_cliente_asignado","Sin cliente asignado")),1))])],2)):(0,t.kq)("",!0),l.vistaEspecial?(0,t.kq)("",!0):((0,t.wg)(),(0,t.j4)(u,{key:1,class:"shadow-0"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{outline:"secondary",class:"botones",onClick:a[1]||(a[1]=e=>l.goTo("/menu/caja/tickets"))},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"bars",size:"4x"})])),_:1}),(0,t.Wm)(i,{onClick:a[2]||(a[2]=e=>l.refModalArticulos.abrirModal()),outline:"secondary",class:(0,d.C_)(["botones ms-1",{oculto:"Si"===l.parametros?.ProhibirCercaArticles}])},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"search",size:"4x"})])),_:1},8,["class"]),(0,t.Wm)(i,{outline:"secondary",class:"botones ms-1",onClick:a[3]||(a[3]=e=>l.refModalClientes.abrirModal())},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"users",size:"4x"})])),_:1})])),_:1})),l.vistaEspecial?(0,t.kq)("",!0):((0,t.wg)(),(0,t.j4)(u,{key:2,class:"shadow-0 mt-1"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{onClick:a[4]||(a[4]=e=>l.imprimirUltimoTicket()),outline:"secondary",class:"botones"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"print",size:"4x"})])),_:1}),(0,t.Wm)(i,{onClick:a[5]||(a[5]=e=>l.refModalUnidades.abrirModal()),outline:"secondary",class:"botones ms-1"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"calculator",size:"4x"})])),_:1}),(0,t.Wm)(i,{onClick:a[6]||(a[6]=e=>l.goTo("/cestas")),outline:"secondary",class:"botones ms-1"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"shopping-cart",size:"4x"})])),_:1})])),_:1})),(0,t.Wm)(u,{class:"shadow-0 mt-1"},{default:(0,t.w5)((()=>[void 0==l.indexActivoCesta||null==l.indexActivoCesta?((0,t.wg)(),(0,t.j4)(i,{key:0,outline:"secondary",class:"botones",onClick:a[7]||(a[7]=e=>l.borrarLista())},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"trash",size:"4x"})])),_:1})):((0,t.wg)(),(0,t.j4)(i,{key:1,outline:"secondary",class:"botones",onClick:a[8]||(a[8]=e=>l.borrarItem())},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"times",size:"4x"})])),_:1})),(0,t.Wm)(i,{onClick:a[9]||(a[9]=e=>l.resetGeneral()),outline:"secondary",class:"botones ms-1"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"undo",size:"4x"})])),_:1}),(0,t.Wm)(i,{outline:"secondary",onClick:a[10]||(a[10]=e=>l.changeVistaCliente()),class:"botones ms-1"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"star",size:"4x"})])),_:1})])),_:1}),(0,t.Wm)(c,{ref:"refModalClientes"},null,512),(0,t.Wm)(m,{ref:"refModalArticulos"},null,512),(0,t.Wm)(p,{ref:"refModalUnidades"},null,512),(0,t.Wm)(v,{ref:"tarjetaNum"},null,512)],64)}var ia=o(8686);const sa={class:"row"},da={class:"d-inline-block text-center"},ua={class:"row mt-1 p-4"},ca={class:"col-md-8"},ma={class:"col-md-4"},pa={key:0,class:"row"},va={class:"col"},fa={class:"table-responsive w-100",style:{height:"400px"}},ba={class:"table table-striped mt-1"},Ca={class:"textoNombre d-inline-block text-truncate"},_a={key:1,class:"row"},wa={class:"sinResultados position-relative"},Ma={class:"textoSinResultados position-absolute top-50 start-50 translate-middle"};function ya(e,a,o,l,n,r){const i=(0,t.up)("MDBBtn"),s=(0,t.up)("MDBModalBody"),u=(0,t.up)("MDBModal"),c=(0,t.up)("ModalNuevoCliente");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(u,{id:"modalClientes",tabindex:"-1",labelledby:"tituloModalClientes",modelValue:l.modalClientes,"onUpdate:modelValue":a[7]||(a[7]=e=>l.modalClientes=e),staticBackdrop:"",size:"xl"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t._)("div",sa,[(0,t._)("div",da,[(0,t.Wm)(i,{color:"warning",class:"sizeBotones",onClick:a[0]||(a[0]=e=>l.clickClienteAtajo("CliBoti_000_{A83B364B-252F-464B-B0C3-AA89DA258F64}"))},{default:(0,t.w5)((()=>[(0,t.Uk)("Glovo")])),_:1}),(0,t.Wm)(i,{color:"dark",class:"ms-2 sizeBotones",onClick:a[1]||(a[1]=e=>l.clickClienteAtajo("CliBoti_000_{2713C1E3-06C0-4099-851D-33018FD4851C}"))},{default:(0,t.w5)((()=>[(0,t.Uk)("Uber")])),_:1}),(0,t.Wm)(i,{color:"primary",class:"ms-2 sizeBotones",onClick:a[2]||(a[2]=e=>l.clickClienteAtajo("CliBoti_000_{7A6EA7B0-3229-4A94-81EA-232F4666A7BE}"))},{default:(0,t.w5)((()=>[(0,t.Uk)("To Go")])),_:1}),(0,t.Wm)(i,{color:"success",class:"ms-2 sizeBotones",onClick:a[3]||(a[3]=e=>l.modalNuevoClienteRef.abrirModal())},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("nuevo","Nuevo")),1)])),_:1}),(0,t.Wm)(i,{color:"danger",class:"ms-2 sizeBotones",onClick:a[4]||(a[4]=e=>l.modalClientes=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("salir","Salir")),1)])),_:1})])]),(0,t._)("div",ua,[(0,t._)("div",ca,[(0,t.wy)((0,t._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:"Buscar por nombre","aria-label":".form-control-lg example","onUpdate:modelValue":a[5]||(a[5]=e=>l.inputBusqueda=e)},null,512),[[X.nr,l.inputBusqueda]])]),(0,t._)("div",ma,[(0,t.Wm)(i,{color:"secondary",class:"botonBusqueda w-100",onClick:a[6]||(a[6]=e=>l.buscar())},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("buscar","Buscar")),1)])),_:1})])]),l.arrayClientes?.length>0?((0,t.wg)(),(0,t.iD)("div",pa,[(0,t._)("div",va,[(0,t._)("div",fa,[(0,t._)("table",ba,[(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.arrayClientes,((a,o)=>((0,t.wg)(),(0,t.iD)("tr",{key:o},[(0,t._)("td",null,[(0,t._)("span",Ca,(0,d.zw)(a.nombre),1)]),(0,t._)("td",null,[(0,t.Wm)(i,{color:"primary",size:"lg",onClick:e=>l.selectCliente(a.id,a.nombre),class:"w-100",style:{height:"3.85rem","font-size":"1.5rem"}},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("elegir","Elegir")),1)])),_:2},1032,["onClick"])])])))),128))])])])])])):((0,t.wg)(),(0,t.iD)("div",_a,[(0,t._)("div",wa,[(0,t._)("span",Ma,(0,d.zw)(e.$t("sin_resultados","Sin resultados")),1)])]))])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(c,{ref:"modalNuevoClienteRef"},null,512)],64)}const ga={class:"row mt-1 p-4"},ka={class:"col-md-8"},Ba={class:"col-md-4"},ha={class:"row p-4"},Da={class:"col-md-8"},Aa={class:"col-md-4 sizeModalClientes"},Ta={class:"row"},xa={class:"d-inline-block text-end"};function Ia(e,a,o,l,n,r){const i=(0,t.up)("MDBBtn"),s=(0,t.up)("MDBModalBody"),u=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(u,{id:"modalNuevoCliente",tabindex:"-1",labelledby:"tituloModalClientes",modelValue:l.modalNuevoCliente,"onUpdate:modelValue":a[4]||(a[4]=e=>l.modalNuevoCliente=e),staticBackdrop:"",size:"xl"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t._)("div",ga,[(0,t._)("div",ka,[(0,t.wy)((0,t._)("input",{class:"form-control inputNombreCliente w-100",type:"text",placeholder:"Nombre del cliente","aria-label":".form-control-lg example","onUpdate:modelValue":a[0]||(a[0]=e=>l.inputNombreCliente=e)},null,512),[[X.nr,l.inputNombreCliente]])]),(0,t._)("div",Ba,[(0,t.Wm)(i,{color:"secondary",class:"botonBusqueda w-100",disabled:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("nombre","Nombre")),1)])),_:1})])]),(0,t._)("div",ha,[(0,t._)("div",Da,[(0,t.wy)((0,t._)("input",{class:"form-control inputNombreCliente w-100",type:"text",placeholder:"Código tarjeta","aria-label":".form-control-lg example","onUpdate:modelValue":a[1]||(a[1]=e=>l.inputCodigoTarjeta=e)},null,512),[[X.nr,l.inputCodigoTarjeta]])]),(0,t._)("div",Aa,[(0,t.Wm)(i,{color:"secondary",class:"botonBusqueda w-100",disabled:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("cod_tarjeta","Cód. tarjeta")),1)])),_:1})])]),(0,t._)("div",Ta,[(0,t._)("div",xa,[(0,t.Wm)(i,{color:"primary",class:"ms-2 sizeBotones",onClick:a[2]||(a[2]=e=>l.crearCliente())},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("crear","Crear")),1)])),_:1}),(0,t.Wm)(i,{color:"danger",class:"ms-2 sizeBotones",onClick:a[3]||(a[3]=e=>l.modalNuevoCliente=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("atras","Atrás")),1)])),_:1})])])])),_:1})])),_:1},8,["modelValue"])}var za={name:"ModalNuevoClienteComponent",components:{MDBModal:z.j3,MDBModalBody:z.Yz,MDBBtn:z.$v},setup(e,a){const o=(0,A.iH)(!1),t=(0,A.iH)(""),l=(0,A.iH)("");function n(){o.value=!0}function r(){U.Z.post("clientes/crearNuevoCliente",{idTarjetaCliente:l.value,nombreCliente:t.value}).then((e=>{if(!e.data)throw Error("No se ha podido crear el cliente. backend");W().fire({icon:"success",title:"Cliente creado correctamente",showConfirmButton:!1,timer:2e3}),o.value=!1})).catch((e=>{W().fire("Oops...",e.message,"error")}))}return a.expose({abrirModal:n}),{inputCodigoTarjeta:l,modalNuevoCliente:o,inputNombreCliente:t,crearCliente:r}}};const Sa=(0,b.Z)(za,[["render",Ia],["__scopeId","data-v-d5ef2184"]]);var Ua=Sa,Ea={name:"ModalClientesComponent",components:{MDBModal:z.j3,MDBModalBody:z.Yz,MDBBtn:z.$v,ModalNuevoCliente:Ua},setup(e,a){const o=(0,v.oR)(),l=(0,A.iH)(!1),n=(0,A.iH)(0),r=(0,A.iH)(""),i=(0,A.iH)(),s=(0,A.iH)(null),d=(0,t.f3)("actualizarPuntos"),u=(0,t.Fl)((()=>o.state.Trabajadores.arrayTrabajadores)),c=(0,t.Fl)((()=>o.state.Trabajadores.indexActivo)),m=(0,t.Fl)((()=>u.value&&void 0!=c.value&&null!=c.value&&u.value[c.value]?u.value[c.value]:null)),p=(0,t.Fl)((()=>o.state.Cestas.arrayCestas));function f(){l.value=!0}function b(){n.value++}function C(e){U.Z.post("clientes/getClienteById",{idCliente:e}).then((a=>{if(!a.data)throw Error("No se ha podido obtener la información del cliente. backend");_(e,a.data.nombre)})).catch((e=>{W().fire("Oops...",e.message,"error")}))}function _(e,a){if(p.value)for(let t=0;t<p.value.length;t++)if(m.value.idCesta===p.value[t]._id){o.dispatch("Cestas/setClienteCesta",{index:t,idCliente:e,nombreCliente:a}),o.dispatch("EstadoDinamico/setVistaCliente",!0),d(),l.value=!1;break}}function w(){U.Z.post("clientes/buscar",{busqueda:r.value}).then((e=>{i.value=e.data})).catch((e=>{W().fire("Oops...",e.message,"error")}))}return(0,t.YP)(r,(()=>{w()})),a.expose({abrirModal:f,datoBorrar:n,selectCliente:_}),{test:b,datoBorrar:n,modalClientes:l,inputBusqueda:r,arrayClientes:i,selectCliente:_,buscar:w,modalNuevoClienteRef:s,clickClienteAtajo:C}}};const Wa=(0,b.Z)(Ea,[["render",ya],["__scopeId","data-v-7b36cf97"]]);var ja=Wa;const Na={class:"row mt-1 p-4"},Ha={class:"col-md-8"},Va={class:"col-md-4"},Oa={key:0,class:"row"},Ra={class:"col"},Fa={class:"table-responsive w-100",style:{height:"400px"}},Pa={class:"table table-striped mt-1"},Za={class:"textoNombre d-inline-block text-truncate"},$a={key:1,class:"row"},qa={class:"sinResultados position-relative"},La={class:"textoSinResultados position-absolute top-50 start-50 translate-middle"};function Ya(e,a,o,l,n,r){const i=(0,t.up)("MDBBtn"),s=(0,t.up)("MDBModalBody"),u=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(u,{id:"modalArticulos",tabindex:"-1",labelledby:"tituloModalArticulos",modelValue:l.modalArticulos,"onUpdate:modelValue":a[2]||(a[2]=e=>l.modalArticulos=e),size:"xl"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t._)("div",Na,[(0,t._)("div",Ha,[(0,t.wy)((0,t._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:"Buscar por nombre de artículo","aria-label":".form-control-lg example","onUpdate:modelValue":a[0]||(a[0]=e=>l.inputBusqueda=e)},null,512),[[X.nr,l.inputBusqueda]])]),(0,t._)("div",Va,[(0,t.Wm)(i,{color:"secondary",class:"botonBusqueda w-100",onClick:a[1]||(a[1]=e=>l.buscar())},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("buscar","Buscar")),1)])),_:1})])]),l.arrayArticulos?.length>0?((0,t.wg)(),(0,t.iD)("div",Oa,[(0,t._)("div",Ra,[(0,t._)("div",Fa,[(0,t._)("table",Pa,[(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.arrayArticulos,((a,o)=>((0,t.wg)(),(0,t.iD)("tr",{key:o},[(0,t._)("td",null,[(0,t._)("span",Za,(0,d.zw)(a.nombre),1)]),(0,t._)("td",null,[(0,t.Wm)(i,{color:"primary",size:"lg",onClick:e=>l.selectArticulo({idArticle:a._id,esSumable:a.esSumable}),class:"w-100",style:{height:"3.85rem","font-size":"1.5rem"}},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("elegir","Elegir")),1)])),_:2},1032,["onClick"])])])))),128))])])])])])):((0,t.wg)(),(0,t.iD)("div",$a,[(0,t._)("div",qa,[(0,t._)("span",La,(0,d.zw)(e.$t("sin_resultados","Sin resultados")),1)])]))])),_:1})])),_:1},8,["modelValue"])}var Ja={name:"ModalArticulosComponent",components:{MDBModal:z.j3,MDBModalBody:z.Yz,MDBBtn:z.$v},setup(e,a){const o=(0,A.iH)(!1),l=(0,A.iH)(0),n=(0,A.iH)(""),r=(0,A.iH)(),i=(0,t.f3)("clickTecla");function s(e){i(e),o.value=!1}function d(){o.value=!0}function u(){l.value++}function c(){U.Z.post("articulos/buscar",{busqueda:n.value}).then((e=>{r.value=e.data})).catch((e=>{W().fire("Oops...",e.message,"error")}))}return(0,t.YP)(n,(()=>{c()})),a.expose({abrirModal:d,datoBorrar:l}),{test:u,datoBorrar:l,modalArticulos:o,inputBusqueda:n,arrayArticulos:r,buscar:c,selectArticulo:s}}};const Ga=(0,b.Z)(Ja,[["render",Ya],["__scopeId","data-v-79cdfc4c"]]);var Ka=Ga;const Qa={class:"row"},Xa={class:"row"},eo={class:"text-center"};function ao(e,a,o,l,n,r){const i=(0,t.up)("MDBModalTitle"),s=(0,t.up)("MDBModalHeader"),u=(0,t.up)("NumpadComponent"),c=(0,t.up)("MDBModalBody"),m=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(m,{id:"modalUnidades",tabindex:"-1",labelledby:"modalUnidadesLabel",modelValue:l.modalUnidades,"onUpdate:modelValue":a[1]||(a[1]=e=>l.modalUnidades=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t.Wm)(i,{id:"modalUnidadesLabel"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.$t("introduce","Introduce"))+" "+(0,d.zw)(e.$t("las_unidades","las unidades"))+" "+(0,d.zw)(e.$t("y_marca","y marca"))+" "+(0,d.zw)(e.$t("un_articulo","un artículo")),1)])),_:1})])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t._)("div",Qa,[l.refUnidadesComponent?(0,t.wy)(((0,t.wg)(),(0,t.iD)("input",{key:0,type:"text",class:"form-control sizeUnidades",disabled:"","onUpdate:modelValue":a[0]||(a[0]=e=>l.refUnidadesComponent.cantidad=e)},null,512)),[[X.nr,l.refUnidadesComponent.cantidad]]):(0,t.kq)("",!0)]),(0,t._)("div",Xa,[(0,t._)("div",eo,[(0,t.Wm)(u,{ref:"refUnidadesComponent"},null,512)])])])),_:1})])),_:1},8,["modelValue"])}var oo={name:"UnidadesComponent",components:{NumpadComponent:S.Z,MDBModal:z.j3,MDBModalBody:z.Yz,MDBModalHeader:z.ol,MDBModalTitle:z.wo},setup(){const e=(0,A.iH)(null),a=(0,A.iH)(null),o=(0,v.oR)();function l(){a.value=!0}function n(e){o.dispatch("Unidades/setUnidades",e),a.value=!1}return(0,t.JJ)("okValue",n),{refUnidadesComponent:e,modalUnidades:a,abrirModal:l}}};const to=(0,b.Z)(oo,[["render",ao],["__scopeId","data-v-37288cef"]]);var lo=to,no={name:"MenuIzquierdaComponent",components:{MDBBtnGroup:z.Ff,MDBBtn:z.$v,MDBIcon:z.vm,ModalClientesComponent:ja,ModalArticulosComponent:Ka,ModalUnidadesComponent:lo},setup(e,{expose:a}){const o=(0,v.oR)(),l=(0,t.Fl)((()=>o.state.Configuracion.parametros)),n=(0,A.iH)(null),r=(0,A.iH)(null),i=(0,A.iH)(null),s=(0,A.iH)(null),d=(0,t.Fl)((()=>o.state.EstadoDinamico.vistaEspecial)),u=(0,t.Fl)((()=>o.state.Cestas.arrayCestas)),c=(0,t.Fl)((()=>o.state.Trabajadores.arrayTrabajadores)),m=(0,t.Fl)((()=>o.state.Cestas.indexItemActivo)),p=(0,t.Fl)((()=>o.state.Trabajadores.indexActivo));let f="";const b=(0,A.iH)(!1),C=(0,t.Fl)((()=>{if(u.value)for(let e=0;e<u.value.length;e++)if(c.value&&c.value[p.value]&&u.value[e]._id==c.value[p.value].idCesta)return u.value[e];return null}));function _(){null!=m.value&&void 0!=m.value&&C.value&&o.dispatch("Cestas/deleteIndex",{index:m.value,idCesta:C.value._id})}function w(){C.value&&o.dispatch("Cestas/deleteLista",C.value._id)}function M(){d.value?o.dispatch("EstadoDinamico/setVistaCliente",!1):o.dispatch("EstadoDinamico/setVistaCliente",!0)}function y(e){ia.Z.push(e)}function g(e){U.Z.post("clientes/consultarPuntos",{idCliente:e}).then((e=>{if("number"!==typeof e.data)throw Error("No se ha podido obtener la información del cliente");W().fire(`Puntos: ${e.data}`,"","info")})).catch((e=>{W().fire("Oops...",e.message,"error")}))}async function k(){if(u.value&&C.value)for(let e=0;e<u.value.length;e++)if(u.value[e]._id===C.value._id){o.dispatch("Unidades/setUnidades",1),await o.dispatch("Cestas/setModoCesta",{index:e,modo:"VENTA"}),o.dispatch("Cestas/setClienteCesta",{index:e,idCliente:null,nombreCliente:null}),o.dispatch("EstadoDinamico/reset");break}}function B(e){U.Z.post("clientes/getClienteByNumber",{idTarjeta:e}).then((a=>{a.data?n.value.selectCliente(e,a.data.nombre):W().fire({icon:"error",title:"No lo hemos podido leer correctamente, reintentalo de nuevo.",showConfirmButton:!1,timer:1500})})).catch((e=>{W().fire("Oops...",e.message,"error")}))}function h(e){if("Enter"==e)return B(f),void(f="");f+=e}function D(){U.Z.post("tickets/getUltimoTicket").then((e=>{e.data[0]?._id?(s.value=e.data[0]._id,U.Z.post("impresora/imprimirTicket",{idTicket:s.value}).catch((e=>{W().fire("Oops...",e.message,"error")}))):W().fire("AVISO","Crea un ticket en esta caja abierta","info")}))}return a({resetGeneral:k}),(0,t.bv)((()=>{C.value&&(C.value.idCliente||"VENTA"!=C.value.modo)&&o.dispatch("EstadoDinamico/setVistaCliente",!0),U.Z.post("parametros/getParametros").then((e=>{void 0!=e.data?.params?.prohibirBuscarArticulos?"Si"==e.data?.params?.prohibirBuscarArticulos&&(b.value=!0):b.value=!1}))})),{indexActivoCesta:m,borrarItem:_,borrarLista:w,vistaEspecial:d,changeVistaCliente:M,cesta:C,goTo:y,refModalClientes:n,refModalArticulos:r,refModalUnidades:i,resetGeneral:k,consultarPuntos:g,parametros:l,NoBuscarProducte:b,imprimirUltimoTicket:D,idTicket:s,getTarjetaCliente:h,tarjetaClienteNumero:f}},methods:{onKeydown(e){this.getTarjetaCliente(e.key)}},mounted(){document.addEventListener("keydown",this.onKeydown)}};const ro=(0,b.Z)(no,[["render",ra],["__scopeId","data-v-ad6427b6"]]);var io=ro;const so=e=>((0,t.dD)("data-v-1a5392fd"),e=e(),(0,t.Cn)(),e),uo={class:"row"},co={key:0,class:"nombreTrabajador text-center d-inline-block text-truncate"},mo={key:1,class:"nombreMesa d-inline-block text-truncate"},po={class:"row"},vo={class:"disponible"},fo={class:"again"},bo={key:2,src:"pay-loading.svg",alt:"Procesando pago",width:"200",height:"60"},Co={key:3,class:"d-inline text-center caritasContentas grupoContento pt-1"},_o={key:4,class:"d-inline text-center caritasTristes grupoTriste pt-1"},wo={class:"row mt-1"},Mo=so((()=>(0,t._)("span",{class:"letraTotal ms-3 mt-2"},null,-1))),yo={class:"letraTotal ms-3 mt-2"},go={class:"text-start fst-italic informacion"};function ko(e,a,o,l,n,r){const i=(0,t.up)("MDBBtn"),s=(0,t.up)("MDBIcon");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",uo,[l.trabajadorActivo?((0,t.wg)(),(0,t.iD)("span",co,(0,d.zw)(l.trabajadorActivo.nombreCorto),1)):(0,t.kq)("",!0),l.cesta&&l.cesta.indexMesa&&l.arrayMesas&&l.arrayMesas[l.cesta.indexMesa]?((0,t.wg)(),(0,t.iD)("span",mo,(0,d.zw)(e.$t("mesa","Mesa"))+" "+(0,d.zw)(l.arrayMesas[l.cesta.indexMesa].nombre),1)):(0,t.kq)("",!0)]),(0,t._)("div",po,[""===l.estadoDatafono?((0,t.wg)(),(0,t.j4)(i,{key:0,outline:"primary",class:"botonEstado"},{default:(0,t.w5)((()=>[(0,t._)("span",vo,(0,d.zw)(e.$t("datafono_disponible","Datáfono disponible")),1)])),_:1})):(0,t.kq)("",!0),"AGAIN"===l.estadoDatafono?((0,t.wg)(),(0,t.j4)(i,{key:1,outline:"warning",class:"botonEstado",onClick:a[0]||(a[0]=e=>l.tarjetaUltimoTicket())},{default:(0,t.w5)((()=>[(0,t._)("span",fo,(0,d.zw)(e.$t("reintentar_pago","Reintentar pago")),1)])),_:1})):(0,t.kq)("",!0),"PENDIENTE"===l.estadoDatafono?((0,t.wg)(),(0,t.iD)("img",bo)):(0,t.kq)("",!0),"APROBADA"===l.estadoDatafono?((0,t.wg)(),(0,t.iD)("div",Co,[(0,t.Wm)(s,{class:"d-inline",icon:"grin-alt",iconStyle:"far",size:"3x"}),(0,t.Wm)(s,{class:"d-inline ms-2",icon:"grin-alt",iconStyle:"far",size:"3x"}),(0,t.Wm)(s,{class:"d-inline ms-2",icon:"grin-alt",iconStyle:"far",size:"3x"}),(0,t.Wm)(s,{class:"d-inline ms-2",icon:"grin-alt",iconStyle:"far",size:"3x"})])):(0,t.kq)("",!0),"DENEGADA"===l.estadoDatafono?((0,t.wg)(),(0,t.iD)("div",_o,[(0,t.Wm)(s,{class:"d-inline",icon:"frown",iconStyle:"far",size:"3x"}),(0,t.Wm)(s,{class:"d-inline ms-2",icon:"frown",iconStyle:"far",size:"3x"}),(0,t.Wm)(s,{class:"d-inline ms-2",icon:"frown",iconStyle:"far",size:"3x"}),(0,t.Wm)(s,{class:"d-inline ms-2",icon:"frown",iconStyle:"far",size:"3x"})])):(0,t.kq)("",!0)]),(0,t._)("div",wo,[l.cesta&&l.getTotal(l.cesta)>0&&"MODIFICAR_ARTICULO"!=l.modoActual&&"MOVER_ARTICULO"!=l.modoActual&&("CONSUMO_PERSONAL"===l.cesta.modo||"DEVOLUCION"===l.cesta.modo)?((0,t.wg)(),(0,t.j4)(i,{key:0,outline:"primary",class:"botonPagar",onClick:a[1]||(a[1]=e=>l.handleCobro())},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"hand-holding-usd",size:"5x"}),Mo])),_:1})):l.cesta&&l.getTotal(l.cesta)>0&&"CONSUMO_PERSONAL"!==l.cesta.modo?((0,t.wg)(),(0,t.j4)(i,{key:1,outline:"primary",class:"botonPagar",onClick:a[2]||(a[2]=e=>l.handleCobro())},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"hand-holding-usd",size:"5x"}),(0,t._)("span",yo,(0,d.zw)(l.getTotal(l.cesta).toFixed(2))+" € ",1)])),_:1})):(0,t.kq)("",!0),"MODIFICAR_ARTICULO"==l.modoActual?((0,t.wg)(),(0,t.j4)(i,{key:2,onClick:a[3]||(a[3]=e=>l.finalizarEdicion()),outline:"primary",class:"botonPagar"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{size:"5x",far:"",icon:"thumbs-up"})])),_:1})):(0,t.kq)("",!0),"MODIFICAR_ARTICULO"!=l.modoActual&&"MOVER_ARTICULO"!=l.modoActual&&l.cesta&&0===l.getTotal(l.cesta)?((0,t.wg)(),(0,t.j4)(i,{key:3,outline:"primary",class:"botonPagar",onClick:a[4]||(a[4]=e=>l.abrirCajon())},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"hand-holding-usd",size:"5x"})])),_:1})):(0,t.kq)("",!0),(0,t._)("span",go,"(v"+(0,d.zw)(l.tocVersion)+") ("+(0,d.zw)(l.nombreTienda)+") "+(0,d.zw)(l.getClock),1)])],64)}var Bo={name:"MenuDerechaComponent",components:{MDBIcon:z.vm,MDBBtn:z.$v},setup(){const e=(0,A.iH)(""),a=(0,A.iH)(""),o=(0,A.iH)(""),l=(0,v.oR)(),n=(0,Ve.tv)(),r=(0,A.iH)([]),i=(0,t.f3)("resetGeneral"),s=(0,t.Fl)((()=>l.state.Trabajadores.arrayTrabajadores)),d=(0,t.Fl)((()=>l.state.Cestas.arrayCestas)),u=(0,t.Fl)((()=>l.state.Trabajadores.indexActivo)),c=(0,t.Fl)((()=>l.state.Datafono.estado)),m=(0,t.Fl)((()=>l.state.modoActual)),p=(0,t.Fl)((()=>s.value&&void 0!=u.value&&null!=u.value&&s.value[u.value]?s.value[u.value]:null)),f=(0,t.Fl)((()=>{if(d.value)for(let e=0;e<d.value.length;e++)if(s.value&&s.value[u.value]&&d.value[e]._id==s.value[u.value].idCesta)return d.value[e];return null}));function b(e){return e.detalleIva.importe1+e.detalleIva.importe2+e.detalleIva.importe3+e.detalleIva.importe4+e.detalleIva.importe5}function C(){U.Z.get("mesas/getMesas").then((e=>{if(!e.data||50!==e.data.length)throw Error("Error al obtener la configuración de mesas");r.value=e.data})).catch((e=>{W().fire("Oops...",e.message,"error")}))}function _(e){n.push(e)}function w(){U.Z.post("impresora/abrirCajon"),W().fire("AVISO","elige un artículo para ir a cobrar","info")}function M(){l.dispatch("setModoActual","NORMAL")}function y(){U.Z.post("paytef/cobrarUltimoTicket",{idTrabajador:p.value._id}).then((()=>{l.dispatch("Datafono/setEstado","PENDIENTE")})).catch((e=>{W().fire("Oops...",e.message,"error")}))}async function g(){if(f.value)if("VENTA"===f.value.modo)if(f.value.idCliente&&""!=f.value.idCliente){const e=(await U.Z.post("clientes/getClienteById",{idCliente:f.value.idCliente})).data;!0===e?.albaran&&!0===e?.noPagaEnTienda?U.Z.post("tickets/crearTicket",{total:b(f.value),idCesta:f.value._id,idTrabajador:p.value._id,tipo:"DEUDA",tkrsData:null}).then((e=>{if(!e.data)throw Error("No se ha podido registrar la venta en modo deuda");W().fire({icon:"success",title:"Venta modo deuda registrada correctamente",showConfirmButton:!1,timer:2e3})})).catch((e=>{W().fire("Oops...",e.message,"error")})):(await U.Z.post("impresora/despedida",{precioTotal:b(f.value).toFixed(2)}),_("/cobro"))}else await U.Z.post("impresora/despedida",{precioTotal:b(f.value).toFixed(2)}),_("/cobro");else"DEVOLUCION"===f.value.modo?U.Z.post("devoluciones/nuevaDevolucion",{total:b(f.value),idCesta:f.value._id,idTrabajador:p.value._id}).then((e=>{if(!e.data)throw Error("No se ha podido crear la devolución");i(),W().fire({icon:"success",title:"Devolución creada correctamente",showConfirmButton:!1,timer:2e3})})).catch((e=>{W().fire("Oops...",e.message,"error")})):"CONSUMO_PERSONAL"===f.value.modo&&U.Z.post("tickets/crearTicket",{total:b(f.value),idCesta:f.value._id,idTrabajador:p.value._id,tipo:"CONSUMO_PERSONAL"}).then((e=>{if(!e.data)throw Error("No se ha podido crear el ticket de consumo personal");i(),W().fire({icon:"success",title:"Consumo personal registrado",showConfirmButton:!1,timer:1200})})).catch((e=>{W().fire("Oops...",e.message,"error")}));else W().fire("Oops...","El modo de la cesta es incorrecto","error")}function k(){const e=new Date,a=e.getSeconds(),t=e.getMinutes(),l=e.getHours();o.value=("0"+l).substr(-2)+":"+("0"+t).substr(-2)+":"+("0"+a).substr(-2)}return setInterval(k,1e3),(0,t.bv)((()=>{C(),U.Z.get("getInfo/tocGame").then((o=>{void 0!=o.data&&null!=o.data&&(e.value=o.data.version,a.value=o.data.nombreTienda)})).catch((e=>{W().fire("Error en getVersion CATCH")}))})),{trabajadorActivo:p,estadoDatafono:c,cesta:f,arrayMesas:r,getTotal:b,goTo:_,abrirCajon:w,tarjetaUltimoTicket:y,modoActual:m,handleCobro:g,tocVersion:e,nombreTienda:a,getClock:o,finalizarEdicion:M}}};const ho=(0,b.Z)(Bo,[["render",ko],["__scopeId","data-v-1a5392fd"]]);var Do=ho,Ao=o(2066),To=o(9534),xo={name:"MainView",components:{MenusComponent:_,SubmenusComponent:B,TeclasComponent:Fe,CestaComponent:aa,MenuIzquierdaComponent:io,MenuDerechaComponent:Do,ModalErrorDatafonoComponent:To.Z},setup(){const e=(0,Ve.tv)(),a=(0,A.iH)(null),o=(0,A.iH)(null),l=(0,A.iH)(null),n=(0,Ao.io)("http://localhost:5051"),r=(0,A.iH)(null);function i(e){a.value.clickTecla(e)}const s=(0,v.oR)(),d=(0,t.Fl)((()=>s.state.Trabajadores.arrayTrabajadores)),u=(0,t.Fl)((()=>s.state.Trabajadores.indexActivo)),c=(0,t.Fl)((()=>d.value&&void 0!=u.value&&null!=u.value&&d.value[u.value]?d.value[u.value]:null));function m(){o.value.resetGeneral()}function p(){l.value.actualizarPuntos()}return(0,t.JJ)("clickTecla",i),(0,t.JJ)("resetGeneral",m),(0,t.JJ)("actualizarPuntos",p),n.on("consultaPaytefRefund",(e=>{e.ok||r.value.abrirModal(e.id)})),(0,t.bv)((()=>{U.Z.get("caja/estadoCaja").then((a=>{!a.data&&c.value?e.push("/abrirCaja"):a.data||c.value||e.push("/menu/fichajes")})).catch((e=>{W().fire("Oops...",e.message,"error")}))})),{arrayTrabajadores:d,indexTrabajadorActivo:u,trabajadorActivo:c,refTeclasComponent:a,refMenuIzquierda:o,cestaRef:l,modalErrorDatafonoRef:r}}};const Io=(0,b.Z)(xo,[["render",s]]);var zo=Io}}]);
//# sourceMappingURL=807.a6599bcd.js.map