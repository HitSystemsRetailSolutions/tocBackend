"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[877],{61562:function(e,a,l){l.d(a,{Z:function(){return p}});var o=l(73396),t=l(87139);const n=["onClick"],i={class:"botonTecladoSpaceDiv"};function d(e,a,l,d,u,s){const c=(0,o.up)("MDBInput"),r=(0,o.up)("MDBModalHeader"),v=(0,o.up)("MDBModalBody"),p=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(p,{frame:"",position:"bottom",id:"keyBoardModal",tabindex:"-1",labelledby:"keyBoardModal",modelValue:d.keyBoardModal,"onUpdate:modelValue":a[4]||(a[4]=e=>d.keyBoardModal=e)},{default:(0,o.w5)((()=>[d.showInput?((0,o.wg)(),(0,o.j4)(r,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{style:{width:"80rem !important"},label:"Texto introducido",modelValue:d.text,"onUpdate:modelValue":a[0]||(a[0]=e=>d.text=e)},null,8,["modelValue"])])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(v,{class:"mainDiv"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(d.chars.length,((e,a)=>((0,o.wg)(),(0,o.iD)("div",{key:a},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(d.chars[e-1],((e,a)=>((0,o.wg)(),(0,o.iD)("div",{class:"btn-group-vertical mt-1 divTecla",key:a},[(0,o._)("button",{type:"button",style:(0,t.j5)([{"text-transform":"none"},d.keyStyle(e)]),class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a=>d.processTecla(e)},(0,t.zw)(e),13,n)])))),128))])))),128)),(0,o._)("div",i,[(0,o._)("button",{style:(0,t.j5)([{"font-size":"1.8rem"},d.keyStyle("✎")]),type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[1]||(a[1]=e=>d.processTecla("✎"))}," ✎ ",4),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonTecladoSpace",onClick:a[2]||(a[2]=e=>d.processTecla(" "))}," ␣ "),(0,o._)("button",{style:(0,t.j5)([{"font-size":"1.8rem"},d.keyStyle("#")]),type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[3]||(a[3]=e=>d.processTecla("#"))}," Ⅳ ",4)])])),_:1})])),_:1},8,["modelValue"])}var u=l(44870),s=l(74313),c={name:"KeyBoardComponent",components:{MDBIcon:s.vm,MDBModalBody:s.Yz,MDBModal:s.j3,MDBBtn:s.$v,MDBModalHeader:s.ol,MDBModalTitle:s.wo,MDBInput:s.u2,MDBModalFooter:s.ab},props:{value:String,text:String},setup(e,{expose:a}){const l=(0,u.iH)(e.value||""),t=(0,u.iH)(!1),n=(0,u.iH)(!1),i=(0,u.iH)(!1);let d=!1;const s=(0,u.iH)(!1),c=[["q","w","e","r","t","y","u","i","o","p","←"],["a","s","d","f","g","h","j","k","l","ñ","↵"],["z","x","c","v","b","n","m",",",".","-","⇪"]],r=(0,u.iH)([]);function v(e){switch(e){case"←":b();break;case"↵":t.value=!1;break;case"⇪":d=!d,l.value.length>0&&(n.value=!n.value),_();break;case"#":i.value=!i.value,_();break;case"✎":s.value=!s.value;break;default:m(e);break}}function p(e){let a=l.value.length<=0&&!d||n.value,o="background-color: #606060 !important; color: white !important;";return i.value&&"#"==e||s.value&&"✎"==e||"⇪"==e&&a?o:a?"text-transform: uppercase":"text-transform: none;"}function m(e){let a=l.value.length<=0&&!d||n.value;d=!1,a&&(e=e.toUpperCase()),l.value+=e}function b(){l.value.length>0&&(l.value=l.value.slice(0,-1))}function _(){let e=c;const a=["á","é","í","ó","ú","ü","¡","¿"];if(i.value){let a=[["1","2","3","4","5","6","7","8","9","0","ç"]];a=a.concat(c),e=a}r.value=e.map((e=>e.map((e=>a.includes(e)?[e,e.toUpperCase()]:e))))}function f(e=""){void 0===l.value&&(l.value=""),l.value=e,t.value=!0}function y(){return[l.value,t.value]}return a({getValue:y,abrirModal:f}),(0,o.bv)((()=>{_()})),{text:l,addTecla:m,deleteTecla:b,keyBoardModal:t,processTecla:v,upperCase:n,keyStyle:p,buildKeyboard:_,abrirModal:f,showInput:s,chars:r}}},r=l(40089);const v=(0,r.Z)(c,[["render",d],["__scopeId","data-v-c19133e2"]]);var p=v},11424:function(e,a,l){l.d(a,{Z:function(){return y}});var o=l(73396),t=l(87139);const n={class:"btn-group"},i={class:"btn-group"},d={class:"btn-group"},u={class:"btn-group"},s={class:"btn-group"};function c(e,a,l,c,r,v){return(0,o.wg)(),(0,o.iD)("div",{class:(0,t.C_)(["btn-group-vertical mt-1",{disabled:l.disabled}])},[(0,o._)("div",n,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[0]||(a[0]=e=>c.addTecla("1"))}," 1 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[1]||(a[1]=e=>c.addTecla("2"))}," 2 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[2]||(a[2]=e=>c.addTecla("3"))}," 3 ")]),(0,o._)("div",i,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[3]||(a[3]=e=>c.addTecla("4"))}," 4 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[4]||(a[4]=e=>c.addTecla("5"))}," 5 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[5]||(a[5]=e=>c.addTecla("6"))}," 6 ")]),(0,o._)("div",d,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[6]||(a[6]=e=>c.addTecla("7"))}," 7 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[7]||(a[7]=e=>c.addTecla("8"))}," 8 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[8]||(a[8]=e=>c.addTecla("9"))}," 9 ")]),(0,o._)("div",u,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[9]||(a[9]=e=>c.deleteTecla())}," < "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[10]||(a[10]=e=>c.addTecla("0"))}," 0 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[11]||(a[11]=e=>c.okValue(Number(c.cantidad)))}," OK ")]),(0,o._)("div",s,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonComa",onClick:a[12]||(a[12]=e=>c.addTecla("."))}," , ")])],2)}l(42492);var r=l(32066),v=l(66592),p=l(44870);const m=(0,r.io)("http://"+v.Z.state.TocGameURL+":5051");var b={props:{skipBalanza:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},name:"NumpadComponent",setup(e,{expose:a,emit:l}){const t=(0,p.iH)("0"),n=(0,o.f3)("okValue"),i=(0,p.iH)("5.5rem"),d=(0,p.iH)("5.5rem");(0,o.Fl)((()=>v.Z.state.Weight.lastWeight));function u(e){"."===e&&(t.value=t.value.replace(".","")),t.value+=e,"0"==t.value[0]&&(t.value=t.value.slice(1)),l("setValue",t.value)}function s(){t.value=t.value.slice(0,-1),""===t.value&&(t.value="0")}function c(e){t.value=Number(e).toString(),l("setValue",t.value)}return m.on("setBalanzaValue",(a=>{a&&!e.skipBalanza&&c(a)})),a({cantidad:t,setValor:c}),(0,o.bv)((async()=>{e.skipBalanza||c((await(0,o.Fl)((()=>v.Z.state.Weight.lastWeight))).value)})),{okValue:n,cantidad:t,addTecla:u,deleteTecla:s,setValor:c,anchoTecla:i,altoTecla:d}}},_=l(40089);const f=(0,_.Z)(b,[["render",c],["__scopeId","data-v-e6915a30"]]);var y=f},72877:function(e,a,l){l.r(a),l.d(a,{default:function(){return ve}});var o=l(73396),t=l(87139),n=l(49242);const i=e=>((0,o.dD)("data-v-8f0f7576"),e=e(),(0,o.Cn)(),e),d={class:"row p-2",style:{"text-align":"center"}},u=i((()=>(0,o._)("img",{src:"/img/1cts.png",width:"84",height:"84"},null,-1))),s=i((()=>(0,o._)("img",{src:"/img/2cts.png",width:"84",height:"84"},null,-1))),c=i((()=>(0,o._)("img",{src:"/img/5cts.png",width:"84",height:"84"},null,-1))),r=i((()=>(0,o._)("img",{src:"/img/10cts.png",width:"84",height:"84"},null,-1))),v=i((()=>(0,o._)("img",{src:"/img/20cts.png",width:"84",height:"84"},null,-1))),p=i((()=>(0,o._)("img",{src:"/img/50cts.png",width:"84",height:"84"},null,-1))),m=i((()=>(0,o._)("img",{src:"/img/uneuro.png",width:"84",height:"84"},null,-1))),b=i((()=>(0,o._)("img",{src:"/img/doseuros.png",width:"84",height:"84"},null,-1))),_={class:"row mx-auto mt-1"},f=["width"],y=i((()=>(0,o._)("br",null,null,-1))),g=["width"],w=i((()=>(0,o._)("br",null,null,-1))),C=["width"],k=i((()=>(0,o._)("br",null,null,-1))),D=["width"],B=i((()=>(0,o._)("br",null,null,-1))),z=["width"],h=i((()=>(0,o._)("br",null,null,-1))),M=["width"],T=i((()=>(0,o._)("br",null,null,-1))),x=["width"],H=i((()=>(0,o._)("br",null,null,-1))),j={class:"row"},A={class:"col-md-9"},V={key:0,style:{"font-size":"0.5rem",zoom:"0.6"},class:"spinner-border",role:"status"},W=i((()=>(0,o._)("span",{class:"visually-hidden"},"Loading...",-1))),$=[W],S={key:0},N={key:1},U={class:"d-flex"},P={class:"col-md-3 text-end"},Z={class:"row"},F={class:"col"},I={class:"input-group input-group-lg"},q={class:"input-group-text",id:"inputGroup-sizing-lg"},R={class:"row"},E={class:"col text-center"};function G(e,a,l,i,W,G){const Y=(0,o.up)("MDBCardTitle"),K=(0,o.up)("MDBIcon"),L=(0,o.up)("MDBPopover"),O=(0,o.up)("MDBCardText"),J=(0,o.up)("MDBBtn"),Q=(0,o.up)("MDBCardBody"),X=(0,o.up)("MDBCard"),ee=(0,o.up)("NumpadComponent"),ae=(0,o.up)("MDBModalTitle"),le=(0,o.up)("MDBModalHeader"),oe=(0,o.up)("MDBModalBody"),te=(0,o.up)("MDBModalFooter"),ne=(0,o.up)("MDBModal"),ie=(0,o.up)("ModalDescuadreComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",d,[(0,o._)("div",{class:"col",onClick:a[0]||(a[0]=e=>i.setActivo(0))},[u,(0,o._)("label",{class:(0,t.C_)([{seleccionado:0==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[0])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",onClick:a[1]||(a[1]=e=>i.setActivo(1))},[s,(0,o._)("label",{class:(0,t.C_)([{seleccionado:1==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[1])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",onClick:a[2]||(a[2]=e=>i.setActivo(2))},[c,(0,o._)("label",{class:(0,t.C_)([{seleccionado:2==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[2])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",onClick:a[3]||(a[3]=e=>i.setActivo(3))},[r,(0,o._)("label",{class:(0,t.C_)([{seleccionado:3==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[3])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",onClick:a[4]||(a[4]=e=>i.setActivo(4))},[v,(0,o._)("label",{class:(0,t.C_)([{seleccionado:4==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[4])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",onClick:a[5]||(a[5]=e=>i.setActivo(5))},[p,(0,o._)("label",{class:(0,t.C_)([{seleccionado:5==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[5])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",onClick:a[6]||(a[6]=e=>i.setActivo(6))},[m,(0,o._)("label",{class:(0,t.C_)([{seleccionado:6==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[6])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",onClick:a[7]||(a[7]=e=>i.setActivo(7))},[b,(0,o._)("label",{class:(0,t.C_)([{seleccionado:7==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[7])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)])]),(0,o._)("div",_,[(0,o._)("div",{class:"col",style:{"text-align":"center"},onClick:a[8]||(a[8]=e=>i.setActivo(8))},[(0,o._)("img",{src:"/img/5euros.png",width:i.sizeBilletes},null,8,f),(0,o.Uk)(),y,(0,o._)("label",{class:(0,t.C_)([{seleccionado:8==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[8])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",style:{"text-align":"center"},onClick:a[9]||(a[9]=e=>i.setActivo(9))},[(0,o._)("img",{src:"/img/10euros.png",width:i.sizeBilletes},null,8,g),w,(0,o._)("label",{class:(0,t.C_)([{seleccionado:9==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[9])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",style:{"text-align":"center"},onClick:a[10]||(a[10]=e=>i.setActivo(10))},[(0,o._)("img",{src:"/img/20euros.png",width:i.sizeBilletes},null,8,C),k,(0,o._)("label",{class:(0,t.C_)([{seleccionado:10==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[10])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",style:{"text-align":"center"},onClick:a[11]||(a[11]=e=>i.setActivo(11))},[(0,o._)("img",{src:"/img/50euros.png",width:i.sizeBilletes},null,8,D),B,(0,o._)("label",{class:(0,t.C_)([{seleccionado:11==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[11])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",style:{"text-align":"center"},onClick:a[12]||(a[12]=e=>i.setActivo(12))},[(0,o._)("img",{src:"/img/100euros.png",width:i.sizeBilletes},null,8,z),h,(0,o._)("label",{class:(0,t.C_)([{seleccionado:12==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[12])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",style:{"text-align":"center"},onClick:a[13]||(a[13]=e=>i.setActivo(13))},[(0,o._)("img",{src:"/img/200euros.png",width:i.sizeBilletes},null,8,M),T,(0,o._)("label",{class:(0,t.C_)([{seleccionado:13==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[13])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)]),(0,o._)("div",{class:"col",style:{"text-align":"center"},onClick:a[14]||(a[14]=e=>i.setActivo(14))},[(0,o._)("img",{src:"/img/500euros.png",width:i.sizeBilletes},null,8,x),H,(0,o._)("label",{class:(0,t.C_)([{seleccionado:14==i.indexActivo},"unidadesSize"])},(0,t.zw)(i.infoDinero[14])+" "+(0,t.zw)(e.$t("unidades","unidades")),3)])]),(0,o._)("div",j,[(0,o._)("div",A,[(0,o.Wm)(X,{class:"sizeInfoCaja"},{default:(0,o.w5)((()=>[(0,o.Wm)(Q,null,{default:(0,o.w5)((()=>[(0,o.Wm)(Y,{class:"estiloTituloInfo"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("informacion_de_la_caja","Información de la caja")),1)])),_:1}),(0,o.Wm)(O,{class:"estiloInfoCaja sizeCajaInfo"},{default:(0,o.w5)((()=>[(0,o._)("p",null,[(0,o.Wm)(K,{icon:"money-bill"}),(0,o.Uk)("   "+(0,t.zw)(e.$t("total_contado","Total contado"))+": "+(0,t.zw)(i.total)+" € ",1)]),(0,o._)("p",{onMouseover:a[16]||(a[16]=e=>{i.popOverTotalPaytef=!0}),onMouseleave:a[17]||(a[17]=e=>i.popOverTotalPaytef=!1)},[(0,o.Wm)(K,{icon:"credit-card"}),(0,o.Uk)("   "+(0,t.zw)(e.$t("total_paytef","Total Datáfono "))+" : ",1),null==i.totalPaytef?((0,o.wg)(),(0,o.iD)("div",V,$)):(0,o.kq)("",!0),(0,o.Uk)(" "+(0,t.zw)(null==i.totalPaytef?"":i.totalPaytef.toFixed(2)+" €")+"  ",1),null!=i.totalPaytef?((0,o.wg)(),(0,o.j4)(K,{key:1,icon:i.isLanPaytef?"ethernet":"globe"},null,8,["icon"])):(0,o.kq)("",!0),(0,o.Wm)(L,{modelValue:i.popOverTotalPaytef,"onUpdate:modelValue":a[15]||(a[15]=e=>i.popOverTotalPaytef=e),direction:"right"},{header:(0,o.w5)((()=>[(0,o.Uk)("Ultima conexión")])),body:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(i.hourPaytef),1)])),_:1},8,["modelValue"])],32),i.trabajadorActivo?((0,o.wg)(),(0,o.iD)("p",S,[(0,o.Wm)(K,{icon:"user"}),(0,o.Uk)("   "+(0,t.zw)(e.$t("dependienta_responsable","Dependienta responsable"))+": ",1),(0,o._)("i",null,(0,t.zw)(i.trabajadorActivo.nombre),1)])):(0,o.kq)("",!0),i.trabajadorActivo?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("p",N,[(0,o.Wm)(K,{icon:"user"}),(0,o._)("i",null,"   "+(0,t.zw)(e.$t("sin_dependienta_responsable","Sin dependienta responsable")),1)])),(0,o._)("div",{class:"d-flex",onClick:a[18]||(a[18]=e=>i.setCambioEmergencia())},[(0,o._)("p",null,[(0,o.Wm)(K,{icon:"box"}),(0,o.Uk)("   "),(0,o._)("span",{class:(0,t.C_)([{seleccionado:i.cambioEmActivo},"border border-2 rounded"])},(0,t.zw)(e.$t("cambio_de_emergencia","Cambio de emergencia"))+": "+(0,t.zw)(i.cambioEmergencia)+" €",3)])])])),_:1}),(0,o._)("div",U,[(0,o.Wm)(J,{color:"primary",class:"w-100",size:"lg",onClick:a[19]||(a[19]=e=>i.confirmarCierre()),disabled:i.botonesBloqueados},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("cerrar_caja","Cerrar caja")),1)])),_:1},8,["disabled"]),i.estadoTurno?((0,o.wg)(),(0,o.j4)(J,{key:0,onClick:a[20]||(a[20]=e=>i.cambioTurno()),color:"primary",class:"w-50",size:"lg",disabled:i.botonesBloqueados},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("anular_cambio_turno","Anular cambio turno")),1)])),_:1},8,["disabled"])):((0,o.wg)(),(0,o.j4)(J,{key:1,onClick:a[21]||(a[21]=e=>i.anularTurno()),color:"primary",class:"w-50",size:"lg",disabled:i.botonesBloqueados},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("cambio_turno","Cambio turno")),1)])),_:1},8,["disabled"]))])])),_:1})])),_:1})]),(0,o._)("div",P,[(0,o.Wm)(ee,{ref:"numpadRef"},null,512)])]),(0,o.Wm)(ne,{id:"modalConfirmar",tabindex:"-1",labelledby:"modalConfirmarLabel",modelValue:i.modalConfirmar,"onUpdate:modelValue":a[25]||(a[25]=e=>i.modalConfirmar=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(le,null,{default:(0,o.w5)((()=>[(0,o.Wm)(ae,{id:"modalConfirmarLabel"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("confirmacion_de_cierre","Confirmación de cierre")),1)])),_:1})])),_:1}),(0,o.Wm)(oe,null,{default:(0,o.w5)((()=>[(0,o._)("div",Z,[(0,o._)("div",F,[(0,o._)("div",I,[(0,o._)("span",q,(0,t.zw)(e.$t("datafono_manual","Datáfono manual")),1),i.numpadRef2?(0,o.wy)(((0,o.wg)(),(0,o.iD)("input",(0,o.dG)({key:0,type:"text",class:"form-control","onUpdate:modelValue":a[22]||(a[22]=e=>i.numpadRef2.cantidad=e)},(0,o.mx)(i.cargarTotal3G(),!0)),null,16)),[[n.nr,i.numpadRef2.cantidad]]):(0,o.kq)("",!0)])])]),(0,o._)("div",R,[(0,o._)("div",E,[(0,o.Wm)(ee,{skipBalanza:!0,ref:"numpadRef2",onSetValue:i.setTotal3G},null,8,["onSetValue"])])])])),_:1}),(0,o.Wm)(te,null,{default:(0,o.w5)((()=>[(0,o.Wm)(J,{color:"secondary",onClick:a[23]||(a[23]=e=>i.modalConfirmar=!1),size:"lg"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("cerrar","Cerrar")),1)])),_:1}),(0,o.Wm)(J,{color:"primary",size:"lg",onClick:a[24]||(a[24]=e=>i.cerrarCaja()),disabled:i.botonesBloqueados},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("confirmar_cierre","Confirmar cierre")),1)])),_:1},8,["disabled"])])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(ie,{ref:"modalDescuadreRef",onForzarCierre:i.cerrarCaja},null,8,["onForzarCierre"])],64)}l(57658);var Y=l(44870),K=l(11424),L=l(74313),O=l(20065),J=l(42492),Q=l.n(J),X=l(91076),ee=l(22483),ae=l(74834);const le=e=>((0,o.dD)("data-v-8bc30172"),e=e(),(0,o.Cn)(),e),oe=le((()=>(0,o._)("label",{for:"descExplanation",class:"form-label"}," Explica la razón del descuadre antes de forzar el cierre (opcional): ",-1)));function te(e,a,l,i,d,u){const s=(0,o.up)("MDBIcon"),c=(0,o.up)("MDBModalTitle"),r=(0,o.up)("MDBModalHeader"),v=(0,o.up)("MDBModalBody"),p=(0,o.up)("MDBBtn"),m=(0,o.up)("MDBModalFooter"),b=(0,o.up)("MDBModal"),_=(0,o.up)("KeyBoardComponentVue");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(b,{id:"modalDescuadre",tabindex:"-1",labelledby:"tituloModalDescuadre",modelValue:i.modalDescuadre,"onUpdate:modelValue":a[2]||(a[2]=e=>i.modalDescuadre=e),staticBackdrop:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{showCloseButton:!1},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{fas:"",icon:"exclamation-circle",class:"text-warning me-2"}),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Uk)("El descuadre es grande")])),_:1})])),_:1}),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[oe,(0,o.wy)((0,o._)("textarea",{"onUpdate:modelValue":a[0]||(a[0]=e=>i.reasonDesc=e),class:"form-control",rows:"3",placeholder:"Razón del descuadre...",onClick:a[1]||(a[1]=e=>i.openKeyboard()),readonly:""},null,512),[[n.nr,i.reasonDesc]])])),_:1}),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,{color:"secondary",onClick:i.onCancel},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("volver_a_contar","Volver a contar")),1)])),_:1},8,["onClick"]),(0,o.Wm)(p,{color:"primary",onClick:i.onConfirm,disabled:i.isLoading},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("forzar_cierre","Forzar cierre")),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(_,{ref:"keyboardRef"},null,512)],64)}var ne=l(61562),ie={name:"modalDescuadreComponent",components:{MDBModal:L.j3,MDBModalHeader:L.ol,MDBModalTitle:L.wo,MDBModalBody:L.Yz,MDBModalFooter:L.ab,MDBBtn:L.$v,KeyBoardComponentVue:ne.Z,MDBIcon:L.vm},setup(e,{expose:a,emit:l}){const o=(0,Y.iH)(!1),t=(0,Y.iH)(0),n=(0,Y.iH)(""),i=(0,Y.iH)(!1),d=(0,Y.iH)(null);function u(e=0){o.value=!0,t.value=e}const s=()=>{r(),o.value=!1},c=()=>{i.value||(i.value=!0,l("forzarCierre",!0,n.value),r(),setTimeout((()=>{i.value=!1}),1500))},r=()=>{o.value=!1};let v;async function p(){try{d.value.abrirModal(n.value),v=setInterval((()=>{n.value=d.value.getValue()[0],d.value.getValue()[1]||clearInterval(v)}),100)}catch(e){console.log(e),v=void 0}}return a({openModal:u,reasonDesc:n}),{onCancel:s,onConfirm:c,modalDescuadre:o,descuadre:t,reasonDesc:n,openKeyboard:p,keyboardRef:d,isLoading:i}}},de=l(40089);const ue=(0,de.Z)(ie,[["render",te],["__scopeId","data-v-8bc30172"]]);var se=ue,ce={name:"CerrarCajaComponent",components:{NumpadComponent:K.Z,MDBCard:L.Yl,MDBCardBody:L.H7,MDBCardTitle:L.QM,MDBCardText:L.Pp,MDBPopover:L.SW,MDBBtn:L.$v,MDBCheckbox:L.IH,MDBModal:L.j3,MDBModalHeader:L.ol,MDBModalTitle:L.wo,MDBModalBody:L.Yz,MDBModalFooter:L.ab,MDBIcon:L.vm,MDBLoading:L.J$,ModalDescuadreComponent:se},setup(){const e=(0,Y.iH)(0),a="140",l=(0,Y.iH)(0),t=(0,Y.iH)(!0),n=(0,Y.iH)(null),i=(0,Y.iH)(null),d=(0,O.oR)(),u=(0,Y.iH)(null),s=(0,ee.tv)(),c=(0,Y.iH)([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),r=(0,Y.iH)("Cerrar"),v=(0,Y.iH)(null),p=(0,Y.iH)(null),m=(0,Y.iH)(0),b=(0,Y.iH)(!1),_=(0,Y.iH)(!1),f=(0,Y.iH)(!1),y=(0,Y.iH)(!1),g=((0,Y.iH)(null),(0,Y.iH)(null),(0,Y.iH)(null),(0,o.Fl)((()=>d.state.Caja.arrayVentas)),(0,o.Fl)((()=>d.state.Trabajadores.arrayTrabajadores))),w=(0,o.Fl)((()=>d.state.Trabajadores.indexActivo)),C=(0,o.Fl)((()=>g.value&&null!=w.value&&void 0!=w.value&&g.value[w.value]?g.value[w.value]:null)),k=(0,o.Fl)((()=>d.state.BtnMenuPrincipal.botonesBloqueados)),D=(0,Y.iH)(0),B=(0,Y.iH)(0);let z=(0,Y.iH)(0);const h=(0,Y.iH)(!1),M=(0,Y.iH)(!1),T=(0,Y.iH)(!1);function x(a){_.value&&(_.value=!1),e.value=a,n.value.setValor(c.value[a])}function H(){e.value=null,_.value=!0,n.value.setValor(m.value)}const j=(0,o.Fl)((()=>{let e=0;return e+=.01*c.value[0],e+=.02*c.value[1],e+=.05*c.value[2],e+=.1*c.value[3],e+=.2*c.value[4],e+=.5*c.value[5],e+=1*c.value[6],e+=2*c.value[7],e+=5*c.value[8],e+=10*c.value[9],e+=20*c.value[10],e+=50*c.value[11],e+=100*c.value[12],e+=200*c.value[13],e+=500*c.value[14],e+=Number(m.value.toString()),e=Number(e.toFixed(2)),e}));function A(){const e=[{_id:"0.01",valor:.01*c.value[0],unidades:c.value[0]},{_id:"0.02",valor:.02*c.value[1],unidades:c.value[1]},{_id:"0.05",valor:.05*c.value[2],unidades:c.value[2]},{_id:"0.10",valor:.1*c.value[3],unidades:c.value[3]},{_id:"0.20",valor:.2*c.value[4],unidades:c.value[4]},{_id:"0.50",valor:.5*c.value[5],unidades:c.value[5]},{_id:"1",valor:1*c.value[6],unidades:c.value[6]},{_id:"2",valor:2*c.value[7],unidades:c.value[7]},{_id:"5",valor:5*c.value[8],unidades:c.value[8]},{_id:"10",valor:10*c.value[9],unidades:c.value[9]},{_id:"20",valor:20*c.value[10],unidades:c.value[10]},{_id:"50",valor:50*c.value[11],unidades:c.value[11]},{_id:"100",valor:100*c.value[12],unidades:c.value[12]},{_id:"200",valor:200*c.value[13],unidades:c.value[13]},{_id:"500",valor:500*c.value[14],unidades:c.value[14]}];return e}async function V(e=!1,a=""){if(null!=C.value&&void 0!=C.value)try{let l=D.value||0;d.dispatch("BtnMenuPrincipal/bloquearBotones");const o=await X.Z.post("caja/cerrarCaja",{total:j.value,detalleMonedas:A(),infoDinero:c.value,cantidad3G:Number(l),cantidadPaytef:p.value,idDependienta:C.value._id,cambioEmergencia:Number(m.value.toString()),cantidad3GAutomatizado:B.value,forzarCierre:e,motivoDescuadre:a});if(o.data?.exito)Q().fire({backdrop:!1,title:"Caja cerrada correctamente",icon:"success",confirmButtonText:"Continuar",timer:1e3}),s.push("/abrirCaja");else{if("Descuadre no permitido"!=o.data?.mensaje)throw Error("No se ha podido cerrar la caja");v.value=!1,T.value.openModal(o.data.descuadre)}}catch(l){Q().fire("Oops...",l.message,"error")}finally{d.dispatch("BtnMenuPrincipal/desbloquearBotones")}else Q().fire("Oops...","Necesitas seleccionar un trabajador para poder cerrar","error")}function W(){z.value++;const e=[{condition:()=>j.value>180,title:"Hay más de 180€ en la caja"},{condition:()=>!h.value,title:"No se han hecho devoluciones"},{condition:()=>!M.value,title:"No se han hecho salidas de entregas diarias"}];if(z.value<=e.length){const a=e[z.value-1];a.condition()?$(a):W()}else t.value=!0,v.value=!0,z.value=0}function $(e){Q().fire({title:e.title,icon:"warning",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Continuar cierre",denyButtonText:"Cancelar",reverseButtons:!0}).then((e=>{e.isConfirmed?W():e.isDenied&&(z.value=0)}))}function S(){X.Z.post("/caja/cambioTurno").then((e=>{null!=e&&(y.value=!1)}))}function N(){X.Z.post("caja/anularTurno").then((e=>{null!=e&&(y.value=!0)}))}const U=(0,o.Fl)((()=>n.value?Number(n.value.cantidad):null));function P(e,a,l){const o=new Date;o.setTime(o.getTime()+24*l*60*60*1e3);let t="expires="+o.toUTCString();document.cookie=e+"="+a+";"+t+";path=/"}function Z(e){D.value=e}function F(){t.value&&(t.value=!1,i.value.setValor(D.value))}return(0,o.YP)(U,(()=>{null!=e.value&&void 0!=e.value?(c.value[e.value]=U.value,P("datosCierre",JSON.stringify(c.value),7)):null!=_.value&&void 0!=_.value&&(m.value=U.value)})),(0,o.YP)(m,(async()=>{if(m.value||0===m.value)try{X.Z.post("caja/setCambioEmActual",{valor:0===m.value?0:Number(m.value.toFixed(2))})}catch(e){}})),(0,o.YP)(c,(async()=>{try{const e=A();X.Z.post("caja/setDetalleActual",{detalleActual:e})}catch(e){}}),{deep:!0}),(0,o.bv)((async()=>{X.Z.post("/paytef/totalPaytefHour").then((e=>{u.value=e.data})),ae.W.cargarVentas(),X.Z.post("/caja/comprovarTurno").then((e=>{y.value=e.data.info.estado}));let e=(await X.Z.post("/parametros/totalPaytef")).data;p.value=e[0]?e[0]:0,f.value=!!e[1]&&e[1],X.Z.get("tickets/getTotalDatafono3G").then((e=>{e.data&&(B.value=e.data,D.value=e.data)})),X.Z.get("caja/getCambioEmActual").then((e=>{"number"!==typeof e.data||Number.isNaN(e.data)?m.value=0:m.value=e.data})).catch((e=>{m.value=0})),X.Z.get("caja/getDetalleActual").then((e=>{if(e.data)for(const a in e.data)c.value[a]=e.data[a].unidades})).catch((e=>{m.value=0})),X.Z.get("devoluciones/verifyCurrentBoxReturns").then((e=>{h.value=e.data})).catch((e=>{h.value=!1})),X.Z.get("movimientos/verifyCurrentBoxEntregaDiaria").then((e=>{M.value=e.data})).catch((e=>{M.value=!1}))})),(0,o.JJ)("okValue",(()=>v.value?V():W())),{infoDinero:c,setActivo:x,indexActivo:e,sizeBilletes:a,total:j,numpadRef:n,cerrarCaja:V,modo:r,trabajadorActivo:C,modalConfirmar:v,confirmarCierre:W,cantidad3G:l,numpadRef2:i,estadoTurno:y,cambioTurno:S,popOverTotalPaytef:b,hourPaytef:u,anularTurno:N,totalPaytef:p,isLanPaytef:f,cargarTotal3G:F,itsMyFirstTimePleaseBeCareful:t,cambioEmergencia:m,setCambioEmergencia:H,cambioEmActivo:_,botonesBloqueados:k,modalDescuadreRef:T,setTotal3G:Z}}};const re=(0,de.Z)(ce,[["render",G],["__scopeId","data-v-8f0f7576"]]);var ve=re}}]);
//# sourceMappingURL=877.18e80b60.js.map