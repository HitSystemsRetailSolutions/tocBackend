"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[388],{3388:function(e,a,t){t.r(a),t.d(a,{default:function(){return K}});var s=t(73396),l=t(87139);const i=e=>((0,s.dD)("data-v-63a5f445"),e=e(),(0,s.Cn)(),e),n={id:"main"},o={id:"vueMenuEncargo"},c={class:"encargos"},r={class:""},d={class:"row"},u=i((()=>(0,s._)("div",{class:"col"},null,-1))),v={class:"col"},_={key:0},m={class:"btnEncargo lgEncargo float-right"},p={key:1,class:"btnEncargo float-right"},g=i((()=>(0,s._)("i",{class:"fas fa-search"},null,-1))),b=i((()=>(0,s._)("hr",null,null,-1))),C={class:"productos"},f={key:0},D={class:"d-flex flex-column py-1"},w={class:"d-flex flex-column justify-content-center"},h={class:""},k={key:1},y={class:"encargos-footer"},x=i((()=>(0,s._)("small",{id:"emailHelp",class:"form-text text-muted"},"Precio total:",-1))),T={class:"mb-0 mt-2"},E={class:""};function A(e,a,t,i,A,j){return(0,s.wg)(),(0,s.iD)("div",n,[(0,s._)("div",o,[(0,s._)("div",null,[(0,s._)("div",c,[(0,s._)("div",r,[(0,s._)("div",d,[u,(0,s._)("div",v,[i.clienteData.idCliente?((0,s.wg)(),(0,s.iD)("h1",_,[(0,s._)("button",m,(0,l.zw)(i.clienteData.nombreCliente),1)])):((0,s.wg)(),(0,s.iD)("button",p,[g,(0,s.Uk)(" Abrir modal cliente ")]))])]),b,(0,s._)("div",C,[i.cestaActiva.lista.length?((0,s.wg)(),(0,s.iD)("div",f,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.cestaActiva.lista,((e,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"producto d-flex justify-content-between w-75 mx-auto",key:a},[(0,s._)("div",D,[(0,s._)("span",null,"- "+(0,l.zw)(e.nombre),1),(0,s._)("div",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.arraySuplementos,((e,a)=>((0,s.wg)(),(0,s.iD)("span",{class:"ms-3",key:a},(0,l.zw)(e.nombre),1)))),128))])]),(0,s._)("div",null,[(0,s._)("span",h,(0,l.zw)(e.unidades)+" unidad(es)",1)])])))),128))])):((0,s.wg)(),(0,s.iD)("div",k,(0,l.zw)(e.$t("toc_game_no_hay_productos","No hay ningún producto seleccionado")),1))]),(0,s._)("div",y,[(0,s._)("div",null,[x,(0,s._)("p",T,(0,l.zw)(i.precioTotal)+"€",1)]),(0,s._)("div",E,[(0,s._)("input",{type:"button",value:"Crear deuda",class:"btn btn-primary btn-lg",onClick:a[0]||(a[0]=(...e)=>i.crearDeuda&&i.crearDeuda(...e))})])])])])])])])}t(57658);var j=t(44870),z=t(20065),F=t(42492),H=t.n(F),N=t(5658),O=t(44161),I=t(54455),P={name:"DeudasComponent",setup(){const e=(0,z.oR)(),{t:a}=(0,N.QT)(),t=(0,j.iH)(0),l=e.getters["Cestas/getCestaActiva"],i=e.getters["Cestas/getCestaActivaIndex"],n=(0,s.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),o=(0,s.Fl)((()=>e.state.Trabajadores.indexActivo)),c=(0,s.Fl)((()=>n.value&&null!=o.value&&void 0!=o.value&&n.value[o.value]?n.value[o.value]:null)),r=(0,j.iH)(null),d={idCliente:l.idCliente,nombreCliente:l.nombreCliente},u=()=>{const e=l.lista.reduce(((e,a)=>e+a.subtotal),0);return Number(e.toFixed(2))},v=async()=>{try{const e=await O.Z.post("tickets/crearTicket",{total:u(),idCesta:l._id,idTrabajador:c.value._id,tipo:"DEUDA",tkrsData:{cantidadTkrs:t.value,formaPago:"EFECTIVO"},concepto:"DEUDA"});if(!e.data)throw Error("No se ha podido crear el ticket");m(a("toc_game_encargos_ok","Deuda creada!"),"success",_)}catch(e){H().fire("Oops...",e.message,"error")}},_=async()=>(await e.dispatch("Cestas/setModoCesta",{index:i,modo:"VENTA"}),e.dispatch("Cestas/setClienteCesta",{index:i,idCliente:null,nombreCliente:null}),e.dispatch("EstadoDinamico/reset"),e.dispatch("Cestas/deleteLista",l._id),p("/main"),Promise.resolve()),m=(e,a,t=(()=>{}))=>{H().fire("error"===a?"Oops...":"Ok!!",e,a).then((()=>t()))},p=e=>I.Z.push(e);return(0,s.bv)((()=>{r.value=u()})),{crearDeuda:v,cestaActiva:l,clienteData:d,precioTotal:r,cantidadTkrs:t}}},U=t(40089);const Z=(0,U.Z)(P,[["render",A],["__scopeId","data-v-63a5f445"]]);var K=Z}}]);
//# sourceMappingURL=388.e0172915.js.map