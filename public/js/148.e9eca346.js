"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[148],{7767:function(a,e,t){t.d(e,{Z:function(){return b}});var o=t(3396);const n={class:"btn-group-vertical mt-1"},l={class:"btn-group"},s={class:"btn-group"},i={class:"btn-group"},r={class:"btn-group"},c={class:"btn-group"};function u(a,e,t,u,d,m){return(0,o.wg)(),(0,o.iD)("div",n,[(0,o._)("div",l,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[0]||(e[0]=a=>u.addTecla("1"))}," 1 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[1]||(e[1]=a=>u.addTecla("2"))}," 2 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[2]||(e[2]=a=>u.addTecla("3"))}," 3 ")]),(0,o._)("div",s,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[3]||(e[3]=a=>u.addTecla("4"))}," 4 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[4]||(e[4]=a=>u.addTecla("5"))}," 5 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[5]||(e[5]=a=>u.addTecla("6"))}," 6 ")]),(0,o._)("div",i,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[6]||(e[6]=a=>u.addTecla("7"))}," 7 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[7]||(e[7]=a=>u.addTecla("8"))}," 8 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[8]||(e[8]=a=>u.addTecla("9"))}," 9 ")]),(0,o._)("div",r,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[9]||(e[9]=a=>u.deleteTecla())}," < "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[10]||(e[10]=a=>u.addTecla("0"))}," 0 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[11]||(e[11]=a=>u.okValue(Number(u.cantidad)))}," OK ")]),(0,o._)("div",c,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonComa",onClick:e[12]||(e[12]=a=>u.addTecla("."))}," , ")])])}var d=t(4870),m={name:"NumpadComponent",setup(a,{expose:e}){const t=(0,d.iH)("0"),n=(0,o.f3)("okValue"),l=(0,d.iH)("5.5rem"),s=(0,d.iH)("5.5rem");function i(a){"."===a&&(t.value=t.value.replace(".","")),t.value+=a,"0"==t.value[0]&&(t.value=t.value.slice(1))}function r(){t.value=t.value.slice(0,-1),""===t.value&&(t.value="0")}function c(a){t.value=a.toString()}return e({cantidad:t,setValor:c}),{okValue:n,cantidad:t,addTecla:i,deleteTecla:r,setValor:c,anchoTecla:l,altoTecla:s}}},p=t(89);const v=(0,p.Z)(m,[["render",u],["__scopeId","data-v-6bb950cc"]]);var b=v},2374:function(a,e,t){t.d(e,{Z:function(){return d}});var o=t(3396),n=t(7139);const l={class:"input-group position-absolute bottom-0 start-0"};function s(a,e,t,s,i,r){return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("button",{onClick:e[0]||(e[0]=a=>s.volver()),class:"btn btn-warning ms-2",style:{"font-size":"27px"}},(0,n.zw)(a.$t("volver","VOLVER")),1)])}var i=t(8686),r={name:"VolverComponent",setup(){function a(){i.Z.back()}return{volver:a}}},c=t(89);const u=(0,c.Z)(r,[["render",s]]);var d=u},6148:function(a,e,t){t.r(e),t.d(e,{default:function(){return ea}});var o=t(3396),n=t(7139);const l=a=>((0,o.dD)("data-v-584d59c6"),a=a(),(0,o.Cn)(),a),s={class:"row"},i={class:"row mt-4"},r={class:"col"},c=l((()=>(0,o._)("img",{src:"img/img-efectivo.png",width:"300",alt:"Seleccionar efectivo"},null,-1))),u={class:"col"},d=l((()=>(0,o._)("img",{src:"img/img-tkrs.png",width:"300",alt:"Seleccionar pago con ticket restaurante"},null,-1))),m={key:0,class:"col"},p=l((()=>(0,o._)("img",{src:"img/img-tarjetas.png",width:"300",alt:"Seleccionar pago con tarjeta"},null,-1))),v={key:1,class:"col mt-1"},b=l((()=>(0,o._)("img",{src:"img/img-3g.png",width:"300",alt:"Seleccionar pago con datatfono3G"},null,-1))),g={class:"position-absolute bottom-0 end-0"},k={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function _(a,e,t,l,_,f){const C=(0,o.up)("CambioComponent"),w=(0,o.up)("MDBIcon"),T=(0,o.up)("MDBCardText"),y=(0,o.up)("MDBCardBody"),D=(0,o.up)("MDBCard"),M=(0,o.up)("ModalTkrsComponent"),B=(0,o.up)("VolverComponent"),z=(0,o.up)("MDBBtn");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",s,[(0,o.Wm)(C,{ref:"cambioRef"},null,512)]),(0,o._)("div",i,[(0,o._)("div",r,[(0,o.Wm)(D,{class:"cardTicketRestaurante text-center",onClick:e[0]||(e[0]=a=>l.setFormaPago("EFECTIVO"))},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[c,"EFECTIVO"===l.formaPago?((0,o.wg)(),(0,o.j4)(w,{key:0,class:"mt-4",icon:"hand-pointer",size:"5x"})):(0,o.kq)("",!0)])),_:1})])),_:1})])),_:1})]),(0,o._)("div",u,[l.modalTkrsRef?((0,o.wg)(),(0,o.j4)(D,{key:0,class:"cardTicketRestaurante text-center",onClick:e[1]||(e[1]=a=>l.modalTkrsRef.abrirModal())},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[d,"TKRS"===l.formaPago?((0,o.wg)(),(0,o.j4)(w,{key:0,class:"mt-4",icon:"hand-pointer",size:"5x"})):(0,o.kq)("",!0)])),_:1})])),_:1})])),_:1})):(0,o.kq)("",!0)]),0===l.tipoDatafono3G?((0,o.wg)(),(0,o.iD)("div",m,[(0,o.Wm)(D,{class:"cardTicketRestaurante text-center",onClick:e[2]||(e[2]=a=>l.setFormaPago("TARJETA"))},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[p,"TARJETA"===l.formaPago?((0,o.wg)(),(0,o.j4)(w,{key:0,class:"mt-4",icon:"hand-pointer",size:"5x"})):(0,o.kq)("",!0)])),_:1})])),_:1})])),_:1})])):(0,o.kq)("",!0),1===l.tipoDatafono3G?((0,o.wg)(),(0,o.iD)("div",v,[(0,o.Wm)(D,{class:"cardTicketRestaurante text-center",onClick:e[3]||(e[3]=a=>l.setFormaPago("DATAFONO_3G"))},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[b,"DATAFONO_3G"===l.formaPago?((0,o.wg)(),(0,o.j4)(w,{key:0,class:"mt-4",icon:"hand-pointer",size:"5x"})):(0,o.kq)("",!0)])),_:1})])),_:1})])),_:1})])):(0,o.kq)("",!0)]),(0,o.Wm)(M,{ref:"modalTkrsRef"},null,512),(0,o.Wm)(B,{onClick:e[4]||(e[4]=a=>l.cancelarVenta())}),(0,o._)("div",g,[(0,o.Wm)(z,{class:(0,n.C_)(["botonCobrar",{disabled:l.loading}]),color:"primary",onClick:e[5]||(e[5]=a=>l.cobrar())},{default:(0,o.w5)((()=>[l.loading?((0,o.wg)(),(0,o.iD)("span",k)):(0,o.kq)("",!0),(0,o.Uk)(" "+(0,n.zw)(a.$t("pagar","Pagar")),1)])),_:1},8,["class"])])],64)}t(7658);var f=t(4870);const C={class:"row mt-2"},w={class:"col-md-3"},T={key:0,class:"sizeLetrasCambio"},y={class:"sizeLetrasCambio"},D={key:1,class:"estiloFalta sizeLetrasCambio"},M={key:2,class:"estiloPerfecto sizeLetrasCambio"},B={key:3,class:"estiloSobra sizeLetrasCambio"},z={class:"col-md-9"},h={class:"row"},P={class:"col text-end"},x={class:"row mt-2"},E={class:"col text-end"};function F(a,e,t,l,s,i){const r=(0,o.up)("MDBCardTitle"),c=(0,o.up)("MDBCardText"),u=(0,o.up)("MDBBtn"),d=(0,o.up)("MDBCardBody"),m=(0,o.up)("MDBCard");return(0,o.wg)(),(0,o.iD)("div",C,[(0,o._)("div",w,[(0,o.Wm)(m,{class:"cardInfoCambio"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(a.$t("informacion_cambio","Información cambio")),1)])),_:1}),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[null!=l.cantidadTkrs&&void 0!=l.cantidadTkrs?((0,o.wg)(),(0,o.iD)("li",T,(0,n.zw)(a.$t("dinero_recibido","Dinero recibido:"))+" "+(0,n.zw)(Number(l.totalRecibido+l.cantidadTkrs).toFixed(2))+" € ",1)):(0,o.kq)("",!0),(0,o._)("li",y,(0,n.zw)(a.$t("dinero_a_pagar","Dinero a pagar:"))+" "+(0,n.zw)((Math.round(100*l.aPagar)/100).toFixed(2))+" € ",1),null!=l.cuenta&&void 0!=l.cuenta&&l.cuenta>0?((0,o.wg)(),(0,o.iD)("li",D,(0,n.zw)(a.$t("faltan","Faltan"))+" "+(0,n.zw)((Math.round(100*l.cuenta)/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0),null!=l.cuenta&&void 0!=l.cuenta&&0==l.cuenta?((0,o.wg)(),(0,o.iD)("li",M,(0,n.zw)(a.$t("cambio_perfecto","Cambio perfecto")),1)):(0,o.kq)("",!0),null!=l.cuenta&&void 0!=l.cuenta&&l.cuenta<0?((0,o.wg)(),(0,o.iD)("li",B,(0,n.zw)(a.$t("sobran","Sobran"))+" "+(0,n.zw)((Math.round(100*(l.aPagar-l.totalRecibido))/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(u,{size:"lg",color:"warning",onClick:e[0]||(e[0]=a=>l.deshacer()),class:"sizeBotones"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(a.$t("desahcer","Deshacer")),1)])),_:1}),(0,o.Wm)(u,{size:"lg",color:"danger",class:"sizeBotones",onClick:e[1]||(e[1]=a=>l.limpiar())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(a.$t("limpiar","Limpiar")),1)])),_:1})])),_:1})])),_:1})]),(0,o._)("div",z,[(0,o._)("div",h,[(0,o._)("div",P,[(0,o._)("img",{src:"/img/1cts.png",class:"sizeMonedas",onClick:e[2]||(e[2]=a=>l.sumar(.01))}),(0,o._)("img",{src:"/img/2cts.png",class:"sizeMonedas",onClick:e[3]||(e[3]=a=>l.sumar(.02))}),(0,o._)("img",{src:"/img/5cts.png",class:"sizeMonedas",onClick:e[4]||(e[4]=a=>l.sumar(.05))}),(0,o._)("img",{src:"/img/10cts.png",class:"sizeMonedas",onClick:e[5]||(e[5]=a=>l.sumar(.1))}),(0,o._)("img",{src:"/img/20cts.png",class:"sizeMonedas",onClick:e[6]||(e[6]=a=>l.sumar(.2))}),(0,o._)("img",{src:"/img/50cts.png",class:"sizeMonedas",onClick:e[7]||(e[7]=a=>l.sumar(.5))}),(0,o._)("img",{src:"/img/uneuro.png",class:"sizeMonedas",onClick:e[8]||(e[8]=a=>l.sumar(1))}),(0,o._)("img",{src:"/img/doseuros.png",class:"sizeMonedas",onClick:e[9]||(e[9]=a=>l.sumar(2))})])]),(0,o._)("div",x,[(0,o._)("div",E,[(0,o._)("img",{src:"/img/5euros.png",class:"sizeBilletes",onClick:e[10]||(e[10]=a=>l.sumar(5))}),(0,o._)("img",{src:"/img/10euros.png",class:"sizeBilletes",onClick:e[11]||(e[11]=a=>l.sumar(10))}),(0,o._)("img",{src:"/img/20euros.png",class:"sizeBilletes",onClick:e[12]||(e[12]=a=>l.sumar(20))}),(0,o._)("img",{src:"/img/50euros.png",class:"sizeBilletes",onClick:e[13]||(e[13]=a=>l.sumar(50))}),(0,o._)("img",{src:"/img/100euros.png",class:"sizeBilletes",onClick:e[14]||(e[14]=a=>l.sumar(100))}),(0,o._)("img",{src:"/img/200euros.png",class:"sizeBilletes",onClick:e[15]||(e[15]=a=>l.sumar(200))}),(0,o._)("img",{src:"/img/500euros.png",class:"sizeBilletes",onClick:e[16]||(e[16]=a=>l.sumar(500))})])])])])}var R=t(4313),W={name:"CambioComponent",components:{MDBCard:R.Yl,MDBCardBody:R.H7,MDBCardTitle:R.QM,MDBCardText:R.Pp,MDBBtn:R.$v},setup(a,{expose:e}){const t=(0,f.iH)(0),n=(0,o.f3)("total"),l=(0,f.iH)(n),s=(0,f.iH)([]),i=(0,f.iH)(0),r=(0,o.Fl)((()=>l.value-i.value<0?0:l.value-(t.value+i.value)));function c(a){t.value+=a,s.value.push(a)}function u(){s.value.pop();let a=0;s.value.forEach((e=>{a+=e})),t.value=a}function d(){t.value=0,s.value=[]}function m(a){i.value=Number(a)}return e({setTkrs:m}),{sumar:c,totalRecibido:t,aPagar:l,deshacer:u,limpiar:d,cantidadTkrs:i,cuenta:r}}},A=t(89);const V=(0,A.Z)(W,[["render",F],["__scopeId","data-v-0e9fd9d8"]]);var N=V,I=t(2374);const H={class:"row"},O={key:0,class:"cantidad text-center"},j={class:"row mt-2"},q={class:"col text-center"};function Z(a,e,t,l,s,i){const r=(0,o.up)("MDBModalTitle"),c=(0,o.up)("MDBModalHeader"),u=(0,o.up)("NumpadComponent"),d=(0,o.up)("MDBModalBody"),m=(0,o.up)("MDBBtn"),p=(0,o.up)("MDBModalFooter"),v=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(v,{id:"modalTkrs",tabindex:"-1",labelledby:"modalTkrsLabel",modelValue:l.modalTkrs,"onUpdate:modelValue":e[1]||(e[1]=a=>l.modalTkrs=a)},{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,{id:"modalTkrsLabel"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(a.$t("introduce_la_cantidad_del_tiquet_restaurante","Introduce la cantidad del tiquet restaurante")),1)])),_:1})])),_:1}),(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o._)("div",H,[l.numPadRef?((0,o.wg)(),(0,o.iD)("span",O,(0,n.zw)(l.numPadRef.cantidad),1)):(0,o.kq)("",!0)]),(0,o._)("div",j,[(0,o._)("div",q,[(0,o.Wm)(u,{ref:"numPadRef"},null,512)])])])),_:1}),(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(m,{color:"danger",size:"lg",onClick:e[0]||(e[0]=a=>l.modalTkrs=!1)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(a.$t("cerrar","Cerrar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}var $=t(7767),S={name:"ModalTkrsComponent",components:{MDBModal:R.j3,MDBModalHeader:R.ol,MDBModalTitle:R.wo,MDBModalBody:R.Yz,MDBModalFooter:R.ab,MDBBtn:R.$v,NumpadComponent:$.Z},setup(a,{expose:e}){const t=(0,f.iH)(!1),n=(0,f.iH)(null),l=(0,o.f3)("setTkrs");function s(){t.value=!0}function i(){t.value=!1,l(n.value.cantidad)}return(0,o.JJ)("okValue",i),e({abrirModal:s}),{modalTkrs:t,numPadRef:n,okValue:i}}};const J=(0,A.Z)(S,[["render",Z],["__scopeId","data-v-b796d518"]]);var G=J,L=t(2492),U=t.n(L),Y=t(4161),K=t(65),Q=t(2483),X={name:"CobroView",components:{CambioComponent:N,MDBCard:R.Yl,MDBBtn:R.$v,MDBCardBody:R.H7,MDBCardText:R.Pp,VolverComponent:I.Z,ModalTkrsComponent:G,MDBIcon:R.vm},setup(a,{expose:e}){const t=(0,K.oR)(),n=(0,Q.tv)(),l=(0,f.iH)("EFECTIVO"),s=(0,f.iH)(0),i=(0,f.iH)(null),r=(0,f.iH)(null),c=(0,f.iH)(0),u=(0,f.iH)(!1),d=(0,o.Fl)((()=>t.state.Trabajadores.indexActivo)),m=(0,o.Fl)((()=>t.state.Trabajadores.arrayTrabajadores)),p=(0,o.Fl)((()=>t.state.Cestas.arrayCestas)),v=(0,o.Fl)((()=>t.state.Cestas.Descuento)),b=(0,o.Fl)((()=>m.value&&void 0!=d.value&&null!=d.value&&m.value[d.value]?m.value[d.value]:null));let g=(0,o.Fl)((()=>{if(p.value)for(let a=0;a<p.value.length;a++)if(p.value[a]._id==m.value[d.value].idCesta)return p.value[a];return null}));function k(a){c.value=Number(a),r.value.setTkrs(a),a>=y(g.value)?l.value="TKRS":l.value="EFECTIVO"}function _(a){c.value<y(g.value)?"TARJETA"===a&&c.value>0?U().fire("Oops...","De momento el Ticket Restaurant solo se puede combinar con EFECTIVO","error"):l.value=a:U().fire("¡Eo!","El ticket resturant ya cubre el total de la venta","error")}async function C(){u.value=!0;try{const a=await Y.Z.post("tickets/crearTicket",{total:y(g.value),idCesta:g.value._id,idTrabajador:b.value._id,tipo:l.value,tkrsData:{cantidadTkrs:c.value,formaPago:"EFECTIVO"}});if(!a.data)throw Error("No se ha podido crear el ticket");U().fire({icon:"success",title:"Venta registrada correctamente",showConfirmButton:!1,timer:500}),"PAGO SEPARADO"==g.value.modo&&await T(g.value._id),"TARJETA"===l.value&&t.dispatch("Datafono/setEstado","PENDIENTE"),n.push("/main")}catch(a){U().fire("Oops...",a.message,"error")}u.value=!1}async function w(){"PAGO SEPARADO"==g.value.modo&&await Y.Z.post("cestas/DevolverProductosACestaSep",{cesta:t.getters["Cestas/getCestaBaseActivo"],articulos:g.value.lista}).then((a=>{T(g.value._id)}))}async function T(a){Y.Z.post("cestas/fulminarCesta",{idCesta:a}).catch((a=>{U().fire({icon:"error",title:"Error al eliminar la cesta (Pago dividido)",showConfirmButton:!1,timer:500})})),await Y.Z.post("cestas/cambiarCestaTrabajador",{idCesta:t.getters["Cestas/getCestaBaseActivo"],idTrabajador:m.value[t.state.Trabajadores.indexActivo]._id}).then((a=>{t.dispatch("Cestas/setCestaBaseAction",null)}))}function y(a){let e=a.detalleIva.importe1+a.detalleIva.importe2+a.detalleIva.importe3+a.detalleIva.importe4+a.detalleIva.importe5;return e-e*v.value}return e({}),(0,o.bv)((()=>{Y.Z.post("parametros/getParametros").then((a=>{"3G"===a.data?.tipoDatafono&&(s.value=1)}))})),(0,o.JJ)("total",y(g.value)),(0,o.JJ)("setTkrs",k),{DescuentoCliente:v,cesta:g,getTotal:y,cobrar:C,formaPago:l,modalTkrsRef:i,cambioRef:r,setFormaPago:_,loading:u,tipoDatafono3G:s,eliminarAlPagarFnc:T,cancelarVenta:w}}};const aa=(0,A.Z)(X,[["render",_],["__scopeId","data-v-584d59c6"]]);var ea=aa}}]);
//# sourceMappingURL=148.e9eca346.js.map