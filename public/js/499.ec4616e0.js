"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[499],{61837:function(a,e,t){t.d(e,{Z:function(){return C}});var l=t(73396);const n={class:"btn-group-vertical mt-1"},o={class:"btn-group"},d={class:"btn-group"},s={class:"btn-group"},u={class:"btn-group"},c={class:"btn-group"};function i(a,e,t,i,r,p){return(0,l.wg)(),(0,l.iD)("div",n,[(0,l._)("div",o,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[0]||(e[0]=a=>i.addTecla("1"))}," 1 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[1]||(e[1]=a=>i.addTecla("2"))}," 2 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[2]||(e[2]=a=>i.addTecla("3"))}," 3 ")]),(0,l._)("div",d,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[3]||(e[3]=a=>i.addTecla("4"))}," 4 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[4]||(e[4]=a=>i.addTecla("5"))}," 5 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[5]||(e[5]=a=>i.addTecla("6"))}," 6 ")]),(0,l._)("div",s,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[6]||(e[6]=a=>i.addTecla("7"))}," 7 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[7]||(e[7]=a=>i.addTecla("8"))}," 8 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[8]||(e[8]=a=>i.addTecla("9"))}," 9 ")]),(0,l._)("div",u,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[9]||(e[9]=a=>i.deleteTecla())}," < "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[10]||(e[10]=a=>i.addTecla("0"))}," 0 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:e[11]||(e[11]=a=>i.okValue(Number(i.cantidad)))}," OK ")]),(0,l._)("div",c,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonComa",onClick:e[12]||(e[12]=a=>i.addTecla("."))}," , ")])])}t(42492);var r=t(32066),p=t(86525),m=t(44870);const b=(0,r.io)("http://"+p.Z.state.TocGameURL+":5051");var v={props:{skipBalanza:{type:Boolean,default:!1}},name:"NumpadComponent",setup(a,{expose:e}){const t=(0,m.iH)("0"),n=(0,l.f3)("okValue"),o=(0,m.iH)("5.5rem"),d=(0,m.iH)("5.5rem");(0,l.Fl)((()=>p.Z.state.Weight.lastWeight));function s(a){"."===a&&(t.value=t.value.replace(".","")),t.value+=a,"0"==t.value[0]&&(t.value=t.value.slice(1))}function u(){t.value=t.value.slice(0,-1),""===t.value&&(t.value="0")}function c(a){t.value=Number(a).toString()}return b.on("setBalanzaValue",(e=>{e&&!a.skipBalanza&&c(e)})),e({cantidad:t,setValor:c}),(0,l.bv)((async()=>{a.skipBalanza||c((await(0,l.Fl)((()=>p.Z.state.Weight.lastWeight))).value)})),{okValue:n,cantidad:t,addTecla:s,deleteTecla:u,setValor:c,anchoTecla:o,altoTecla:d}}},_=t(40089);const y=(0,_.Z)(v,[["render",i],["__scopeId","data-v-6fec6be8"]]);var C=y},23499:function(a,e,t){t.r(e),t.d(e,{default:function(){return q}});var l=t(73396),n=t(87139),o=t(49242);const d=a=>((0,l.dD)("data-v-ab70faf0"),a=a(),(0,l.Cn)(),a),s={id:"main"},u={id:"vueMenuEncargo"},c={class:"encargos"},i={class:""},r={class:"row"},p=d((()=>(0,l._)("div",{class:"col"},null,-1))),m={class:"col"},b={key:0},v={class:"btnEncargo lgEncargo float-right"},_={key:1,class:"btnEncargo float-right"},y=d((()=>(0,l._)("i",{class:"fas fa-search"},null,-1))),C=d((()=>(0,l._)("hr",null,null,-1))),f={class:"productos"},g={key:0},k={class:"d-flex flex-column py-1"},D={class:"d-flex flex-column justify-content-center"},T={class:""},w={key:1},N={class:"encargos-footer"},M=d((()=>(0,l._)("small",{id:"emailHelp",class:"form-text text-muted"},"Precio total:",-1))),h={class:"mb-0 mt-2"},B={class:"input-deja-a-cuenta"},x=d((()=>(0,l._)("small",{id:"emailHelp",class:"form-text text-muted"},"Deja a cuenta:",-1))),H={class:""},j={key:0,class:"spinner"},z={key:1,class:"m-0"},A={class:"row"},V={class:"col"},W={class:"input-group input-group-lg"},F={class:"row"},E={class:"col text-center"};function I(a,e,t,d,I,U){const Z=(0,l.up)("MDBBtn"),R=(0,l.up)("MDBModalTitle"),L=(0,l.up)("MDBModalHeader"),O=(0,l.up)("NumpadComponent"),Y=(0,l.up)("MDBModalBody"),$=(0,l.up)("MDBModalFooter"),P=(0,l.up)("MDBModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",s,[(0,l._)("div",u,[(0,l._)("div",null,[(0,l._)("div",c,[(0,l._)("div",i,[(0,l._)("div",r,[p,(0,l._)("div",m,[d.clienteData.idCliente?((0,l.wg)(),(0,l.iD)("h1",b,[(0,l._)("button",v,(0,n.zw)(d.clienteData.nombreCliente),1)])):((0,l.wg)(),(0,l.iD)("button",_,[y,(0,l.Uk)(" Abrir modal cliente ")]))])]),C,(0,l._)("div",f,[d.cestaActiva.lista.length?((0,l.wg)(),(0,l.iD)("div",g,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.cestaActiva.lista,((a,e)=>((0,l.wg)(),(0,l.iD)("div",{class:"producto d-flex justify-content-between w-75",key:e},[(0,l._)("div",k,[(0,l._)("span",null,"- "+(0,n.zw)(a.nombre),1),(0,l._)("div",D,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.arraySuplementos,((a,e)=>((0,l.wg)(),(0,l.iD)("span",{class:"ms-3",key:e},(0,n.zw)(a.nombre),1)))),128))])]),(0,l._)("div",null,[(0,l._)("span",T,(0,n.zw)(a.unidades)+" unidad(es)",1)])])))),128))])):((0,l.wg)(),(0,l.iD)("div",w,(0,n.zw)(a.$t("toc_game_no_hay_productos","No hay ningún producto seleccionado")),1))]),(0,l._)("div",N,[(0,l._)("div",null,[M,(0,l._)("p",h,(0,n.zw)(d.precioTotal)+"€",1)]),(0,l._)("div",B,[x,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"cuenta",name:"dejaACuenta",placeholder:"0",min:"0","onUpdate:modelValue":e[0]||(e[0]=a=>d.dejaACuenta=a),onClick:e[1]||(e[1]=(...a)=>d.openTecladoNum&&d.openTecladoNum(...a)),readonly:""},null,512),[[o.nr,d.dejaACuenta]])]),(0,l._)("div",H,[(0,l.Wm)(Z,{color:"primary",onClick:e[2]||(e[2]=a=>d.crearDeuda()),disabled:d.loading,class:"btn btn-primary btn-lg"},{default:(0,l.w5)((()=>[d.loading?((0,l.wg)(),(0,l.iD)("span",j)):((0,l.wg)(),(0,l.iD)("p",z,"Crear deuda"))])),_:1},8,["disabled"])])])])])])])]),(0,l.Wm)(P,{id:"modalTecladoNum",tabindex:"-1",labelledby:"modalTecladoNumLabel",modelValue:d.modalTecladoNum,"onUpdate:modelValue":e[6]||(e[6]=a=>d.modalTecladoNum=a),"data-backdrop":"false"},{default:(0,l.w5)((()=>[(0,l.Wm)(L,null,{default:(0,l.w5)((()=>[(0,l.Wm)(R,{id:"modalTecladoNumLabel"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(a.$t("deja_a_cuenta","Deja a cuenta")),1)])),_:1})])),_:1}),(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l._)("div",A,[(0,l._)("div",V,[(0,l._)("div",W,[d.numpadRef?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=a=>d.numpadRef.cantidad=a)},null,512)),[[o.nr,d.numpadRef.cantidad]]):(0,l.kq)("",!0)])])]),(0,l._)("div",F,[(0,l._)("div",E,[(0,l.Wm)(O,{skipBalanza:!0,ref:"numpadRef"},null,512)])])])),_:1}),(0,l.Wm)($,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{color:"danger",onClick:e[4]||(e[4]=a=>d.closeTecladoNum()),size:"lg"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Cerrar ")])),_:1}),(0,l.Wm)(Z,{color:"success",size:"lg",onClick:e[5]||(e[5]=a=>d.finishTecladoNum())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(a.$t("aceptar","Aceptar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}t(57658);var U=t(44870),Z=t(74313),R=t(20065),L=t(42492),O=t.n(L),Y=t(87853),$=t(91076),P=t(16797),J=t(61837),K={name:"DeudasComponent",components:{MDBBtn:Z.$v,MDBCard:Z.Yl,MDBCardBody:Z.H7,MDBCardTitle:Z.QM,MDBCardText:Z.Pp,MDBCheckbox:Z.IH,MDBModal:Z.j3,MDBModalHeader:Z.ol,MDBModalTitle:Z.wo,MDBModalBody:Z.Yz,MDBModalFooter:Z.ab,MDBIcon:Z.vm,MDBLoading:Z.J$,NumpadComponent:J.Z},setup(){const a=(0,R.oR)(),{t:e}=(0,Y.QT)(),t=(0,U.iH)(0),n=(0,l.Fl)((()=>a.state.Cestas.arrayCestas)),o=a.getters["Cestas/getCestaActiva"],d=a.getters["Cestas/getCestaActivaIndex"],s=(0,l.Fl)((()=>a.state.Trabajadores.arrayTrabajadores)),u=(0,l.Fl)((()=>a.state.Trabajadores.indexActivo)),c=(0,l.Fl)((()=>s.value&&null!=u.value&&void 0!=u.value&&s.value[u.value]?s.value[u.value]:null)),i=(0,l.Fl)((()=>{if(n.value)for(let a=0;a<n.value.length;a++)if(n.value[a]._id==s.value[u.value].idCesta)return n.value[a];return null})),r=(0,l.Fl)((()=>a.state.Cestas.Descuento)),p=(0,U.iH)(null),m={idCliente:o.idCliente,nombreCliente:o.nombreCliente},b=(0,U.iH)(!1),v=(0,U.iH)(null),_=(0,U.iH)(null),y=(0,U.iH)(0);function C(a){let e=a.detalleIva.importe1+a.detalleIva.importe2+a.detalleIva.importe3+a.detalleIva.importe4+a.detalleIva.importe5,t=Math.round(100*e)/100;return t}const f=async()=>{try{const a=await $.Z.post("tickets/crearTicketDeuda",{total:C(i.value),idCesta:i.value._id,idTrabajador:c.value._id,tipo:"DEUDA",tkrsData:{cantidadTkrs:t.value,formaPago:"EFECTIVO"},dejaCuenta:y.value,concepto:"DEUDA"});if(!a.data)throw Error("No se ha podido crear el ticket");k(e("toc_game_encargos_ok","Deuda creada!"),"success",g)}catch(a){O().fire("Oops...",a.message,"error")}finally{b.value=!1}};const g=async()=>(await a.dispatch("Cestas/setModoCesta",{index:d,modo:"VENTA"}),a.dispatch("Cestas/setClienteCesta",{index:d,idCliente:null,nombreCliente:null,albaran:!1,vip:!1}),a.dispatch("EstadoDinamico/reset"),a.dispatch("Cestas/deleteLista",o._id),N("/main"),Promise.resolve()),k=(a,e,t=(()=>{}))=>{O().fire("error"===e?"Oops...":"Ok!!",a,e).then((()=>t()))},D=()=>{v.value=!0},T=()=>{v.value=!1},w=()=>{let a=Number(_.value.cantidad);y.value=Number(a.toFixed(2)),T()};(0,l.JJ)("okValue",(()=>v.value?w():D()));const N=a=>P.Z.push(a);return(0,l.bv)((()=>{p.value=C(i.value)})),{crearDeuda:f,cestaActiva:o,clienteData:m,precioTotal:p,cantidadTkrs:t,cesta:i,arrayCestas:n,getTotal:C,DescuentoCliente:r,loading:b,modalTecladoNum:v,numpadRef:_,openTecladoNum:D,closeTecladoNum:T,finishTecladoNum:w,dejaACuenta:y}}},Q=t(40089);const S=(0,Q.Z)(K,[["render",I],["__scopeId","data-v-ab70faf0"]]);var q=S}}]);
//# sourceMappingURL=499.ec4616e0.js.map