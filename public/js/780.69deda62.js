"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[780],{8780:function(e,a,t){t.r(a),t.d(a,{default:function(){return Z}});var s=t(3396),i=t(7139);const l=e=>((0,s.dD)("data-v-7100125c"),e=e(),(0,s.Cn)(),e),n={id:"main"},o={id:"vueMenuEncargo"},c={class:"encargos"},r={class:""},d={class:"row"},u=l((()=>(0,s._)("div",{class:"col"},null,-1))),v={class:"col"},_={key:0},g={class:"btnEncargo lgEncargo float-right"},p={key:1,class:"btnEncargo float-right"},m=l((()=>(0,s._)("i",{class:"fas fa-search"},null,-1))),C=l((()=>(0,s._)("hr",null,null,-1))),b={class:"productos"},D={key:0},f={class:"d-flex flex-column justify-content-center"},w={class:"d-flex flex-column justify-content-center"},h={key:1},k={class:"encargos-footer"},y=l((()=>(0,s._)("small",{id:"emailHelp",class:"form-text text-muted"},"Precio total:",-1))),E={class:"mb-0 mt-2"},T={class:""};function x(e,a,t,l,x,A){return(0,s.wg)(),(0,s.iD)("div",n,[(0,s._)("div",o,[(0,s._)("div",null,[(0,s._)("div",c,[(0,s._)("div",r,[(0,s._)("div",d,[u,(0,s._)("div",v,[l.clienteData.idCliente?((0,s.wg)(),(0,s.iD)("h1",_,[(0,s._)("button",g,(0,i.zw)(l.clienteData.nombreCliente),1)])):((0,s.wg)(),(0,s.iD)("button",p,[m,(0,s.Uk)(" Abrir modal cliente ")]))])]),C,(0,s._)("div",b,[l.cestaActiva.lista.length?((0,s.wg)(),(0,s.iD)("div",D,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.cestaActiva.lista,((e,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"producto",key:a},[(0,s._)("div",f,[(0,s._)("span",null,(0,i.zw)(e.nombre),1),(0,s._)("div",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.arraySuplementos,((e,a)=>((0,s.wg)(),(0,s.iD)("span",{key:a},(0,i.zw)(e.nombre),1)))),128))]),(0,s._)("span",null,(0,i.zw)(e.unidades)+" unidad(es)",1)])])))),128))])):((0,s.wg)(),(0,s.iD)("div",h,(0,i.zw)(e.$t("toc_game_no_hay_productos","No hay ningún producto seleccionado")),1))]),(0,s._)("div",k,[(0,s._)("div",null,[y,(0,s._)("p",E,(0,i.zw)(l.precioTotal)+"€",1)]),(0,s._)("div",T,[(0,s._)("input",{type:"button",value:"Crear deuda",class:"btn btn-primary btn-lg",onClick:a[0]||(a[0]=(...e)=>l.crearDeuda&&l.crearDeuda(...e))})])])])])])])])}t(7658);var A=t(4870),j=t(65),z=t(2492),F=t.n(z),H=t(5658),N=t(4161),O=t(6109),I={name:"DeudasComponent",setup(){const e=(0,j.oR)(),{t:a}=(0,H.QT)(),t=(0,A.iH)(0),i=e.getters["Cestas/getCestaActiva"],l=e.getters["Cestas/getCestaActivaIndex"],n=(0,s.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),o=(0,s.Fl)((()=>e.state.Trabajadores.indexActivo)),c=(0,s.Fl)((()=>n.value&&null!=o.value&&void 0!=o.value&&n.value[o.value]?n.value[o.value]:null)),r=(0,A.iH)(null),d={idCliente:i.idCliente,nombreCliente:i.nombreCliente},u=()=>{const e=i.lista.reduce(((e,a)=>e+a.subtotal),0);return Number(e.toFixed(2))},v=async()=>{try{const e=await N.Z.post("tickets/crearTicket",{total:u(),idCesta:i._id,idTrabajador:c.value._id,tipo:"DEUDA",tkrsData:{cantidadTkrs:t.value,formaPago:"EFECTIVO"},concepto:"DEUDA"});if(!e.data)throw Error("No se ha podido crear el ticket");g(a("toc_game_encargos_ok","Encargo creado!"),"success",_)}catch(e){F().fire("Oops...",e.message,"error")}},_=async()=>(await e.dispatch("Cestas/setModoCesta",{index:l,modo:"VENTA"}),e.dispatch("Cestas/setClienteCesta",{index:l,idCliente:null,nombreCliente:null}),e.dispatch("EstadoDinamico/reset"),e.dispatch("Cestas/deleteLista",i._id),p("/main"),Promise.resolve()),g=(e,a,t=(()=>{}))=>{F().fire("error"===a?"Oops...":"Ok!!",e,a).then((()=>t()))},p=e=>O.Z.push(e);return(0,s.bv)((()=>{r.value=u()})),{crearDeuda:v,cestaActiva:i,clienteData:d,precioTotal:r,cantidadTkrs:t}}},P=t(89);const U=(0,P.Z)(I,[["render",x],["__scopeId","data-v-7100125c"]]);var Z=U}}]);
//# sourceMappingURL=780.69deda62.js.map