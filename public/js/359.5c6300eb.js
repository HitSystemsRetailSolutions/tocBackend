"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[359],{4286:function(a,e,o){o.d(e,{Z:function(){return _}});var t=o(3396),n=o(7139);const r={class:"container"},i={key:0,class:"h3 text-center"},s={key:1,class:"h3 text-center"},l={key:2,class:"h3 text-center"},c={class:"row mt-2 container botonesCaja"},u={class:"again py-5"},d={class:"again py-5"},m={class:"again py-5"};function v(a,e,o,v,p,f){const b=(0,t.up)("MDBBtn"),g=(0,t.up)("MDBModalBody"),k=(0,t.up)("MDBModal");return(0,t.wg)(),(0,t.j4)(k,{id:"ModalErrorDatafonoQueHacerComponent",tabindex:"-1",labelledby:"tituloModalDatafono",modelValue:v.ModalErrorDatafonoQueHacerComponent,"onUpdate:modelValue":e[3]||(e[3]=a=>v.ModalErrorDatafonoQueHacerComponent=a),staticBackdrop:"",size:"lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[(0,t._)("div",r,[1==v.ticketExist?((0,t.wg)(),(0,t.iD)("p",i," Se ha cobrado el pago con datáfono pero no nos ha llegado. ¿Que hacemos? ")):(0,t.kq)("",!0),2==v.ticketExist?((0,t.wg)(),(0,t.iD)("p",s," No se ha cobrado el pago con datáfono. ¿Que hacemos? ")):(0,t.kq)("",!0),3==v.ticketExist?((0,t.wg)(),(0,t.iD)("p",l," Ultimo pago cancelado, que hacemos? ¿Que hacemos? ")):(0,t.kq)("",!0)]),(0,t._)("div",c,[1==v.ticketExist?((0,t.wg)(),(0,t.j4)(b,{key:0,color:"success",size:"1g",class:"botonEstado my-3 botones",onClick:e[0]||(e[0]=a=>v.darComoValido())},{default:(0,t.w5)((()=>[(0,t._)("span",u,(0,n.zw)(a.$t("volver_a_cobrar","Pago válido con tarjeta")),1)])),_:1})):(0,t.kq)("",!0),v.ticketExist>1?((0,t.wg)(),(0,t.j4)(b,{key:1,color:"warning  ",size:"lg",class:"botonEstado my-3 botones",disabled:v.esperandoConexion?"":a.disabled,onClick:e[1]||(e[1]=a=>{v.tarjetaUltimoTicket(),v.esperandoConexion=!0})},{default:(0,t.w5)((()=>[(0,t._)("span",d,(0,n.zw)(a.$t("reintentar_pago","Reintentar pago con tarjeta")),1)])),_:1},8,["disabled"])):(0,t.kq)("",!0),v.ticketExist>1?((0,t.wg)(),(0,t.j4)(b,{key:2,color:"primary  ",size:"lg",class:"botonEstado my-3 botones",onClick:e[2]||(e[2]=a=>v.pagoDependienta())},{default:(0,t.w5)((()=>[(0,t._)("span",m,(0,n.zw)(a.$t("pago en efectivo","PAGO EN EFECTIVO O EN 3G")),1)])),_:1})):(0,t.kq)("",!0)])])),_:1})])),_:1},8,["modelValue"])}var p=o(65),f=o(4161),b=o(4313),g=o(2492),k=o.n(g),h=o(4870),w={name:"ModalErrorDatafonoQueHacerComponent",components:{MDBModal:b.j3,MDBModalBody:b.Yz,MDBBtn:b.$v},setup(a,{expose:e}){const o=(0,h.iH)(null),n=(0,h.iH)(0),r=(0,p.oR)(),i=(0,h.iH)(!1),s=(0,t.Fl)((()=>r.state.Trabajadores.arrayTrabajadores));let l=(0,h.iH)(!1);const c=(0,t.Fl)((()=>r.state.Trabajadores.indexActivo)),u=(0,t.Fl)((()=>s.value&&void 0!=c.value&&null!=c.value&&s.value[c.value]?s.value[c.value]:null));function d(a,e){if(4==e)return k().fire({icon:"success",title:"¡Todo ha salido correctamente!",showConfirmButton:!1,timer:1200});o.value=a,n.value=e,i.value=!0}async function m(){await f.Z.post("paytef/darPorValidoUltimoTicket",{idTrabajador:u.value._id}).then((()=>{i.value=!1,r.dispatch("Datafono/setEstado","APROBADA")})).catch((a=>{i.value=!0,k().fire("Oops...",a.message,"error")})),k().fire({icon:"success",title:"Pagado validado.",showConfirmButton:!1,timer:1200})}function v(){l.value=!0,f.Z.post("paytef/cobrarUltimoTicket",{idTrabajador:u.value._id}).then((()=>{i.value=!1,l.value=!1,r.dispatch("Datafono/setEstado","PENDIENTE")})).catch((a=>{l.value=!1,i.value=!0,k().fire("Oops...",a.message,"error")})),l.value=!1,k().fire({icon:"success",title:"Pago enviado al datáfono",showConfirmButton:!1,timer:1200})}function b(){k().fire({icon:"success",title:"Pagado en efectivo",showConfirmButton:!1,timer:1200}),i.value=!1}return e({abrirModal:d}),(0,t.bv)((()=>{})),{store:r,darComoValido:m,ModalErrorDatafonoQueHacerComponent:i,tarjetaUltimoTicket:v,esperandoConexion:l,arrayTrabajadores:s,indexTrabajadorActivo:c,idSeleccionado:o,pagoDependienta:b,ticketExist:n}}},C=o(89);const D=(0,C.Z)(w,[["render",v],["__scopeId","data-v-1ca4de76"]]);var _=D},8359:function(a,e,o){o.r(e),o.d(e,{default:function(){return T}});var t=o(3396),n=o(7139);const r={class:"margenLateral position-relative"},i={key:0,class:"position-absolute start-0 mb-1 mt-4"},s={class:"sizeTrabajadores"},l={class:"btn-group",role:"group"},c=["onClick"];function u(a,e,o,u,d,m){const v=(0,t.up)("LateralComponent"),p=(0,t.up)("ModalErrorDatafonoComponentVue"),f=(0,t.up)("router-view");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(v),(0,t.Wm)(p,{ref:"modalErrorDatafonoRef"},null,512),(0,t._)("div",r,[(0,t.Wm)(f),"/menu/pedidos"!=u.actualPage?((0,t.wg)(),(0,t.iD)("div",i,[(0,t._)("div",s,[(0,t._)("div",l,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(u.arrayTrabajadores,((a,e)=>((0,t.wg)(),(0,t.iD)("button",{key:e,type:"button",class:(0,n.C_)(["btn btn-lg sizeBotonesTrabajador d-inline-block text-truncate me-2",[e===u.indexActivo?"btn-primary":"btn-outline-primary"]]),onClick:a=>u.setIndexActivo(e)},(0,n.zw)(a.nombre),11,c)))),128))])])])):(0,t.kq)("",!0)])],64)}function d(a,e,o,r,i,s){const l=(0,t.up)("MDBIcon"),c=(0,t.up)("MDBSideNavItem"),u=(0,t.up)("MDBSideNavMenu"),d=(0,t.up)("MDBSideNav");return(0,t.wg)(),(0,t.j4)(d,{modelValue:r.sidenavPositions,"onUpdate:modelValue":e[6]||(e[6]=a=>r.sidenavPositions=a),id:"sidenavPositions",mode:r.mode,slim:!0,backdrop:!1},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{class:"mx-auto text-center"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{onClick:e[0]||(e[0]=a=>r.goTo("/main"))},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{icon:"money-bill-alt",size:"5x"})])),_:1}),(0,t.Wm)(c,{class:(0,n.C_)(["mt-5",{activo:r.router.currentRoute.value.path.startsWith("/menu/caja")}]),onClick:e[1]||(e[1]=a=>r.goTo("/menu/caja"))},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{icon:"piggy-bank",size:"5x"})])),_:1},8,["class"]),(0,t.Wm)(c,{onClick:e[2]||(e[2]=a=>r.goTo("/menu/fichajes")),class:(0,n.C_)(["mt-5",{activo:r.router.currentRoute.value.path.startsWith("/menu/fichajes")}])},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{icon:"door-open",size:"5x"})])),_:1},8,["class"]),(0,t.Wm)(c,{onClick:e[3]||(e[3]=a=>r.activarDevolucion()),class:(0,n.C_)(["mt-5",{activo:r.router.currentRoute.value.path.startsWith("/menu/devolver")}])},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{icon:"trash-alt",size:"5x"})])),_:1},8,["class"]),(0,t.Wm)(c,{onClick:e[4]||(e[4]=a=>r.goTo("/menu/pedidos")),class:(0,n.C_)(["mt-5",{activo:r.router.currentRoute.value.path.startsWith("/menu/pedido")}])},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{icon:"globe",size:"5x"})])),_:1},8,["class"]),(0,t.Wm)(c,{onClick:e[5]||(e[5]=a=>r.goTo("/tecnico")),class:"mt-5"},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{icon:"key",size:"5x"})])),_:1})])),_:1})])),_:1},8,["modelValue","mode"])}o(7658);var m=o(4313),v=o(4870),p=o(2483),f=o(65),b=o(4161),g=o(2492),k=o.n(g),h={name:"LateralComponent",components:{MDBSideNav:m.Bv,MDBSideNavMenu:m.g5,MDBSideNavItem:m.Yx,MDBIcon:m.vm},setup(){const a=(0,p.tv)(),e=(0,f.oR)(),o=(0,v.iH)(!0),n=(0,v.iH)("over"),r=a=>{n.value=a},i=(0,t.Fl)((()=>e.state.Cestas.arrayCestas)),s=(0,t.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),l=(0,t.Fl)((()=>e.state.Trabajadores.indexActivo));(0,t.Fl)((()=>{if(i.value)for(let a=0;a<i.value.length;a++)if(i.value[a]._id==s.value[l.value].idCesta)return i.value[a];return null}));function c(e){a.push(e)}async function u(){await b.Z.post("cestas/crearCestaDevolucion",{idTrabajador:s.value[l.value].idTrabajador}).then((async e=>{if(e.data)return await k().fire({icon:"success",title:"¡Activando modo devolución!",showConfirmButton:!1,timer:500}),a.push("/main");throw Error("No se ha podido crear la devolución.")})).catch((a=>{k().fire("Oops...",a.message,"error")}))}return{sidenavPositions:o,mode:n,setMode:r,router:a,goTo:c,activarDevolucion:u}}},w=o(89);const C=(0,w.Z)(h,[["render",d]]);var D=C,_=o(4286),y=o(2066),j={name:"MenuPrincipalView",components:{LateralComponent:D,ModalErrorDatafonoComponentVue:_.Z},setup(){const a=(0,f.oR)(),e=(0,v.iH)(null),o=(0,y.io)("http://"+a.state.TocGameURL+":5051"),n=(0,p.tv)(),r=(0,t.Fl)((()=>n.currentRoute.value.path)),i=(0,t.Fl)((()=>a.state.Trabajadores.arrayTrabajadores)),s=(0,t.Fl)((()=>a.state.Trabajadores.indexActivo));function l(e){a.dispatch("Trabajadores/setIndexActivo",e)}return o.on("consultaPaytefRefund",(a=>{a.ok})),{arrayTrabajadores:i,setIndexActivo:l,modalErrorDatafonoRef:e,indexActivo:s,actualPage:r}}};const x=(0,w.Z)(j,[["render",u],["__scopeId","data-v-d5cda926"]]);var T=x}}]);
//# sourceMappingURL=359.5c6300eb.js.map