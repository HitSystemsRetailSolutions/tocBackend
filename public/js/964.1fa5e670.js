"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[964],{3449:function(e,a,l){l.d(a,{O:function(){return s}});var o=l(73396),t=l(20065),n=l(91076),i=l(42492),d=l.n(i);function s(){const e=(0,t.oR)(),a=(0,o.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),l=(0,o.Fl)((()=>e.state.Trabajadores.indexActivo)),i=(0,o.Fl)((()=>a.value&&void 0!=l.value&&null!=l.value&&a.value[l.value]?a.value[l.value]:null)),s=(0,o.Fl)((()=>e.state.Cestas.arrayCestas));async function r(e){try{const a=await n.Z.post("clientes/getClienteById",{idCliente:e});if(a.data)return u(a.data);throw new Error("No se ha podido obtener la información del cliente desde el backend")}catch(a){return d().fire("Oops...",a.message,"error"),!1}}async function u(a){const{id:l,nombre:o,albaran:t,vip:d,descuento:r}=a;if(s.value)for(let u=0;u<s.value.length;u++)if(i.value.idCesta===s.value[u]._id){await e.dispatch("Cestas/setClienteCesta",{index:u,idCliente:l,albaran:t,nombreCliente:o,vip:d});e.dispatch("EstadoDinamico/setVistaCliente",!0);const a=t||d||!r?0:r;return e.dispatch("Cestas/setDescuentoAction",Number(a)/100),n.Z.post("cestas/recalcularIvas",{idCesta:s.value[u]._id}),!0}return!1}return{findCliente:r}}},48118:function(e,a,l){l.d(a,{Z:function(){return _}});var o=l(73396),t=l(87139);const n={class:"btn-group"},i={class:"btn-group"},d={class:"btn-group"},s={class:"btn-group"},r=["disabled"],u={class:"btn-group"};function c(e,a,l,c,p,m){return(0,o.wg)(),(0,o.iD)("div",{class:(0,t.C_)(["btn-group-vertical mt-1",{disabled:l.disabled}])},[(0,o._)("div",n,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[0]||(a[0]=e=>c.addTecla("1"))}," 1 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[1]||(a[1]=e=>c.addTecla("2"))}," 2 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[2]||(a[2]=e=>c.addTecla("3"))}," 3 ")]),(0,o._)("div",i,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[3]||(a[3]=e=>c.addTecla("4"))}," 4 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[4]||(a[4]=e=>c.addTecla("5"))}," 5 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[5]||(a[5]=e=>c.addTecla("6"))}," 6 ")]),(0,o._)("div",d,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[6]||(a[6]=e=>c.addTecla("7"))}," 7 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[7]||(a[7]=e=>c.addTecla("8"))}," 8 "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[8]||(a[8]=e=>c.addTecla("9"))}," 9 ")]),(0,o._)("div",s,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[9]||(a[9]=e=>c.deleteTecla())}," < "),(0,o._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[10]||(a[10]=e=>c.addTecla("0"))}," 0 "),(0,o._)("button",{disabled:l.disabledComa,type:"button",class:"btn btn-outline-secondary botonNumpad",onClick:a[11]||(a[11]=e=>c.addTecla("."))}," , ",8,r)]),(0,o._)("div",u,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary botonComa",onClick:a[12]||(a[12]=e=>c.okValue(Number(c.cantidad)))}," OK ")])],2)}l(42492);var p=l(32066),m=l(25994),v=l(44870);const b=(0,p.io)("http://"+m.Z.state.TocGameURL+":5051");var C={props:{useBalanza:{type:Boolean,default:!1},max3EntersDigits:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},disabledComa:{type:Boolean,default:!1}},name:"NumpadComponent",setup(e,{expose:a,emit:l}){const t=(0,v.iH)("0"),n=(0,o.f3)("okValue"),i=(0,v.iH)("5.5rem"),d=(0,v.iH)("5.5rem");(0,o.Fl)((()=>m.Z.state.Weight.lastWeight));function s(){l("activarShake")}function r(a){if(e.max3EntersDigits){let[e,l]=t.value.split("."),o=t.value.includes(".");if(e.length>=3&&!o&&"."!=a)return s();if(l&&l.length>=2)return s();if("."===a&&t.value.includes("."))return s()}"."===a&&t.value.includes(".")||(t.value+=a,"0"==t.value[0]&&(t.value=t.value.slice(1)),l("setValue",t.value))}function u(){t.value=t.value.slice(0,-1),""===t.value&&(t.value="0")}function c(e){t.value=Number(e).toString(),l("setValue",t.value)}return b.on("setBalanzaValue",(a=>{a&&e.useBalanza&&c(a)})),a({cantidad:t,setValor:c}),(0,o.bv)((async()=>{e.useBalanza&&c((await(0,o.Fl)((()=>m.Z.state.Weight.lastWeight))).value)})),{okValue:n,cantidad:t,addTecla:r,deleteTecla:u,setValor:c,anchoTecla:i,altoTecla:d}}},f=l(40089);const y=(0,f.Z)(C,[["render",c],["__scopeId","data-v-7dce7ef7"]]);var _=y},9741:function(e,a,l){l.d(a,{Z:function(){return G}});var o=l(73396),t=l(87139),n=l(49242);const i={class:"row"},d={class:"d-inline-block text-center"},s={class:"row mt-1 p-4"},r={class:"col-md-8"},u={class:"col-md-4"},c={key:0,class:"row"},p={class:"col"},m={class:"table-responsive w-100",style:{height:"400px"}},v={class:"table table-striped mt-1"},b={class:"nameDiv"},C={class:"textoNombre d-inline-block text-truncate"},f={key:1,class:"row"},y={class:"sinResultados position-relative"},_={class:"textoSinResultados position-absolute top-50 start-50 translate-middle"};function B(e,a,l,B,M,k){const g=(0,o.up)("MDBBtn"),w=(0,o.up)("MDBBadge"),D=(0,o.up)("MDBicon"),h=(0,o.up)("MDBModalBody"),T=(0,o.up)("MDBModal"),V=(0,o.up)("ModalNuevoCliente"),x=(0,o.up)("KeyBoardComponentVue"),N=(0,o.up)("ModalCondicionalClienteComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(T,{id:"modalClientes",tabindex:"-1",labelledby:"tituloModalClientes",modelValue:B.modalClientes,"onUpdate:modelValue":a[8]||(a[8]=e=>B.modalClientes=e),staticBackdrop:"",size:"xl"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o._)("div",i,[(0,o._)("div",d,[(0,o.Wm)(g,{color:"warning",class:"sizeBotones",onClick:a[0]||(a[0]=e=>B.clickDelivery("Glovo")),disabled:!B.activoGlovo},{default:(0,o.w5)((()=>[(0,o.Uk)("Glovo")])),_:1},8,["disabled"]),(0,o.Wm)(g,{color:"dark",class:"ms-2 sizeBotones",disabled:!B.activoUber,onClick:a[1]||(a[1]=e=>B.clickDelivery("Uber"))},{default:(0,o.w5)((()=>[(0,o.Uk)("Uber")])),_:1},8,["disabled"]),(0,o.Wm)(g,{color:"primary",class:"ms-2 sizeBotones",disabled:!B.activoToGo,onClick:a[2]||(a[2]=e=>B.clickDelivery("TooGoodToGo"))},{default:(0,o.w5)((()=>[(0,o.Uk)("To Go")])),_:1},8,["disabled"]),(0,o.Wm)(g,{color:"success",class:"ms-2 sizeBotones",onClick:a[3]||(a[3]=e=>B.modalNuevoClienteRef.abrirModal())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("nuevo","Nuevo")),1)])),_:1}),(0,o.Wm)(g,{color:"danger",class:"ms-2 sizeBotones",onClick:a[4]||(a[4]=e=>B.cerrarModal())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("salir","Salir")),1)])),_:1})])]),(0,o._)("div",s,[(0,o._)("div",r,[(0,o.wy)((0,o._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:"Buscar por nombre","aria-label":".form-control-lg example","onUpdate:modelValue":a[5]||(a[5]=e=>B.inputBusqueda=e),onClick:a[6]||(a[6]=e=>B.openKeyboard()),readonly:""},null,512),[[n.nr,B.inputBusqueda]])]),(0,o._)("div",u,[(0,o.Wm)(g,{color:"secondary",class:"botonBusqueda w-100",onClick:a[7]||(a[7]=e=>B.buscar())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("buscar","Buscar")),1)])),_:1})])]),B.arrayClientes?.length>0?((0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("div",p,[(0,o._)("div",m,[(0,o._)("table",v,[(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(B.arrayClientes,((a,l)=>((0,o.wg)(),(0,o.iD)("tr",{key:l},[(0,o._)("td",null,[(0,o._)("div",b,[(0,o._)("span",C,(0,t.zw)(a.nombre),1),(0,o.Uk)("  "),a?.albaran&&a?.noPagaEnTienda?((0,o.wg)(),(0,o.j4)(w,{key:0,badge:"info",class:"text-dark textoAlbaran",pill:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Albaran")])),_:1})):a?.vip||a?.albaran&&!a?.noPagaEnTienda?((0,o.wg)(),(0,o.j4)(w,{key:1,badge:"info",class:"text-dark textoAlbaran",pill:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Vip")])),_:1})):(0,o.kq)("",!0)])]),(0,o._)("td",null,[(0,o.Wm)(g,{color:"primary",size:"lg",onClick:e=>B.selectCliente(a.id,a.nombre),class:"w-100",style:{height:"3.85rem","font-size":"1.5rem"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("elegir","Elegir")),1),(0,o.Wm)(D,{icon:""})])),_:2},1032,["onClick"])])])))),128))])])])])])):((0,o.wg)(),(0,o.iD)("div",f,[(0,o._)("div",y,[(0,o._)("span",_,(0,t.zw)(e.$t("sin_resultados","Sin resultados")),1)])]))])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(V,{ref:"modalNuevoClienteRef"},null,512),(0,o.Wm)(x,{ref:"keyboardRef"},null,512),(0,o.Wm)(N,{ref:"refModalCondicionalCliente",onSetModo:B.updateModo},null,8,["onSetModo"])],64)}var M=l(91076),k=l(74313),g=l(42492),w=l.n(g),D=l(44870),h=l(20065),T=l(23168),V=l(22871),x=l(3449);const N=e=>((0,o.dD)("data-v-fa86e550"),e=e(),(0,o.Cn)(),e),H={class:"h4 mx-2 py-2 border-bottom"},W={class:"d-flex justify-content-between mt-3 mx-2"},z=N((()=>(0,o._)("input",{type:"radio",name:"tipo",id:"tipo1",value:"CONSUMO_PERSONAL"},null,-1))),U={for:"tipo1",class:"h5"},j=N((()=>(0,o._)("input",{type:"radio",name:"tipo",id:"tipo2",value:"VENTA"},null,-1))),F={for:"tipo2",class:"h5"},E={class:"h5"},S=N((()=>(0,o._)("i",{class:"fa fa-exclamation-circle text-danger","aria-hidden":"true"},null,-1)));function Z(e,a,l,n,i,d){const s=(0,o.up)("MDBModalTitle"),r=(0,o.up)("MDBModalHeader"),u=(0,o.up)("MDBModalBody"),c=(0,o.up)("MDBBtn"),p=(0,o.up)("MDBModalFooter"),m=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(m,{id:"modalCondicionalCliente",tabindex:"-1",labelledby:"modalCondicionalCliente",modelValue:n.modalCondicionalCliente,"onUpdate:modelValue":a[4]||(a[4]=e=>n.modalCondicionalCliente=e),staticBackdrop:"",centered:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,{class:"h3 ms-2"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(n.nombreCliente)+" "+(0,t.zw)(e.$t("es_un_trabajador","es un trabajador")),1)])),_:1})])),_:1}),(0,o.Wm)(u,{class:"py-3"},{default:(0,o.w5)((()=>[(0,o._)("h2",H,(0,t.zw)(e.$t("elige_el_tipo_de_cobro","Elige el tipo de cobro"))+": ",1),(0,o._)("div",W,[(0,o._)("div",{class:"inputCondCliente",onClick:a[0]||(a[0]=e=>n.tipo="CONSUMO_PERSONAL")},[z,(0,o._)("label",U,(0,t.zw)(e.$t("consumo_personal","Consumo personal")),1)]),(0,o._)("div",{class:"inputCondCliente",onClick:a[1]||(a[1]=e=>n.tipo="VENTA")},[j,(0,o._)("label",F,(0,t.zw)(e.$t("ticket_normal","Ticket normal")),1)])]),(0,o._)("div",{class:(0,t.C_)([{"d-none":!n.errorValidacionTipo},"m-2 text-center"])},[(0,o._)("p",E,[S,(0,o.Uk)(" "+(0,t.zw)(n.commentError),1)])],2)])),_:1}),(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{color:"success",size:"lg",onClick:a[2]||(a[2]=e=>n.confirmarTipo())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("confirmar","confirmar")),1)])),_:1}),(0,o.Wm)(c,{color:"warning",size:"lg",onClick:a[3]||(a[3]=e=>n.cerrarModalCondicionalCliente())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}var A={name:"ModalCondicionalClienteComponent",components:{MDBModal:k.j3,MDBModalBody:k.Yz,MDBBtn:k.$v,MDBModalHeader:k.ol,MDBModalTitle:k.wo,MDBModalFooter:k.ab,MDBIcon:k.vm,MDBTabs:k.zk,MDBTabNav:k.JH,MDBTabItem:k.kX,MDBTabContent:k.oJ,MDBTabPane:k.jE,MDBSelect:k.R3,MDBPopover:k.SW},setup(e,{expose:a,emit:l}){(0,h.oR)();const o=(0,D.iH)(!1),t=(0,D.iH)(null),n=(0,D.iH)(!1),i=(0,D.iH)(""),d=(0,D.iH)(""),s=(0,D.iH)(null),r=()=>{t.value?(n.value=!1,"CONSUMO_PERSONAL"===t.value?l("setModo",{modo:"CONSUMO_PERSONAL",idCliente:s.value}):l("setModo",{modo:"VENTA",idCliente:s.value}),c()):(n.value=!0,i.value=$t("debes_seleccionar_un_tipo_de_cobro","Debes seleccionar un tipo de cobro"))},u=(e,a=null)=>{o.value=!0,s.value=e,d.value=a},c=()=>{o.value=!1,t.value=null,n.value=!1,i.value="",s.value=null,d.value=""};return a({abrirModal:u}),{modalCondicionalCliente:o,tipo:t,errorValidacionTipo:n,commentError:i,confirmarTipo:r,cerrarModalCondicionalCliente:c,nombreCliente:d}}},O=l(40089);const I=(0,O.Z)(A,[["render",Z],["__scopeId","data-v-fa86e550"]]);var R=I,K={name:"ModalClientesComponent",components:{MDBModal:k.j3,MDBModalBody:k.Yz,MDBBtn:k.$v,ModalNuevoCliente:T.Z,MDBIcon:k.vm,MDBBadge:k.m_,KeyBoardComponentVue:V.Z,ModalCondicionalClienteComponent:R},setup(e,a){const l=(0,h.oR)(),t=(0,D.iH)(!1),n=(0,D.iH)(0),i=(0,D.iH)(null),d=(0,D.iH)(""),s=(0,D.iH)(),r=(0,D.iH)(null),u=(0,D.iH)(!0),c=(0,D.iH)(!0),p=(0,D.iH)(!0),m=(0,o.f3)("actualizarPuntos"),v=(0,o.Fl)((()=>l.state.Trabajadores.arrayTrabajadores)),b=(0,o.Fl)((()=>l.state.Trabajadores.indexActivo)),C=((0,o.Fl)((()=>v.value&&void 0!=b.value&&null!=b.value&&v.value[b.value]?v.value[b.value]:null)),(0,o.Fl)((()=>l.state.Cestas.arrayCestas))),f=(0,o.Fl)((()=>{if(C.value)for(let e=0;e<C.value.length;e++)if(C.value[e]._id==v.value[b.value].idCesta)return C.value[e];return null})),y=(0,D.iH)(!1),_=e=>{W(e)},{findCliente:B}=(0,x.O)();function k(){t.value=!0,V()}function g(){n.value++}function T(e){M.Z.post("clientes/getClienteById",{idCliente:e}).then((a=>{if(!a.data)throw Error("No se ha podido obtener la información del cliente. backend");H(e,a.data.nombre,a.data.albaran,a.data.vip)})).catch((e=>{w().fire("Oops...",e.message,"error")}))}const V=async()=>{const e=await M.Z.post("clientes/getServiciosTienda");e.data?(u.value=!!e.data.includes("Glovo"),c.value=!!e.data.includes("TooGoodToGo"),p.value=!!e.data.includes("Uber")):(u.value=!1,c.value=!1,p.value=!1)},N=async e=>{const a=await M.Z.post("clientes/getClienteByServicio",{servicio:e});if(!a.data)throw Error("No se ha podido obtener la información del cliente. backend");T(a.data)};async function H(e,a){const{data:l}=await M.Z.get("clientes/getIdTrabajadorCliente",{params:{idCliente:e}});if(l&&y.value)y.value.abrirModal(e,a);else{const a=await B(e);a&&(m(),z())}}async function W(e){const a=C.value.findIndex((e=>e._id===f.value._id));-1!==a&&l.dispatch("Cestas/setModoCesta",{index:a,modo:e.modo});const o=await B(e.idCliente);o&&m(),z()}function z(){t.value=!1,d.value=""}function U(){M.Z.post("clientes/buscar",{busqueda:d.value}).then((e=>{s.value=e.data})).catch((e=>{w().fire("Oops...",e.message,"error")}))}let j;async function F(){try{i.value.abrirModal(d.value),j=setInterval((()=>{d.value=i.value.getValue()[0],i.value.getValue()[1]||clearInterval(j)}),100)}catch(e){console.log(e),j=void 0}}return(0,o.YP)(d,(()=>{U()})),a.expose({abrirModal:k,datoBorrar:n,selectCliente:H}),(0,o.JJ)("cerrarModalClientes",z),{test:g,datoBorrar:n,modalClientes:t,inputBusqueda:d,arrayClientes:s,selectCliente:H,buscar:U,keyboardRef:i,openKeyboard:F,modalNuevoClienteRef:r,clickClienteAtajo:T,activoGlovo:u,activoToGo:c,activoUber:p,clickDelivery:N,refModalCondicionalCliente:y,updateModo:_,cerrarModal:z}}};const $=(0,O.Z)(K,[["render",B],["__scopeId","data-v-e6dc36f0"]]);var G=$},23168:function(e,a,l){l.d(a,{Z:function(){return M}});var o=l(73396),t=l(87139);const n={class:"row"},i={class:"col w-50"},d={class:"col w-50 datos"},s={key:0,class:"spinner"},r={key:1};function u(e,a,l,u,c,p){const m=(0,o.up)("MDBModalHeader"),v=(0,o.up)("MDBInput"),b=(0,o.up)("MDBModalBody"),C=(0,o.up)("MDBBtn"),f=(0,o.up)("MDBModalFooter"),y=(0,o.up)("MDBModal"),_=(0,o.up)("KeyBoardComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(y,{id:"modalFichaCliente",tabindex:"-1",labelledby:"tituloModalFichaCliente",modelValue:u.modalFichaCliente,"onUpdate:modelValue":a[16]||(a[16]=e=>u.modalFichaCliente=e),staticBackdrop:"",size:"xl"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o._)("h2",null,"Ficha de "+(0,t.zw)(u.nombre),1)])),_:1}),(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o._)("div",n,[(0,o._)("div",i,[(0,o.Wm)(v,{label:"Nombre",modelValue:u.nombre,"onUpdate:modelValue":a[0]||(a[0]=e=>u.nombre=e),style:{"margin-top":"10px"},readonly:"",onClick:a[1]||(a[1]=e=>u.openKeyBoardCampos("nombre"))},null,8,["modelValue"]),(0,o.Wm)(v,{label:"Telefono",modelValue:u.telefono,"onUpdate:modelValue":a[2]||(a[2]=e=>u.telefono=e),class:"datos",style:{"margin-top":"10px"},readonly:"",onClick:a[3]||(a[3]=e=>u.openKeyBoardCampos("telefono"))},null,8,["modelValue"]),(0,o.Wm)(v,{label:"email",modelValue:u.email,"onUpdate:modelValue":a[4]||(a[4]=e=>u.email=e),class:"datos",style:{"margin-top":"10px"},readonly:"",onClick:a[5]||(a[5]=e=>u.openKeyBoardCampos("email"))},null,8,["modelValue"]),(0,o.Wm)(v,{label:"direccion",modelValue:u.direccion,"onUpdate:modelValue":a[6]||(a[6]=e=>u.direccion=e),class:"datos",style:{"margin-top":"10px"},readonly:"",onClick:a[7]||(a[7]=e=>u.openKeyBoardCampos("direccion"))},null,8,["modelValue"])]),(0,o._)("div",d,[(0,o.Wm)(v,{label:"Tarjeta Cliente",modelValue:u.tarjeta,"onUpdate:modelValue":a[8]||(a[8]=e=>u.tarjeta=e),class:"datos",style:{"margin-top":"10px"},"aria-required":"true",readonly:"",onClick:a[9]||(a[9]=e=>u.openKeyBoardCampos("tarjeta"))},null,8,["modelValue"]),(0,o.Wm)(v,{label:"Nif",modelValue:u.nif,"onUpdate:modelValue":a[10]||(a[10]=e=>u.nif=e),class:"datos",style:{"margin-top":"10px"},readonly:"",onClick:a[11]||(a[11]=e=>u.openKeyBoardCampos("nif"))},null,8,["modelValue"]),(0,o.Wm)(v,{label:"descuento",modelValue:u.descuento,"onUpdate:modelValue":a[12]||(a[12]=e=>u.descuento=e),type:"number",min:"0",max:"100",class:"datos",style:{"margin-top":"10px"},onChange:u.validateDescuento,readonly:"",onClick:a[13]||(a[13]=e=>u.openKeyBoardCampos("descuento"))},null,8,["modelValue","onChange"])])])])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(C,{color:"primary",onClick:a[14]||(a[14]=e=>u.guardarCliente()),disabled:u.loading,class:"btnSpinner d-flex align-items-center justify-content-center"},{default:(0,o.w5)((()=>[u.loading?((0,o.wg)(),(0,o.iD)("span",s)):((0,o.wg)(),(0,o.iD)("span",r,"Guardar"))])),_:1},8,["disabled"]),(0,o.Wm)(C,{color:"danger",onClick:a[15]||(a[15]=e=>u.modalFichaCliente=!1),ref:"salirBoton",disabled:u.loading},{default:(0,o.w5)((()=>[(0,o.Uk)(" Salir ")])),_:1},8,["disabled"])])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(_,{ref:"keyboardRef"},null,512)],64)}var c=l(74313),p=l(44870),m=l(91076),v=l(42492),b=l.n(v),C=l(3449),f=l(22871),y={name:"ModalFichaClienteComponent",props:["callback"],components:{MDBBtn:c.$v,MDBInput:c.u2,MDBModal:c.j3,MDBModalBody:c.Yz,MDBModalFooter:c.ab,MDBModalHeader:c.ol,KeyBoardComponent:f.Z},setup(e,{expose:a}){const l=(0,p.iH)(!1),t=(0,p.iH)(null),n=(0,p.iH)(""),i=(0,p.iH)(""),d=(0,p.iH)(""),s=(0,p.iH)(""),r=(0,p.iH)(""),u=(0,p.iH)(""),c=(0,p.iH)("0"),v=((0,p.iH)(null),(0,p.iH)(null)),f=(0,o.f3)("cerrarModalClientes"),y=(0,p.iH)(!1),{findCliente:_}=(0,C.O)(),B=(0,o.f3)("actualizarPuntos"),M={nombre:n,email:d,direccion:s,tarjeta:r,nif:u,descuento:c,telefono:i},k=async()=>{""!=n.value?isNaN(Number(c.value))?b().fire({title:"Vaya...",text:"El descuento tiene que ser un número",icon:"error",confirmButtonText:"Aceptar"}):(y.value=!0,m.Z.post("clientes/crearNuevoCliente",{nombre:n.value,telefono:i.value,email:d.value,direccion:s.value,tarjetaCliente:r.value,nif:u.value,descuento:c.value}).then((async e=>{if(e.data.success){b().fire({title:"Cliente creado",icon:"success",confirmButtonText:"Aceptar"});const a=await _(e.data.idCliente);a&&B(),y.value=!1,l.value=!1,f&&"function"===typeof f&&f()}else b().fire({title:"Vaya...",text:e.data.message,icon:"error",confirmButtonText:"Aceptar"}),y.value=!1})).catch((e=>{console.log(e),b().fire({title:"Vaya...",text:"Error al crear el cliente",icon:"error",confirmButtonText:"Aceptar"}),y.value=!1}))):b().fire({title:"Vaya...",text:"El campo de nombre y de tarjeta son obligatorios",icon:"error",confirmButtonText:"Aceptar"})};function g(e=""){n.value="",i.value="",d.value="",s.value="",r.value=e,u.value="",c.value="",l.value=!0}function w(e){const a=c.value;if(void 0===a||null===a||""===a)return;const l=a.replace(/[^0-9.]/g,""),[o,n]=l.split("."),i=n&&n.length>2?n.slice(0,2):n,d=o+(i?`.${i}`:""),s=parseFloat(d);let r="";isNaN(s)||(r=s<0?"0":s>100?"100":d),c.value!==r&&(c.value=r,t.value.setText(r))}let D;function h(e){T(M[e])}async function T(e){try{t.value.abrirModal(e.value),D=setInterval((()=>{const a=t.value.getValue()[0];a!==e.value&&(e.value=a),t.value.getValue()[1]||clearInterval(D)}),100)}catch(a){console.log(a),D=void 0}}return(0,o.YP)(c,(e=>{w()})),a({abrirModal:g}),{modalFichaCliente:l,guardarCliente:k,nombre:n,telefono:i,email:d,direccion:s,tarjeta:r,nif:u,descuento:c,salirBoton:v,loading:y,validateDescuento:w,openKeyBoardCampos:h,keyboardRef:t}}},_=l(40089);const B=(0,_.Z)(y,[["render",u],["__scopeId","data-v-4cff42e4"]]);var M=B}}]);
//# sourceMappingURL=964.1fa5e670.js.map