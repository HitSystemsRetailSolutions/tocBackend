"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[760],{32374:function(a,e,l){l.d(e,{Z:function(){return c}});var o=l(73396),t=l(87139);const i={class:"input-group position-absolute bottom-0 start-0"};function s(a,e,l,s,r,n){return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("button",{onClick:e[0]||(e[0]=a=>s.volver()),class:"btn btn-warning ms-2",style:{"font-size":"27px"}},(0,t.zw)(a.$t("volver","VOLVER")),1)])}var r=l(16797),n={name:"VolverComponent",setup(){function a(){r.Z.back()}return{volver:a}}},u=l(40089);const d=(0,u.Z)(n,[["render",s]]);var c=d},79066:function(a,e,l){l.d(e,{Z:function(){return T}});var o=l(73396),t=l(87139);const i={class:"row mt-2"},s={class:"col-md-3"},r={key:0,class:"sizeLetrasCambio"},n={class:"sizeLetrasCambio"},u={key:1,class:"estiloFalta sizeLetrasCambio"},d={key:2,class:"estiloPerfecto sizeLetrasCambio"},c={key:3,class:"estiloSobra sizeLetrasCambio"},v={class:"col-md-9"},m={class:"row"},p={class:"col text-end"},g={class:"row mt-2"},_={class:"col text-end"};function f(a,e,l,f,C,b){const w=(0,o.up)("MDBCardTitle"),k=(0,o.up)("MDBCardText"),y=(0,o.up)("MDBBtn"),T=(0,o.up)("MDBCardBody"),D=(0,o.up)("MDBCard");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",s,[(0,o.Wm)(D,{class:"cardInfoCambio"},{default:(0,o.w5)((()=>[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("informacion_cambio","Información cambio")),1)])),_:1}),(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[null!=f.cantidadTkrs&&void 0!=f.cantidadTkrs?((0,o.wg)(),(0,o.iD)("li",r,(0,t.zw)(a.$t("dinero_recibido","Dinero recibido:"))+" "+(0,t.zw)(Number(f.totalRecibido+f.cantidadTkrs).toFixed(2))+" € ",1)):(0,o.kq)("",!0),(0,o._)("li",n,(0,t.zw)(a.$t("dinero_a_pagar","Dinero a pagar:"))+" "+(0,t.zw)((Math.round(100*f.aPagar)/100).toFixed(2))+" € ",1),null!=f.cuenta&&void 0!=f.cuenta&&f.cuenta>0?((0,o.wg)(),(0,o.iD)("li",u,(0,t.zw)(a.$t("faltan","Faltan"))+" "+(0,t.zw)((Math.round(100*f.cuenta)/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0),null!=f.cuenta&&void 0!=f.cuenta&&0==f.cuenta?((0,o.wg)(),(0,o.iD)("li",d,(0,t.zw)(a.$t("cambio_perfecto","Cambio perfecto")),1)):(0,o.kq)("",!0),null!=f.cuenta&&void 0!=f.cuenta&&f.cuenta<0?((0,o.wg)(),(0,o.iD)("li",c,(0,t.zw)(a.$t("sobran","Sobran"))+" "+(0,t.zw)((Math.round(100*(f.aPagar-f.totalRecibido))/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(y,{size:"lg",color:"warning",onClick:e[0]||(e[0]=a=>f.deshacer()),class:"sizeBotones"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("desahcer","Deshacer")),1)])),_:1}),(0,o.Wm)(y,{size:"lg",color:"danger",class:"sizeBotones",onClick:e[1]||(e[1]=a=>f.limpiar())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("limpiar","Limpiar")),1)])),_:1})])),_:1})])),_:1})]),(0,o._)("div",v,[(0,o._)("div",m,[(0,o._)("div",p,[(0,o._)("img",{src:"/img/1cts.png",class:"sizeMonedas",onClick:e[2]||(e[2]=a=>f.sumar(.01))}),(0,o._)("img",{src:"/img/2cts.png",class:"sizeMonedas",onClick:e[3]||(e[3]=a=>f.sumar(.02))}),(0,o._)("img",{src:"/img/5cts.png",class:"sizeMonedas",onClick:e[4]||(e[4]=a=>f.sumar(.05))}),(0,o._)("img",{src:"/img/10cts.png",class:"sizeMonedas",onClick:e[5]||(e[5]=a=>f.sumar(.1))}),(0,o._)("img",{src:"/img/20cts.png",class:"sizeMonedas",onClick:e[6]||(e[6]=a=>f.sumar(.2))}),(0,o._)("img",{src:"/img/50cts.png",class:"sizeMonedas",onClick:e[7]||(e[7]=a=>f.sumar(.5))}),(0,o._)("img",{src:"/img/uneuro.png",class:"sizeMonedas",onClick:e[8]||(e[8]=a=>f.sumar(1))}),(0,o._)("img",{src:"/img/doseuros.png",class:"sizeMonedas",onClick:e[9]||(e[9]=a=>f.sumar(2))})])]),(0,o._)("div",g,[(0,o._)("div",_,[(0,o._)("img",{src:"/img/5euros.png",class:"sizeBilletes",onClick:e[10]||(e[10]=a=>f.sumar(5))}),(0,o._)("img",{src:"/img/10euros.png",class:"sizeBilletes",onClick:e[11]||(e[11]=a=>f.sumar(10))}),(0,o._)("img",{src:"/img/20euros.png",class:"sizeBilletes",onClick:e[12]||(e[12]=a=>f.sumar(20))}),(0,o._)("img",{src:"/img/50euros.png",class:"sizeBilletes",onClick:e[13]||(e[13]=a=>f.sumar(50))}),(0,o._)("img",{src:"/img/100euros.png",class:"sizeBilletes",onClick:e[14]||(e[14]=a=>f.sumar(100))}),(0,o._)("img",{src:"/img/200euros.png",class:"sizeBilletes",onClick:e[15]||(e[15]=a=>f.sumar(200))}),(0,o._)("img",{src:"/img/500euros.png",class:"sizeBilletes",onClick:e[16]||(e[16]=a=>f.sumar(500))})])])])])}l(57658);var C=l(44870),b=l(74313),w={name:"CambioComponent",components:{MDBCard:b.Yl,MDBCardBody:b.H7,MDBCardTitle:b.QM,MDBCardText:b.Pp,MDBBtn:b.$v},setup(a,{expose:e}){const l=(0,C.iH)(0),t=(0,o.f3)("total"),i=(0,C.iH)(t),s=(0,C.iH)([]),r=(0,C.iH)(0),n=(0,o.Fl)((()=>i.value-r.value<0?0:i.value-(l.value+r.value)));function u(a){l.value+=a,s.value.push(a)}function d(){s.value.pop();let a=0;s.value.forEach((e=>{a+=e})),l.value=a}function c(){l.value=0,s.value=[]}function v(a){r.value=Number(a)}return e({setTkrs:v}),{sumar:u,totalRecibido:l,aPagar:i,deshacer:d,limpiar:c,cantidadTkrs:r,cuenta:n}}},k=l(40089);const y=(0,k.Z)(w,[["render",f],["__scopeId","data-v-0e9fd9d8"]]);var T=y},38020:function(a,e,l){l.d(e,{Z:function(){return _}});var o=l(73396),t=l(87139);const i={class:"row"},s={key:0,class:"cantidad text-center"},r={class:"row mt-2"},n={class:"col text-center"};function u(a,e,l,u,d,c){const v=(0,o.up)("MDBModalTitle"),m=(0,o.up)("MDBModalHeader"),p=(0,o.up)("NumpadComponent"),g=(0,o.up)("MDBModalBody"),_=(0,o.up)("MDBBtn"),f=(0,o.up)("MDBModalFooter"),C=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(C,{id:"modalTkrs",tabindex:"-1",labelledby:"modalTkrsLabel",modelValue:u.modalTkrs,"onUpdate:modelValue":e[1]||(e[1]=a=>u.modalTkrs=a)},{default:(0,o.w5)((()=>[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{id:"modalTkrsLabel"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("introduce_la_cantidad_del_tiquet_restaurante","Introduce la cantidad del tiquet restaurante")),1)])),_:1})])),_:1}),(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o._)("div",i,[u.numPadRef?((0,o.wg)(),(0,o.iD)("span",s,(0,t.zw)(u.numPadRef.cantidad),1)):(0,o.kq)("",!0)]),(0,o._)("div",r,[(0,o._)("div",n,[(0,o.Wm)(p,{ref:"numPadRef"},null,512)])])])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(_,{color:"danger",size:"lg",onClick:e[0]||(e[0]=a=>u.modalTkrs=!1)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("cerrar","Cerrar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}var d=l(74313),c=l(61837),v=l(44870),m={name:"ModalTkrsComponent",components:{MDBModal:d.j3,MDBModalHeader:d.ol,MDBModalTitle:d.wo,MDBModalBody:d.Yz,MDBModalFooter:d.ab,MDBBtn:d.$v,NumpadComponent:c.Z},setup(a,{expose:e}){const l=(0,v.iH)(!1),t=(0,v.iH)(null),i=(0,o.f3)("setTkrs");function s(){l.value=!0}function r(){l.value=!1,i(t.value.cantidad)}return(0,o.JJ)("okValue",r),e({abrirModal:s}),{modalTkrs:l,numPadRef:t,okValue:r}}},p=l(40089);const g=(0,p.Z)(m,[["render",u],["__scopeId","data-v-b796d518"]]);var _=g},60760:function(a,e,l){l.d(e,{Z:function(){return Ja}});var o=l(73396),t=l(87139);const i=a=>((0,o.dD)("data-v-b02918ca"),a=a(),(0,o.Cn)(),a),s={class:"row"},r={class:"row mt-2"},n={class:"col-md-3"},u={class:"text-center"},d={class:"mt-4"},c={id:"detalleTicket"},v={class:"contencionTicket"},m={class:"table"},p={class:"titulosTicket"},g={class:"titulosTicket"},_={class:"titulosTicket"},f=i((()=>(0,o._)("hr",null,null,-1))),C={class:"sizeLetrasCambio"},b={key:0,class:"sizeLetrasCambio"},w={key:1,class:"estiloFalta sizeLetrasCambio"},k={key:2,class:"estiloPerfecto sizeLetrasCambio"},y={key:3,class:"estiloSobra sizeLetrasCambio"},T={class:"col-md-9",style:{"padding-left":"4vmin"}},D={class:"row"},h={class:"col text-end",style:{"margin-top":"2vmin"}},A=["src","onClick"],z={class:"row mt-2"},E={class:"col text-end",style:{"margin-top":"2vmin"}},M=["src","onClick"],B={class:"row"},R={class:"col mt-4"},O={class:"divBotones"},I=["disabled"],P=["disabled"],x=["disabled"],F=["disabled"],j={class:"row"},V={class:"cantidad text-center"},Z={class:"row mt-2"},H={class:"col text-center"},U={key:0,class:"estadoPaytef"},S=i((()=>(0,o._)("h3",null,"Estado:",-1))),N={style:{"margin-top":"1vm","font-weight":"300",color:"orangered","font-size":"1.3em"}},L={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function W(a,e,l,i,W,$){const q=(0,o.up)("MDBCardTitle"),G=(0,o.up)("MDBCardText"),J=(0,o.up)("MDBBtn"),Y=(0,o.up)("MDBCardBody"),K=(0,o.up)("MDBCard"),Q=(0,o.up)("ModalTkrsComponent"),X=(0,o.up)("NumpadComponent"),aa=(0,o.up)("MDBModalBody"),ea=(0,o.up)("MDBModal"),la=(0,o.up)("MDBIcon"),oa=(0,o.up)("CashlogyCobroView");return(0,o.wg)(),(0,o.j4)(ea,{id:"modalCobro",tabindex:"-1",labelledby:"modalCobro",modelValue:i.modalCobro,"onUpdate:modelValue":e[9]||(e[9]=a=>i.modalCobro=a),staticBackdrop:!0,animation:!1,fullscreen:""},{default:(0,o.w5)((()=>[(0,o.Wm)(aa,{style:{"background-color":"#fff5e9"}},{default:(0,o.w5)((()=>[(0,o._)("div",s,[(0,o._)("div",r,[(0,o._)("div",n,[(0,o.Wm)(K,{class:"cardInfoCambio",style:{height:"80vmin"}},{default:(0,o.w5)((()=>[(0,o.Wm)(Y,{style:{display:"flex","flex-direction":"column","justify-content":"space-evenly"}},{default:(0,o.w5)((()=>[(0,o.Wm)(q,null,{default:(0,o.w5)((()=>[(0,o._)("h2",u,(0,t.zw)(a.$t("ticket","Ticket"))+":",1)])),_:1}),(0,o._)("div",d,[(0,o._)("div",c,[(0,o._)("div",v,[(0,o._)("table",m,[(0,o._)("tr",null,[(0,o._)("th",p,(0,t.zw)(a.$t("producto","Producto")),1),(0,o._)("th",g,(0,t.zw)(a.$t("subtotal","Subtotal")),1),(0,o._)("th",_,(0,t.zw)(a.$t("unidades","Unidades")),1)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.productos,((a,e)=>((0,o.wg)(),(0,o.iD)("tr",{key:e,style:(0,t.j5)(a.pagado?"text-decoration: line-through":"")},[(0,o._)("td",null,(0,t.zw)(a.nombre),1),(0,o._)("td",null,(0,t.zw)((a.subtotal-a.subtotal*i.DescuentoCliente).toFixed(2))+" € ",1),(0,o._)("td",null,(0,t.zw)(a.unidades),1)],4)))),128))])]),f])]),(0,o.Wm)(G,null,{default:(0,o.w5)((()=>[(0,o._)("li",C,(0,t.zw)(a.$t("dinero_a_pagar","Dinero a pagar:"))+" "+(0,t.zw)((Math.round(100*(i.aPagar+i.dejaCuenta))/100).toFixed(2))+" € ",1),null!=i.cantidadTkrs&&void 0!=i.cantidadTkrs?((0,o.wg)(),(0,o.iD)("li",b,(0,t.zw)(a.$t("dinero_recibido","Dinero recibido:"))+" "+(0,t.zw)(Number(i.totalRecibido+i.cantidadTkrs+i.dejaCuenta).toFixed(2))+" € ",1)):(0,o.kq)("",!0),null!=i.cuenta&&void 0!=i.cuenta&&i.cuenta>0?((0,o.wg)(),(0,o.iD)("li",w,(0,t.zw)(a.$t("faltan","Faltan"))+" "+(0,t.zw)((Math.round(100*i.cuenta)/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0),null!=i.cuenta&&void 0!=i.cuenta&&0==i.cuenta?((0,o.wg)(),(0,o.iD)("li",k,(0,t.zw)(a.$t("cambio_perfecto","Cambio perfecto")),1)):(0,o.kq)("",!0),null!=i.cuenta&&void 0!=i.cuenta&&i.cuenta<0?((0,o.wg)(),(0,o.iD)("li",y,(0,t.zw)(a.$t("sobran","Sobran"))+" "+(0,t.zw)((Math.round(100*(i.aPagar-i.totalRecibido))/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0)])),_:1}),(0,o._)("div",null,[(0,o.Wm)(J,{size:"lg",color:"warning",onClick:e[0]||(e[0]=a=>i.deshacer()),class:"sizeBotones"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("desahcer","Deshacer")),1)])),_:1}),(0,o.Wm)(J,{size:"lg",color:"danger",class:"sizeBotones",onClick:e[1]||(e[1]=a=>i.limpiar())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("limpiar","Limpiar")),1)])),_:1})])])),_:1})])),_:1})]),(0,o._)("div",T,[(0,o._)("div",D,[(0,o._)("div",h,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)([.01,.02,.05,.1,.2,.5,1,2],(a=>(0,o._)("img",{src:"/img/"+(a<1?100*a+"cts":1==a?"uneuro":"doseuros")+".png",class:"sizeMonedas",onClick:e=>i.sumar(a)},null,8,A))),64))])]),(0,o._)("div",z,[(0,o._)("div",E,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)([5,10,20,50,100,200,500],(a=>(0,o._)("img",{src:"/img/"+a+"euros.png",class:"sizeBilletes",onClick:e=>i.sumar(a)},null,8,M))),64))])]),(0,o._)("div",B,[(0,o._)("div",R,[(0,o._)("div",O,[(0,o._)("img",{disabled:i.loading,src:"img/img-efectivo.png",onClick:e[2]||(e[2]=a=>i.setFormaPago("EFECTIVO")),style:(0,t.j5)("EFECTIVO"===i.formaPago?"zoom: 1.3;":"filter: grayscale(1);"),width:"300",alt:"Seleccionar pago con EFECTIVO"},null,12,I),i.modalTkrsRef&&!i.prohibirTkRestaurant?((0,o.wg)(),(0,o.iD)("img",{key:0,disabled:i.loading,src:"img/img-tkrs.png",onClick:e[3]||(e[3]=a=>i.loading?null:i.modalTkrsRef.abrirModal()),style:(0,t.j5)("TKRS"===i.formaPago?"zoom: 1.3;":"filter: grayscale(1);"),width:"300",alt:"Seleccionar pago con ticket restaurante"},null,12,P)):(0,o.kq)("",!0),0===i.tipoDatafono3G?((0,o.wg)(),(0,o.iD)("img",{key:1,disabled:i.loading,src:"img/img-tarjetas.png",onClick:e[4]||(e[4]=a=>i.setFormaPago("TARJETA")),style:(0,t.j5)("TARJETA"===i.formaPago?"zoom: 1.3;":"filter: grayscale(1);"),width:"300",alt:"Seleccionar pago con TARJETA"},null,12,x)):(0,o.kq)("",!0),1===i.tipoDatafono3G?((0,o.wg)(),(0,o.iD)("img",{key:2,disabled:i.loading,src:"img/img-3g.png",onClick:e[5]||(e[5]=a=>i.setFormaPago("DATAFONO_3G")),style:(0,t.j5)("DATAFONO_3G"===i.formaPago?"zoom: 1.3;":"filter: grayscale(1);"),width:"300",alt:"Seleccionar pago con DATAFONO 3G"},null,12,F)):(0,o.kq)("",!0)])])])])])]),(0,o.Wm)(Q,{ref:"modalTkrsRef"},null,512),(0,o.Wm)(ea,{id:"modalNumpad",tabindex:"-1",labelledby:"modalTkrsLabel",modelValue:i.modalNumpad,"onUpdate:modelValue":e[6]||(e[6]=a=>i.modalNumpad=a)},{default:(0,o.w5)((()=>[(0,o.Wm)(aa,null,{default:(0,o.w5)((()=>[(0,o._)("div",j,[(0,o._)("span",V,(0,t.zw)(),1)]),(0,o._)("div",Z,[(0,o._)("div",H,[(0,o.Wm)(X,{ref:"numPadRef"},null,512)])])])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(J,{class:"ms-2 botoncicos-abajo volver",disabled:i.loading,color:"warning",onClick:e[7]||(e[7]=a=>i.cancelarVenta())},{default:(0,o.w5)((()=>[(0,o.Wm)(la,{icon:"arrow-left"})])),_:1},8,["disabled"]),i.loading?((0,o.wg)(),(0,o.iD)("div",U,[(0,o._)("div",null,[S,(0,o._)("span",N,(0,t.zw)(i.procesoDatafono),1)])])):(0,o.kq)("",!0),(0,o.Wm)(J,{class:"botonCobrar botoncicos-abajo",color:"primary",disabled:i.loading,onClick:e[8]||(e[8]=a=>i.cobrar()),style:{right:"4vmin"}},{default:(0,o.w5)((()=>[i.loading?((0,o.wg)(),(0,o.iD)("span",L)):(0,o.kq)("",!0),(0,o.Uk)(" "+(0,t.zw)(a.$t("pagar","Pagar")),1)])),_:1},8,["disabled"]),(0,o.Wm)(oa,{ref:"CashlogyCobroViewRef"},null,512)])),_:1})])),_:1},8,["modelValue"])}l(57658);var $=l(44870),q=l(79066),G=l(32374),J=l(38020),Y=l(42492),K=l.n(Y),Q=l(61837),X=l(49242),aa=l(74313),ea=l(92136),la=l(12195),oa=l(16136),ta=l(66720),ia=l(66631),sa=l(13150),ra=l(16683),na=l(34730),ua=l(88807);const da=a=>((0,o.dD)("data-v-3aa0abf0"),a=a(),(0,o.Cn)(),a),ca={key:0,class:"w-100 h-100"},va={key:0,class:"d-flex flex-column w-100 h-100",style:{"justify-content":"start"}},ma=["src","onClick"],pa=["src","onClick"],ga={class:"frame-Cashlogy",style:{flex:"1 1 auto"}},_a={class:"col-9 h-100"},fa={class:"frame-Cashlogy flex-column",style:{"justify-content":"start"}},Ca={style:{"text-align":"start","padding-top":"4rem"}},ba=da((()=>(0,o._)("br",null,null,-1))),wa={key:0},ka={key:1},ya={key:2},Ta={class:"col h-100"},Da={class:"frame-Cashlogy flex-column"},ha=da((()=>(0,o._)("label",null,"Importe entrada manual",-1))),Aa=da((()=>(0,o._)("br",null,null,-1))),za={key:0,style:{flex:"0 0 20%"},class:"items-Cashlogy"},Ea={key:1,style:{flex:"0 0 20%"},class:"items-Cashlogy"},Ma={key:1,class:"frame-Cashlogy flex-column"},Ba=da((()=>(0,o._)("br",null,null,-1))),Ra={key:2,class:"frame-Cashlogy flex-column"},Oa=da((()=>(0,o._)("br",null,null,-1))),Ia={key:1,class:"frame-Cashlogy flex-column"},Pa={class:"d-flex flex-column",style:{gap:"2px"}},xa=da((()=>(0,o._)("span",null,"Falta cambios para la devolución",-1))),Fa={key:2,class:"frame-Cashlogy flex-column"},ja={class:"d-flex flex-column",style:{gap:"2px"}},Va={key:3,class:"frame-Cashlogy flex-column"},Za=da((()=>(0,o._)("br",null,null,-1)));var Ha={__name:"CashlogyCobroView",setup(a,{expose:e}){const l=(0,$.iH)(null),i=(0,$.iH)(null),s=(0,$.iH)(""),r=(0,$.iH)(""),n=(0,$.iH)(""),u=(0,$.iH)(""),d=(0,$.iH)(""),c=(0,$.iH)(""),v=(0,$.iH)(!1),m=(0,$.iH)(!1),p=(0,$.iH)(!1);(0,$.iH)(!1);async function g(){return sa.Z.activado()}const _=(0,$.iH)({});function f(){m.value=!0,sa.Z.boton_pulsar("BOT_CANCELAR")}const C=(0,$.iH)(!1);function b(){C.value=!0,k.value=(0,ra.vg)(y)}function w(a){y=(0,ra.ul)((0,ra.XX)(h())+a),k.value=(0,ra.vg)(y)}const k=(0,$.iH)("");let y=0,T=(0,ra.vg)(1.23).charAt(1),D=2;function h(){if(!k.value)return 0;let a=k.value,[e,l]=a.split(T);e||(e="0"),l||(l="0");while(l.length<D)l+="0";let o=100*parseInt(e,10)+parseInt(l,10);return o/100}function A(a){let e=k.value,[l,o]=e.split(T);if("number"==typeof a){if(null!=o){if(o.length>=D)return}else if(l.length>=8)return;"0"==e&&(e=""),e+=a.toString(),k.value=e}else if("C"==a)e="",k.value=e;else if(a==T){if(null!=o)return;""==e&&(e="0"),e+=a,k.value=e}y=h()}function z(){C.value=!1,y=h(),sa.Z.importe_entrado_manualmente_en_cobrar(y)}function E(){C.value=!1}const M=new ra.JQ((a=>{n.value=(0,ra.vg)(a,!0),O.value="PANTALLA_FALTA_CAMBIO_DEVOLUCION"}));function B(){p.value=!0,sa.Z.boton_pulsar("BOT_ACEPTAR")}const R=(0,$.iH)(),O=(0,$.iH)(null);function I(a){ea.socket[a]("Cashlogy.update",P)}function P(a){switch(O.value=a.proceso,a.proceso){case"COBRAR":switch(R.value=a.state,a.state){case"ENTRADA":s.value=(0,ra.vg)(a.importe_entrado,!0),v.value=a.importe_pendiente<0,v.value?n.value=(0,ra.vg)(-a.importe_pendiente,!0):r.value=(0,ra.vg)(a.importe_pendiente,!0),c.value=(0,ra.vg)(a.importe_entrado_manualmente,!0);break;case"VUELTA":case"CANCELAR":n.value=(0,ra.vg)(a.importe_a_devolver,!0);break}break;case"AÑADIR_CAMBIOS":_.value=(0,ra.c)(a),u.value=(0,ra.vg)(a.importe_entrado,!0),d.value=(0,ra.vg)(a.importe_recicladores,!0);break;case"SOLO_DISPENSAR":n.value=(0,ra.vg)(a.importe_a_devolver,!0);break}}let x=!1;async function F(a){let e,{aPagar:o,totalRecibido:t,cantidadTkrs:s}=a;x=!0,O.value=null,ua.Z.Info(a,"CashlogyCobroView","run-in"),await(0,ra.R_)(l),l.value.start(),I("on");try{await sa.Z.saveGrupoProcesos("COBRAR",{importe_a_cobrar:o}),m.value=!1,await sa.Z.importe_entrado_manualmente_en_cobrar(t+s);let a=await sa.Z.cobrar(o);if(null!=a.importe_entrado&&await sa.Z.saveGrupoProcesos(null,{importe_entrado:a.importe_entrado}),e=await(l.value?.informacionAbort_y_cancel(a)),a.manual)e||(e={}),e.manual=!0;else if(null==e?.abort_id){e=null;let o=a.importe_falta_devolver??0;if(0==o)e={cancelado:a.cancelado,importe_falta_devolver:0,importe_anadido_en_cambios:0};else{let t=0,s=a.error_en_la_devolucion;while(!e){O.value="ERROR_DEVOLUCION",await(0,ra.R_)(i),await i.value.run({error_en_la_devolucion:s});let r=await M.start(a.importe_falta_devolver);if("AÑADIR"==r){O.value=null,p.value=!1;let i=await sa.Z.anadir_cambios_y_devolver(o);e=await(l.value?.informacionAbort_y_cancel(a)),e?e.importe_falta_devolver=o:(s=i.error_en_la_devolucion,o=i.importe_falta_devolver,t+=i.importe_anadido_en_cambios,await sa.Z.saveGrupoProcesos(null,{importe_anadido_en_cambios:t}),0==o&&(e={cancelado:a.cancelado,importe_falta_devolver:0,importe_anadido_en_cambios:t}))}else e={cancelado:a.cancelado,importe_falta_devolver:o,importe_anadido_en_cambios:t}}}}e.abort_id||(await sa.Z.saveGrupoProcesos(null),await(0,na.i_)(e.importe_anadido_en_cambios,"Añadir Cambios","ENTRADA_DINERO"))}catch(r){console.log(r),e={cancelado:!0}}return I("off"),l.value?.end(),ua.Z.Info(e,"CashlogyCobroView","run-out"),x=!1,e}return(0,o.Ah)((()=>{x&&sa.Z.boton_pulsar("BOT_ABORTAR_Y_CANCELAR")})),e({run:F,activado:g}),(a,e)=>((0,o.wg)(),(0,o.j4)(ia.Z,{enProceso:null!=O.value,ref_key:"CashlogyPantalla_ref",ref:l},{default:(0,o.w5)((()=>["COBRAR"==O.value?((0,o.wg)(),(0,o.iD)("div",ca,["ENTRADA"==R.value?((0,o.wg)(),(0,o.iD)("div",va,[(0,o._)("div",{class:"text-end",style:(0,t.j5)({visibility:C.value?"visible":"hidden"})},[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)([1,2,5,10,20,50,100,200],(a=>(0,o._)("img",{src:(0,$.SU)(ra.Cq)("monedas",a),class:"sizeMonedas",onClick:e=>w(a)},null,8,ma))),64))],4),(0,o._)("div",{class:"text-end",style:(0,t.j5)([{"margin-top":"2vmin"},{visibility:C.value?"visible":"hidden"}])},[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)([500,1e3,2e3,5e3,1e4,2e4,5e4],(a=>(0,o._)("img",{src:(0,$.SU)(ra.Cq)("billetes",a),class:"sizeBilletes",onClick:e=>w(a)},null,8,pa))),64))],4),(0,o._)("div",ga,[(0,o._)("div",_a,[(0,o._)("div",fa,[(0,o._)("div",Ca,[(0,o.Uk)(" Importe entrado: "+(0,t.zw)(s.value),1),ba,v.value?((0,o.wg)(),(0,o.iD)("div",ka," Importe a devolver: "+(0,t.zw)(n.value),1)):((0,o.wg)(),(0,o.iD)("div",wa," Importe pendiente: "+(0,t.zw)(r.value),1)),c.value?((0,o.wg)(),(0,o.iD)("div",ya," Importe manual: "+(0,t.zw)(c.value),1)):(0,o.kq)("",!0)])])]),(0,o._)("div",Ta,[(0,o._)("div",Da,[(0,o._)("div",{style:(0,t.j5)([{flex:"0 0 35%","align-content":"center"},{visibility:C.value?"visible":"hidden"}])},[((0,o.wg)(),(0,o.j4)(ta.Z,{key:0,tipo_importe:"",onClickKey:A}))],4),(0,o._)("div",{style:(0,t.j5)({visibility:C.value?"visible":"hidden"})},[ha,Aa,(0,o.wy)((0,o._)("input",{type:"text",readonly:"",onFocus:e[0]||(e[0]=a=>{a.currentTarget?.blur?.()}),"onUpdate:modelValue":e[1]||(e[1]=a=>k.value=a),class:"cashlogyCierreFondoCaja_selected",style:{"text-align":"end","border-radius":"4px"}},null,544),[[X.nr,k.value]])],4),C.value?((0,o.wg)(),(0,o.iD)("div",za,[(0,o.Wm)((0,$.SU)(aa.$v),{onClick:z,outline:"success",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Aceptar ")])),_:1}),(0,o.Wm)((0,$.SU)(aa.$v),{onClick:E,outline:"danger",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Cancelar ")])),_:1})])):((0,o.wg)(),(0,o.iD)("div",Ea,[(0,o.Wm)((0,$.SU)(aa.$v),{disabled:m.value,onClick:f,color:"danger",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Cancelar ")])),_:1},8,["disabled"]),(0,o.Wm)((0,$.SU)(aa.$v),{disabled:m.value,onClick:b,color:"warning",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Cobro Manual ")])),_:1},8,["disabled"])]))])])])])):(0,o.kq)("",!0),"VUELTA"==R.value?((0,o.wg)(),(0,o.iD)("div",Ma,[(0,o.Uk)(" Dispensando"),Ba,(0,o.Uk)(" Importe a devolver: "+(0,t.zw)(n.value),1)])):(0,o.kq)("",!0),"CANCELAR"==R.value?((0,o.wg)(),(0,o.iD)("div",Ra,[(0,o.Uk)(" Cancelando"),Oa,(0,o.Uk)(" Importe a devolver: "+(0,t.zw)(n.value),1)])):(0,o.kq)("",!0)])):(0,o.kq)("",!0),"PANTALLA_FALTA_CAMBIO_DEVOLUCION"==O.value?((0,o.wg)(),(0,o.iD)("div",Ia,[(0,o._)("div",Pa,[xa,(0,o._)("span",null,"Importe falta devolver: "+(0,t.zw)(n.value),1),(0,o.Wm)((0,$.SU)(aa.$v),{onClick:e[2]||(e[2]=a=>(0,$.SU)(M).R("AÑADIR")),color:"success",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" añadir cambios ")])),_:1}),(0,o.Wm)((0,$.SU)(aa.$v),{onClick:e[3]||(e[3]=a=>(0,$.SU)(M).R("MANUAL")),color:"warning",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" devolucion manual ")])),_:1})])])):(0,o.kq)("",!0),"AÑADIR_CAMBIOS"==O.value?((0,o.wg)(),(0,o.iD)("div",Fa,[(0,o.Wm)(la.Z,{tabla:_.value,style:{flex:"0 0 75%"}},null,8,["tabla"]),(0,o._)("div",ja,[(0,o._)("span",null,"Importe introducido : "+(0,t.zw)(u.value),1),(0,o._)("span",null,"Importe total: "+(0,t.zw)(d.value),1),(0,o._)("span",null,"Importe falta devolver: "+(0,t.zw)(n.value),1),(0,o.Wm)((0,$.SU)(aa.$v),{disabled:p.value,onClick:B,color:"success",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Aceptar ")])),_:1},8,["disabled"])])])):(0,o.kq)("",!0),"SOLO_DISPENSAR"==O.value?((0,o.wg)(),(0,o.iD)("div",Va,[(0,o._)("div",null,[(0,o.Uk)(" Dispensando"),Za,(0,o.Uk)(" Importe a devolver: "+(0,t.zw)(n.value),1)])])):(0,o.kq)("",!0),"ERROR_DEVOLUCION"==O.value?((0,o.wg)(),(0,o.j4)(oa.Z,{key:4,ref_key:"CashlogyErrorDevolucion_ref",ref:i},null,512)):(0,o.kq)("",!0)])),_:1},8,["enProceso"]))}},Ua=l(40089);const Sa=(0,Ua.Z)(Ha,[["__scopeId","data-v-3aa0abf0"]]);var Na=Sa,La=l(91076),Wa=l(20065),$a=l(22483),qa={name:"CobroView",components:{CambioComponent:q.Z,MDBCard:aa.Yl,MDBBtn:aa.$v,MDBCardBody:aa.H7,MDBCardText:aa.Pp,NumpadComponent:Q.Z,VolverComponent:G.Z,ModalTkrsComponent:J.Z,MDBIcon:aa.vm,MDBModal:aa.j3,MDBModalBody:aa.Yz,CashlogyCobroView:Na},setup(a,{expose:e}){const l=(0,Wa.oR)(),t=(0,$.iH)(!1),i=(0,$.iH)(!1),s=(0,$a.tv)(),r=(0,o.Fl)((()=>l.state.Datafono.procesoActual)),n=(0,$.iH)(null),u=(0,$.iH)("EFECTIVO"),d=(0,$.iH)(0),c=(0,$.iH)(null),v=(0,$.iH)(!1),m=(0,$.iH)(!1),p=(0,$.iH)(!1),g=(0,$.iH)(0),_=(0,$.iH)(!1),f=(0,$.iH)(0),C=(0,$.iH)(0),b=(0,$.iH)([]),w=(0,$.iH)(null),k=(0,o.Fl)((()=>O.value?.lista)),y=((0,o.f3)("resetGeneral"),(0,$.iH)(null));let T=(0,o.Fl)((()=>C.value-g.value<0?0:C.value-(f.value+g.value)));const D=(0,o.Fl)((()=>l.state.Trabajadores.indexActivo)),h=(0,o.Fl)((()=>l.state.Trabajadores.arrayTrabajadores)),A=(0,o.Fl)((()=>l.state.Cestas.arrayCestas)),z=(0,o.Fl)((()=>{const a=l.state.Cestas.Descuento;return void 0===a||isNaN(a)?0:a})),E=(0,o.Fl)((()=>h.value&&void 0!=D.value&&null!=D.value&&h.value[D.value]?h.value[D.value]:null)),M=(0,o.Fl)((()=>l.state.Deudas.deudasSeleccionadas)),B=(0,o.Fl)((()=>l.state.Encargos.encargoSeleccionado)),R=(0,o.Fl)((()=>{if(M.value.length>0){let a=0;for(const e of M.value)e.dejaCuenta&&(a+=e.dejaCuenta);return a}return B.value&&B.value.dejaCuenta||0}));let O=(0,$.iH)(null);function I(a){g.value=Number(a),a>=W(O.value)?u.value="TKRS":u.value="EFECTIVO"}function P(a){_.value||(g.value<W(O.value)&&g.value>=0?"TARJETA"===a&&g.value>0?K().fire("Oops...","De momento el Ticket Restaurant solo se puede combinar con EFECTIVO","error"):u.value=a:K().fire("¡Eo!","El ticket resturant ya cubre el total de la venta","error"))}async function x(a){O=(0,o.Fl)((()=>{if(A.value)for(let a=0;a<A.value.length;a++)if(A.value[a]._id==h.value[D.value].idCesta)return A.value[a];return null}));const e=O.value?O.value.lista.filter((a=>a.pagado)).reduce(((a,e)=>a+e.subtotal),0):0;C.value=O.value?W(O.value)-e:0,t.value=!0}async function F(){_.value?ua.Z.Warn(`cobrar loading.value: ${_.value}`,"modalCobroView.vue"):(_.value=!0,ua.Z.Info("cobrar inicio","modalCobroView.vue"),"PAGO DEUDA"==O.value.modo?await j():await V())}async function j(){try{let a;if("TARJETA"==u.value)a=await La.Z.post("deudas/crearPagoDeudaPaytef",{total:W(O.value),idCesta:O.value._id,idTrabajador:E.value._id,tipo:u.value,tkrsData:{cantidadTkrs:g.value,formaPago:"EFECTIVO"},arrayDeudas:M.value});else{if("EFECTIVO"==u.value&&T.value>0&&await w.value.activado()){let a=await w.value.run({aPagar:C.value,totalRecibido:f.value,cantidadTkrs:g.value});if(a.cancelado)throw new Error("Pago cancelado")}a=await La.Z.post("deudas/crearPagoDeuda",{total:W(O.value),idCesta:O.value._id,idTrabajador:E.value._id,tipo:u.value,tkrsData:{cantidadTkrs:g.value,formaPago:"EFECTIVO"},arrayDeudas:M.value})}if(!a.data){if("TARJETA"==u.value)throw Error("Pago con datáfono invalido");throw Error("No se ha podido crear el pago de deuda")}K().fire({icon:"success",title:"Pago deuda registrada correctamente",showConfirmButton:!1,timer:500}),await La.Z.post("impresora/saludo").catch((a=>{K().fire("Oops...",a.message,"error")})),H(),await L(O.value._id),u.value="EFECTIVO",N(!0)}catch(a){K().fire("Oops...",a.message,"error")}_.value=!1,Y()}async function V(){try{const a=JSON.parse(JSON.stringify(O.value.lista)),e=a.some((a=>a.pagado));let o;const t="PAGO SEPARADO"==O.value.modo,i="RECOGER ENCARGO"==O.value.modo;if("TARJETA"==u.value)l.dispatch("Datafono/setEstado","PENDIENTE"),o=await La.Z.post("tickets/crearTicketPaytef",{total:W(O.value),idCesta:O.value._id,idTrabajador:E.value._id,tipo:u.value,tkrsData:{cantidadTkrs:Number((Math.round(100*g.value)/100).toFixed(2)),formaPago:"EFECTIVO"},honei:e,dejaCuenta:R.value});else{if("EFECTIVO"==u.value&&T.value>0&&await w.value.activado()){let a=await w.value.run({aPagar:C.value,totalRecibido:f.value,cantidadTkrs:g.value});if(a.cancelado)throw new Error("Pago cancelado")}o=await La.Z.post("tickets/crearTicket",{total:W(O.value),idCesta:O.value._id,idTrabajador:E.value._id,tipo:u.value,tkrsData:{cantidadTkrs:Number((Math.round(100*g.value)/100).toFixed(2)),formaPago:"EFECTIVO"},honei:e,dejaCuenta:R.value})}if(!o.data){if("TARJETA"==u.value)throw Error("Pago con datáfono invalido");throw Error("No se ha podido crear el ticket")}R.value>0&&i&&La.Z.post("movimientos/nuevoMovimiento",{cantidad:R.value,concepto:"dejaACuenta",idTrabajador:E.value._id,tipo:"SALIDA"}).then((a=>{if(!a.data)throw Error("No se ha podido realizar la salida de dinero")})).catch((a=>{K().fire("Oops...",a.message,"error")})),K().fire({icon:"success",title:"Venta registrada correctamente",showConfirmButton:!1,timer:500}),await La.Z.post("impresora/saludo").catch((a=>{K().fire("Oops...",a.message,"error")})),p.value&&"TARJETA"!=u.value&&await La.Z.post("tickets/getUltimoTicket").then((async a=>{a.data[0]?._id?await La.Z.post("impresora/imprimirTicket",{idTicket:a.data[0]?._id}).catch((a=>{K().fire("Oops...",a.message,"error")})):K().fire("AVISO","Crea un ticket en esta caja abierta","info")})),i&&await La.Z.post("cestas/deselectClient",{idCesta:l.getters["Cestas/getCestaBaseActivo"]}),(t||i)&&await L(O.value._id),i&&(La.Z.post("encargos/setEntregado",{id:B.value._id}),U()),Z(),u.value="EFECTIVO",N(!0)}catch(a){K().fire("Oops...",a.message,"error")}_.value=!1,Y(),ua.Z.Info("cobrar fin","modalCobroView.vue")}function Z(){let a=!1;A.value.forEach((e=>{if(!a&&e.trabajador===h.value[D.value]._id&&"DEVOLUCION"!=e.modo){a=!0;let l=e._id;La.Z.post("cestas/cambiarCestaTrabajador",{idCesta:l,idTrabajador:h.value[D.value]._id})}}))}function H(){l.dispatch("Deudas/deleteDeudasSeleccionadas")}function U(){l.dispatch("Encargos/deleteEncargoSeleccionado")}async function S(){ua.Z.Info(`cancelarVenta loading:${_.value}`,"modalCobroView.vue"),N(),Y(),"PAGO DEUDA"==O.value.modo?(H(),await L(O.value._id)):"PAGO SEPARADO"==O.value.modo&&await La.Z.post("cestas/DevolverProductosACestaSep",{cesta:l.getters["Cestas/getCestaBaseActivo"],articulos:O.value.lista}).then((async a=>{await L(O.value._id)}))}function N(a=!1){const e=s.currentRoute.value.path;l.dispatch("ModalCobroView/cerrarModalCobroView"),"/cestas"===e&&a&&s.push("/main"),t.value=!1}async function L(a){La.Z.post("cestas/fulminarCesta",{idCesta:a}).catch((a=>{K().fire({icon:"error",title:"Error al eliminar la cesta utilizada.",showConfirmButton:!1,timer:500})})),await La.Z.post("cestas/cambiarCestaTrabajador",{idCesta:l.getters["Cestas/getCestaBaseActivo"],idTrabajador:h.value[l.state.Trabajadores.indexActivo]._id}).then((a=>{l.dispatch("Cestas/setCestaBaseAction",null)}))}function W(a){let e=a.detalleIva.importe1+a.detalleIva.importe2+a.detalleIva.importe3+a.detalleIva.importe4+a.detalleIva.importe5;return e-=R.value,e=Math.round(100*e)/100,e}function q(){La.Z.get("caja/estadoCaja").then((a=>{1==a.data&&K().fire("Caja cerrada automáticamente.","La caja de ayer se ha cerrado automáticamente debido a que no se cerró.","error"),1!=a.data&&3!=a.data||void 0==l.getters["Trabajadores/getTrabajadorActivo"]?._id?void 0==l.getters["Trabajadores/getTrabajadorActivo"]?._id&&s.push("/menu/fichajes"):s.push("/abrirCaja")})).catch((a=>{K().fire("Oops...",a.message,"error")}))}function G(a){f.value+=a,b.value.push(a)}function J(){b.value.pop();let a=0;b.value.forEach((e=>{a+=e})),f.value=a}function Y(){f.value=0,g.value=0,b.value=[],T=(0,o.Fl)((()=>C.value-g.value<0?0:C.value-(f.value+g.value)))}function Q(a){C.value=Number(a)}return(0,o.JJ)("setTkrs",I),e({abrirModal:x}),(0,o.bv)((()=>{q(),La.Z.post("parametros/getParametros").then((a=>{"3G"!==a.data?.tipoDatafono&&"0.0.0.0"!=a.data?.ipTefpay||(d.value=1),void 0!=a.data?.params?.SempreTicket?"Si"==a.data?.params?.SempreTicket&&(p.value=!0):p.value=!1,void 0!=a.data?.params?.prohibirTkRestaurant?"Si"==a.data?.params?.prohibirTkRestaurant&&(v.value=!0):v.value=!1,void 0!=a.data?.params?.TicketDFAuto?"Si"==a.data?.params?.TicketDFAuto&&(m.value=!0):m.value=!1}))})),{DescuentoCliente:z,cesta:O,getTotal:W,cobrar:F,formaPago:u,modalTkrsRef:c,prohibirTkRestaurant:v,setFormaPago:P,loading:_,tipoDatafono3G:d,eliminarAlPagarFnc:L,modalNumpad:i,cancelarVenta:S,modalCobro:t,abrirModal:x,sumar:G,totalRecibido:f,aPagar:C,numPadRef:n,deshacer:J,limpiar:Y,procesoDatafono:r,setTkrs:I,cantidadTkrs:g,setAPagar:Q,cuenta:T,productos:k,TicketDFAuto:m,cliente:y,dejaCuenta:R,CashlogyCobroViewRef:w}}};const Ga=(0,Ua.Z)(qa,[["render",W],["__scopeId","data-v-b02918ca"]]);var Ja=Ga}}]);
//# sourceMappingURL=760.542c90ac.js.map