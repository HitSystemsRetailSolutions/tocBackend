"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[748],{1464:function(e,a,o){o.d(a,{Z:function(){return P}});var l=o(3396),t=o(7139),n=o(9242);const i={class:"row"},r={class:"d-inline-block text-center"},c={class:"row mt-1 p-4"},s={class:"col-md-8"},d={class:"col-md-4"},u={key:0,class:"row"},m={class:"col"},_={class:"table-responsive w-100",style:{height:"400px"}},v={class:"table table-striped mt-1"},p={class:"textoNombre d-inline-block text-truncate"},C={key:1,class:"row"},g={class:"sinResultados position-relative"},f={class:"textoSinResultados position-absolute top-50 start-50 translate-middle"};function b(e,a,o,b,k,w){const h=(0,l.up)("MDBBtn"),y=(0,l.up)("MDBModalBody"),B=(0,l.up)("MDBModal"),D=(0,l.up)("ModalNuevoCliente");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(B,{id:"modalClientes",tabindex:"-1",labelledby:"tituloModalClientes",modelValue:b.modalClientes,"onUpdate:modelValue":a[7]||(a[7]=e=>b.modalClientes=e),staticBackdrop:"",size:"xl"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l._)("div",r,[(0,l.Wm)(h,{color:"warning",class:"sizeBotones",onClick:a[0]||(a[0]=e=>b.clickClienteAtajo("CliBoti_000_{A83B364B-252F-464B-B0C3-AA89DA258F64}"))},{default:(0,l.w5)((()=>[(0,l.Uk)("Glovo")])),_:1}),(0,l.Wm)(h,{color:"dark",class:"ms-2 sizeBotones",onClick:a[1]||(a[1]=e=>b.clickClienteAtajo("CliBoti_000_{2713C1E3-06C0-4099-851D-33018FD4851C}"))},{default:(0,l.w5)((()=>[(0,l.Uk)("Uber")])),_:1}),(0,l.Wm)(h,{color:"primary",class:"ms-2 sizeBotones",onClick:a[2]||(a[2]=e=>b.clickClienteAtajo("CliBoti_000_{7A6EA7B0-3229-4A94-81EA-232F4666A7BE}"))},{default:(0,l.w5)((()=>[(0,l.Uk)("To Go")])),_:1}),(0,l.Wm)(h,{color:"success",class:"ms-2 sizeBotones",onClick:a[3]||(a[3]=e=>b.modalNuevoClienteRef.abrirModal())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("nuevo","Nuevo")),1)])),_:1}),(0,l.Wm)(h,{color:"danger",class:"ms-2 sizeBotones",onClick:a[4]||(a[4]=e=>b.modalClientes=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("salir","Salir")),1)])),_:1})])]),(0,l._)("div",c,[(0,l._)("div",s,[(0,l.wy)((0,l._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:"Buscar por nombre","aria-label":".form-control-lg example","onUpdate:modelValue":a[5]||(a[5]=e=>b.inputBusqueda=e)},null,512),[[n.nr,b.inputBusqueda]])]),(0,l._)("div",d,[(0,l.Wm)(h,{color:"secondary",class:"botonBusqueda w-100",onClick:a[6]||(a[6]=e=>b.buscar())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("buscar","Buscar")),1)])),_:1})])]),b.arrayClientes?.length>0?((0,l.wg)(),(0,l.iD)("div",u,[(0,l._)("div",m,[(0,l._)("div",_,[(0,l._)("table",v,[(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(b.arrayClientes,((a,o)=>((0,l.wg)(),(0,l.iD)("tr",{key:o},[(0,l._)("td",null,[(0,l._)("span",p,(0,t.zw)(a.nombre),1)]),(0,l._)("td",null,[(0,l.Wm)(h,{color:"primary",size:"lg",onClick:e=>b.selectCliente(a.id,a.nombre),class:"w-100",style:{height:"3.85rem","font-size":"1.5rem"}},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("elegir","Elegir")),1)])),_:2},1032,["onClick"])])])))),128))])])])])])):((0,l.wg)(),(0,l.iD)("div",C,[(0,l._)("div",g,[(0,l._)("span",f,(0,t.zw)(e.$t("sin_resultados","Sin resultados")),1)])]))])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(D,{ref:"modalNuevoClienteRef"},null,512)],64)}var k=o(70),w=o(4313),h=o(2492),y=o.n(h),B=o(4870),D=o(65);const M={class:"row mt-1 p-4"},A={class:"col-md-8"},z={class:"col-md-4"},E={class:"row p-4"},j={class:"col-md-8"},x={class:"col-md-4 sizeModalClientes"},N={class:"row"},U={class:"d-inline-block text-end"};function H(e,a,o,i,r,c){const s=(0,l.up)("MDBBtn"),d=(0,l.up)("MDBModalBody"),u=(0,l.up)("MDBModal");return(0,l.wg)(),(0,l.j4)(u,{id:"modalNuevoCliente",tabindex:"-1",labelledby:"tituloModalClientes",modelValue:i.modalNuevoCliente,"onUpdate:modelValue":a[4]||(a[4]=e=>i.modalNuevoCliente=e),staticBackdrop:"",size:"xl"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l._)("div",M,[(0,l._)("div",A,[(0,l.wy)((0,l._)("input",{class:"form-control inputNombreCliente w-100",type:"text",placeholder:"Nombre del cliente","aria-label":".form-control-lg example","onUpdate:modelValue":a[0]||(a[0]=e=>i.inputNombreCliente=e)},null,512),[[n.nr,i.inputNombreCliente]])]),(0,l._)("div",z,[(0,l.Wm)(s,{color:"secondary",class:"botonBusqueda w-100",disabled:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("nombre","Nombre")),1)])),_:1})])]),(0,l._)("div",E,[(0,l._)("div",j,[(0,l.wy)((0,l._)("input",{class:"form-control inputNombreCliente w-100",type:"text",placeholder:"Código tarjeta","aria-label":".form-control-lg example","onUpdate:modelValue":a[1]||(a[1]=e=>i.inputCodigoTarjeta=e)},null,512),[[n.nr,i.inputCodigoTarjeta]])]),(0,l._)("div",x,[(0,l.Wm)(s,{color:"secondary",class:"botonBusqueda w-100",disabled:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("cod_tarjeta","Cód. tarjeta")),1)])),_:1})])]),(0,l._)("div",N,[(0,l._)("div",U,[(0,l.Wm)(s,{color:"primary",class:"ms-2 sizeBotones",onClick:a[2]||(a[2]=e=>i.crearCliente())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("crear","Crear")),1)])),_:1}),(0,l.Wm)(s,{color:"danger",class:"ms-2 sizeBotones",onClick:a[3]||(a[3]=e=>i.modalNuevoCliente=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("atras","Atrás")),1)])),_:1})])])])),_:1})])),_:1},8,["modelValue"])}var R={name:"ModalNuevoClienteComponent",components:{MDBModal:w.j3,MDBModalBody:w.Yz,MDBBtn:w.$v},setup(e,a){const o=(0,B.iH)(!1),l=(0,B.iH)(""),t=(0,B.iH)("");function n(){o.value=!0}function i(){k.Z.post("clientes/crearNuevoCliente",{idTarjetaCliente:t.value,nombreCliente:l.value}).then((e=>{if(!e.data)throw Error("No se ha podido crear el cliente. backend");y().fire({icon:"success",title:"Cliente creado correctamente",showConfirmButton:!1,timer:2e3}),o.value=!1})).catch((e=>{y().fire("Oops...",e.message,"error")}))}return a.expose({abrirModal:n}),{inputCodigoTarjeta:t,modalNuevoCliente:o,inputNombreCliente:l,crearCliente:i}}},T=o(89);const V=(0,T.Z)(R,[["render",H],["__scopeId","data-v-d5ef2184"]]);var $=V,q={name:"ModalClientesComponent",components:{MDBModal:w.j3,MDBModalBody:w.Yz,MDBBtn:w.$v,ModalNuevoCliente:$},setup(e,a){const o=(0,D.oR)(),t=(0,B.iH)(!1),n=(0,B.iH)(0),i=(0,B.iH)(""),r=(0,B.iH)(),c=(0,B.iH)(null),s=(0,l.f3)("actualizarPuntos"),d=(0,l.Fl)((()=>o.state.Trabajadores.arrayTrabajadores)),u=(0,l.Fl)((()=>o.state.Trabajadores.indexActivo)),m=(0,l.Fl)((()=>d.value&&void 0!=u.value&&null!=u.value&&d.value[u.value]?d.value[u.value]:null)),_=(0,l.Fl)((()=>o.state.Cestas.arrayCestas));function v(){t.value=!0}function p(){n.value++}function C(e){k.Z.post("clientes/getClienteById",{idCliente:e}).then((a=>{if(!a.data)throw Error("No se ha podido obtener la información del cliente. backend");g(e,a.data.nombre)})).catch((e=>{y().fire("Oops...",e.message,"error")}))}function g(e,a){if(_.value)for(let l=0;l<_.value.length;l++)if(m.value.idCesta===_.value[l]._id){o.dispatch("Cestas/setClienteCesta",{index:l,idCliente:e,nombreCliente:a}),o.dispatch("EstadoDinamico/setVistaCliente",!0),s(),t.value=!1;break}}function f(){k.Z.post("clientes/buscar",{busqueda:i.value}).then((e=>{r.value=e.data})).catch((e=>{y().fire("Oops...",e.message,"error")}))}return(0,l.YP)(i,(()=>{f()})),a.expose({abrirModal:v,datoBorrar:n,selectCliente:g}),{test:p,datoBorrar:n,modalClientes:t,inputBusqueda:i,arrayClientes:r,selectCliente:g,buscar:f,modalNuevoClienteRef:c,clickClienteAtajo:C}}};const W=(0,T.Z)(q,[["render",b],["__scopeId","data-v-7b36cf97"]]);var P=W},3748:function(e,a,o){o.r(a),o.d(a,{default:function(){return S}});var l=o(3396),t=o(7139),n=o(9242);const i=e=>((0,l.dD)("data-v-08c80408"),e=e(),(0,l.Cn)(),e),r={id:"main"},c={id:"vueMenuEncargo"},s={class:"encargos"},d={class:""},u={class:"row"},m=i((()=>(0,l._)("div",{class:"col"},null,-1))),_={class:"col"},v={key:0},p={class:"btnEncargo lgEncargo float-right"},C=i((()=>(0,l._)("i",{class:"fas fa-search"},null,-1))),g=i((()=>(0,l._)("hr",null,null,-1))),f={class:"productos"},b={class:"producto"},k=["onUpdate:modelValue"],w={key:1},h=i((()=>(0,l._)("hr",{class:"hrEncargo"},null,-1))),y={class:"recogida"},B={class:"opciones-recogida"},D={class:"fechas-recogida"},M={key:0},A={key:1},z={key:2},E=["id","onUpdate:modelValue","onClick"],j=i((()=>(0,l._)("hr",{class:"hrEncargo"},null,-1))),x={class:"encargos-footer"},N={class:"input-deja-a-cuenta"},U=i((()=>(0,l._)("small",{id:"emailHelp",class:"form-text text-muted"},"Deja a cuenta:",-1))),H={class:""};function R(e,a,o,i,R,T){const V=(0,l.up)("ModalClientesComponent");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",r,[(0,l._)("div",c,[(0,l._)("div",null,[(0,l._)("div",s,[(0,l._)("div",d,[(0,l._)("div",u,[m,(0,l._)("div",_,[i.clienteData.idCliente?((0,l.wg)(),(0,l.iD)("h1",v,[(0,l._)("button",p,(0,t.zw)(i.clienteData.nombreCliente),1)])):((0,l.wg)(),(0,l.iD)("button",{key:1,class:"btnEncargo float-right",onClick:a[0]||(a[0]=e=>i.refModalClientes.abrirModal())},[C,(0,l.Uk)(" Abrir modal cliente ")]))])]),g,(0,l._)("div",f,[i.productos.length?((0,l.wg)(!0),(0,l.iD)(l.HY,{key:0},(0,l.Ko)(i.productos,(e=>((0,l.wg)(),(0,l.iD)("div",b,[(0,l._)("span",null,(0,t.zw)(e.nombre),1),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Comentario del producto...","onUpdate:modelValue":a=>e.comentario=a},null,8,k),[[n.nr,e.comentario]])])))),256)):((0,l.wg)(),(0,l.iD)("div",w,(0,t.zw)(e.$t("toc_game_no_hay_productos","No hay ningún producto seleccionado")),1))]),h,(0,l._)("div",y,[(0,l._)("div",B,[(0,l._)("button",{onClick:a[1]||(a[1]=(...e)=>i.onClickRecogida&&i.onClickRecogida(...e)),value:"1",class:(0,t.C_)({active:1===i.refEncargoRecogida})},(0,t.zw)(e.$t("toc_game_encargos_hoy","Hoy")),3),(0,l._)("button",{onClick:a[2]||(a[2]=(...e)=>i.onClickRecogida&&i.onClickRecogida(...e)),value:"2",class:(0,t.C_)({active:2===i.refEncargoRecogida})},(0,t.zw)(e.$t("toc_game_encargos_otro_dia","Otro día")),3),(0,l._)("button",{onClick:a[3]||(a[3]=(...e)=>i.onClickRecogida&&i.onClickRecogida(...e)),value:"3",class:(0,t.C_)({active:3===i.refEncargoRecogida})},(0,t.zw)(e.$t("toc_game_encargos_cada","Cada...")),3)]),(0,l._)("div",D,[1===i.refEncargoRecogida?((0,l.wg)(),(0,l.iD)("div",M,[(0,l._)("button",{onClick:a[4]||(a[4]=(...e)=>i.onClickAmPm&&i.onClickAmPm(...e)),value:"am",class:(0,t.C_)({active:"am"===i.refAmPm})},(0,t.zw)(e.$t("toc_game_encargos_por_la_manana","Por la mañana")),3),(0,l._)("button",{onClick:a[5]||(a[5]=(...e)=>i.onClickAmPm&&i.onClickAmPm(...e)),value:"pm",class:(0,t.C_)({active:"pm"===i.refAmPm})},(0,t.zw)(e.$t("toc_game_encargos_por_la_tarde","Por la tarde")),3)])):(0,l.kq)("",!0),2===i.refEncargoRecogida?((0,l.wg)(),(0,l.iD)("div",A,[(0,l.wy)((0,l._)("input",{type:"date",class:"form-control","onUpdate:modelValue":a[6]||(a[6]=e=>i.fechaInput=e)},null,512),[[n.nr,i.fechaInput]]),(0,l.wy)((0,l._)("input",{type:"time",class:"form-control","onUpdate:modelValue":a[7]||(a[7]=e=>i.horaInput=e)},null,512),[[n.nr,i.horaInput]])])):(0,l.kq)("",!0),3===i.refEncargoRecogida?((0,l.wg)(),(0,l.iD)("div",z,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.dias,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},[(0,l.wy)((0,l._)("input",{type:"button",id:e.dia,"onUpdate:modelValue":a=>e.dia=a,onClick:a=>i.clickDia(e),class:(0,t.C_)({active:e.checked})},null,10,E),[[n.nr,e.dia]])])))),128))])):(0,l.kq)("",!0)])]),j,(0,l._)("div",x,[(0,l._)("div",N,[U,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"cuenta",name:"dejaACuenta",placeholder:"0",min:"0","onUpdate:modelValue":a[8]||(a[8]=e=>i.dejaACuenta=e)},null,512),[[n.nr,i.dejaACuenta]])]),(0,l._)("div",H,[(0,l._)("input",{type:"button",value:"Crear encargo",class:"btn btn-primary btn-lg",onClick:a[9]||(a[9]=(...e)=>i.crearEncargo&&i.crearEncargo(...e))})])])])])])])]),(0,l.Wm)(V,{ref:"refModalClientes"},null,512)],64)}o(7658);var T=o(4870),V=o(65),$=o(1464),q=o(2492),W=o.n(q),P=o(5658),I=o(70),F=o(8686),Z={name:"EncargosComponent",components:{ModalClientesComponent:$.Z},setup(){const e=(0,T.iH)(null),a=(0,V.oR)(),{t:o}=(0,P.QT)(),t=a.getters["Cestas/getCestaActiva"],n=a.getters["Cestas/getCestaActivaIndex"],i=(0,l.Fl)((()=>a.state.Trabajadores.arrayTrabajadores)),r=(0,l.Fl)((()=>a.state.Trabajadores.indexActivo)),c=(0,l.Fl)((()=>i.value&&null!=r.value&&void 0!=r.value&&i.value[r.value]?i.value[r.value]:null)),s=(0,T.iH)(null),d=(0,T.iH)(null),u=(0,T.iH)(null),m=(0,T.iH)(null),_=(0,T.iH)([{dia:"Lunes",nDia:0,checked:!1},{dia:"Martes",nDia:1,checked:!1},{dia:"Miércoles",nDia:2,checked:!1},{dia:"Jueves",nDia:3,checked:!1},{dia:"Viernes",nDia:4,checked:!1},{dia:"Sábado",nDia:5,checked:!1},{dia:"Domingo",nDia:6,checked:!1}]),v=(0,T.iH)(0),p={idCliente:t.idCliente,nombreCliente:t.nombreCliente},C=(0,T.iH)(t.lista.map((e=>({id:e.idArticulo,nombre:e.nombre,total:e.subtotal,unidades:e.unidades,comentario:""})))),g=e=>{s.value=parseInt(e.target.value)},f=e=>{d.value=e.target.value},b=e=>{e.checked=!e.checked},k=()=>_.value.filter((e=>e.checked)),w=()=>t.lista.reduce(((e,a)=>e+a.subtotal),0),h=()=>{if(!C.value.length)return void y(o("toc_game_encargos_error_no_productos","Tienes que haber al menos un producto para crear el encargo."),"error");if(!s.value)return void y(o("toc_game_encargos_error_no_recogida","Tienes que elegir una opción de recogida (hoy, otro día o cada...)"),"error");if(1===s.value&&!d.value)return void y(o("toc_game_encargos_error_no_am_pm","Tienes que elegir por la mañana o por la tarde"),"error");if(2===s.value&&(!u.value||!m.value))return void y(o("toc_game_encargos_error_fecha_hora","Tienes que elegir la fecha y la hora del encargo"),"error");if(3===s.value&&!k().length)return void y(o("toc_game_encargos_error_dias_seleccionados","Tienes que elegir al menos un día"),"error");const e={idCliente:p.idCliente,opcionRecogida:s.value,amPm:d.value,fecha:u.value,hora:m.value,dias:k(),dejaCuenta:v.value,total:w(),productos:C.value,idTrabajador:c.value._id};I.Z.post("encargos/setEncargo",e).then((({data:e})=>{console.log(e),e&&e.msg?e.error?y(e.msg,"error"):y(o("toc_game_encargos_ok","Encargo creado!"),"success",B):y(o("toc_game_encargos_error_general","Error general"),"error")})).catch((e=>{console.log(e),y(o("toc_game_encargos_error_general","Error general"),"error")}))},y=(e,a,o=(()=>{}))=>{W().fire("error"===a?"Oops...":"Ok!!",e,a).then((()=>o()))},B=async()=>(await a.dispatch("Cestas/setModoCesta",{index:n,modo:"VENTA"}),a.dispatch("Cestas/setClienteCesta",{index:n,idCliente:null,nombreCliente:null}),a.dispatch("EstadoDinamico/reset"),a.dispatch("Cestas/deleteLista",t._id),D("/"),Promise.resolve()),D=e=>F.Z.push(e);return{refModalClientes:e,cestaActiva:t,clienteData:p,productos:C,refEncargoRecogida:s,refAmPm:d,dias:_,fechaInput:u,horaInput:m,dejaACuenta:v,onClickRecogida:g,onClickAmPm:f,clickDia:b,crearEncargo:h}}},Y=o(89);const O=(0,Y.Z)(Z,[["render",R],["__scopeId","data-v-08c80408"]]);var S=O}}]);
//# sourceMappingURL=748.5c50b525.js.map