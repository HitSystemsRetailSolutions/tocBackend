"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[370],{3449:function(e,a,o){o.d(a,{O:function(){return s}});var l=o(73396),t=o(20065),r=o(91076),i=o(42492),n=o.n(i);function s(){const e=(0,t.oR)(),a=(0,l.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),o=(0,l.Fl)((()=>e.state.Trabajadores.indexActivo)),i=(0,l.Fl)((()=>a.value&&void 0!=o.value&&null!=o.value&&a.value[o.value]?a.value[o.value]:null)),s=(0,l.Fl)((()=>e.state.Cestas.arrayCestas));async function d(e){try{const a=await r.Z.post("clientes/getClienteById",{idCliente:e});if(a.data)return c(a.data);throw new Error("No se ha podido obtener la información del cliente desde el backend")}catch(a){return n().fire("Oops...",a.message,"error"),!1}}async function c(a){const{id:o,nombre:l,albaran:t,vip:n,descuento:d}=a;if(s.value)for(let c=0;c<s.value.length;c++)if(i.value.idCesta===s.value[c]._id){await e.dispatch("Cestas/setClienteCesta",{index:c,idCliente:o,albaran:t,nombreCliente:l,vip:n});e.dispatch("EstadoDinamico/setVistaCliente",!0);const a=t||n||!d?0:d;return e.dispatch("Cestas/setDescuentoAction",Number(a)/100),r.Z.post("cestas/recalcularIvas",{idCesta:s.value[c]._id}),!0}return!1}return{findCliente:d}}},22871:function(e,a,o){o.d(a,{Z:function(){return p}});var l=o(73396),t=o(87139);const r=["onClick"],i={class:"botonTecladoSpaceDiv"};function n(e,a,o,n,s,d){const c=(0,l.up)("MDBInput"),u=(0,l.up)("MDBModalHeader"),m=(0,l.up)("MDBModalBody"),p=(0,l.up)("MDBModal");return(0,l.wg)(),(0,l.j4)(p,{frame:"",position:"bottom",id:"keyBoardModal",tabindex:"-1",labelledby:"keyBoardModal",modelValue:n.keyBoardModal,"onUpdate:modelValue":a[5]||(a[5]=e=>n.keyBoardModal=e)},{default:(0,l.w5)((()=>[n.showInput?((0,l.wg)(),(0,l.j4)(u,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{style:{width:"80rem !important"},label:"Texto introducido",modelValue:n.text,"onUpdate:modelValue":a[0]||(a[0]=e=>n.text=e)},null,8,["modelValue"])])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(m,{class:"mainDiv"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.chars.length,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.chars[e-1],((e,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"btn-group-vertical mt-1 divTecla",key:a},[(0,l._)("button",{type:"button",style:(0,t.j5)([{"text-transform":"none"},n.keyStyle(e)]),class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a=>n.processTecla(e)},(0,t.zw)(e),13,r)])))),128))])))),128)),(0,l._)("div",i,[(0,l._)("button",{style:(0,t.j5)([{"font-size":"1.8rem"},n.keyStyle("✎")]),type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[1]||(a[1]=e=>n.processTecla("✎"))}," ✎ ",4),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonTecladoSpace",onClick:a[2]||(a[2]=e=>n.processTecla(" "))}," ␣ "),(0,l._)("button",{style:{"font-size":"1.8rem"},type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[3]||(a[3]=e=>n.processTecla("@"))}," @ "),(0,l._)("button",{style:(0,t.j5)([{"font-size":"1.8rem"},n.keyStyle("#")]),type:"button",class:"btn btn-outline-secondary py-3 botonTeclado",onClick:a[4]||(a[4]=e=>n.processTecla("#"))}," Ⅳ ",4)])])),_:1})])),_:1},8,["modelValue"])}var s=o(44870),d=o(74313),c={name:"KeyBoardComponent",components:{MDBIcon:d.vm,MDBModalBody:d.Yz,MDBModal:d.j3,MDBBtn:d.$v,MDBModalHeader:d.ol,MDBModalTitle:d.wo,MDBInput:d.u2,MDBModalFooter:d.ab},props:{value:String,text:String},setup(e,{expose:a}){const o=(0,s.iH)(e.value||""),t=(0,s.iH)(!1),r=(0,s.iH)(!1),i=(0,s.iH)(!1);let n=!1;const d=(0,s.iH)(!1),c=[["q","w","e","r","t","y","u","i","o","p","←"],["a","s","d","f","g","h","j","k","l","ñ","↵"],["z","x","c","v","b","n","m",",",".","-","⇪"]],u=(0,s.iH)([]);function m(e){switch(e){case"←":f();break;case"↵":t.value=!1;break;case"⇪":n=!n,o.value.length>0&&(r.value=!r.value),g();break;case"#":i.value=!i.value,g();break;case"✎":d.value=!d.value;break;default:v(e);break}}function p(e){let a=(o.value?.length<=0||!o.value)&&!n||r.value,l="background-color: #606060 !important; color: white !important;";return i.value&&"#"==e||d.value&&"✎"==e||"⇪"==e&&a?l:a?"text-transform: uppercase":"text-transform: none;"}function v(e){let a=r.value;n=!1,a&&(e=e.toUpperCase()),o.value+=e}function b(e){o.value=e}function f(){o.value.length>0&&(o.value=o.value.slice(0,-1))}function g(){let e=c;const a=["á","é","í","ó","ú","ü","¡","¿"];if(i.value){let a=[["1","2","3","4","5","6","7","8","9","0","ç"]];a=a.concat(c),e=a}u.value=e.map((e=>e.map((e=>a.includes(e)?[e,e.toUpperCase()]:e))))}function C(e=""){void 0===o.value&&(o.value=""),o.value=e,t.value=!0}function y(){return[o.value,t.value]}return a({getValue:y,abrirModal:C,setText:b}),(0,l.bv)((()=>{g()})),{text:o,addTecla:v,deleteTecla:f,keyBoardModal:t,processTecla:m,upperCase:r,keyStyle:p,buildKeyboard:g,abrirModal:C,showInput:d,chars:u}}},u=o(40089);const m=(0,u.Z)(c,[["render",n],["__scopeId","data-v-0b19e9d8"]]);var p=m},3500:function(e,a,o){o.d(a,{Z:function(){return y}});var l=o(73396),t=o(87139);const r={class:"btn-group"},i={class:"btn-group"},n={class:"btn-group"},s={class:"btn-group"},d=["disabled"],c={class:"btn-group"};function u(e,a,o,u,m,p){return(0,l.wg)(),(0,l.iD)("div",{class:(0,t.C_)(["btn-group-vertical mt-1",{disabled:o.disabled}])},[(0,l._)("div",r,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[0]||(a[0]=e=>u.addTecla("1"))}," 1 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[1]||(a[1]=e=>u.addTecla("2"))}," 2 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[2]||(a[2]=e=>u.addTecla("3"))}," 3 ")]),(0,l._)("div",i,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[3]||(a[3]=e=>u.addTecla("4"))}," 4 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[4]||(a[4]=e=>u.addTecla("5"))}," 5 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[5]||(a[5]=e=>u.addTecla("6"))}," 6 ")]),(0,l._)("div",n,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[6]||(a[6]=e=>u.addTecla("7"))}," 7 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[7]||(a[7]=e=>u.addTecla("8"))}," 8 "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[8]||(a[8]=e=>u.addTecla("9"))}," 9 ")]),(0,l._)("div",s,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[9]||(a[9]=e=>u.deleteTecla())}," < "),(0,l._)("button",{type:"button",class:"btn btn-outline-secondary py-3 botonNumpad",onClick:a[10]||(a[10]=e=>u.addTecla("0"))}," 0 "),(0,l._)("button",{disabled:o.disabledComa,type:"button",class:"btn btn-outline-secondary botonNumpad",onClick:a[11]||(a[11]=e=>u.addTecla("."))}," , ",8,d)]),(0,l._)("div",c,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary botonComa",onClick:a[12]||(a[12]=e=>u.okValue(Number(u.cantidad)))}," OK ")])],2)}o(42492);var m=o(32066),p=o(25994),v=o(44870);const b=(0,m.io)("http://"+p.Z.state.TocGameURL+":5051");var f={props:{skipBalanza:{type:Boolean,default:!1},max3EntersDigits:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},disabledComa:{type:Boolean,default:!1}},name:"NumpadComponent",setup(e,{expose:a,emit:o}){const t=(0,v.iH)("0"),r=(0,l.f3)("okValue"),i=(0,v.iH)("5.5rem"),n=(0,v.iH)("5.5rem");(0,l.Fl)((()=>p.Z.state.Weight.lastWeight));function s(){o("activarShake")}function d(a){if(e.max3EntersDigits){let[e,o]=t.value.split("."),l=t.value.includes(".");if(e.length>=3&&!l&&"."!=a)return s();if(o&&o.length>=2)return s();if("."===a&&t.value.includes("."))return s()}"."===a&&t.value.includes(".")||(t.value+=a,"0"==t.value[0]&&(t.value=t.value.slice(1)),o("setValue",t.value))}function c(){t.value=t.value.slice(0,-1),""===t.value&&(t.value="0")}function u(e){t.value=Number(e).toString(),o("setValue",t.value)}return b.on("setBalanzaValue",(a=>{a&&!e.skipBalanza&&u(a)})),a({cantidad:t,setValor:u}),(0,l.bv)((async()=>{e.skipBalanza||u((await(0,l.Fl)((()=>p.Z.state.Weight.lastWeight))).value)})),{okValue:r,cantidad:t,addTecla:d,deleteTecla:c,setValor:u,anchoTecla:i,altoTecla:n}}},g=o(40089);const C=(0,g.Z)(f,[["render",u],["__scopeId","data-v-b1cc6166"]]);var y=C},20080:function(e,a,o){o.r(a),o.d(a,{default:function(){return To}});var l=o(73396),t=o(87139);const r={key:0,class:"row mt-2 overflow-auto sizeGeneral"},i={key:0},n={key:1},s={key:0,style:{"font-size":"1.2rem"}},d={class:"overflow-auto text-truncate listaCesta"},c={class:"list-group"},u={class:"d-inline-block text-truncate",style:{"max-width":"12rem"}},m={class:"ms-1",style:{"vertical-align":"top"}},p={class:"trabajadores"},v={key:1,class:"row sizeGeneral m-0 mt-1"},b={key:2,class:"position-absolute bottom-0 start-0"};function f(e,a,o,f,g,C){const y=(0,l.up)("MDBCardTitle"),_=(0,l.up)("MDBCardText"),w=(0,l.up)("MDBBtn"),M=(0,l.up)("MDBCardBody"),k=(0,l.up)("MDBBadge"),h=(0,l.up)("MDBCard"),x=(0,l.up)("MesasComponent"),D=(0,l.up)("CobroSeparadoMesas");return(0,l.wg)(),(0,l.iD)(l.HY,null,[!f.vistaMesas&&f.arrayTrabajadores&&f.arrayCestas&&null!=f.indexActivoTrabajador&&void 0!=f.indexActivoTrabajador?((0,l.wg)(),(0,l.iD)("div",r,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.totalRows,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"row",key:a},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(4,((e,o)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:o},[4*a+o+1<=f.arrayCestas.length&&(null!=f.arrayCestas[4*a+o].indexMesa||f.arrayCestas[4*a+o].trabajador===f.arrayTrabajadores[f.indexActivoTrabajador]._id)||"DEVOLUCION"==f.arrayCestas[4*a+o]?.modo?((0,l.wg)(),(0,l.j4)(h,{key:0,onClick:e=>f.seleccionar(f.arrayCestas[4*a+o]),class:(0,t.C_)(["cesta mb-3 ms-2 me-1",{cestaActiva:f.arrayCestas[4*a+o]._id===f.idCestaSeleccionada}]),size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(f.arrayCestas[4*a+o].modo)+" ",1),null===f.arrayCestas[4*a+o].indexMesa?((0,l.wg)(),(0,l.iD)("a",i,[(0,l.Uk)(" de "),(0,l._)("i",null,(0,t.zw)(f.getNombreByID(f.arrayCestas[4*a+o].trabajador)),1)])):(0,l.kq)("",!0),f.arrayMesas[4*a+o]&&null!=f.arrayCestas[4*a+o].indexMesa?((0,l.wg)(),(0,l.iD)("span",n,"Mesa: "+(0,t.zw)(f.arrayMesas[f.arrayCestas[4*a+o].indexMesa].nombre),1)):(0,l.kq)("",!0)])),_:2},1024),(0,l.Wm)(_,null,{default:(0,l.w5)((()=>["VENTA"===f.arrayCestas[4*a+o].modo?((0,l.wg)(),(0,l.iD)("span",s,"Total: "+(0,t.zw)(f.getTotal(f.arrayCestas[4*a+o]).toFixed(2))+" €",1)):(0,l.kq)("",!0),(0,l._)("div",d,[(0,l._)("ul",c,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.arrayCestas[4*a+o].lista,((e,a)=>((0,l.wg)(),(0,l.iD)("li",{key:a,class:"list-group-item"},[(0,l._)("span",u,(0,t.zw)(e.nombre),1),(0,l._)("span",m,"x"+(0,t.zw)(e.unidades),1)])))),128))])])])),_:2},1024),f.arrayMesas[4*a+o]&&null!=f.arrayCestas[4*a+o].indexMesa&&(f.arrayCestas[4*a+o].lista.length>1||f.arrayCestas[4*a+o].lista[0]?.unidades>1)?((0,l.wg)(),(0,l.j4)(w,{key:0,onClick:e=>f.PagarSeparado(f.arrayCestas[4*a+o],4*a+o),style:{"font-size":"16px"},color:"secondary d-inline-block"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Pagar por separado ")])),_:2},1032,["onClick"])):(0,l.kq)("",!0)])),_:2},1024),(0,l._)("div",p,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.arrayCestas[4*a+o].trabajadores,((e,a)=>((0,l.wg)(),(0,l.j4)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(k,{color:"info",class:"text-dark",pill:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(f.arrayTrabajadoresID[e]),1)])),_:2},1024)])),_:2},1024)))),256))])])),_:2},1032,["onClick","class"])):(0,l.kq)("",!0)],64)))),64))])))),128))])):(0,l.kq)("",!0),f.vistaMesas?((0,l.wg)(),(0,l.iD)("div",v,[(0,l.Wm)(x)])):(0,l.kq)("",!0),f.vistaMesas?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",b,[(0,l._)("button",{onClick:a[0]||(a[0]=e=>f.volver()),class:"btn btn-warning ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("volver","VOLVER")),1)])),(0,l.Wm)(D,{ref:"CobroSeparadoRef"},null,512)],64)}var g=o(44870),C=o(20065),y=o(74313),_=o(44918),w=o(91076),M=o(42492),k=o.n(M);const h={key:0},x=["onClick"],D={class:"nombreMesa"},B={key:0,class:"icono-encargado-mesa position-absolute top-0 end-10",style:{"font-size":"1.1rem","z-index":"2"}},z={key:1,class:"trabajadores"},E=["onClick"],T={class:"nombreMesa"},j={key:0,class:"trabajadores"},P={class:"position-relative footer"},H={class:"position-absolute bottom-0 start-0"},V={class:"position-absolute bottom-0 end-0"},U={key:6,style:{"font-size":"1.7rem","font-weight":"bold"},class:"me-2"},S={key:7,style:{"font-size":"1.7rem","font-weight":"bold"},class:"me-2"};function W(e,a,o,r,i,n){const s=(0,l.up)("MDBBtn"),d=(0,l.up)("MDBBtnGroup"),c=(0,l.up)("MDBIcon"),u=(0,l.up)("MDBBadge"),m=(0,l.up)("MDBInput"),p=(0,l.up)("MDBModalBody"),v=(0,l.up)("MDBModalFooter"),b=(0,l.up)("MDBModal"),f=(0,l.up)("modalSeleccionarRepartidor"),g=(0,l.up)("CobroSeparadoMesas"),C=(0,l.up)("ModalCondicionalPedidoCliente"),y=(0,l.up)("KeyBoardComponentVue"),_=(0,l.up)("ModalencargadoMesa");return(0,l.wg)(),(0,l.iD)(l.HY,null,[r.PedidosTelegram?((0,l.wg)(),(0,l.iD)("div",h,[(0,l.Wm)(d,{class:"buttonsSelector"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{size:"lg",disabled:r.modoEdicion||r.modoImprimir||r.ImprimirKitchen,color:[r.activeMenu?"secondary":"primary"],onClick:a[0]||(a[0]=e=>r.activeMenu=0)},{default:(0,l.w5)((()=>[(0,l.Uk)("MESAS")])),_:1},8,["disabled","color"]),(0,l.Wm)(s,{size:"lg",disabled:r.modoEdicion||r.modoImprimir||r.ImprimirKitchen,color:r.activeMenu?"primary":"secondary",onClick:a[1]||(a[1]=e=>r.activeMenu=1)},{default:(0,l.w5)((()=>[(0,l.Uk)("PEDIDOS")])),_:1},8,["disabled","color"])])),_:1})])):(0,l.kq)("",!0),r.arrayMesas.length>0&&!r.activeMenu?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},(0,l.Ko)(5,((e,a)=>(0,l._)("div",{class:"row p-0",key:a},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(10,((e,o)=>(0,l._)("div",{class:(0,t.C_)(["mesa ms-3",[0===o?"ms-5":"",o+10*a===r.indexMesaActiva&&r.modoEdicion?"border border-4 border-dark":"",r.cestaSeleccionada===r.arrayMesas[o+10*a].idCesta?"seleccionada":"",r.tieneCosas(r.arrayMesas[o+10*a].idCesta)?"tieneCosas":"",r.arrayMesas[o+10*a].nombre?"habilitada":"deshabilitada",r.cestasHonei.includes(o+10*a)?"honei":""]]),key:o,onClick:e=>r.handleClick(o+10*a)},[(0,l._)("span",D,(0,t.zw)(r.arrayMesas[o+10*a].nombre),1),r.getCestaById(r.arrayMesas[o+10*a].idCesta)?.encargadoMesa&&r.encargadoMesa?((0,l.wg)(),(0,l.iD)("span",B,[(0,l.Wm)(c,{icon:"user-tie"})])):(0,l.kq)("",!0),r.arrayMesas[o+10*a].nombre?((0,l.wg)(),(0,l.iD)("div",z,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.getCestaById(r.arrayMesas[o+10*a].idCesta)?.trabajadores,((e,a)=>((0,l.wg)(),(0,l.j4)(u,{color:"info",class:"text-dark trabajador",pill:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(r.getNombreTrabajadorById(e)),1)])),_:2},1024)))),256))])):(0,l.kq)("",!0)],10,x))),64))]))),64)):(0,l.kq)("",!0),r.activeMenu?((0,l.wg)(),(0,l.iD)(l.HY,{key:2},(0,l.Ko)(5,((e,a)=>(0,l._)("div",{class:"row p-0",key:a},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(10,((e,o)=>(0,l._)("div",{class:(0,t.C_)(["mesa ms-3",[0===o?"ms-5":"",r.arrayEncargos[o+10*a]?._id?"habilitada":"deshabilitada",r.arrayEncargos[o+10*a]?.cesta.lista.length>0?"tieneCosas":""]]),key:o,onClick:e=>r.openPedido(o+10*a)},[(0,l._)("span",T,(0,t.zw)(r.arrayEncargos[o+10*a]?.nombreCliente),1),r.arrayEncargos[o+10*a]?.nombreCliente?((0,l.wg)(),(0,l.iD)("div",j,[r.arrayEncargos[o+10*a]?.nombreCliente?((0,l.wg)(),(0,l.j4)(u,{key:0,color:"info",class:"text-dark trabajador",pill:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(r.arrayEncargos[o+10*a]?.nombreDependienta),1)])),_:2},1024)):(0,l.kq)("",!0)])):(0,l.kq)("",!0)],10,E))),64))]))),64)):(0,l.kq)("",!0),(0,l._)("div",P,[(0,l._)("div",H,[(0,l._)("button",{onClick:a[2]||(a[2]=e=>r.volver()),class:"btn btn-warning ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("volver","Volver")),1)]),(0,l._)("div",V,[r.arrayMesas&&null!=r.indexMesaActiva&&void 0!=r.indexMesaActiva&&r.arrayMesas[r.indexMesaActiva]&&r.arrayMesas[r.indexMesaActiva].nombre&&r.modoEdicion?((0,l.wg)(),(0,l.iD)("button",{key:0,onClick:a[3]||(a[3]=e=>r.desactivarMesa()),class:"btn btn-danger ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("eliminar_cesta","Eliminar cesta")),1)):(0,l.kq)("",!0),r.arrayMesas&&null!=r.indexMesaActiva&&void 0!=r.indexMesaActiva&&r.arrayMesas[r.indexMesaActiva]&&r.arrayMesas[r.indexMesaActiva].nombre&&r.modoEdicion&&!r.activeMenu?((0,l.wg)(),(0,l.iD)("button",{key:1,onClick:a[4]||(a[4]=e=>r.toggleModotransferir()),class:"btn btn-secondary ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("transferir_articulos","Transferir articulos")),1)):(0,l.kq)("",!0),r.arrayMesas&&null!=r.indexMesaActiva&&void 0!=r.indexMesaActiva&&r.arrayMesas[r.indexMesaActiva]&&r.arrayMesas[r.indexMesaActiva].nombre&&r.modoEdicion&&!r.activeMenu&&r.encargadoMesa?((0,l.wg)(),(0,l.iD)("button",{key:2,onClick:a[5]||(a[5]=e=>r.openModalEncargadoMesa()),class:"btn btn-primary ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("encargado","Encargado")),1)):(0,l.kq)("",!0),r.arrayMesas&&null!=r.indexMesaActiva&&void 0!=r.indexMesaActiva&&r.arrayMesas[r.indexMesaActiva]&&r.arrayMesas[r.indexMesaActiva].nombre&&r.modoEdicion&&!r.activeMenu?((0,l.wg)(),(0,l.iD)("button",{key:3,onClick:a[6]||(a[6]=a=>e.modal=!0),class:"btn btn-info ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("cambiar_nombre","Cambiar nombre")),1)):r.modoEdicion&&!r.activeMenu?((0,l.wg)(),(0,l.iD)("button",{key:4,onClick:a[7]||(a[7]=e=>r.activarMesa()),class:"btn btn-success ms-2",style:{"font-size":"27px"}},(0,t.zw)(e.$t("activar_cesta","Activar cesta")),1)):r.modoEdicion||r.modoImprimir||r.activeMenu||r.ImprimirKitchen?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("button",{key:5,onClick:a[8]||(a[8]=e=>r.pagarPorSeparado()),class:(0,t.C_)(["btn",r.pagarNoJunto?"btn-warning":"btn-success","ms-2"]),style:{"font-size":"27px"}},(0,t.zw)(e.$t("pagar_por_separado","Pagar por separado")),3)),r.modoImprimir?((0,l.wg)(),(0,l.iD)("span",U,(0,t.zw)(e.$t("selecciona_una_mesa","Selecciona una mesa"))+" "+(0,t.zw)(e.$t("para_imprimir_la_nota","para imprimir la nota")),1)):(0,l.kq)("",!0),r.ImprimirKitchen?((0,l.wg)(),(0,l.iD)("span",S,(0,t.zw)(e.$t("selecciona_una_mesa","Selecciona una mesa"))+" "+(0,t.zw)(e.$t("para_imprimir_la_nota","para preparar")),1)):(0,l.kq)("",!0)])]),(0,l.Wm)(b,{id:"modalNombreMesa",tabindex:"-1",modelValue:r.modalNombreMesa,"onUpdate:modelValue":a[13]||(a[13]=e=>r.modalNombreMesa=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"Introduce el nombre de la mesa",size:"lg",modelValue:r.inputNombre,"onUpdate:modelValue":a[9]||(a[9]=e=>r.inputNombre=e),onClick:a[10]||(a[10]=e=>r.openKeyboard()),readonly:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s,{color:"secondary",size:"lg",onClick:a[11]||(a[11]=e=>r.cerrarModalNombreMesa())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("cerrar","Cerrar")),1)])),_:1}),(0,l.Wm)(s,{color:"primary",size:"lg",onClick:a[12]||(a[12]=e=>r.cambiarNombre())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("guardar_cambios","Guardar cambios")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),r.modoImprimir||r.activeMenu||r.ImprimirKitchen?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(s,{key:3,color:"dark",floating:"",id:"editBtn",onClick:a[14]||(a[14]=e=>r.toggleEdicion())},{default:(0,l.w5)((()=>[r.modoEdicion?((0,l.wg)(),(0,l.j4)(c,{key:1,icon:"check"})):((0,l.wg)(),(0,l.j4)(c,{key:0,icon:"edit"}))])),_:1})),r.modoImprimir||!r.activeMenu||r.ImprimirKitchen?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(s,{key:4,color:"dark",floating:"",id:"editBtn",onClick:a[15]||(a[15]=e=>{r.enviarRepartidor=!r.enviarRepartidor,r.activarModosPedido()})},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{icon:"paper-plane"})])),_:1})),r.modoImprimir||r.modoEdicion||r.activeMenu||r.ImprimirKitchen?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(s,{key:5,color:"dark",floating:"",id:"userBtn",onClick:a[16]||(a[16]=e=>r.handleClick("",!0))},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{icon:"user"})])),_:1})),r.modoImprimir||r.modoEdicion||!r.activeMenu||r.ImprimirKitchen?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(s,{key:6,color:"dark",floating:"",id:"userBtn",onClick:a[17]||(a[17]=e=>{r.eliminarPedido=!r.eliminarPedido,r.activarModosPedido()})},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{icon:"trash"})])),_:1})),r.arrayMesas&&null!=r.indexMesaActiva&&void 0!=r.indexMesaActiva&&r.arrayMesas[r.indexMesaActiva]&&r.arrayMesas[r.indexMesaActiva].nombre&&!r.modoEdicion&&!r.ImprimirKitchen?((0,l.wg)(),(0,l.j4)(s,{key:7,color:"dark",floating:"",id:"printBtn",onClick:a[18]||(a[18]=e=>r.toggleImprimir())},{default:(0,l.w5)((()=>[r.modoImprimir?((0,l.wg)(),(0,l.j4)(c,{key:1,icon:"times"})):((0,l.wg)(),(0,l.j4)(c,{key:0,icon:"print"}))])),_:1})):(0,l.kq)("",!0),r.arrayMesas&&null!=r.indexMesaActiva&&void 0!=r.indexMesaActiva&&r.arrayMesas[r.indexMesaActiva]&&r.arrayMesas[r.indexMesaActiva].nombre&&!r.modoEdicion&&!r.modoImprimir?((0,l.wg)(),(0,l.j4)(s,{key:8,color:"dark",floating:"",id:"printCiBtn",onClick:a[19]||(a[19]=e=>r.toggleImprimirKitchen())},{default:(0,l.w5)((()=>[r.ImprimirKitchen?((0,l.wg)(),(0,l.j4)(c,{key:1,icon:"times"})):((0,l.wg)(),(0,l.j4)(c,{key:0,icon:"sticky-note"}))])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(f,{ref:"modalSeleccionarRepartidor"},null,512),(0,l.Wm)(g,{ref:"CobroSeparadoRef"},null,512),(0,l.Wm)(C,{ref:"ModalCondicionalPedidoClienteRef"},null,512),(0,l.Wm)(y,{ref:"keyboardRef"},null,512),(0,l.Wm)(_,{ref:"ModalencargadoMesaRef"},null,512)],64)}const N=e=>((0,l.dD)("data-v-47afe112"),e=e(),(0,l.Cn)(),e),A={class:"row"},I=["onClick"],$=N((()=>(0,l._)("br",null,null,-1))),F=["onClick"],R=N((()=>(0,l._)("br",null,null,-1))),Z={class:"row"},q={key:0,class:"table-responsive divCesta reverso"},K={class:"table colorFuente"},O={class:"tableBody"},Y=["onClick"],J={class:"d-inline-block text-truncate",style:{"max-width":"21rem","min-width":"21rem"}};function G(e,a,o,r,i,n){const s=(0,l.up)("MDBModalTitle"),d=(0,l.up)("MDBModalHeader"),c=(0,l.up)("MDBBtn"),u=(0,l.up)("MDBModalBody"),m=(0,l.up)("MDBModalFooter"),p=(0,l.up)("MDBModal"),v=(0,l.up)("modalCobroViewVue");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(p,{id:"modalCobroSeparado",tabindex:"-1",labelledby:"staticBackdropLabel",modelValue:r.modalCobroSeparado,"onUpdate:modelValue":a[3]||(a[3]=e=>r.modalCobroSeparado=e),staticBackdrop:"",size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s,{id:"staticBackdropLabel"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Selecciona los articulos a pagar "+(0,t.zw)(r.totalPrice.toFixed(2))+" € ",1)])),_:1})])),_:1}),(0,l.Wm)(u,{class:"modal-body"},{default:(0,l.w5)((()=>[(0,l._)("div",A,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.arrayArticulosMesa,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a,class:"col mb-3"},[e?.gramos&&e?.gramos>0?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn w-100 h-100 colorIvan1 btnSuplemento",onClick:o=>r.addArticulo(e,a)},[(0,l.Uk)((0,t.zw)(e.nombre)+" ",1),$,(0,l.Uk)(" "+(0,t.zw)(e.subtotal.toFixed(2))+" € ",1)],8,I)):((0,l.wg)(),(0,l.iD)("button",{key:1,class:"btn w-100 h-100 colorIvan1 btnSuplemento",onClick:o=>r.addArticulo(e,a)},[(0,l.Uk)((0,t.zw)(e.nombre)+" ",1),R,(0,l.Uk)(" "+(0,t.zw)((e.subtotal/e.unidades).toFixed(2))+" € ",1)],8,F))])))),128))]),(0,l._)("div",Z,[r.articulosAPagar?((0,l.wg)(),(0,l.iD)("div",q,[(0,l._)("table",K,[(0,l._)("tbody",O,[e.item?.pagado?(0,l.kq)("",!0):((0,l.wg)(!0),(0,l.iD)(l.HY,{key:0},(0,l.Ko)(r.articulosAPagar,((e,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:a,class:(0,t.C_)(["itemCesta",{seleccionado:r.itemSeleccionado===a}]),onClick:e=>r.setIndex(a)},[(0,l._)("td",null,[(0,l._)("span",J,(0,t.zw)(e.nombre),1)]),(0,l._)("td",null,(0,t.zw)((e.subtotal/e.unidades).toFixed(2))+" €",1)],10,Y)))),128))])])])):(0,l.kq)("",!0),r.deleteBtn?((0,l.wg)(),(0,l.j4)(c,{key:1,onClick:a[0]||(a[0]=e=>r.delArticulo()),color:"danger",size:"lg"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("eliminar","Eliminar")),1)])),_:1})):(0,l.kq)("",!0)])])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{color:"secondary",onClick:a[1]||(a[1]=e=>r.modalCobroSeparado=!1),size:"lg"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1}),(0,l.Wm)(c,{color:"success",size:"lg",onClick:a[2]||(a[2]=e=>r.Pago())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("Pagar","Pagar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(v,{class:"p-0",ref:"modalCobroViewVueRef"},null,512)],64)}o(57658);var L=o(22483),Q=o(76674),X={name:"modalCobroSeparadoComponent",components:{MDBModal:y.j3,MDBModalHeader:y.ol,MDBModalTitle:y.wo,MDBModalBody:y.Yz,MDBModalFooter:y.ab,MDBBtn:y.$v,modalCobroViewVue:Q.Z},setup(e,{expose:a}){const o=(0,g.iH)(!1),t=(0,g.iH)(null),r=(0,g.iH)([]);let i=(0,l.Fl)((()=>s.state.Cestas.arrayCestas));const n=(0,g.iH)([]),s=(0,C.oR)(),d=(0,L.tv)(),c=(0,l.Fl)((()=>s.state.Trabajadores.indexActivo)),u=(0,l.Fl)((()=>s.state.Trabajadores.arrayTrabajadores)),m=(0,l.Fl)((()=>s.state.Trabajadores.indexActivo)),p=(0,l.Fl)((()=>u.value&&void 0!=c.value&&null!=c.value&&u.value[c.value]?u.value[c.value]:null)),v=(0,g.iH)([]);let b=0;const f=(0,g.iH)(!1),y=(0,g.iH)(0),_=(0,g.iH)(null);async function M(e){n.value.push(e)}async function h(e){for(let a=0;a<e.lista.length;a++)for(let o=0;o<e.lista[a].unidades;o++)e.lista[a].pagado||M(e.lista[a])}async function x(e,a){n.value.splice(a,1),y.value+=e.subtotal/e.unidades,r.value.push(e)}async function D(){let e=t.value;n.value.push(r.value[e]),y.value-=r.value[e].subtotal/r.value[e].unidades,r.value.splice(e,1),f.value=!1,t.value=-1}function B(e){t.value==e?(t.value=-1,f.value=!1):(t.value=e,f.value=!0)}async function z(e){v.value=e,b=e._id,r.value=[],n.value=[],o.value=!0,y.value=0,f.value=!1,h(e)}async function E(){let e,a=v;s.dispatch("Cestas/setCestaBaseAction",a.value._id),a.value.lista=r.value;for(let o=0;o<a.value.lista.length;o++)a.value.lista[o].subtotal=a.value.lista[o].subtotal/a.value.lista[o].unidades,a.value.lista[o].unidades=1;w.Z.post("cestas/PagarPorSeparado",{articulos:a.value.lista}).then((async a=>{a.data&&await w.Z.post("cestas/cambiarCestaTrabajador",{idCesta:a.data,idTrabajador:u.value[m.value]._id}).then((async t=>{if(i=(0,l.Fl)((()=>s.state.Cestas.arrayCestas)),e=await(0,l.Fl)((()=>{if(i.value)for(let e=0;e<i.value.length;e++)if(i.value[e]._id==a.data)return i.value[e]})),"PAGO SEPARADO"===e.value.modo)if(e.value.idCliente&&""!=e.value.idCliente){const a=(await w.Z.post("clientes/getClienteById",{idCliente:e.value.idCliente})).data;!0===a?.albaran&&!0===a?.noPagaEnTienda?w.Z.post("tickets/crearTicket",{total:y.value,idCesta:e.value._id,idTrabajador:p.value._id,tipo:"DEUDA",tkrsData:null}).then((e=>{if(!e.data)throw Error("No se ha podido registrar la venta en modo deuda");k().fire({icon:"success",title:"Venta modo deuda registrada correctamente",showConfirmButton:!1,timer:2e3})})).catch((e=>{k().fire("Oops...",e.message,"error")})):(await w.Z.post("impresora/despedida",{precioTotal:y.value.toFixed(2)}),await d.push("/cobro").then((()=>{})))}else await w.Z.post("impresora/despedida",{precioTotal:y.value.toFixed(2)}),_.value.abrirModal(),o.value=!1}))})),await w.Z.post("cestas/borrarUnicoItemCesta",{idCesta:a.value._id,articulos:r.value}).then((e=>{if(!e.data)throw Error("No se ha podido eliminar el artículo de la cesta")})).catch((e=>{k().fire("Oops...",e.message,"error")}))}return a({abrirModal:z}),{articulosAPagar:r,arrayArticulosMesa:n,modalCobroSeparado:o,itemSeleccionado:t,setIndex:B,deleteBtn:f,addArticulo:x,delArticulo:D,totalPrice:y,Pago:E,modalCobroViewVueRef:_}}},ee=o(40089);const ae=(0,ee.Z)(X,[["render",G],["__scopeId","data-v-47afe112"]]);var oe=ae;const le=e=>((0,l.dD)("data-v-60ae68fa"),e=e(),(0,l.Cn)(),e),te={style:{padding:"5px 0px 30px 0px"}},re={class:"w-100 text-center"},ie=le((()=>(0,l._)("div",{class:"modal-icon-container mb-3"},[(0,l._)("i",{class:"fas fa-bicycle modal-icon"})],-1))),ne=le((()=>(0,l._)("h2",{class:"modal-title fw-bold text-primary mb-1"}," Seleccionar Repartidor ",-1))),se={class:"text-muted small mb-0"},de={class:"infoCliente"},ce=le((()=>(0,l._)("i",{class:"fas fa-map-marker-alt"},null,-1))),ue=le((()=>(0,l._)("i",{class:"fas fa-phone"},null,-1))),me={class:"form-group"},pe=le((()=>(0,l._)("label",{class:"form-label fw-semibold text-dark mb-2"},[(0,l._)("i",{class:"fas fa-user-check me-2 text-primary"}),(0,l.Uk)(" Repartidores disponibles: ")],-1))),ve={class:"select-wrapper"},be=le((()=>(0,l._)("div",{class:"info-card mt-3 p-3 bg-light rounded-3"},[(0,l._)("div",{class:"d-flex align-items-center"},[(0,l._)("i",{class:"fas fa-info-circle text-info me-2"}),(0,l._)("small",{class:"text-muted"}," El repartidor recibirá una notificación en Telegram. ")])],-1))),fe={class:"d-flex gap-2 w-100"},ge=le((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1))),Ce=le((()=>(0,l._)("i",{class:"fas fa-paper-plane me-2"},null,-1))),ye=le((()=>(0,l._)("span",null,"Enviar información",-1))),_e=le((()=>(0,l._)("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},[(0,l._)("span",{class:"visually-hidden"},"Cargando...")],-1))),we=le((()=>(0,l._)("span",null,"Enviando...",-1)));function Me(e,a,o,r,i,n){const s=(0,l.up)("MDBSelect"),d=(0,l.up)("MDBModalBody"),c=(0,l.up)("MDBBtn"),u=(0,l.up)("MDBModalFooter"),m=(0,l.up)("MDBModal");return(0,l.wg)(),(0,l.j4)(m,{id:"modalSeleccionarRepartidor",tabindex:"-1",labelledby:"tituloModalRepartidor",modelValue:r.modalSeleccionarRepartidor,"onUpdate:modelValue":a[4]||(a[4]=e=>r.modalSeleccionarRepartidor=e),staticBackdrop:"",centered:"",size:"md"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"px-4 py-3"},{default:(0,l.w5)((()=>[(0,l._)("div",te,[(0,l._)("div",re,[ie,ne,(0,l._)("p",se,[(0,l.Uk)(" Elige el repartidor para esta entrega "),(0,l._)("b",null,(0,t.zw)(r.infoCliente?.nombre),1)]),(0,l._)("div",de,[(0,l._)("span",null,[ce,(0,l.Uk)(" "+(0,t.zw)(r.infoCliente?.direccion),1)]),(0,l._)("span",null,[ue,(0,l.Uk)(" "+(0,t.zw)(r.infoCliente?.telefono),1)])])])]),(0,l._)("div",me,[pe,(0,l._)("div",ve,[(0,l.Wm)(s,{options:r.repartidoresValues,"onUpdate:options":a[0]||(a[0]=e=>r.repartidoresValues=e),selected:r.selectedRepartidor,"onUpdate:selected":a[1]||(a[1]=e=>r.selectedRepartidor=e),optionHeight:50,filter:"",placeholder:"Buscar y seleccionar repartidor...",class:"custom-select"},null,8,["options","selected"])])]),be])),_:1}),(0,l.Wm)(u,{class:"border-0 pt-2 px-4 pb-4"},{default:(0,l.w5)((()=>[(0,l._)("div",fe,[(0,l.Wm)(c,{color:"light",onClick:a[2]||(a[2]=e=>r.modalSeleccionarRepartidor=!1),ref:"salirBoton",disabled:r.loading,class:"flex-fill btn-cancel"},{default:(0,l.w5)((()=>[ge,(0,l.Uk)(" Cancelar ")])),_:1},8,["disabled"]),(0,l.Wm)(c,{color:"success",onClick:a[3]||(a[3]=e=>r.enviarRepartidor()),disabled:r.loading,class:"flex-fill btn-confirm btnSpinner d-flex align-items-center justify-content-center"},{default:(0,l.w5)((()=>[r.loading?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[_e,we],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[Ce,ye],64))])),_:1},8,["disabled"])])])),_:1})])),_:1},8,["modelValue"])}o(3449);var ke={name:"ModalFichaClienteComponent",props:["callback"],components:{MDBBtn:y.$v,MDBSelect:y.R3,MDBModal:y.j3,MDBModalBody:y.Yz,MDBModalFooter:y.ab,MDBModalHeader:y.ol},setup(e,{expose:a}){const o=(0,g.iH)(!1),l=(0,g.iH)(""),t="1175028468:AAGzPS8EvKKfLcnjOZozFj493tzJ9uATxCA",r=(0,g.iH)({idEncargo:null,total:null}),i=(0,C.oR)(),n=(0,g.iH)(null),s=(0,g.iH)(null),d=(0,g.iH)(!1),c=(0,g.iH)([{id:-1,text:"No hay repartidores disponibles",disabled:!0,selected:!0}]),u=async()=>{let e=(await w.Z.post("trabajadores/getRepartidores")).data;0!=e.length&&(c.value=e.map((e=>({value:e._id,text:e.nombreCorto,secondaryText:e.numero,telegram_id:e.telegram_id,telefono:e.numero}))))},m=async()=>{let e=c.value.find((e=>e.value==l.value));void 0==e&&k().fire({icon:"error",title:"Error",text:"No se ha seleccionado un repartidor"}),console.log(e);const a="https://www.google.com/maps/search/?api=1&query="+encodeURIComponent(s.value.direccion),n=`\n      <b>🚚 NUEVO PEDIDO</b>\n\n      <b>👤 Cliente:</b> ${s.value.nombre}\n      <b>📍 Dirección:</b> ${s.value.direccion}\n      <b>📞 Teléfono:</b> ${s.value.telefono}\n      <b>💰 Total:</b> ${r.value.total.toFixed(2)}€\n\n      Pulsa el botón para ver la ubicación en Google Maps:\n      `,d={inline_keyboard:[[{text:"📍 Ver ubicación",url:a}]]};await w.Z.post(`https://api.telegram.org/bot${t}/sendMessage`,{chat_id:e.telegram_id,text:n,parse_mode:"HTML",reply_markup:d}).then((a=>{a.data.ok?w.Z.post("encargos/setPedidoRepartidor",{idEncargo:r.value.idEncargo,idRepartidor:e.value}).then((e=>{k().fire({icon:"success",title:"Mensaje enviado",text:"El mensaje ha sido enviado correctamente"}),w.Z.post("/encargos/getPedidos").then((e=>{i.dispatch("Encargos/setPedidos",e.data)}))})):k().fire({icon:"error",title:"Error",text:"Ha ocurrido un error al enviar el mensaje"}),o.value=!1}))},p=async(e,a)=>{r.value=a,n.value=e,u(),s.value=(await w.Z.post("clientes/getClienteById",{idCliente:e})).data,o.value=!0};return a({abrirModal:p}),{loading:d,selectedRepartidor:l,infoCliente:s,repartidoresValues:c,enviarRepartidor:m,modalSeleccionarRepartidor:o}}};const he=(0,ee.Z)(ke,[["render",Me],["__scopeId","data-v-60ae68fa"]]);var xe=he,De=o(49242);const Be=e=>((0,l.dD)("data-v-04f665b0"),e=e(),(0,l.Cn)(),e),ze={class:"h4 mx-2 py-2 border-bottom text-secondary"},Ee={class:"d-flex justify-content-around mt-4 mx-2"},Te={for:"tipo1",class:"h5 d-flex align-items-center"},je=Be((()=>(0,l._)("i",{class:"fas fa-user-plus me-2"},null,-1))),Pe={for:"tipo2",class:"h5 d-flex align-items-center"},He=Be((()=>(0,l._)("i",{class:"fas fa-users me-2"},null,-1))),Ve={class:"h5 mb-0"},Ue=Be((()=>(0,l._)("i",{class:"fa fa-exclamation-circle","aria-hidden":"true"},null,-1))),Se=Be((()=>(0,l._)("i",{class:"fas fa-check me-2"},null,-1))),We=Be((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1))),Ne=Be((()=>(0,l._)("i",{class:"fas fa-user-plus me-2"},null,-1))),Ae={class:"row g-3"},Ie={class:"col-md-6 mb-3"},$e={for:"nombreCliente",class:"form-label fw-bold"},Fe=Be((()=>(0,l._)("i",{class:"fas fa-user me-2 text-primary"},null,-1))),Re={class:"col-md-6 mb-3"},Ze={for:"telefonoCliente",class:"form-label fw-bold"},qe=Be((()=>(0,l._)("i",{class:"fas fa-phone me-2 text-primary"},null,-1))),Ke={class:"col-12 mb-3"},Oe={for:"direccionCliente",class:"form-label fw-bold"},Ye=Be((()=>(0,l._)("i",{class:"fas fa-map-marker-alt me-2 text-primary"},null,-1))),Je={class:"col-md-4 mb-3"},Ge={for:"pisoCliente",class:"form-label fw-bold"},Le=Be((()=>(0,l._)("i",{class:"fas fa-building me-2 text-primary"},null,-1))),Qe={class:"col-md-4 mb-3"},Xe={for:"puertaCliente",class:"form-label fw-bold"},ea=Be((()=>(0,l._)("i",{class:"fas fa-door-open me-2 text-primary"},null,-1))),aa={class:"col-md-4 mb-3"},oa={for:"codigoPostalCliente",class:"form-label fw-bold"},la=Be((()=>(0,l._)("i",{class:"fas fa-mail-bulk me-2 text-primary"},null,-1))),ta={class:"h5 mb-0"},ra=Be((()=>(0,l._)("i",{class:"fa fa-exclamation-circle me-2","aria-hidden":"true"},null,-1))),ia=Be((()=>(0,l._)("i",{class:"fas fa-save me-2"},null,-1))),na=Be((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1))),sa=Be((()=>(0,l._)("i",{class:"fas fa-users me-2"},null,-1))),da={class:"row mt-1 p-4"},ca={class:"col-md-8"},ua=["placeholder"],ma={class:"col-md-4"},pa=Be((()=>(0,l._)("i",{class:"fas fa-search me-2"},null,-1))),va={key:0,class:"row"},ba={class:"col"},fa={class:"table-responsive w-100",style:{height:"400px"}},ga={class:"table table-striped mt-1"},Ca={class:"nameDiv"},ya={class:"textoNombre d-inline-block text-truncate"},_a=Be((()=>(0,l._)("i",{class:"fas fa-check-circle me-2"},null,-1))),wa={key:1,class:"row"},Ma={class:"sinResultados position-relative"},ka={class:"textoSinResultados position-absolute top-50 start-50 translate-middle"},ha=Be((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1))),xa=Be((()=>(0,l._)("i",{class:"fas fa-map-marker-alt me-2"},null,-1))),Da={class:"row g-3"},Ba={class:"col-md-12 mb-3"},za={for:"direccionCliente",class:"form-label fw-bold"},Ea=Be((()=>(0,l._)("i",{class:"fas fa-home me-2 text-primary"},null,-1))),Ta={class:"col-md-6 mb-3"},ja={for:"pisoCliente",class:"form-label fw-bold"},Pa=Be((()=>(0,l._)("i",{class:"fas fa-building me-2 text-primary"},null,-1))),Ha={class:"col-md-6 mb-3"},Va={for:"puertaCliente",class:"form-label fw-bold"},Ua=Be((()=>(0,l._)("i",{class:"fas fa-door-open me-2 text-primary"},null,-1))),Sa={class:"col-md-6 mb-3"},Wa={for:"cpCliente",class:"form-label fw-bold"},Na=Be((()=>(0,l._)("i",{class:"fas fa-mail-bulk me-2 text-primary"},null,-1))),Aa={class:"h5 mb-0"},Ia=Be((()=>(0,l._)("i",{class:"fa fa-exclamation-circle","aria-hidden":"true"},null,-1))),$a=Be((()=>(0,l._)("i",{class:"fas fa-check me-2"},null,-1))),Fa=Be((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1))),Ra=Be((()=>(0,l._)("i",{class:"fas fa-map-marker-alt me-2"},null,-1))),Za={class:"row g-3"},qa={class:"col-md-12 mb-3"},Ka={for:"direccionCliente",class:"form-label fw-bold"},Oa=Be((()=>(0,l._)("i",{class:"fas fa-home me-2 text-primary"},null,-1))),Ya={class:"col-md-6 mb-3"},Ja={for:"pisoCliente",class:"form-label fw-bold"},Ga=Be((()=>(0,l._)("i",{class:"fas fa-building me-2 text-primary"},null,-1))),La={class:"col-md-6 mb-3"},Qa={for:"puertaCliente",class:"form-label fw-bold"},Xa=Be((()=>(0,l._)("i",{class:"fas fa-door-open me-2 text-primary"},null,-1))),eo={class:"col-md-6 mb-3"},ao={for:"cpCliente",class:"form-label fw-bold"},oo=Be((()=>(0,l._)("i",{class:"fas fa-mail-bulk me-2 text-primary"},null,-1))),lo={class:"h5 mb-0"},to=Be((()=>(0,l._)("i",{class:"fa fa-exclamation-circle","aria-hidden":"true"},null,-1))),ro=Be((()=>(0,l._)("i",{class:"fas fa-check me-2"},null,-1))),io=Be((()=>(0,l._)("i",{class:"fas fa-times me-2"},null,-1)));function no(e,a,o,r,i,n){const s=(0,l.up)("MDBModalTitle"),d=(0,l.up)("MDBModalHeader"),c=(0,l.up)("MDBModalBody"),u=(0,l.up)("MDBBtn"),m=(0,l.up)("MDBModalFooter"),p=(0,l.up)("MDBModal"),v=(0,l.up)("MDBBadge"),b=(0,l.up)("KeyBoardComponentVue");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(p,{id:"ModalCondicionalPedidoCliente",tabindex:"-1",labelledby:"ModalCondicionalPedidoCliente",modelValue:r.ModalCondicionalPedidoCliente,"onUpdate:modelValue":a[4]||(a[4]=e=>r.ModalCondicionalPedidoCliente=e),staticBackdrop:"",centered:""},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"h3 ms-2 text-primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,t.zw)(e.$t("elige_pedido_cliente","Seleccionar opción"))+":",1)])),_:1})])),_:1}),(0,l.Wm)(c,{class:"py-4"},{default:(0,l.w5)((()=>[(0,l._)("h2",ze,(0,t.zw)(e.$t("que_desea_hacer","¿Que desea hacer?")),1),(0,l._)("div",Ee,[(0,l._)("div",{class:(0,t.C_)("createClient"==r.tipo?"option-card selected":"option-card"),onClick:a[0]||(a[0]=e=>r.tipo="createClient")},[(0,l._)("label",Te,[je,(0,l.Uk)(" "+(0,t.zw)(e.$t("crear_cliente","Cliente nuevo")),1)])],2),(0,l._)("div",{class:(0,t.C_)("existenClient"==r.tipo?"option-card selected":"option-card"),onClick:a[1]||(a[1]=e=>r.tipo="existenClient")},[(0,l._)("label",Pe,[He,(0,l.Uk)(" "+(0,t.zw)(e.$t("existen_client","Cliente existente")),1)])],2)]),(0,l._)("div",{class:(0,t.C_)([{"d-none":!r.errorValidacionTipo},"alert alert-danger mt-3 mx-2 text-center"])},[(0,l._)("p",Ve,[Ue,(0,l.Uk)(" "+(0,t.zw)(r.commentError),1)])],2)])),_:1}),(0,l.Wm)(m,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{color:"success",size:"lg",class:"px-4",onClick:a[2]||(a[2]=e=>r.confirmarTipo())},{default:(0,l.w5)((()=>[Se,(0,l.Uk)(" "+(0,t.zw)(e.$t("confirmar","confirmar")),1)])),_:1}),(0,l.Wm)(u,{color:"warning",size:"lg",class:"px-4",onClick:a[3]||(a[3]=e=>r.cerrarModalCondicionalPedidoCliente())},{default:(0,l.w5)((()=>[We,(0,l.Uk)(" "+(0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(p,{id:"ModalCrearCliente",tabindex:"-1",labelledby:"ModalCrearCliente",modelValue:r.modalCrearCliente,"onUpdate:modelValue":a[13]||(a[13]=e=>r.modalCrearCliente=e),staticBackdrop:"",centered:"",size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"h3 ms-2 text-primary"},{default:(0,l.w5)((()=>[Ne,(0,l.Uk)(" "+(0,t.zw)(e.$t("datos_nuevo_cliente","Datos del nuevo cliente")),1)])),_:1})])),_:1}),(0,l.Wm)(c,{class:"py-4"},{default:(0,l.w5)((()=>[(0,l._)("div",Ae,[(0,l._)("div",Ie,[(0,l._)("label",$e,[Fe,(0,l.Uk)(" "+(0,t.zw)(e.$t("nombre_cliente","Nombre cliente")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"nombreCliente","onUpdate:modelValue":a[5]||(a[5]=e=>r.datosNuevoCliente.nombre=e),placeholder:"Nombre completo"},null,512),[[De.nr,r.datosNuevoCliente.nombre]])]),(0,l._)("div",Re,[(0,l._)("label",Ze,[qe,(0,l.Uk)(" "+(0,t.zw)(e.$t("telefono_cliente","Número de teléfono")),1)]),(0,l.wy)((0,l._)("input",{type:"tel",class:"form-control form-control-lg",id:"telefonoCliente","onUpdate:modelValue":a[6]||(a[6]=e=>r.datosNuevoCliente.telefono=e),placeholder:"Ej: 612345678"},null,512),[[De.nr,r.datosNuevoCliente.telefono]])]),(0,l._)("div",Ke,[(0,l._)("label",Oe,[Ye,(0,l.Uk)(" "+(0,t.zw)(e.$t("direccion_cliente","Dirección")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"direccionCliente","onUpdate:modelValue":a[7]||(a[7]=e=>r.datosNuevoCliente.direccion=e),placeholder:"Calle, número"},null,512),[[De.nr,r.datosNuevoCliente.direccion]])]),(0,l._)("div",Je,[(0,l._)("label",Ge,[Le,(0,l.Uk)(" "+(0,t.zw)(e.$t("piso_cliente","Piso")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"pisoCliente","onUpdate:modelValue":a[8]||(a[8]=e=>r.datosNuevoCliente.piso=e),placeholder:"Ej: 2"},null,512),[[De.nr,r.datosNuevoCliente.piso]])]),(0,l._)("div",Qe,[(0,l._)("label",Xe,[ea,(0,l.Uk)(" "+(0,t.zw)(e.$t("puerta_cliente","Puerta")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"puertaCliente","onUpdate:modelValue":a[9]||(a[9]=e=>r.datosNuevoCliente.puerta=e),placeholder:"Ej: A"},null,512),[[De.nr,r.datosNuevoCliente.puerta]])]),(0,l._)("div",aa,[(0,l._)("label",oa,[la,(0,l.Uk)(" "+(0,t.zw)(e.$t("codigo_postal_cliente","Código postal")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"codigoPostalCliente","onUpdate:modelValue":a[10]||(a[10]=e=>r.datosNuevoCliente.codigoPostal=e),placeholder:"Ej: 08001"},null,512),[[De.nr,r.datosNuevoCliente.codigoPostal]])])]),(0,l._)("div",{class:(0,t.C_)([{"d-none":!r.errorValidacionDatosCliente},"alert alert-danger mt-3 text-center"])},[(0,l._)("p",ta,[ra,(0,l.Uk)(" "+(0,t.zw)(r.errorDatosCliente),1)])],2)])),_:1}),(0,l.Wm)(m,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{color:"success",size:"lg",class:"px-4",onClick:a[11]||(a[11]=e=>r.confirmarDatosCliente())},{default:(0,l.w5)((()=>[ia,(0,l.Uk)(" "+(0,t.zw)(e.$t("guardar","Guardar")),1)])),_:1}),(0,l.Wm)(u,{color:"warning",size:"lg",class:"px-4",onClick:a[12]||(a[12]=e=>r.cerrarModalCrearCliente())},{default:(0,l.w5)((()=>[na,(0,l.Uk)(" "+(0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(p,{id:"ModalSeleccionarCliente",tabindex:"-1",labelledby:"ModalSeleccionarCliente",modelValue:r.modalSeleccionarCliente,"onUpdate:modelValue":a[18]||(a[18]=e=>r.modalSeleccionarCliente=e),staticBackdrop:"",size:"xl"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"h3 ms-2 text-primary"},{default:(0,l.w5)((()=>[sa,(0,l.Uk)(" "+(0,t.zw)(e.$t("seleccionar_cliente_existente","Seleccionar cliente existente")),1)])),_:1})])),_:1}),(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l._)("div",da,[(0,l._)("div",ca,[(0,l.wy)((0,l._)("input",{class:"form-control inputBusqueda w-100",type:"text",placeholder:e.$t("buscar_por_nombre","Buscar por nombre"),"aria-label":".form-control-lg example","onUpdate:modelValue":a[14]||(a[14]=e=>r.inputBusqueda=e),onClick:a[15]||(a[15]=e=>r.openKeyboard()),readonly:""},null,8,ua),[[De.nr,r.inputBusqueda]])]),(0,l._)("div",ma,[(0,l.Wm)(u,{color:"secondary",class:"botonBusqueda w-100",onClick:a[16]||(a[16]=e=>r.buscarClientes())},{default:(0,l.w5)((()=>[pa,(0,l.Uk)(" "+(0,t.zw)(e.$t("buscar","Buscar")),1)])),_:1})])]),r.arrayClientes?.length>0?((0,l.wg)(),(0,l.iD)("div",va,[(0,l._)("div",ba,[(0,l._)("div",fa,[(0,l._)("table",ga,[(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.arrayClientes,((a,o)=>((0,l.wg)(),(0,l.iD)("tr",{key:o,class:"cliente-row"},[(0,l._)("td",null,[(0,l._)("div",Ca,[(0,l._)("span",ya,(0,t.zw)(a.nombre),1),a.albaran?((0,l.wg)(),(0,l.j4)(v,{key:0,badge:"info",class:"text-dark textoAlbaran",pill:""},{default:(0,l.w5)((()=>[(0,l.Uk)(" Albaran ")])),_:1})):a?.vip?((0,l.wg)(),(0,l.j4)(v,{key:1,badge:"info",class:"text-dark textoAlbaran",pill:""},{default:(0,l.w5)((()=>[(0,l.Uk)(" Vip ")])),_:1})):(0,l.kq)("",!0)])]),(0,l._)("td",null,[(0,l.Wm)(u,{color:"primary",size:"lg",onClick:e=>r.seleccionarClienteExistente(a.id,a.nombre),class:"w-100 btn-elegir"},{default:(0,l.w5)((()=>[_a,(0,l.Uk)(" "+(0,t.zw)(e.$t("elegir","Elegir")),1)])),_:2},1032,["onClick"])])])))),128))])])])])])):((0,l.wg)(),(0,l.iD)("div",wa,[(0,l._)("div",Ma,[(0,l._)("span",ka,(0,t.zw)(e.$t("sin_resultados","Sin resultados")),1)])]))])),_:1}),(0,l.Wm)(m,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{color:"warning",size:"lg",class:"px-4",onClick:a[17]||(a[17]=e=>r.cerrarModalSeleccionarCliente())},{default:(0,l.w5)((()=>[ha,(0,l.Uk)(" "+(0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(p,{id:"ModalEditarDireccion",tabindex:"-1",labelledby:"ModalEditarDireccion",modelValue:r.modalEditarDireccion,"onUpdate:modelValue":a[25]||(a[25]=e=>r.modalEditarDireccion=e),staticBackdrop:"",centered:"",size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"h3 ms-2 text-primary"},{default:(0,l.w5)((()=>[xa,(0,l.Uk)(" "+(0,t.zw)(e.$t("editar_direccion","Editar dirección del cliente")),1)])),_:1})])),_:1}),(0,l.Wm)(c,{class:"py-4"},{default:(0,l.w5)((()=>[(0,l._)("div",Da,[(0,l._)("div",Ba,[(0,l._)("label",za,[Ea,(0,l.Uk)(" "+(0,t.zw)(e.$t("direccion","Dirección")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"direccionCliente","onUpdate:modelValue":a[19]||(a[19]=e=>r.datosDireccion.direccion=e),placeholder:"Calle, número..."},null,512),[[De.nr,r.datosDireccion.direccion]])]),(0,l._)("div",Ta,[(0,l._)("label",ja,[Pa,(0,l.Uk)(" "+(0,t.zw)(e.$t("piso","Piso")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"pisoCliente","onUpdate:modelValue":a[20]||(a[20]=e=>r.datosDireccion.piso=e),placeholder:"Piso"},null,512),[[De.nr,r.datosDireccion.piso]])]),(0,l._)("div",Ha,[(0,l._)("label",Va,[Ua,(0,l.Uk)(" "+(0,t.zw)(e.$t("puerta","Puerta")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"puertaCliente","onUpdate:modelValue":a[21]||(a[21]=e=>r.datosDireccion.puerta=e),placeholder:"Puerta"},null,512),[[De.nr,r.datosDireccion.puerta]])]),(0,l._)("div",Sa,[(0,l._)("label",Wa,[Na,(0,l.Uk)(" "+(0,t.zw)(e.$t("codigo_postal","Código Postal")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"cpCliente","onUpdate:modelValue":a[22]||(a[22]=e=>r.datosDireccion.codigoPostal=e),placeholder:"Código Postal"},null,512),[[De.nr,r.datosDireccion.codigoPostal]])])]),(0,l._)("div",{class:(0,t.C_)([{"d-none":!r.errorValidacionDireccion},"alert alert-danger mt-3 mx-2 text-center"])},[(0,l._)("p",Aa,[Ia,(0,l.Uk)(" "+(0,t.zw)(r.errorDireccion),1)])],2)])),_:1}),(0,l.Wm)(m,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{color:"success",size:"lg",class:"px-4",onClick:a[23]||(a[23]=e=>r.confirmarDireccion())},{default:(0,l.w5)((()=>[$a,(0,l.Uk)(" "+(0,t.zw)(e.$t("confirmar","Confirmar")),1)])),_:1}),(0,l.Wm)(u,{color:"warning",size:"lg",class:"px-4",onClick:a[24]||(a[24]=e=>r.cerrarModalEditarDireccion())},{default:(0,l.w5)((()=>[Fa,(0,l.Uk)(" "+(0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(p,{id:"ModalEditarDireccion",tabindex:"-1",labelledby:"ModalEditarDireccion",modelValue:r.modalEditarDireccion,"onUpdate:modelValue":a[32]||(a[32]=e=>r.modalEditarDireccion=e),staticBackdrop:"",centered:"",size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"h3 ms-2 text-primary"},{default:(0,l.w5)((()=>[Ra,(0,l.Uk)(" "+(0,t.zw)(e.$t("editar_direccion","Editar dirección del cliente")),1)])),_:1})])),_:1}),(0,l.Wm)(c,{class:"py-4"},{default:(0,l.w5)((()=>[(0,l._)("div",Za,[(0,l._)("div",qa,[(0,l._)("label",Ka,[Oa,(0,l.Uk)(" "+(0,t.zw)(e.$t("direccion","Dirección")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"direccionCliente","onUpdate:modelValue":a[26]||(a[26]=e=>r.datosDireccion.direccion=e),placeholder:"Calle, número..."},null,512),[[De.nr,r.datosDireccion.direccion]])]),(0,l._)("div",Ya,[(0,l._)("label",Ja,[Ga,(0,l.Uk)(" "+(0,t.zw)(e.$t("piso","Piso")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"pisoCliente","onUpdate:modelValue":a[27]||(a[27]=e=>r.datosDireccion.piso=e),placeholder:"Piso"},null,512),[[De.nr,r.datosDireccion.piso]])]),(0,l._)("div",La,[(0,l._)("label",Qa,[Xa,(0,l.Uk)(" "+(0,t.zw)(e.$t("puerta","Puerta")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"puertaCliente","onUpdate:modelValue":a[28]||(a[28]=e=>r.datosDireccion.puerta=e),placeholder:"Puerta"},null,512),[[De.nr,r.datosDireccion.puerta]])]),(0,l._)("div",eo,[(0,l._)("label",ao,[oo,(0,l.Uk)(" "+(0,t.zw)(e.$t("codigo_postal","Código Postal")),1)]),(0,l.wy)((0,l._)("input",{type:"text",class:"form-control form-control-lg",id:"cpCliente","onUpdate:modelValue":a[29]||(a[29]=e=>r.datosDireccion.codigoPostal=e),placeholder:"Código Postal"},null,512),[[De.nr,r.datosDireccion.codigoPostal]])])]),(0,l._)("div",{class:(0,t.C_)([{"d-none":!r.errorValidacionDireccion},"alert alert-danger mt-3 mx-2 text-center"])},[(0,l._)("p",lo,[to,(0,l.Uk)(" "+(0,t.zw)(r.errorDireccion),1)])],2)])),_:1}),(0,l.Wm)(m,{class:"bg-light"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{color:"success",size:"lg",class:"px-4",onClick:a[30]||(a[30]=e=>r.confirmarDireccion())},{default:(0,l.w5)((()=>[ro,(0,l.Uk)(" "+(0,t.zw)(e.$t("confirmar","Confirmar")),1)])),_:1}),(0,l.Wm)(u,{color:"warning",size:"lg",class:"px-4",onClick:a[31]||(a[31]=e=>r.cerrarModalEditarDireccion())},{default:(0,l.w5)((()=>[io,(0,l.Uk)(" "+(0,t.zw)(e.$t("cancelar","Cancelar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(b,{ref:"keyboardRef"},null,512)],64)}var so=o(22871),co={name:"ModalCondicionalPedidoClienteComponent",components:{MDBModal:y.j3,MDBModalBody:y.Yz,MDBBtn:y.$v,MDBModalHeader:y.ol,MDBModalTitle:y.wo,MDBModalFooter:y.ab,MDBIcon:y.vm,MDBTabs:y.zk,MDBTabNav:y.JH,MDBTabItem:y.kX,MDBTabContent:y.oJ,MDBTabPane:y.jE,MDBSelect:y.R3,MDBPopover:y.SW,MDBBadge:y.m_,KeyBoardComponentVue:so.Z},setup(e,{expose:a,emit:o}){const t=(0,C.oR)(),r=(0,g.iH)(!1),i=(0,g.iH)(null),n=(0,g.iH)(!1),s=(0,g.iH)(""),d=(0,g.iH)(""),c=(0,g.iH)(null),u=(0,g.iH)(null),m=t.getters["Cestas/getCestaActiva"],p=(0,g.iH)(!1),v=(0,g.iH)({nombre:"",telefono:"",direccion:"",piso:"",puerta:"",codigoPostal:""}),b=(0,g.iH)(!1),f=(0,g.iH)(""),y=(0,g.iH)(!1),_=(0,g.iH)(""),M=(0,g.iH)([]),h=(0,g.iH)(null),x=(0,l.Fl)((()=>t.state.Trabajadores.arrayTrabajadores)),D=(0,l.Fl)((()=>t.state.Trabajadores.indexActivo)),B=(0,l.Fl)((()=>x.value&&null!=D.value&&void 0!=D.value&&x.value[D.value]?x.value[D.value]:null)),z=(0,g.iH)(!1),E=(0,g.iH)({direccion:"",piso:"",puerta:"",codigoPostal:""}),T=(0,g.iH)(!1),j=(0,g.iH)(""),P=()=>{if(!E.value.direccion)return T.value=!0,void(j.value="La dirección es obligatoria");w.Z.post("clientes/actualizarCliente",{idCliente:c.value.id,nombre:c.value.nombre,telefono:c.value.telefono,direccion:V(E.value),email:c.value.email,tarjetaCliente:c.value.tarjetaCliente,nif:c.value.nif,descuento:c.value.descuento}).then((e=>{console.log(e.data),e.data?(k().fire("¡Éxito!","Dirección actualizada correctamente","success"),H(),N(c.value.id,c.value.nombre),F()):k().fire("Oops...",e.data.msg||"Error al actualizar la dirección","error")})).catch((e=>{console.error(e),k().fire("Oops...","Error al conectar con el servidor","error")}))},H=()=>{z.value=!1,T.value=!1,j.value="",E.value={direccion:"",piso:"",puerta:"",codigoPostal:""}};(0,l.YP)(i,(e=>{"createClient"===e&&(v.value={nombre:"",telefono:"",direccion:"",piso:"",puerta:"",codigoPostal:""})}));const V=e=>{let a=e.direccion;return e.piso&&(a+=", Piso "+e.piso),e.puerta&&(a+=", Puerta "+e.puerta),a+=", Código Postal "+e.codigoPostal,a};(0,l.YP)(_,(()=>{R()}));const U=()=>{i.value?(n.value=!1,"createClient"===i.value?p.value=!0:"existenClient"===i.value?(y.value=!0,R()):F()):(n.value=!0,s.value="Debes seleccionar un tipo de cliente.")},S=()=>{switch(!0){case""===v.value.nombre:return b.value=!0,void(f.value="El nombre es obligatorio.");case""===v.value.telefono:return b.value=!0,void(f.value="El teléfono es obligatorio.");case""===v.value.direccion:return b.value=!0,void(f.value="La dirección es obligatoria.");case""===v.value.codigoPostal:return b.value=!0,void(f.value="El código postal es obligatorio.");default:b.value=!1,f.value="";break}w.Z.post("clientes/crearNuevoCliente",{nombre:v.value.nombre,telefono:v.value.telefono,email:"",direccion:V(v.value),tarjetaCliente:"",nif:"",descuento:0}).then((async e=>{console.log(e.data,"passerror"==e.data.details),e.data.success?("passerror"==e.data.details?await k().fire({title:e.data.message,icon:"warning",confirmButtonText:"Aceptar"}):await k().fire({title:"Cliente creado",icon:"success",confirmButtonText:"Aceptar"}),A(),F(),N(e.data.idCliente,v.value.nombre)):k().fire({title:"Vaya...",text:"Error al crear el cliente",icon:"error",confirmButtonText:"Aceptar"})})).catch((e=>{console.log(e,"socjo"),k().fire({title:"Vaya...",text:"Error al crear el cliente",icon:"error",confirmButtonText:"Aceptar"})}))},W=(e,a,o=(()=>{}))=>{k().fire("error"===a?"Oops...":"Ok!!",e,a).then((()=>o()))},N=(e,a)=>{const o=new Date;let l=m;const r=o.getFullYear(),i=o.getMonth()+1,n=o.getDate();let s=`${r}-${i.toString().padStart(2,"0")}-${n.toString().padStart(2,"0")}`;l.idCliente=e,l.nombreCliente=a;const d={idCliente:e,nombreCliente:a,opcionRecogida:1,amPm:"pm",fecha:s,hora:null,dias:[],dejaCuenta:0,total:0,productos:[],cesta:l,idTrabajador:B.value._id,nombreDependienta:B.value.nombre};w.Z.post("encargos/setPedido",d).then((({data:e})=>{function a(){w.Z.post("/encargos/getPedidos").then((e=>{t.dispatch("Encargos/setPedidos",e.data)}))}e&&e.msg?e.error?W(e.msg,"error"):(a(),t.dispatch("Cestas/setCestaActivaAction",null),W("Pedido iniciado","success")):W("Error general","error")})).catch((e=>{console.log(e),W("Error general","error")}))},A=()=>{p.value=!1,b.value=!1,f.value=""},I=()=>{y.value=!1,_.value="",M.value=[]},$=(e,a=null)=>{const o=(0,l.Fl)((()=>t.state.Encargos.pedidos));o.value.length>49?k().fire({title:"Vaya...",text:"Ya tienes demasiados pedidos abiertos",icon:"warning",confirmButtonText:"Aceptar"}):(r.value=!0,u.value=e,d.value=a)},F=()=>{r.value=!1,i.value=null,n.value=!1,s.value="",u.value=null,d.value="",p.value=!1,y.value=!1},R=()=>{w.Z.post("clientes/buscar",{busqueda:_.value}).then((e=>{M.value=e.data})).catch((e=>{k().fire("Oops...",e.message,"error")}))},Z=async(e,a)=>{const o=await w.Z.post("clientes/getClienteById",{idCliente:e});if(!o.data)return k().fire("Oops...","Cliente no encontrado","error");c.value=o.data,await k().fire({title:"Confirmar dirección",html:`¿La dirección que hay guardada del cliente es correcta?<br><br> <b>${c.value.direccion}</b>`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, es correcta",cancelButtonText:"No, es incorrecta"}).then((o=>{o.isConfirmed?(I(),N(e,a),F()):(z.value=!0,E.value=q(c.value.direccion))}))},q=e=>{const a=e.split(","),o=`${a[0]} ${a[1].includes("Piso")?"":a[1]}`;let l="",t="",r="";for(let i=1;i<a.length;i++){const e=a[i].trim();e.startsWith("Piso")&&(l=e.split(" ")[1]),e.startsWith("Puerta")&&(t=e.split(" ")[1]),e.startsWith("Código Postal")&&(r=e.split(" ")[2])}return{direccion:o,piso:l,puerta:t,codigoPostal:r}};let K;const O=()=>{try{h.value.abrirModal(_.value),K=setInterval((()=>{_.value=h.value.getValue()[0],h.value.getValue()[1]||clearInterval(K)}),10)}catch(e){console.log(e),K=void 0}};return a({abrirModal:$,cerrarModalCondicionalPedidoCliente:F,crearPedido:N}),{ModalCondicionalPedidoCliente:r,tipo:i,errorValidacionTipo:n,commentError:s,confirmarTipo:U,cerrarModalCondicionalPedidoCliente:F,nombreCliente:d,confirmarDireccion:P,datosDireccion:E,errorValidacionDireccion:T,errorDireccion:j,modalEditarDireccion:z,cerrarModalEditarDireccion:H,modalCrearCliente:p,datosNuevoCliente:v,errorValidacionDatosCliente:b,errorDatosCliente:f,ClienteSeleccionado:c,confirmarDatosCliente:S,cerrarModalCrearCliente:A,modalSeleccionarCliente:y,inputBusqueda:_,arrayClientes:M,buscarClientes:R,seleccionarClienteExistente:Z,cerrarModalSeleccionarCliente:I,openKeyboard:O,keyboardRef:h}}};const uo=(0,ee.Z)(co,[["render",no],["__scopeId","data-v-04f665b0"]]);var mo=uo;const po={class:"mb-4"},vo={class:"form-label fw-bold",for:"trabajadorSelect"},bo=["value"],fo={class:"mb-4"},go={class:"form-label fw-bold",for:"comensalesInput"},Co={class:"input-group"},yo={class:"mb-3"};function _o(e,a,o,r,i,n){const s=(0,l.up)("MDBIcon"),d=(0,l.up)("MDBInput"),c=(0,l.up)("NumpadComponent"),u=(0,l.up)("MDBModalBody"),m=(0,l.up)("MDBBtn"),p=(0,l.up)("MDBModalFooter"),v=(0,l.up)("MDBModal");return(0,l.wg)(),(0,l.j4)(v,{modelValue:r.modalEncargadoMesa,"onUpdate:modelValue":a[4]||(a[4]=e=>r.modalEncargadoMesa=e),static:"",backdrop:"true","tab-index":"-1"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"mx-auto py-4"},{default:(0,l.w5)((()=>[(0,l._)("div",po,[(0,l._)("label",vo,[(0,l.Wm)(s,{icon:"users",class:"me-2 text-info"}),(0,l.Uk)(" "+(0,t.zw)(e.$t("encargado_de_la_mesa","Encargado de la mesa:")),1)]),(0,l.wy)((0,l._)("select",{id:"trabajadorSelect","onUpdate:modelValue":a[0]||(a[0]=e=>r.indiceTrabajadorActivo=e),class:"form-select selecTrabajador border-primary shadow-sm"},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.arrayTrabajadores,((e,a)=>((0,l.wg)(),(0,l.iD)("option",{key:a,value:a},(0,t.zw)(r.arrayTrabajadores[a].nombre),9,bo)))),128))],512),[[De.bM,r.indiceTrabajadorActivo]])]),(0,l._)("div",fo,[(0,l._)("label",go,[(0,l.Wm)(s,{icon:"users-cog",class:"me-2 text-success"}),(0,l.Uk)(" "+(0,t.zw)(e.$t("num_comensales","Número de comensales:")),1)]),(0,l._)("div",Co,[r.numpadRef&&r.numpadRef.cantidad?((0,l.wg)(),(0,l.j4)(d,{key:0,id:"comensalesInput",modelValue:r.numpadRef.cantidad,"onUpdate:modelValue":a[1]||(a[1]=e=>r.numpadRef.cantidad=e),class:"form-control border-success shadow-sm",placeholder:"Ej: 4"},null,8,["modelValue"])):(0,l.kq)("",!0)])]),(0,l._)("div",yo,[((0,l.wg)(),(0,l.j4)(c,{ref:"numpadRef",key:r.modalEncargadoMesa,disabledComa:!0}))])])),_:1}),(0,l.Wm)(p,{class:"d-flex justify-content-between bg-light rounded-bottom"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{color:"danger",onClick:a[2]||(a[2]=e=>r.closeModal()),size:"lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{icon:"times",class:"me-2"}),(0,l.Uk)(" "+(0,t.zw)(e.$t("cerrar","Cerrar")),1)])),_:1}),(0,l.Wm)(m,{color:"success",size:"lg",onClick:a[3]||(a[3]=e=>r.iniciarMesa(r.numpadRef.cantidad))},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{icon:"play",class:"me-2"}),(0,l.Uk)(" "+(0,t.zw)(e.$t("guardar","Guardar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}var wo=o(3500),Mo={name:"ModalEncargadoMesa",components:{MDBModal:y.j3,MDBModalHeader:y.ol,MDBModalTitle:y.wo,MDBModalBody:y.Yz,MDBModalFooter:y.ab,MDBBtn:y.$v,MDBInput:y.u2,NumpadComponent:wo.Z},setup(e,{expose:a}){const o=(0,g.iH)(!1),t=(0,g.iH)(null),r=(0,g.iH)(null),i=(0,g.iH)(null),n=(0,C.oR)(),s=(0,l.Fl)((()=>n.state.Trabajadores.arrayTrabajadores)),d=(0,l.Fl)((()=>n.state.Trabajadores.indexActivo)),c=(0,g.iH)(null);function u(e,a,l=null,n=null){if(r.value=e,i.value=a,l){const e=s.value.findIndex((e=>e._id===l));c.value=-1!==e?e:d.value}else c.value=d.value;n?(o.value=!0,setTimeout((()=>{t.value&&"function"===typeof t.value.setValor&&t.value.setValor(n)}),60)):o.value=!0}function m(){o.value=!1,r.value=null,i.value=null}async function p(e){try{const a=await w.Z.post("/mesas/iniciarMesa",{indexMesa:i.value,comensales:e,encargadoMesa:s.value[c.value]._id});a.data&&k().fire({title:"Mesa iniciada",icon:"success",timer:1e3})}catch(a){console.error("Error al iniciar mesa:",a),k().fire({title:"Error al iniciar mesa",text:a.response?a.response.data.message:"Error de red o del servidor",icon:"error"})}finally{m()}}return(0,l.JJ)("okValue",p),a({openModal:u,closeModal:m}),{modalEncargadoMesa:o,closeModal:m,iniciarMesa:p,numpadRef:t,trabajadorActivo:r,arrayTrabajadores:s,indiceTrabajadorActivo:c}}};const ko=(0,ee.Z)(Mo,[["render",_o],["__scopeId","data-v-42a3b8d2"]]);var ho=ko,xo={name:"MesasComponent",components:{MDBModal:y.j3,MDBModalBody:y.Yz,MDBModalFooter:y.ab,modalSeleccionarRepartidor:xe,MDBBtn:y.$v,MDBInput:y.u2,MDBIcon:y.vm,ModalCondicionalPedidoCliente:mo,MDBBadge:y.m_,MDBBtnGroup:y.Ff,CobroSeparadoMesas:oe,KeyBoardComponentVue:so.Z,ModalencargadoMesa:ho},setup(){const e=(0,g.iH)([]),a=(0,g.iH)(0),o=(0,g.iH)(null),t=(0,g.iH)(""),r=(0,g.iH)(null),i=(0,g.iH)(!1),n=(0,g.iH)(!1),s=(0,C.oR)(),d=(0,g.iH)(!1),c=(0,g.iH)(!1),u="1175028468:AAGzPS8EvKKfLcnjOZozFj493tzJ9uATxCA",m=(0,g.iH)(!1),p=(0,g.iH)(0),v=(0,g.iH)(!1),b=(0,l.Fl)((()=>s.state.Encargos.pedidos)),f=(0,g.iH)(!1),y=(0,g.iH)(null),M=(0,g.iH)(!1),h=(0,g.iH)(null);let x=(0,l.Fl)((()=>s.state.Cestas.arrayCestas));const D=(0,l.Fl)((()=>s.state.Trabajadores.arrayTrabajadores)),B=(0,l.Fl)((()=>s.state.Trabajadores.indexActivo)),z=(0,g.iH)(null),E=(0,g.iH)(!1),T=(0,g.iH)(!1),j=e=>{const a=x.value.find((a=>a._id===e));return a},P=e=>{const a=D.value.find((a=>a._id==e));return a},H=e=>{const a=D.value.find((a=>a._id==e));return a?.nombre},V=()=>{M.value=!M.value},U=async(e,a)=>{try{const o=await w.Z.post("/cestas/transferirItemsCesta",{idCestaOrigen:e.idCesta,idCestaDestino:a.idCesta});if(!o.data)throw Error("No se han podido transferir los articulos")}catch(o){k().fire("Oops...",o.message,"error")}};function S(){w.Z.post("/encargos/getPedidos").then((e=>{s.dispatch("Encargos/setPedidos",e.data)}))}const W=async e=>{let a=(await w.Z.post("trabajadores/getRepartidores")).data;a=a.filter((a=>a._id==b.value[e].idRepartidor)),k().fire({title:"¿Estás seguro?",html:"¡No podrás revertir esto!<br/>Pedido de: <b>"+b.value[e].nombreCliente,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, eliminar!",cancelButtonText:"Cancelar."}).then((async o=>{o.isConfirmed&&(a.length>0&&a[0].telegram_id&&await k().fire({title:"¿Desea avisar al repartidor?",html:"Repartidor: <b> "+a[0].nombre+"</b>",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, avisar!",cancelButtonText:"No, sin avisar."}).then((async o=>{if(o.isConfirmed){console.log(a[0]);let o=`<b>⚠️ Pedido Anulado</b>\n\nEl pedido a nombre de <b>${b.value[e].nombreCliente}</b> ha sido <b style="color: red;">cancelado</b>.\n\nPor favor, no proceses este pedido.\n\nSi tienes alguna duda, contacta con el responsable.\n\nGracias por tu atención 🙏`;await w.Z.post(`https://api.telegram.org/bot${u}/sendMessage`,{chat_id:a[0].telegram_id,text:o,parse_mode:"HTML"})}})),await w.Z.post("/encargos/anularEncargo",{id:b.value[e]._id}).then((e=>{e.data&&(k().fire("Eliminado!","El pedido ha sido eliminado.","success"),S())})))}))},N=async e=>{r.value.abrirModal(b.value[e].idCliente,{idEncargo:b.value[e]._id,total:A(b.value[e].total,2)})};function A(e,a){let o=new RegExp("\\d\\.(\\d){"+a+",}");return o.test(e)?Number(e.toFixed(a)):0===Number(e.toFixed(a))?0:e}function I(e){const a=document.querySelector("body");if(a.style.backgroundColor="#fff5e9",n.value){if(n.value=!1,!b.value[e])return;W(e)}else if(i.value){if(i.value=!1,!b.value[e])return;N(e)}else{if(!b.value[e])return y.value.abrirModal();try{if(v.value)return void R(b.value[e]);A(b.value[e].total,2);s.dispatch("Cestas/setCestaBaseAction",se);const a=b.value[e].cesta;w.Z.post("cestas/generarCestaPedido",{idEncargo:b.value[e]._id,cestaEncargo:a}).then((async a=>{if(!a.data)throw Error("No se ha podido cargar la cesta");await w.Z.post("cestas/cambiarCestaTrabajador",{idCesta:a.data,idTrabajador:D.value[B.value]._id}).then((async o=>{let t=(0,l.Fl)((()=>s.state.Cestas.arrayCestas)),r=await(0,l.Fl)((()=>{if(t.value)for(let e=0;e<t.value.length;e++)if(t.value[e]._id==a.data)return t.value[e]}));(r.value.modo="MODIFICAR PEDIDO")&&(s.dispatch("EstadoDinamico/setVistaCliente",!0),s.dispatch("Encargos/setEncargoSeleccionado",b.value[e]))})),_.Z.back()}))}catch(o){console.error(o)}}}async function $(o,l=!1){if(c.value)return void(a.value=o);if(m.value)return void Z(e.value[o]);if(v.value)return void q(e.value[o]);if(s.dispatch("Cestas/deleteCestaHonei",o),f.value){const l=await k().fire({icon:"question",title:`¿Quieres transferir los articulos de ${e.value[a.value].nombre} a ${e.value[o].nombre}?`,showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"});if(!l.isConfirmed)return;await U(e.value[a.value],e.value[o])}if(M.value)return void h.value.abrirModal(j(e.value[o].idCesta));let t=null;if(l||(t=j(e.value[o].idCesta)),""!==o&&!t?.encargadoMesa&&T.value&&e.value[o].idCesta&&!l&&E?.value&&"function"===typeof E.value.openModal){const e=P(D.value[B.value]._id);E.value.openModal(e,o)}else{if(l)ie(se);else{if(!e.value[o].idCesta)return;ie(e.value[o].idCesta)}_.Z.back()}}function F(){if(E?.value&&"function"===typeof E.value.openModal){const o=P(D.value[B.value]._id),l=j(e.value[a.value]?.idCesta),t=l?.encargadoMesa||null,r=l?.comensales||null;E.value.openModal(o,a.value,t,r)}}const R=e=>{if(!e?.cesta?.lista.length)return k().fire("Oops...","Añade productos para imprimir un pedido. No se puede imprimir","error"),void(v.value=!1);const a=D.value[B.value]._id;w.Z.post("cestas/imprimirNotaPedido",{idEncargo:e._id,idTrabajador:a,cesta:e.cesta,codigo:e._id.slice(-4)}).then((e=>{if(!e.data)throw Error("No se ha podido imprimir la cesta")})).catch((e=>{k().fire("Oops...",e.message,"error")}))},Z=e=>{if(!e.idCesta)return k().fire("Oops...","Mesa inactiva. No se puede imprimir","error");const a=D.value[B.value].nombreCorto;w.Z.post("cestas/imprimirNotaKitchen",{idCesta:e.idCesta,nombre:e.nombre,trabajador:a}).then((e=>{if(!e.data)throw new Error("No hay productos a imprimir")})).catch((e=>{k().fire("Oops...",e.message,"error")}))},q=e=>{if(!e.idCesta)return k().fire("Oops...","Mesa inactiva. No se puede imprimir","error");const a=D.value[B.value]._id;w.Z.post("cestas/imprimirNotaMesa",{idCesta:e.idCesta,idTrabajador:a}).then((e=>{if(!e.data)throw Error("No se ha podido imprimir la cesta")})).catch((e=>{k().fire("Oops...",e.message,"error")}))},K=()=>{f.value=!0,Y()},O=document.querySelector("body");O.style.backgroundColor=c.value?"#FFFF00":"#fff5e9";const Y=()=>{c.value=!c.value,O.style.backgroundColor=c.value?"#FFFF00":"#fff5e9"},J=()=>{m.value=!m.value,O.style.backgroundColor=m.value?"#FFFF00":"#fff5e9"},G=()=>{v.value=!v.value,O.style.backgroundColor=v.value?"#FFFF00":"#fff5e9"},L=()=>{O.style.backgroundColor=n.value?"#bf5c18":i.value?"#e9fcff":"#fff5e9"};async function Q(a){try{const o=(await w.Z.post("cestas/onlyCrearCestaParaMesa",{indexMesa:a})).data;if(!o)throw Error("No se ha podido crear la cesta para la nueva mesa");e.value[a].idCesta=o,le()}catch(o){k().fire("Oops...",o.message,"error")}}function X(){e.value&&null!=a.value&&void 0!=a.value&&e.value[a.value]&&(e.value[a.value]={nombre:"Mesa "+(a.value+1)},Q(a.value))}function ee(){e.value&&null!=a.value&&void 0!=a.value&&e.value[a.value]&&(w.Z.post("cestas/fulminarCesta",{idCesta:e.value[a.value].idCesta}).then((e=>{if(!e.data)throw Error("No se ha podido eliminar la cesta de la mesa")})).catch((e=>{k().fire("Oops...",e.message,"error")})),e.value[a.value]={nombre:null,idCesta:null},le())}function ae(){e.value&&null!=a.value&&void 0!=a.value&&e.value[a.value]&&(e.value[a.value].nombre=t.value,le(),oe())}function oe(){o.value=!1,t.value=""}function le(){w.Z.post("mesas/guardarCambios",{arrayMesas:e.value}).then((e=>{if(!e.data)throw Error("No se han podido guardar los cambios")})).catch((e=>{k().fire("Oops...",e.message,"error")}))}const te=e=>{if(null===e||void 0===e)return!1;const a=j(e);return a?.lista?.length>0},re=(0,l.f3)("volver"),ie=(0,l.f3)("seleccionar"),ne=(0,l.f3)("cestaSeleccionada"),se=(0,l.f3)("cestaParticular"),de=((0,l.f3)("PagarSeparado"),s.getters["Cestas/getCestasHonei"]);let ce;async function ue(){try{z.value.abrirModal(t.value),ce=setInterval((()=>{t.value=z.value.getValue()[0],z.value.getValue()[1]||clearInterval(ce)}),100)}catch(e){console.log(e),ce=void 0}}return(0,l.bv)((async()=>{S();const{data:o}=await w.Z.post("parametros/getParametros");d.value="Si"==o.params.PedidosTelegram,T.value="Si"==o?.params?.encargadoMesa,w.Z.get("mesas/getMesas").then((o=>{if(!o.data||50!==o.data.length)throw Error("Error al obtener la configuración de mesas");e.value=o.data,a.value=e.value.find((e=>e.idCesta==ne.value))?._id??0})).catch((e=>{k().fire("Oops...",e.message,"error")}))})),{arrayMesas:e,indexMesaActiva:a,handleClick:$,volver:re,activarMesa:X,desactivarMesa:ee,cambiarNombre:ae,modalNombreMesa:o,inputNombre:t,modoEdicion:c,toggleEdicion:Y,cestaSeleccionada:ne,getCestaById:j,openPedido:I,ModalCondicionalPedidoClienteRef:y,activeMenu:p,modalSeleccionarRepartidor:r,getNombreTrabajadorById:H,activarModosPedido:L,toggleModotransferir:K,tieneCosas:te,enviarRepartidor:i,eliminarPedido:n,pagarPorSeparado:V,pagarNoJunto:M,arrayEncargos:b,CobroSeparadoRef:h,cestasHonei:de,ImprimirKitchen:m,toggleImprimirKitchen:J,modoImprimir:v,PedidosTelegram:d,toggleImprimir:G,openKeyboard:ue,keyboardRef:z,cerrarModalNombreMesa:oe,encargadoMesa:T,ModalencargadoMesaRef:E,encargadoMesa:T,openModalEncargadoMesa:F}}};const Do=(0,ee.Z)(xo,[["render",W],["__scopeId","data-v-f817767e"]]);var Bo=Do,zo={name:"CestasView",components:{MDBCard:y.Yl,MDBCardBody:y.H7,MDBCardTitle:y.QM,MDBCardText:y.Pp,MDBBadge:y.m_,MDBBtn:y.$v,MesasComponent:Bo,CobroSeparadoMesas:oe},setup(){const e=(0,C.oR)(),a=(0,g.iH)(!0),o=(0,g.iH)(null);(0,l.Fl)((()=>e.state.Configuracion.parametros));let t=(0,l.Fl)((()=>e.state.Cestas.arrayCestas));const r=(0,g.iH)([]),i=(0,g.iH)({}),n=(0,l.Fl)((()=>e.state.Trabajadores.arrayTrabajadores)),s=(0,l.Fl)((()=>e.state.Trabajadores.indexActivo)),d=(0,g.iH)(null),c=(0,g.iH)(!1);function u(){const e=document.querySelector("body");e.style.backgroundColor="#fff5e9",_.Z.back()}function m(e){n.value&&void 0!=s.value&&null!=s.value&&n.value[s.value]&&null!=e.indexMesa&&o.value.abrirModal(e)}function p(e){let a="undefined";for(let o=0;o<n.value.length;o++)n.value[o].idTrabajador==e&&(a=n.value[o].nombre);return a}function v(e){const a=e.detalleIva,o=Object.keys(a).filter((e=>e.startsWith("importe"))).reduce(((e,o)=>e+a[o]),0);return Math.round(100*o)/100}const b=(0,l.Fl)((()=>{const e=t.value.length;let a=Math.trunc(e/4);return e%4>0&&(a+=1),a}));function f(){void 0!=s.value&&null!=s.value&&n.value&&w.Z.post("cestas/crearCesta",{idTrabajador:n.value[s.value]._id}).then((e=>{if(!e.data)throw Error("No se ha podido crear una nueva cesta, ¡Comprueba que no tengas una ya!")})).catch((e=>{k().fire("Oops...",e.message,"error")}))}function y(){if(d.value){for(let e=0;e<t.value.length;e++)if(t.value[e]._id===d.value&&null!=t.value[e].indexMesa&&void 0!=t.value[e].indexMesa)return k().fire("Oops...","No puedes eliminar una cesta de tipo MESA","error"),!1;w.Z.post("cestas/fulminarCesta",{idCesta:d.value}).then((e=>{if(!e.data)throw Error("No se ha podido borrar la cesta")})).catch((e=>{k().fire("Oops...",e.message,"error")}))}}function M(e){n.value&&void 0!=s.value&&null!=s.value&&n.value[s.value]?(d.value=e,w.Z.post("cestas/cambiarCestaTrabajador",{idCesta:e,idTrabajador:n.value[s.value]._id})):k().fire("Oops...","Error, no se ha podido seleccionar la cesta para el trabajador","error")}function h(){w.Z.get("mesas/getMesas").then((e=>{if(!e.data||50!==e.data.length)throw Error("Error al obtener la configuración de mesas");r.value=e.data})).catch((e=>{k().fire("Oops...",e.message,"error")}))}let x;return t.value.forEach((e=>{e.trabajador===n.value[s.value]._id&&"DEVOLUCION"!=e.modo&&(x=e._id)})),(0,l.JJ)("volver",u),(0,l.JJ)("seleccionar",M),(0,l.JJ)("cestaSeleccionada",d),(0,l.JJ)("cestaParticular",x),(0,l.JJ)("PagarSeparado",m),(0,l.bv)((()=>{if(n.value.forEach((e=>{let a=e.idTrabajador,o=e.nombre;i.value[a]=o})),null==s.value)return k().fire("Oops...","Debes fichar para usar las cestas","error");d.value=n.value[s.value].idCesta,h(),w.Z.post("parametros/getParametros").then((e=>{void 0!=e.data?.params?.mesas?"Si"==e.data?.params?.mesas&&(c.value=!0):c.value=!1}))})),{vistaMesas:a,PagarSeparado:m,arrayCestas:t,arrayTrabajadores:n,indexActivoTrabajador:s,volver:u,getTotal:v,seleccionar:M,totalRows:b,nuevaCesta:f,borrarCesta:y,arrayMesas:r,idCestaSeleccionada:d,SiMesas:c,arrayTrabajadoresID:i,CobroSeparadoRef:o,getNombreByID:p}}};const Eo=(0,ee.Z)(zo,[["render",f],["__scopeId","data-v-7f01a565"]]);var To=Eo}}]);
//# sourceMappingURL=370.2377caf8.js.map