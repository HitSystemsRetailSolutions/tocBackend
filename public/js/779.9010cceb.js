"use strict";(self["webpackChunktoc_game_v4"]=self["webpackChunktoc_game_v4"]||[]).push([[779],{18763:function(a,e,l){l.d(e,{Z:function(){return c}});var o=l(73396),t=l(87139);const i={class:"input-group position-absolute bottom-0 start-0"};function r(a,e,l,r,s,n){return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("button",{onClick:e[0]||(e[0]=a=>r.volver()),class:"btn btn-warning ms-2",style:{"font-size":"27px","margin-bottom":"0.5rem"}},(0,t.zw)(a.$t("volver","VOLVER")),1)])}var s=l(6411),n={name:"VolverComponent",setup(){function a(){s.Z.back()}return{volver:a}}},u=l(40089);const d=(0,u.Z)(n,[["render",r]]);var c=d},66720:function(a,e,l){l.d(e,{Z:function(){return v}});var o=l(73396),t=l(44870),i=l(87139),r=l(74313),s=l(16683);const n={style:{display:"grid","grid-template-columns":"repeat(4,1fr)","grid-template-rows":"repeat(4,1fr)"}};var u={__name:"CashlogyTecladoNumerico",props:{tipo_importe:Boolean},emits:["click-key"],setup(a,{emit:e}){const l=a;let u=(0,s.vg)(1.23).charAt(1);const d=[[7,8,9,{value:"C",style:"grid-row:1/5;grid-column:4"}],[4,5,6],[1,2,3],[{value:0,style:"grid-row:4;grid-column:1/4"}]],c=[[7,8,9,{value:"C",style:"grid-row:1/5;grid-column:4"}],[4,5,6],[1,2,3],[{value:0,style:"grid-row:4;grid-column:1/3"},u]];function v(a){e("click-key",a)}return(a,e)=>((0,o.wg)(),(0,o.iD)("div",n,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.tipo_importe?c:d,(a=>((0,o.wg)(),(0,o.iD)(o.HY,null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a,(a=>((0,o.wg)(),(0,o.j4)((0,t.SU)(r.$v),{onClick:()=>v("object"==typeof a?a.value:a),style:(0,i.j5)(["object"==typeof a?a.style:"",{margin:"1px"}]),color:"info",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)("object"==typeof a?a.value:a),1)])),_:2},1032,["onClick","style"])))),256))],64)))),256))]))}},d=l(40089);const c=(0,d.Z)(u,[["__scopeId","data-v-1845037f"]]);var v=c},79066:function(a,e,l){l.d(e,{Z:function(){return h}});var o=l(73396),t=l(87139);const i={class:"row mt-2"},r={class:"col-md-3"},s={key:0,class:"sizeLetrasCambio"},n={class:"sizeLetrasCambio"},u={key:1,class:"estiloFalta sizeLetrasCambio"},d={key:2,class:"estiloPerfecto sizeLetrasCambio"},c={key:3,class:"estiloSobra sizeLetrasCambio"},v={class:"col-md-9"},m={class:"row"},p={class:"col text-end"},g={class:"row mt-2"},_={class:"col text-end"};function f(a,e,l,f,C,w){const b=(0,o.up)("MDBCardTitle"),k=(0,o.up)("MDBCardText"),y=(0,o.up)("MDBBtn"),h=(0,o.up)("MDBCardBody"),D=(0,o.up)("MDBCard");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",r,[(0,o.Wm)(D,{class:"cardInfoCambio"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("informacion_cambio","Información cambio")),1)])),_:1}),(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[null!=f.cantidadTkrs&&void 0!=f.cantidadTkrs?((0,o.wg)(),(0,o.iD)("li",s,(0,t.zw)(a.$t("dinero_recibido","Dinero recibido:"))+" "+(0,t.zw)(Number(f.totalRecibido+f.cantidadTkrs).toFixed(2))+" € ",1)):(0,o.kq)("",!0),(0,o._)("li",n,(0,t.zw)(a.$t("dinero_a_pagar","Dinero a pagar:"))+" "+(0,t.zw)((Math.round(100*f.aPagar)/100).toFixed(2))+" € ",1),null!=f.cuenta&&void 0!=f.cuenta&&f.cuenta>0?((0,o.wg)(),(0,o.iD)("li",u,(0,t.zw)(a.$t("faltan","Faltan"))+" "+(0,t.zw)((Math.round(100*f.cuenta)/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0),null!=f.cuenta&&void 0!=f.cuenta&&0==f.cuenta?((0,o.wg)(),(0,o.iD)("li",d,(0,t.zw)(a.$t("cambio_perfecto","Cambio perfecto")),1)):(0,o.kq)("",!0),null!=f.cuenta&&void 0!=f.cuenta&&f.cuenta<0?((0,o.wg)(),(0,o.iD)("li",c,(0,t.zw)(a.$t("sobran","Sobran"))+" "+(0,t.zw)((Math.round(100*(f.aPagar-f.totalRecibido))/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(y,{size:"lg",color:"warning",onClick:e[0]||(e[0]=a=>f.deshacer()),class:"sizeBotones"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("desahcer","Deshacer")),1)])),_:1}),(0,o.Wm)(y,{size:"lg",color:"danger",class:"sizeBotones",onClick:e[1]||(e[1]=a=>f.limpiar())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("limpiar","Limpiar")),1)])),_:1})])),_:1})])),_:1})]),(0,o._)("div",v,[(0,o._)("div",m,[(0,o._)("div",p,[(0,o._)("img",{src:"/img/1cts.png",class:"sizeMonedas",onClick:e[2]||(e[2]=a=>f.sumar(.01))}),(0,o._)("img",{src:"/img/2cts.png",class:"sizeMonedas",onClick:e[3]||(e[3]=a=>f.sumar(.02))}),(0,o._)("img",{src:"/img/5cts.png",class:"sizeMonedas",onClick:e[4]||(e[4]=a=>f.sumar(.05))}),(0,o._)("img",{src:"/img/10cts.png",class:"sizeMonedas",onClick:e[5]||(e[5]=a=>f.sumar(.1))}),(0,o._)("img",{src:"/img/20cts.png",class:"sizeMonedas",onClick:e[6]||(e[6]=a=>f.sumar(.2))}),(0,o._)("img",{src:"/img/50cts.png",class:"sizeMonedas",onClick:e[7]||(e[7]=a=>f.sumar(.5))}),(0,o._)("img",{src:"/img/uneuro.png",class:"sizeMonedas",onClick:e[8]||(e[8]=a=>f.sumar(1))}),(0,o._)("img",{src:"/img/doseuros.png",class:"sizeMonedas",onClick:e[9]||(e[9]=a=>f.sumar(2))})])]),(0,o._)("div",g,[(0,o._)("div",_,[(0,o._)("img",{src:"/img/5euros.png",class:"sizeBilletes",onClick:e[10]||(e[10]=a=>f.sumar(5))}),(0,o._)("img",{src:"/img/10euros.png",class:"sizeBilletes",onClick:e[11]||(e[11]=a=>f.sumar(10))}),(0,o._)("img",{src:"/img/20euros.png",class:"sizeBilletes",onClick:e[12]||(e[12]=a=>f.sumar(20))}),(0,o._)("img",{src:"/img/50euros.png",class:"sizeBilletes",onClick:e[13]||(e[13]=a=>f.sumar(50))}),(0,o._)("img",{src:"/img/100euros.png",class:"sizeBilletes",onClick:e[14]||(e[14]=a=>f.sumar(100))}),(0,o._)("img",{src:"/img/200euros.png",class:"sizeBilletes",onClick:e[15]||(e[15]=a=>f.sumar(200))}),(0,o._)("img",{src:"/img/500euros.png",class:"sizeBilletes",onClick:e[16]||(e[16]=a=>f.sumar(500))})])])])])}l(57658);var C=l(44870),w=l(74313),b={name:"CambioComponent",components:{MDBCard:w.Yl,MDBCardBody:w.H7,MDBCardTitle:w.QM,MDBCardText:w.Pp,MDBBtn:w.$v},setup(a,{expose:e}){const l=(0,C.iH)(0),t=(0,o.f3)("total"),i=(0,C.iH)(t),r=(0,C.iH)([]),s=(0,C.iH)(0),n=(0,o.Fl)((()=>i.value-s.value<0?0:i.value-(l.value+s.value)));function u(a){l.value+=a,r.value.push(a)}function d(){r.value.pop();let a=0;r.value.forEach((e=>{a+=e})),l.value=a}function c(){l.value=0,r.value=[]}function v(a){s.value=Number(a)}return e({setTkrs:v}),{sumar:u,totalRecibido:l,aPagar:i,deshacer:d,limpiar:c,cantidadTkrs:s,cuenta:n}}},k=l(40089);const y=(0,k.Z)(b,[["render",f],["__scopeId","data-v-0e9fd9d8"]]);var h=y},29665:function(a,e,l){l.d(e,{Z:function(){return g}});var o=l(73396),t=l(87139);const i={key:0,class:"cantidad text-center"},r={class:"row mt-2"},s={class:"col text-center"};function n(a,e,l,n,u,d){const c=(0,o.up)("MDBModalTitle"),v=(0,o.up)("MDBModalHeader"),m=(0,o.up)("NumpadComponent"),p=(0,o.up)("MDBModalBody"),g=(0,o.up)("MDBBtn"),_=(0,o.up)("MDBModalFooter"),f=(0,o.up)("MDBModal");return(0,o.wg)(),(0,o.j4)(f,{id:"modalTkrs",tabindex:"-1",labelledby:"modalTkrsLabel",modelValue:n.modalTkrs,"onUpdate:modelValue":e[1]||(e[1]=a=>n.modalTkrs=a)},{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{id:"modalTkrsLabel"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("introduce_la_cantidad_del_tiquet_restaurante","Introduce la cantidad del tiquet restaurante")),1)])),_:1})])),_:1}),(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,t.C_)(["row",{shake:n.activarShake}])},[n.numPadRef?((0,o.wg)(),(0,o.iD)("span",i,(0,t.zw)(n.numPadRef.cantidad),1)):(0,o.kq)("",!0)],2),(0,o._)("div",r,[(0,o._)("div",s,[(0,o.Wm)(m,{max3EntersDigits:!0,onActivarShake:n.handleShake,ref:"numPadRef"},null,8,["onActivarShake"])])])])),_:1}),(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o.Wm)(g,{color:"danger",size:"lg",onClick:e[0]||(e[0]=a=>n.modalTkrs=!1)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("cerrar","Cerrar")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}var u=l(74313),d=l(33727),c=l(44870),v={name:"ModalTkrsComponent",components:{MDBModal:u.j3,MDBModalHeader:u.ol,MDBModalTitle:u.wo,MDBModalBody:u.Yz,MDBModalFooter:u.ab,MDBBtn:u.$v,NumpadComponent:d.Z},setup(a,{expose:e}){const l=(0,c.iH)(!1),t=(0,c.iH)(null),i=(0,o.f3)("setTkrs"),r=(0,c.iH)(!1);function s(){l.value=!0}function n(){l.value=!1,i(t.value.cantidad)}function u(){r.value=!0,setTimeout((()=>{r.value=!1}),500)}return(0,o.JJ)("okValue",n),e({abrirModal:s}),{modalTkrs:l,numPadRef:t,okValue:n,activarShake:r,handleShake:u}}},m=l(40089);const p=(0,m.Z)(v,[["render",n],["__scopeId","data-v-36c7c8c6"]]);var g=p},24779:function(a,e,l){l.d(e,{Z:function(){return Qa}});var o=l(73396),t=l(87139);const i=a=>((0,o.dD)("data-v-4e227e65"),a=a(),(0,o.Cn)(),a),r={class:"row"},s={class:"row mt-2"},n={class:"col-md-3"},u={class:"text-center"},d={class:"mt-4"},c={id:"detalleTicket"},v={class:"contencionTicket"},m={class:"table"},p={class:"titulosTicket"},g={class:"titulosTicket"},_={class:"titulosTicket"},f=i((()=>(0,o._)("hr",null,null,-1))),C={class:"sizeLetrasCambio"},w={key:0,class:"sizeLetrasCambio"},b={key:1,class:"estiloParcial sizeLetrasCambio"},k={key:2,class:"estiloFalta sizeLetrasCambio"},y={key:3,class:"estiloPerfecto sizeLetrasCambio"},h={key:4,class:"estiloSobra sizeLetrasCambio"},D={key:5,class:"estiloSobra sizeLetrasCambio"},T={key:6,class:"estiloPendiente sizeLetrasCambio"},A={class:"col-md-9",style:{"padding-left":"4vmin"}},z={class:"row"},E={class:"col text-end",style:{"margin-top":"2vmin"}},M=["src","onClick"],R={class:"row mt-2"},B={class:"col text-end",style:{"margin-top":"2vmin"}},O=["src","onClick"],P={class:"row"},x={class:"col mt-4"},I={class:"divBotones"},j=["disabled"],S=["disabled"],F=["disabled"],N=["disabled"],U={class:"row"},Z={class:"cantidad text-center"},V={class:"row mt-2"},H={class:"col text-center"},L={key:0,class:"estadoPaytef"},$=i((()=>(0,o._)("h3",null,"Estado:",-1))),W={style:{"margin-top":"1vm","font-weight":"300",color:"orangered","font-size":"1.3em"}},q={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function G(a,e,l,i,G,J){const Y=(0,o.up)("MDBCardTitle"),K=(0,o.up)("MDBCardText"),Q=(0,o.up)("MDBBtn"),X=(0,o.up)("MDBCardBody"),aa=(0,o.up)("MDBCard"),ea=(0,o.up)("ModalTkrsComponent"),la=(0,o.up)("NumpadComponent"),oa=(0,o.up)("MDBModalBody"),ta=(0,o.up)("MDBModal"),ia=(0,o.up)("MDBIcon"),ra=(0,o.up)("CashlogyCobroView");return(0,o.wg)(),(0,o.j4)(ta,{id:"modalCobro",tabindex:"-1",labelledby:"modalCobro",modelValue:i.modalCobro,"onUpdate:modelValue":e[9]||(e[9]=a=>i.modalCobro=a),staticBackdrop:!0,animation:!1,fullscreen:""},{default:(0,o.w5)((()=>[(0,o.Wm)(oa,{style:{"background-color":"#fff5e9"}},{default:(0,o.w5)((()=>[(0,o._)("div",r,[(0,o._)("div",s,[(0,o._)("div",n,[(0,o.Wm)(aa,{class:"cardInfoCambio",style:{height:"80vmin"}},{default:(0,o.w5)((()=>[(0,o.Wm)(X,{style:{display:"flex","flex-direction":"column","justify-content":"space-evenly"}},{default:(0,o.w5)((()=>[(0,o.Wm)(Y,null,{default:(0,o.w5)((()=>[(0,o._)("h2",u,(0,t.zw)(a.$t("ticket","Ticket"))+":",1)])),_:1}),(0,o._)("div",d,[(0,o._)("div",c,[(0,o._)("div",v,[(0,o._)("table",m,[(0,o._)("tr",null,[(0,o._)("th",p,(0,t.zw)(a.$t("producto","Producto")),1),(0,o._)("th",g,(0,t.zw)(a.$t("subtotal","Subtotal")),1),(0,o._)("th",_,(0,t.zw)(a.$t("unidades","Unidades")),1)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.productos,((a,e)=>((0,o.wg)(),(0,o.iD)("tr",{key:e,style:(0,t.j5)(a.pagado?"text-decoration: line-through":"")},[(0,o._)("td",null,(0,t.zw)(a.nombre),1),(0,o._)("td",null,(0,t.zw)((a.subtotal-a.subtotal*i.DescuentoCliente).toFixed(2))+" € ",1),(0,o._)("td",null,(0,t.zw)(a.unidades),1)],4)))),128))])]),f])]),(0,o.Wm)(K,null,{default:(0,o.w5)((()=>[(0,o._)("li",C,(0,t.zw)(a.$t("dinero_a_pagar","Dinero a pagar:"))+" "+(0,t.zw)((Math.round(100*i.aPagar)/100).toFixed(2))+" € ",1),null!=i.cantidadTkrs&&void 0!=i.cantidadTkrs?((0,o.wg)(),(0,o.iD)("li",w,(0,t.zw)(a.$t("dinero_recibido","Dinero recibido:"))+" "+(0,t.zw)(Number(i.totalRecibido+i.cantidadTkrs+i.dejaCuenta).toFixed(2))+" € ",1)):(0,o.kq)("",!0),i.deudasSeleccionadas.length>0&&i.montoDeuda>0?((0,o.wg)(),(0,o.iD)("li",b,(0,t.zw)(a.$t("pago_parcial","Pago parcial"))+": "+(0,t.zw)(i.montoDeuda)+"€ ",1)):(0,o.kq)("",!0),null!=i.cuenta&&void 0!=i.cuenta&&i.cuenta>0?((0,o.wg)(),(0,o.iD)("li",k,(0,t.zw)(a.$t("faltan","Faltan"))+" "+(0,t.zw)((Math.round(100*i.cuenta)/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0),null!=i.cuenta&&void 0!=i.cuenta&&0==i.cuenta?((0,o.wg)(),(0,o.iD)("li",y,(0,t.zw)(a.$t("cambio_perfecto","Cambio perfecto")),1)):(0,o.kq)("",!0),null!=i.cuenta&&void 0!=i.cuenta&&i.cuenta<0&&!(i.deudasSeleccionadas.length>0&&i.montoDeuda>0)?((0,o.wg)(),(0,o.iD)("li",h,(0,t.zw)(a.$t("sobran","Sobran"))+" "+(0,t.zw)((Math.round(100*(i.aPagar-i.totalRecibido))/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0),null!=i.cuenta&&void 0!=i.cuenta&&i.cuenta<0&&i.deudasSeleccionadas.length>0&&i.montoDeuda>0?((0,o.wg)(),(0,o.iD)("li",D,(0,t.zw)(a.$t("sobran","Sobran"))+" "+(0,t.zw)((Math.round(100*(i.montoDeuda-i.totalRecibido))/100).toFixed(2))+" € ",1)):(0,o.kq)("",!0),i.deudasSeleccionadas.length>0&&i.montoDeuda>0?((0,o.wg)(),(0,o.iD)("li",T,(0,t.zw)(a.$t("saldo_pendiente","Saldo pendiente"))+": "+(0,t.zw)((Math.round(100*(i.aPagar-i.montoDeuda-i.dejaCuenta))/100).toFixed(2))+"€ ",1)):(0,o.kq)("",!0)])),_:1}),(0,o._)("div",null,[(0,o.Wm)(Q,{size:"lg",color:"warning",onClick:e[0]||(e[0]=a=>i.deshacer()),class:"sizeBotones"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("desahcer","Deshacer")),1)])),_:1}),(0,o.Wm)(Q,{size:"lg",color:"danger",class:"sizeBotones",onClick:e[1]||(e[1]=a=>i.limpiar())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(a.$t("limpiar","Limpiar")),1)])),_:1})])])),_:1})])),_:1})]),(0,o._)("div",A,[(0,o._)("div",z,[(0,o._)("div",E,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)([.01,.02,.05,.1,.2,.5,1,2],(a=>(0,o._)("img",{src:"/img/"+(a<1?100*a+"cts":1==a?"uneuro":"doseuros")+".png",class:"sizeMonedas",onClick:e=>i.sumar(a)},null,8,M))),64))])]),(0,o._)("div",R,[(0,o._)("div",B,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)([5,10,20,50,100,200,500],(a=>(0,o._)("img",{src:"/img/"+a+"euros.png",class:"sizeBilletes",onClick:e=>i.sumar(a)},null,8,O))),64))])]),(0,o._)("div",P,[(0,o._)("div",x,[(0,o._)("div",I,[(0,o._)("img",{disabled:i.loading,src:"img/img-efectivo.png",onClick:e[2]||(e[2]=a=>i.setFormaPago("EFECTIVO")),style:(0,t.j5)("EFECTIVO"===i.formaPago?"zoom: 1.3;":"filter: grayscale(1);"),width:"300",alt:"Seleccionar pago con EFECTIVO"},null,12,j),i.modalTkrsRef&&!i.prohibirTkRestaurant?((0,o.wg)(),(0,o.iD)("img",{key:0,disabled:i.loading,src:"img/img-tkrs.png",onClick:e[3]||(e[3]=a=>i.loading?null:i.modalTkrsRef.abrirModal()),style:(0,t.j5)("TKRS"===i.formaPago?"zoom: 1.3;":"filter: grayscale(1);"),width:"300",alt:"Seleccionar pago con ticket restaurante"},null,12,S)):(0,o.kq)("",!0),0===i.tipoDatafono3G?((0,o.wg)(),(0,o.iD)("img",{key:1,disabled:i.loading,src:"img/img-tarjetas.png",onClick:e[4]||(e[4]=a=>i.setFormaPago("TARJETA")),style:(0,t.j5)("TARJETA"===i.formaPago?"zoom: 1.3;":"filter: grayscale(1);"),width:"300",alt:"Seleccionar pago con TARJETA"},null,12,F)):(0,o.kq)("",!0),1===i.tipoDatafono3G?((0,o.wg)(),(0,o.iD)("img",{key:2,disabled:i.loading,src:"img/img-3g.png",onClick:e[5]||(e[5]=a=>i.setFormaPago("DATAFONO_3G")),style:(0,t.j5)("DATAFONO_3G"===i.formaPago?"zoom: 1.3;":"filter: grayscale(1);"),width:"300",alt:"Seleccionar pago con DATAFONO 3G"},null,12,N)):(0,o.kq)("",!0)])])])])])]),(0,o.Wm)(ea,{ref:"modalTkrsRef"},null,512),(0,o.Wm)(ta,{id:"modalNumpad",tabindex:"-1",labelledby:"modalTkrsLabel",modelValue:i.modalNumpad,"onUpdate:modelValue":e[6]||(e[6]=a=>i.modalNumpad=a)},{default:(0,o.w5)((()=>[(0,o.Wm)(oa,null,{default:(0,o.w5)((()=>[(0,o._)("div",U,[(0,o._)("span",Z,(0,t.zw)(),1)]),(0,o._)("div",V,[(0,o._)("div",H,[(0,o.Wm)(la,{ref:"numPadRef"},null,512)])])])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(Q,{class:"ms-2 botoncicos-abajo volver",disabled:i.loading,color:"warning",onClick:e[7]||(e[7]=a=>i.cancelarVenta())},{default:(0,o.w5)((()=>[(0,o.Wm)(ia,{icon:"arrow-left"})])),_:1},8,["disabled"]),i.loading?((0,o.wg)(),(0,o.iD)("div",L,[(0,o._)("div",null,[$,(0,o._)("span",W,(0,t.zw)(i.procesoDatafono),1)])])):(0,o.kq)("",!0),(0,o.Wm)(Q,{class:"botonCobrar botoncicos-abajo",color:"primary",disabled:i.loading,onClick:e[8]||(e[8]=a=>i.cobrar()),style:{right:"4vmin"}},{default:(0,o.w5)((()=>[i.loading?((0,o.wg)(),(0,o.iD)("span",q)):(0,o.kq)("",!0),(0,o.Uk)(" "+(0,t.zw)(a.$t("pagar","Pagar")),1)])),_:1},8,["disabled"]),(0,o.Wm)(ra,{ref:"CashlogyCobroViewRef"},null,512)])),_:1})])),_:1},8,["modelValue"])}l(57658);var J=l(44870),Y=l(79066),K=l(18763),Q=l(29665),X=l(42492),aa=l.n(X),ea=l(33727),la=l(49242),oa=l(74313),ta=l(92136),ia=l(12195),ra=l(74025),sa=l(66720),na=l(68315),ua=l(13150),da=l(16683),ca=l(34730),va=l(88807);const ma=a=>((0,o.dD)("data-v-98d6db00"),a=a(),(0,o.Cn)(),a),pa={key:0,class:"w-100 h-100"},ga={key:0,class:"d-flex flex-column w-100 h-100",style:{"justify-content":"start"}},_a=["src","onClick"],fa=["src","onClick"],Ca={class:"frame-Cashlogy",style:{flex:"1 1 auto"}},wa={class:"col-9 h-100"},ba={class:"frame-Cashlogy flex-column",style:{"justify-content":"start"}},ka={style:{"text-align":"start","padding-top":"4rem"}},ya=ma((()=>(0,o._)("br",null,null,-1))),ha={key:0},Da={key:1},Ta={key:2},Aa={class:"col h-100"},za={class:"frame-Cashlogy flex-column"},Ea=ma((()=>(0,o._)("label",null,"Importe entrada manual",-1))),Ma=ma((()=>(0,o._)("br",null,null,-1))),Ra={key:0,style:{flex:"0 0 20%"},class:"items-Cashlogy"},Ba={key:1,style:{flex:"0 0 20%"},class:"items-Cashlogy"},Oa={key:1,class:"frame-Cashlogy flex-column"},Pa=ma((()=>(0,o._)("br",null,null,-1))),xa={key:2,class:"frame-Cashlogy flex-column"},Ia=ma((()=>(0,o._)("br",null,null,-1))),ja={key:1,class:"frame-Cashlogy flex-column"},Sa={class:"d-flex flex-column",style:{gap:"2px"}},Fa=ma((()=>(0,o._)("span",null,"Falta cambios para la devolución",-1))),Na={key:2,class:"frame-Cashlogy flex-column"},Ua={class:"d-flex flex-column",style:{gap:"2px"}},Za={key:3,class:"frame-Cashlogy flex-column"},Va=ma((()=>(0,o._)("br",null,null,-1)));var Ha={__name:"CashlogyCobroView",setup(a,{expose:e}){const l=(0,J.iH)(null),i=(0,J.iH)(null),r=(0,J.iH)(""),s=(0,J.iH)(""),n=(0,J.iH)(""),u=(0,J.iH)(""),d=(0,J.iH)(""),c=(0,J.iH)(""),v=(0,J.iH)(!1),m=(0,J.iH)(!1),p=(0,J.iH)(!1),g=((0,J.iH)(!1),(0,J.iH)(!1)),_=(0,J.iH)("Dispensando");function f(a){return a?"CANCELAR MANUALMENTE":"DEVOLUCIÓN MANUAL"}async function C(){return ua.Z.activado()}const w=(0,J.iH)({});function b(){m.value=!0,ua.Z.boton_pulsar("BOT_CANCELAR")}const k=(0,J.iH)(!1);function y(){k.value=!0,D.value=(0,da.vg)(T)}function h(a){T=(0,da.ul)((0,da.XX)(E())+a),D.value=(0,da.vg)(T)}const D=(0,J.iH)("");let T=0,A=(0,da.vg)(1.23).charAt(1),z=2;function E(){if(!D.value)return 0;let a=D.value,[e,l]=a.split(A);e||(e="0"),l||(l="0");while(l.length<z)l+="0";let o=100*parseInt(e,10)+parseInt(l,10);return o/100}function M(a){let e=D.value,[l,o]=e.split(A);if("number"==typeof a){if(null!=o){if(o.length>=z)return}else if(l.length>=8)return;"0"==e&&(e=""),e+=a.toString(),D.value=e}else if("C"==a)e="",D.value=e;else if(a==A){if(null!=o)return;""==e&&(e="0"),e+=a,D.value=e}T=E()}function R(){k.value=!1,T=E(),ua.Z.importe_entrado_manualmente_en_cobrar(T)}function B(){k.value=!1}const O=(0,J.iH)(""),P=new da.JQ((a=>{n.value=(0,da.vg)(a.importe_falta_devolver,!0),g.value=a.opcion_cancelar,O.value=f(a.cancelando),j.value="PANTALLA_FALTA_CAMBIO_DEVOLUCION"}));function x(){p.value=!0,ua.Z.boton_pulsar("BOT_ACEPTAR")}const I=(0,J.iH)(),j=(0,J.iH)(null);function S(a){ta.socket[a]("Cashlogy.update",F)}function F(a){switch(j.value=a.proceso,a.proceso){case"COBRAR":switch(I.value=a.state,a.state){case"ENTRADA":r.value=(0,da.vg)(a.importe_entrado,!0),v.value=a.importe_pendiente<0,v.value?n.value=(0,da.vg)(-a.importe_pendiente,!0):s.value=(0,da.vg)(a.importe_pendiente,!0),c.value=(0,da.vg)(a.importe_entrado_manualmente,!0);break;case"VUELTA":case"CANCELAR":n.value=(0,da.vg)(a.importe_a_devolver,!0);break}break;case"AÑADIR_CAMBIOS":w.value=(0,da.c)(a),u.value=(0,da.vg)(a.importe_entrado,!0),d.value=(0,da.vg)(a.importe_recicladores,!0);break;case"SOLO_DISPENSAR":n.value=(0,da.vg)(a.importe_a_devolver,!0);break}}let N=!1;async function U(a,e,o){let t;if(N=!0,j.value=null,va.Z.Info({importe_a_cobrar:a,totalRecibido:e,cantidadTkrs:o},"CashlogyCobroView","run-in"),await(0,da.R_)(l),l.value.texto_botones_para_abort("COBRAR MANUALMENTE","CANCELAR COBRO"),t=await l.value.start(),t)return va.Z.Info(t,"CashlogyCobroView","run-out"),N=!1,t;S("on");try{await ua.Z.saveGrupoProcesos("COBRAR",{importe_a_cobrar:a}),m.value=!1,T=e+o,await ua.Z.importe_entrado_manualmente_en_cobrar(T);let r=await ua.Z.cobrar(a);if(null!=r.importe_entrado&&(l.value.texto_botones_para_abort(f(r.operativa_cancelar)),await ua.Z.saveGrupoProcesos(null,{importe_entrado:r.importe_entrado})),t=await(l.value?.informacionAbort_y_cancel(r)),!t){t=null;let a=r.importe_falta_devolver??0,e=0,o=r.error_en_la_devolucion,s=r.operativa_cancelar;_.value=s?"Cancelando":"Dispensando";while(!t){if(j.value="ERROR_DEVOLUCION",await(0,da.R_)(i),await i.value.run({error_en_la_devolucion:o}),0==a){t={cancelado:s,importe_falta_devolver:0,importe_anadido_en_cambios:e};break}let[n,u]=await l.value.startPantalla_withReset(P,{importe_falta_devolver:a,opcion_cancelar:!s&&0==r.importe_devuelto&&a==r.importe_falta_devolver,cancelando:s});if(u)t=u;else if("AÑADIR"==n){j.value=null,p.value=!1;let i=await ua.Z.anadir_cambios_y_devolver(a);t=await(l.value?.informacionAbort_y_cancel(i)),t?t.importe_falta_devolver=a:(o=i.error_en_la_devolucion,a=i.importe_falta_devolver,e+=i.importe_anadido_en_cambios,await ua.Z.saveGrupoProcesos(null,{importe_anadido_en_cambios:e}))}else if("CANCELAR"==n){s=!0,l.value.texto_botones_para_abort(f(!0)),a=r.importe_entrado,_.value="Cancelando";let e=await ua.Z.solo_dispensar(a);t=await(l.value?.informacionAbort_y_cancel(e)),t?t.importe_falta_devolver=a:(o=e.error_en_la_devolucion,a=e.importe_falta_devolver)}else t={cancelado:s,importe_falta_devolver:a,importe_anadido_en_cambios:e}}}t.abort_id||(await ua.Z.saveGrupoProcesos(null),await(0,ca.i_)(t.importe_anadido_en_cambios,"Añadir Cambios","ENTRADA_DINERO"))}catch(r){console.log(r),t={cancelado:!0}}return S("off"),l.value?.end(),va.Z.Info(t,"CashlogyCobroView","run-out"),N=!1,t}return(0,o.Ah)((()=>{N&&ua.Z.boton_pulsar("BOT_ABORTAR_Y_CANCELAR")})),e({run:U,activado:C}),(a,e)=>((0,o.wg)(),(0,o.j4)(na.Z,{enProceso:null!=j.value,ref_key:"CashlogyPantalla_ref",ref:l},{default:(0,o.w5)((()=>["COBRAR"==j.value?((0,o.wg)(),(0,o.iD)("div",pa,["ENTRADA"==I.value?((0,o.wg)(),(0,o.iD)("div",ga,[(0,o._)("div",{class:"text-end",style:(0,t.j5)({visibility:k.value?"visible":"hidden"})},[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)([1,2,5,10,20,50,100,200],(a=>(0,o._)("img",{src:(0,J.SU)(da.Cq)("monedas",a),class:"sizeMonedas",onClick:e=>h(a)},null,8,_a))),64))],4),(0,o._)("div",{class:"text-end",style:(0,t.j5)([{"margin-top":"2vmin"},{visibility:k.value?"visible":"hidden"}])},[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)([500,1e3,2e3,5e3,1e4,2e4,5e4],(a=>(0,o._)("img",{src:(0,J.SU)(da.Cq)("billetes",a),class:"sizeBilletes",onClick:e=>h(a)},null,8,fa))),64))],4),(0,o._)("div",Ca,[(0,o._)("div",wa,[(0,o._)("div",ba,[(0,o._)("div",ka,[(0,o.Uk)(" Importe entrado: "+(0,t.zw)(r.value),1),ya,v.value?((0,o.wg)(),(0,o.iD)("div",Da," Importe a devolver: "+(0,t.zw)(n.value),1)):((0,o.wg)(),(0,o.iD)("div",ha," Importe pendiente: "+(0,t.zw)(s.value),1)),c.value?((0,o.wg)(),(0,o.iD)("div",Ta," Importe manual: "+(0,t.zw)(c.value),1)):(0,o.kq)("",!0)])])]),(0,o._)("div",Aa,[(0,o._)("div",za,[(0,o._)("div",{style:(0,t.j5)([{flex:"0 0 35%","align-content":"center"},{visibility:k.value?"visible":"hidden"}])},[((0,o.wg)(),(0,o.j4)(sa.Z,{key:0,tipo_importe:"",onClickKey:M}))],4),(0,o._)("div",{style:(0,t.j5)({visibility:k.value?"visible":"hidden"})},[Ea,Ma,(0,o.wy)((0,o._)("input",{type:"text",readonly:"",onFocus:e[0]||(e[0]=a=>{a.currentTarget?.blur?.()}),"onUpdate:modelValue":e[1]||(e[1]=a=>D.value=a),class:"cashlogyCierreFondoCaja_selected",style:{"text-align":"end","border-radius":"4px"}},null,544),[[la.nr,D.value]])],4),k.value?((0,o.wg)(),(0,o.iD)("div",Ra,[(0,o.Wm)((0,J.SU)(oa.$v),{onClick:R,color:"success",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Aceptar ")])),_:1}),(0,o.Wm)((0,J.SU)(oa.$v),{onClick:B,color:"danger",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Cancelar ")])),_:1})])):((0,o.wg)(),(0,o.iD)("div",Ba,[(0,o.Wm)((0,J.SU)(oa.$v),{disabled:m.value,onClick:b,color:"danger",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Cancelar ")])),_:1},8,["disabled"]),(0,o.Wm)((0,J.SU)(oa.$v),{disabled:m.value,onClick:y,color:"warning",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Cobro Manual ")])),_:1},8,["disabled"])]))])])])])):(0,o.kq)("",!0),"VUELTA"==I.value?((0,o.wg)(),(0,o.iD)("div",Oa,[(0,o.Uk)(" Dispensando"),Pa,(0,o.Uk)(" Importe a devolver: "+(0,t.zw)(n.value),1)])):(0,o.kq)("",!0),"CANCELAR"==I.value?((0,o.wg)(),(0,o.iD)("div",xa,[(0,o.Uk)(" Cancelando"),Ia,(0,o.Uk)(" Importe a devolver: "+(0,t.zw)(n.value),1)])):(0,o.kq)("",!0)])):(0,o.kq)("",!0),"PANTALLA_FALTA_CAMBIO_DEVOLUCION"==j.value?((0,o.wg)(),(0,o.iD)("div",ja,[(0,o._)("div",Sa,[Fa,(0,o._)("span",null,"Importe falta devolver: "+(0,t.zw)(n.value),1),(0,o.Wm)((0,J.SU)(oa.$v),{onClick:e[2]||(e[2]=a=>(0,J.SU)(P).R("AÑADIR")),color:"success",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" añadir cambios ")])),_:1}),(0,o.Wm)((0,J.SU)(oa.$v),{onClick:e[3]||(e[3]=a=>(0,J.SU)(P).R("MANUAL")),color:"warning",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(O.value),1)])),_:1}),g.value?((0,o.wg)(),(0,o.j4)((0,J.SU)(oa.$v),{key:0,onClick:e[4]||(e[4]=a=>(0,J.SU)(P).R("CANCELAR")),color:"danger",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" cancelar ")])),_:1})):(0,o.kq)("",!0)])])):(0,o.kq)("",!0),"AÑADIR_CAMBIOS"==j.value?((0,o.wg)(),(0,o.iD)("div",Na,[(0,o.Wm)(ia.Z,{tabla:w.value,style:{flex:"0 0 75%"}},null,8,["tabla"]),(0,o._)("div",Ua,[(0,o._)("span",null,"Importe introducido : "+(0,t.zw)(u.value),1),(0,o._)("span",null,"Importe total: "+(0,t.zw)(d.value),1),(0,o._)("span",null,"Importe falta devolver: "+(0,t.zw)(n.value),1),(0,o.Wm)((0,J.SU)(oa.$v),{disabled:p.value,onClick:x,color:"success",class:"boton-Cashlogy"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Aceptar ")])),_:1},8,["disabled"])])])):(0,o.kq)("",!0),"SOLO_DISPENSAR"==j.value?((0,o.wg)(),(0,o.iD)("div",Za,[(0,o._)("div",null,[(0,o.Uk)((0,t.zw)(_.value),1),Va,(0,o.Uk)(" Importe a devolver: "+(0,t.zw)(n.value),1)])])):(0,o.kq)("",!0),"ERROR_DEVOLUCION"==j.value?((0,o.wg)(),(0,o.j4)(ra.Z,{key:4,ref_key:"CashlogyErrorDevolucion_ref",ref:i},null,512)):(0,o.kq)("",!0)])),_:1},8,["enProceso"]))}},La=l(40089);const $a=(0,La.Z)(Ha,[["__scopeId","data-v-98d6db00"]]);var Wa=$a,qa=l(91076),Ga=l(20065),Ja=l(22483),Ya={name:"CobroView",components:{CambioComponent:Y.Z,MDBCard:oa.Yl,MDBBtn:oa.$v,MDBCardBody:oa.H7,MDBCardText:oa.Pp,NumpadComponent:ea.Z,VolverComponent:K.Z,ModalTkrsComponent:Q.Z,MDBIcon:oa.vm,MDBModal:oa.j3,MDBModalBody:oa.Yz,CashlogyCobroView:Wa},setup(a,{expose:e}){const l=(0,Ga.oR)(),t=(0,J.iH)(!1),i=(0,J.iH)(!1),r=(0,Ja.tv)(),s=(0,o.Fl)((()=>l.state.Datafono.procesoActual)),n=(0,J.iH)(null),u=(0,J.iH)("EFECTIVO"),d=(0,J.iH)(0),c=(0,J.iH)(null),v=(0,J.iH)(!1),m=(0,J.iH)(!1),p=(0,J.iH)(0),g=(0,J.iH)(!1),_=(0,J.iH)(0),f=(0,J.iH)(0),C=(0,J.iH)([]),w=(0,J.iH)(null),b=(0,o.Fl)((()=>O.value?.lista)),k=((0,o.f3)("resetGeneral"),(0,J.iH)(null));let y=(0,o.Fl)((()=>{if(B.value&&B.value-p.value<0)return 0;if(B.value){let a=f.value==B.value?R.value:0;return B.value-(_.value+p.value+a)}if(f.value-p.value<0)return 0;{let a=f.value==B.value?R.value:0;return"RECOGER ENCARGO"!=O?.value?.modo&&"PAGO DEUDA"!=O?.value?.modo||(a=R.value),f.value-(_.value+p.value+a)}}));const h=(0,o.Fl)((()=>l.state.Trabajadores.indexActivo)),D=(0,o.Fl)((()=>l.state.Trabajadores.arrayTrabajadores)),T=(0,o.Fl)((()=>l.state.Cestas.arrayCestas)),A=(0,o.Fl)((()=>{const a=l.state.Cestas.Descuento;return void 0===a||isNaN(a)?0:a})),z=(0,o.Fl)((()=>D.value&&void 0!=h.value&&null!=h.value&&D.value[h.value]?D.value[h.value]:null)),E=(0,o.Fl)((()=>l.state.Deudas.deudasSeleccionadas)),M=(0,o.Fl)((()=>l.state.Encargos.encargoSeleccionado)),R=(0,o.Fl)((()=>{if(E.value.length>0){let a=0;for(const e of E.value)e.dejaCuenta&&(a+=e.dejaCuenta);return a}return M.value&&"RECOGER ENCARGO"==O?.value?.modo&&M.value.dejaCuenta||0})),B=(0,o.Fl)((()=>l.state.Deudas.totalAPagar));let O=(0,J.iH)(null);function P(a){p.value=Number(a),a>=W(O.value)?u.value="TKRS":u.value="EFECTIVO"}function x(a){g.value||(p.value<W(O.value)&&p.value>=0?"TARJETA"===a&&p.value>0?aa().fire("Oops...","De momento el Ticket Restaurant solo se puede combinar con EFECTIVO","error"):u.value=a:aa().fire("¡Eo!","El ticket resturant ya cubre el total de la venta","error"))}async function I(a){O=(0,o.Fl)((()=>{if(T.value)for(let a=0;a<T.value.length;a++)if(T.value[a]._id==D.value[h.value].idCesta)return T.value[a];return null}));const e=O.value?O.value.lista.filter((a=>a.pagado)).reduce(((a,e)=>a+e.subtotal),0):0;f.value=O.value?W(O.value)-e:0,t.value=!0}async function j(){g.value?va.Z.Warn(`cobrar loading.value: ${g.value}`,"modalCobroView.vue"):(g.value=!0,va.Z.Info("cobrar inicio","modalCobroView.vue"),"PAGO DEUDA"==O.value.modo?await S():await F())}async function S(){try{let a;if("TARJETA"==u.value)a=await qa.Z.post("deudas/crearPagoDeudaPaytef",{total:W(O.value),pagoParcial:B.value,idCesta:O.value._id,idTrabajador:z.value._id,tipo:u.value,tkrsData:{cantidadTkrs:p.value,formaPago:"EFECTIVO"},arrayDeudas:E.value});else{if("EFECTIVO"==u.value&&y.value>0&&await w.value.activado()){let a=await w.value.run(f.value,_.value,p.value);if(a.cancelado)throw new Error("Pago cancelado")}a=await qa.Z.post("deudas/crearPagoDeuda",{total:W(O.value),pagoParcial:B.value,idCesta:O.value._id,idTrabajador:z.value._id,tipo:u.value,tkrsData:{cantidadTkrs:p.value,formaPago:"EFECTIVO"},arrayDeudas:E.value})}if(!a.data){if("TARJETA"==u.value)throw Error("Pago con datáfono invalido");throw Error("No se ha podido crear el pago de deuda")}aa().fire({icon:"success",title:"Pago deuda registrada correctamente",showConfirmButton:!1,timer:500}),await qa.Z.post("impresora/saludo").catch((a=>{aa().fire("Oops...",a.message,"error")})),await qa.Z.post("cestas/deselectClient",{idCesta:l.getters["Cestas/getCestaBaseActivo"]}),U(),V(),await $(O.value._id),u.value="EFECTIVO",L(!0)}catch(a){aa().fire("Oops...",a.message,"error")}g.value=!1,K()}async function F(){try{const a=JSON.parse(JSON.stringify(O.value.lista)),e=a.some((a=>a.pagado));let o;const t="PAGO SEPARADO"==O.value.modo,i="RECOGER ENCARGO"==O.value.modo,r=t||i?R.value:0,s=i?O.value.nombreCliente:null;if("TARJETA"==u.value)l.dispatch("Datafono/setEstado","PENDIENTE"),o=await qa.Z.post("tickets/crearTicketPaytef",{total:W(O.value),idCesta:O.value._id,idTrabajador:z.value._id,tipo:u.value,tkrsData:{cantidadTkrs:Number((Math.round(100*p.value)/100).toFixed(2)),formaPago:"EFECTIVO"},honei:e,dejaCuenta:R.value});else{if("EFECTIVO"==u.value&&y.value>0&&await w.value.activado()){let a=await w.value.run(f.value,_.value,p.value);if(a.cancelado)throw new Error("Pago cancelado")}o=await qa.Z.post("tickets/crearTicket",{total:W(O.value),idCesta:O.value._id,idTrabajador:z.value._id,tipo:u.value,tkrsData:{cantidadTkrs:Number((Math.round(100*p.value)/100).toFixed(2)),formaPago:"EFECTIVO"},honei:e,dejaCuenta:R.value})}if(!o.data){if("TARJETA"==u.value)throw Error("Pago con datáfono invalido");throw Error("No se ha podido crear el ticket")}r>0&&i&&"TARJETA"!=u.value&&qa.Z.post("movimientos/nuevoMovimiento",{cantidad:r,concepto:"dejaACuenta",idTrabajador:z.value._id,tipo:"SALIDA",idTicket:o.data,nombreCliente:s}).then((a=>{if(!a.data)throw Error("No se ha podido realizar la salida de dinero")})).catch((a=>{aa().fire("Oops...",a.message,"error")})),aa().fire({icon:"success",title:"Venta registrada correctamente",showConfirmButton:!1,timer:500}),await qa.Z.post("impresora/saludo").catch((a=>{aa().fire("Oops...",a.message,"error")})),m.value&&"TARJETA"!=u.value&&await qa.Z.post("tickets/getUltimoTicket").then((async a=>{a.data[0]?._id?await qa.Z.post("impresora/imprimirTicket",{idTicket:a.data[0]?._id}).catch((a=>{aa().fire("Oops...",a.message,"error")})):aa().fire("AVISO","Crea un ticket en esta caja abierta","info")})),i&&await qa.Z.post("cestas/deselectClient",{idCesta:l.getters["Cestas/getCestaBaseActivo"]}),(t||i)&&await $(O.value._id),i&&(qa.Z.post("encargos/setEntregado",{id:M.value._id}),Z()),N(),u.value="EFECTIVO",L(!0)}catch(a){aa().fire("Oops...",a.message,"error")}g.value=!1,K(),va.Z.Info("cobrar fin","modalCobroView.vue")}function N(){let a=!1;T.value.forEach((e=>{if(!a&&e.trabajador===D.value[h.value]._id&&"DEVOLUCION"!=e.modo){a=!0;let l=e._id;qa.Z.post("cestas/cambiarCestaTrabajador",{idCesta:l,idTrabajador:D.value[h.value]._id})}}))}function U(){l.dispatch("Deudas/deleteDeudasSeleccionadas")}function Z(){l.dispatch("Encargos/deleteEncargoSeleccionado")}function V(){l.dispatch("Deudas/deleteTotalAPagar")}async function H(){va.Z.Info(`cancelarVenta loading:${g.value}`,"modalCobroView.vue"),L(),K(),"PAGO DEUDA"==O.value.modo?(V(),U(),await $(O.value._id)):"PAGO SEPARADO"==O.value.modo&&await qa.Z.post("cestas/DevolverProductosACestaSep",{cesta:l.getters["Cestas/getCestaBaseActivo"],articulos:O.value.lista}).then((async a=>{await $(O.value._id)}))}function L(a=!1){const e=r.currentRoute.value.path;l.dispatch("ModalCobroView/cerrarModalCobroView"),"/cestas"===e&&a&&r.push("/main"),t.value=!1}async function $(a){qa.Z.post("cestas/fulminarCesta",{idCesta:a}).catch((a=>{aa().fire({icon:"error",title:"Error al eliminar la cesta utilizada.",showConfirmButton:!1,timer:500})})),await qa.Z.post("cestas/cambiarCestaTrabajador",{idCesta:l.getters["Cestas/getCestaBaseActivo"],idTrabajador:D.value[l.state.Trabajadores.indexActivo]._id}).then((a=>{l.dispatch("Cestas/setCestaBaseAction",null)}))}function W(a){const e=a.detalleIva,l=Object.keys(e).filter((a=>a.startsWith("importe"))).reduce(((a,l)=>a+e[l]),0);return Math.round(100*l)/100}function q(){qa.Z.get("caja/estadoCaja").then((a=>{1==a.data&&aa().fire("Caja cerrada automáticamente.","La caja de ayer se ha cerrado automáticamente debido a que no se cerró.","error"),1!=a.data&&3!=a.data||void 0==l.getters["Trabajadores/getTrabajadorActivo"]?._id?void 0==l.getters["Trabajadores/getTrabajadorActivo"]?._id&&r.push("/menu/fichajes"):r.push("/abrirCaja")})).catch((a=>{aa().fire("Oops...",a.message,"error")}))}function G(a){_.value+=a,C.value.push(a)}function Y(){C.value.pop();let a=0;C.value.forEach((e=>{a+=e})),_.value=a}function K(){_.value=0,p.value=0,C.value=[],y=(0,o.Fl)((()=>f.value-p.value<0?0:f.value-(_.value+p.value)))}function Q(a){f.value=Number(a)}return(0,o.JJ)("setTkrs",P),e({abrirModal:I}),(0,o.bv)((()=>{q(),qa.Z.post("parametros/getParametros").then((a=>{"3G"!==a.data?.tipoDatafono&&"0.0.0.0"!=a.data?.ipTefpay||(d.value=1),void 0!=a.data?.params?.SempreTicket?"Si"==a.data?.params?.SempreTicket&&(m.value=!0):m.value=!1,void 0!=a.data?.params?.prohibirTkRestaurant?"Si"==a.data?.params?.prohibirTkRestaurant&&(v.value=!0):v.value=!1}))})),{DescuentoCliente:A,cesta:O,getTotal:W,cobrar:j,formaPago:u,modalTkrsRef:c,prohibirTkRestaurant:v,setFormaPago:x,loading:g,tipoDatafono3G:d,eliminarAlPagarFnc:$,modalNumpad:i,cancelarVenta:H,modalCobro:t,abrirModal:I,sumar:G,totalRecibido:_,aPagar:f,numPadRef:n,deshacer:Y,limpiar:K,procesoDatafono:s,setTkrs:P,cantidadTkrs:p,setAPagar:Q,cuenta:y,productos:b,cliente:k,dejaCuenta:R,deudasSeleccionadas:E,montoDeuda:B,CashlogyCobroViewRef:w}}};const Ka=(0,La.Z)(Ya,[["render",G],["__scopeId","data-v-4e227e65"]]);var Qa=Ka}}]);
//# sourceMappingURL=779.9010cceb.js.map